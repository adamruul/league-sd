(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsCore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsCore=(()=>{var KSe=Object.create;var qm=Object.defineProperty;var jSe=Object.getOwnPropertyDescriptor;var VSe=Object.getOwnPropertyNames;var zSe=Object.getPrototypeOf,HSe=Object.prototype.hasOwnProperty;var OC=r=>qm(r,"__esModule",{value:!0});var Ho=r=>{if(typeof require!="undefined")return require(r);throw new Error('Dynamic require of "'+r+'" is not supported')};var Ge=(r,e)=>()=>(r&&(e=r(r=0)),e);var p=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Ht=(r,e)=>{OC(r);for(var t in e)qm(r,t,{get:e[t],enumerable:!0})},$Se=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of VSe(e))!HSe.call(r,i)&&i!=="default"&&qm(r,i,{get:()=>e[i],enumerable:!(t=jSe(e,i))||t.enumerable});return r},qC=r=>$Se(OC(qm(r!=null?KSe(zSe(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var BC=p(km=>{u();"use strict";km.byteLength=YSe;km.toByteArray=QSe;km.fromByteArray=e3e;var $o=[],ps=[],GSe=typeof Uint8Array!="undefined"?Uint8Array:Array,US="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var sh=0,WSe=US.length;sh<WSe;++sh)$o[sh]=US[sh],ps[US.charCodeAt(sh)]=sh;ps["-".charCodeAt(0)]=62;ps["_".charCodeAt(0)]=63;function kC(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function YSe(r){var e=kC(r),t=e[0],i=e[1];return(t+i)*3/4-i}function XSe(r,e,t){return(e+t)*3/4-t}function QSe(r){var e,t=kC(r),i=t[0],n=t[1],s=new GSe(XSe(r,i,n)),o=0,a=n>0?i-4:i,c;for(c=0;c<a;c+=4)e=ps[r.charCodeAt(c)]<<18|ps[r.charCodeAt(c+1)]<<12|ps[r.charCodeAt(c+2)]<<6|ps[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=ps[r.charCodeAt(c)]<<2|ps[r.charCodeAt(c+1)]>>4,s[o++]=e&255),n===1&&(e=ps[r.charCodeAt(c)]<<10|ps[r.charCodeAt(c+1)]<<4|ps[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function JSe(r){return $o[r>>18&63]+$o[r>>12&63]+$o[r>>6&63]+$o[r&63]}function ZSe(r,e,t){for(var i,n=[],s=e;s<t;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(JSe(i));return n.join("")}function e3e(r){for(var e,t=r.length,i=t%3,n=[],s=16383,o=0,a=t-i;o<a;o+=s)n.push(ZSe(r,o,o+s>a?a:o+s));return i===1?(e=r[t-1],n.push($o[e>>2]+$o[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push($o[e>>10]+$o[e>>4&63]+$o[e<<2&63]+"=")),n.join("")}});var NC=p(FS=>{u();FS.read=function(r,e,t,i,n){var s,o,a=n*8-i-1,c=(1<<a)-1,f=c>>1,l=-7,h=t?n-1:0,d=t?-1:1,y=r[e+h];for(h+=d,s=y&(1<<-l)-1,y>>=-l,l+=a;l>0;s=s*256+r[e+h],h+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=o*256+r[e+h],h+=d,l-=8);if(s===0)s=1-f;else{if(s===c)return o?NaN:(y?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-f}return(y?-1:1)*o*Math.pow(2,s-i)};FS.write=function(r,e,t,i,n,s){var o,a,c,f=s*8-n-1,l=(1<<f)-1,h=l>>1,d=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=i?0:s-1,g=i?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+h>=1?e+=d/c:e+=d*Math.pow(2,1-h),e*c>=2&&(o++,c/=2),o+h>=l?(a=0,o=l):o+h>=1?(a=(e*c-1)*Math.pow(2,n),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;r[t+y]=a&255,y+=g,a/=256,n-=8);for(o=o<<n|a,f+=n;f>0;r[t+y]=o&255,y+=g,o/=256,f-=8);r[t+y-g]|=m*128}});var pt=p(uh=>{u();"use strict";var KS=BC(),oh=NC(),DC=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;uh.Buffer=le;uh.SlowBuffer=o3e;uh.INSPECT_MAX_BYTES=50;var Bm=2147483647;uh.kMaxLength=Bm;le.TYPED_ARRAY_SUPPORT=t3e();!le.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function t3e(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch(r){return!1}}Object.defineProperty(le.prototype,"parent",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.buffer}});Object.defineProperty(le.prototype,"offset",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.byteOffset}});function ec(r){if(r>Bm)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,le.prototype),e}function le(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return jS(r)}return MC(r,e,t)}le.poolSize=8192;function MC(r,e,t){if(typeof r=="string")return i3e(r,e);if(ArrayBuffer.isView(r))return n3e(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(Go(r,ArrayBuffer)||r&&Go(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Go(r,SharedArrayBuffer)||r&&Go(r.buffer,SharedArrayBuffer)))return zS(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return le.from(i,e,t);let n=s3e(r);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return le.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}le.from=function(r,e,t){return MC(r,e,t)};Object.setPrototypeOf(le.prototype,Uint8Array.prototype);Object.setPrototypeOf(le,Uint8Array);function LC(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function r3e(r,e,t){return LC(r),r<=0?ec(r):e!==void 0?typeof t=="string"?ec(r).fill(e,t):ec(r).fill(e):ec(r)}le.alloc=function(r,e,t){return r3e(r,e,t)};function jS(r){return LC(r),ec(r<0?0:HS(r)|0)}le.allocUnsafe=function(r){return jS(r)};le.allocUnsafeSlow=function(r){return jS(r)};function i3e(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!le.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=UC(r,e)|0,i=ec(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function VS(r){let e=r.length<0?0:HS(r.length)|0,t=ec(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function n3e(r){if(Go(r,Uint8Array)){let e=new Uint8Array(r);return zS(e.buffer,e.byteOffset,e.byteLength)}return VS(r)}function zS(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,le.prototype),i}function s3e(r){if(le.isBuffer(r)){let e=HS(r.length)|0,t=ec(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||WS(r.length)?ec(0):VS(r);if(r.type==="Buffer"&&Array.isArray(r.data))return VS(r.data)}function HS(r){if(r>=Bm)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Bm.toString(16)+" bytes");return r|0}function o3e(r){return+r!=r&&(r=0),le.alloc(+r)}le.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==le.prototype};le.compare=function(e,t){if(Go(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),Go(t,Uint8Array)&&(t=le.from(t,t.offset,t.byteLength)),!le.isBuffer(e)||!le.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};le.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};le.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return le.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=le.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){let o=e[i];if(Go(o,Uint8Array))s+o.length>n.length?(le.isBuffer(o)||(o=le.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(le.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function UC(r,e){if(le.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||Go(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return GS(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return QC(r).length;default:if(n)return i?-1:GS(r).length;e=(""+e).toLowerCase(),n=!0}}le.byteLength=UC;function a3e(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return b3e(this,e,t);case"utf8":case"utf-8":return jC(this,e,t);case"ascii":return y3e(this,e,t);case"latin1":case"binary":return g3e(this,e,t);case"base64":return d3e(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m3e(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}le.prototype._isBuffer=!0;function bl(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}le.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)bl(this,t,t+1);return this};le.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)bl(this,t,t+3),bl(this,t+1,t+2);return this};le.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)bl(this,t,t+7),bl(this,t+1,t+6),bl(this,t+2,t+5),bl(this,t+3,t+4);return this};le.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?jC(this,0,e):a3e.apply(this,arguments)};le.prototype.toLocaleString=le.prototype.toString;le.prototype.equals=function(e){if(!le.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:le.compare(this,e)===0};le.prototype.inspect=function(){let e="",t=uh.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};DC&&(le.prototype[DC]=le.prototype.inspect);le.prototype.compare=function(e,t,i,n,s){if(Go(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),!le.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-t,c=Math.min(o,a),f=this.slice(n,s),l=e.slice(t,i);for(let h=0;h<c;++h)if(f[h]!==l[h]){o=f[h],a=l[h];break}return o<a?-1:a<o?1:0};function FC(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,WS(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=le.from(e,i)),le.isBuffer(e))return e.length===0?-1:KC(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):KC(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function KC(r,e,t,i,n){let s=1,o=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function c(l,h){return s===1?l[h]:l.readUInt16BE(h*s)}let f;if(n){let l=-1;for(f=t;f<o;f++)if(c(r,f)===c(e,l===-1?0:f-l)){if(l===-1&&(l=f),f-l+1===a)return l*s}else l!==-1&&(f-=f-l),l=-1}else for(t+a>o&&(t=o-a),f=t;f>=0;f--){let l=!0;for(let h=0;h<a;h++)if(c(r,f+h)!==c(e,h)){l=!1;break}if(l)return f}return-1}le.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};le.prototype.indexOf=function(e,t,i){return FC(this,e,t,i,!0)};le.prototype.lastIndexOf=function(e,t,i){return FC(this,e,t,i,!1)};function c3e(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(WS(a))return o;r[t+o]=a}return o}function u3e(r,e,t,i){return Nm(GS(e,r.length-t),r,t,i)}function l3e(r,e,t,i){return Nm(E3e(e),r,t,i)}function f3e(r,e,t,i){return Nm(QC(e),r,t,i)}function h3e(r,e,t,i){return Nm(S3e(e,r.length-t),r,t,i)}le.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return c3e(this,e,t,i);case"utf8":case"utf-8":return u3e(this,e,t,i);case"ascii":case"latin1":case"binary":return l3e(this,e,t,i);case"base64":return f3e(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h3e(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};le.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function d3e(r,e,t){return e===0&&t===r.length?KS.fromByteArray(r):KS.fromByteArray(r.slice(e,t))}function jC(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let s=r[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){let c,f,l,h;switch(a){case 1:s<128&&(o=s);break;case 2:c=r[n+1],(c&192)==128&&(h=(s&31)<<6|c&63,h>127&&(o=h));break;case 3:c=r[n+1],f=r[n+2],(c&192)==128&&(f&192)==128&&(h=(s&15)<<12|(c&63)<<6|f&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:c=r[n+1],f=r[n+2],l=r[n+3],(c&192)==128&&(f&192)==128&&(l&192)==128&&(h=(s&15)<<18|(c&63)<<12|(f&63)<<6|l&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return p3e(i)}var VC=4096;function p3e(r){let e=r.length;if(e<=VC)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=VC));return t}function y3e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function g3e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function b3e(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let s=e;s<t;++s)n+=A3e[r[s]];return n}function m3e(r,e,t){let i=r.slice(e,t),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}le.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,le.prototype),n};function Ti(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}le.prototype.readUintLE=le.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ti(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return n};le.prototype.readUintBE=le.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ti(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n};le.prototype.readUint8=le.prototype.readUInt8=function(e,t){return e=e>>>0,t||Ti(e,1,this.length),this[e]};le.prototype.readUint16LE=le.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||Ti(e,2,this.length),this[e]|this[e+1]<<8};le.prototype.readUint16BE=le.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||Ti(e,2,this.length),this[e]<<8|this[e+1]};le.prototype.readUint32LE=le.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||Ti(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};le.prototype.readUint32BE=le.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||Ti(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};le.prototype.readBigUInt64LE=Qc(function(e){e=e>>>0,ch(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&H0(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});le.prototype.readBigUInt64BE=Qc(function(e){e=e>>>0,ch(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&H0(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});le.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ti(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};le.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ti(e,t,this.length);let n=t,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};le.prototype.readInt8=function(e,t){return e=e>>>0,t||Ti(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};le.prototype.readInt16LE=function(e,t){e=e>>>0,t||Ti(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};le.prototype.readInt16BE=function(e,t){e=e>>>0,t||Ti(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};le.prototype.readInt32LE=function(e,t){return e=e>>>0,t||Ti(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};le.prototype.readInt32BE=function(e,t){return e=e>>>0,t||Ti(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};le.prototype.readBigInt64LE=Qc(function(e){e=e>>>0,ch(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&H0(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});le.prototype.readBigInt64BE=Qc(function(e){e=e>>>0,ch(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&H0(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});le.prototype.readFloatLE=function(e,t){return e=e>>>0,t||Ti(e,4,this.length),oh.read(this,e,!0,23,4)};le.prototype.readFloatBE=function(e,t){return e=e>>>0,t||Ti(e,4,this.length),oh.read(this,e,!1,23,4)};le.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||Ti(e,8,this.length),oh.read(this,e,!0,52,8)};le.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||Ti(e,8,this.length),oh.read(this,e,!1,52,8)};function Cn(r,e,t,i,n,s){if(!le.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}le.prototype.writeUintLE=le.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Cn(this,e,t,i,a,0)}let s=1,o=0;for(this[t]=e&255;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i};le.prototype.writeUintBE=le.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Cn(this,e,t,i,a,0)}let s=i-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i};le.prototype.writeUint8=le.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,1,255,0),this[t]=e&255,t+1};le.prototype.writeUint16LE=le.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};le.prototype.writeUint16BE=le.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};le.prototype.writeUint32LE=le.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};le.prototype.writeUint32BE=le.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function zC(r,e,t,i,n){XC(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,t}function HC(r,e,t,i,n){XC(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=o,o=o>>8,r[t+2]=o,o=o>>8,r[t+1]=o,o=o>>8,r[t]=o,t+8}le.prototype.writeBigUInt64LE=Qc(function(e,t=0){return zC(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeBigUInt64BE=Qc(function(e,t=0){return HC(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);Cn(this,e,t,i,c-1,-c)}let s=0,o=1,a=0;for(this[t]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[t+s-1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};le.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);Cn(this,e,t,i,c-1,-c)}let s=i-1,o=1,a=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[t+s+1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};le.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};le.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};le.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};le.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};le.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Cn(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};le.prototype.writeBigInt64LE=Qc(function(e,t=0){return zC(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});le.prototype.writeBigInt64BE=Qc(function(e,t=0){return HC(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function $C(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function GC(r,e,t,i,n){return e=+e,t=t>>>0,n||$C(r,e,t,4,34028234663852886e22,-34028234663852886e22),oh.write(r,e,t,i,23,4),t+4}le.prototype.writeFloatLE=function(e,t,i){return GC(this,e,t,!0,i)};le.prototype.writeFloatBE=function(e,t,i){return GC(this,e,t,!1,i)};function WC(r,e,t,i,n){return e=+e,t=t>>>0,n||$C(r,e,t,8,17976931348623157e292,-17976931348623157e292),oh.write(r,e,t,i,52,8),t+8}le.prototype.writeDoubleLE=function(e,t,i){return WC(this,e,t,!0,i)};le.prototype.writeDoubleBE=function(e,t,i){return WC(this,e,t,!1,i)};le.prototype.copy=function(e,t,i,n){if(!le.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};le.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!le.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{let o=le.isBuffer(e)?e:le.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var ah={};function $S(r,e,t){ah[r]=class extends t{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}$S("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);$S("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);$S("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=YC(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=YC(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function YC(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function v3e(r,e,t){ch(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&H0(e,r.length-(t+1))}function XC(r,e,t,i,n,s){if(r>t||r<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${t}${o}`,new ah.ERR_OUT_OF_RANGE("value",a,r)}v3e(i,n,s)}function ch(r,e){if(typeof r!="number")throw new ah.ERR_INVALID_ARG_TYPE(e,"number",r)}function H0(r,e,t){throw Math.floor(r)!==r?(ch(r,t),new ah.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new ah.ERR_BUFFER_OUT_OF_BOUNDS:new ah.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var w3e=/[^+/0-9A-Za-z-_]/g;function _3e(r){if(r=r.split("=")[0],r=r.trim().replace(w3e,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function GS(r,e){e=e||1/0;let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function E3e(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function S3e(r,e){let t,i,n,s=[];for(let o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function QC(r){return KS.toByteArray(_3e(r))}function Nm(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function Go(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function WS(r){return r!==r}var A3e=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function Qc(r){return typeof BigInt=="undefined"?x3e:r}function x3e(){throw new Error("BigInt not supported")}});var rO=p((Ewt,tO)=>{u();var ii=tO.exports={},Wo,Yo;function YS(){throw new Error("setTimeout has not been defined")}function XS(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Wo=setTimeout:Wo=YS}catch(r){Wo=YS}try{typeof clearTimeout=="function"?Yo=clearTimeout:Yo=XS}catch(r){Yo=XS}})();function JC(r){if(Wo===setTimeout)return setTimeout(r,0);if((Wo===YS||!Wo)&&setTimeout)return Wo=setTimeout,setTimeout(r,0);try{return Wo(r,0)}catch(e){try{return Wo.call(null,r,0)}catch(t){return Wo.call(this,r,0)}}}function I3e(r){if(Yo===clearTimeout)return clearTimeout(r);if((Yo===XS||!Yo)&&clearTimeout)return Yo=clearTimeout,clearTimeout(r);try{return Yo(r)}catch(e){try{return Yo.call(null,r)}catch(t){return Yo.call(this,r)}}}var tc=[],lh=!1,ml,Dm=-1;function T3e(){!lh||!ml||(lh=!1,ml.length?tc=ml.concat(tc):Dm=-1,tc.length&&ZC())}function ZC(){if(!lh){var r=JC(T3e);lh=!0;for(var e=tc.length;e;){for(ml=tc,tc=[];++Dm<e;)ml&&ml[Dm].run();Dm=-1,e=tc.length}ml=null,lh=!1,I3e(r)}}ii.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];tc.push(new eO(r,e)),tc.length===1&&!lh&&JC(ZC)};function eO(r,e){this.fun=r,this.array=e}eO.prototype.run=function(){this.fun.apply(null,this.array)};ii.title="browser";ii.browser=!0;ii.env={};ii.argv=[];ii.version="";ii.versions={};function rc(){}ii.on=rc;ii.addListener=rc;ii.once=rc;ii.off=rc;ii.removeListener=rc;ii.removeAllListeners=rc;ii.emit=rc;ii.prependListener=rc;ii.prependOnceListener=rc;ii.listeners=function(r){return[]};ii.binding=function(r){throw new Error("process.binding is not supported")};ii.cwd=function(){return"/"};ii.chdir=function(r){throw new Error("process.chdir is not supported")};ii.umask=function(){return 0}});var Buffer,process,u=Ge(()=>{({Buffer}=pt()),process=rO()});var QS=p(()=>{u()});var JS=p(Mm=>{u();"use strict";var iO=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};Mm.TimeoutError=iO;var nO=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};Mm.AbortError=nO;var sO=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};Mm.HTTPError=sO});var ZS=p((Twt,oO)=>{u();function R3e(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}oO.exports=R3e});var G0=p((Rwt,aO)=>{u();"use strict";var P3e=ZS(),Lm=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,$0=P3e(),C3e=Lm&&!$0,O3e=$0&&!Lm,q3e=$0&&Lm,k3e=typeof Ho=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!$0,B3e=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,N3e=typeof process!="undefined"&&typeof process.env!="undefined"&&!1,D3e=typeof navigator!="undefined"&&navigator.product==="ReactNative";aO.exports={isTest:N3e,isElectron:$0,isElectronMain:O3e,isElectronRenderer:q3e,isNode:k3e,isBrowser:C3e,isWebWorker:B3e,isEnvWithDom:Lm,isReactNative:D3e}});var cO=p(()=>{u()});var W0=p((fh,uO)=>{u();"use strict";var M3e=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof ic!="undefined")return ic;throw new Error("unable to locate global object")},ic=M3e();uO.exports=fh=ic.fetch;ic.fetch&&(fh.default=ic.fetch.bind(ic));fh.Headers=ic.Headers;fh.Request=ic.Request;fh.Response=ic.Response});var t3=p((Owt,e3)=>{u();"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e3.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e3.exports={default:W0().default,Headers:W0().Headers,Request:W0().Request,Response:W0().Response}});var lO=p((qwt,r3)=>{u();"use strict";var{isElectronMain:L3e}=G0();L3e?r3.exports=cO():r3.exports=t3()});var pO=p((kwt,dO)=>{u();"use strict";var{TimeoutError:U3e,AbortError:F3e}=JS(),{Response:fO,Request:K3e,Headers:i3,default:j3e}=lO(),V3e=(r,e={})=>{let t=new XMLHttpRequest;t.open(e.method||"GET",r.toString(),!0);let{timeout:i,headers:n}=e;if(i&&i>0&&i<1/0&&(t.timeout=i),e.overrideMimeType!=null&&t.overrideMimeType(e.overrideMimeType),n)for(let[s,o]of new i3(n))t.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>t.abort()),e.onUploadProgress&&(t.upload.onprogress=e.onUploadProgress),t.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(fO.error());break}case"load":{s(new hO(t.responseURL,t.response,{status:t.status,statusText:t.statusText,headers:$3e(t.getAllResponseHeaders())}));break}case"timeout":{o(new U3e);break}case"abort":{o(new F3e);break}default:break}};t.onerror=a,t.onload=a,t.ontimeout=a,t.onabort=a,t.send(e.body)})},z3e=j3e,H3e=(r,e={})=>e.onUploadProgress!=null?V3e(r,e):z3e(r,e),$3e=r=>{let e=new i3;for(let t of r.trim().split(/[\r\n]+/)){let i=t.indexOf(": ");i>0&&e.set(t.slice(0,i),t.slice(i+1))}return e},hO=class extends fO{constructor(e,t,i){super(t,i);Object.defineProperty(this,"url",{value:e})}};dO.exports={fetch:H3e,Request:K3e,Headers:i3}});var gO=p((Bwt,yO)=>{u();"use strict";yO.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var mr=p((wO,_O)=>{u();"use strict";var Um=gO(),{hasOwnProperty:bO}=Object.prototype,{propertyIsEnumerable:G3e}=Object,hh=(r,e,t)=>Object.defineProperty(r,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),W3e=wO,mO={concatArrays:!1,ignoreUndefined:!1},Fm=r=>{let e=[];for(let t in r)bO.call(r,t)&&e.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(r);for(let i of t)G3e.call(r,i)&&e.push(i)}return e};function dh(r){return Array.isArray(r)?Y3e(r):Um(r)?X3e(r):r}function Y3e(r){let e=r.slice(0,0);return Fm(r).forEach(t=>{hh(e,t,dh(r[t]))}),e}function X3e(r){let e=Object.getPrototypeOf(r)===null?Object.create(null):{};return Fm(r).forEach(t=>{hh(e,t,dh(r[t]))}),e}var vO=(r,e,t,i)=>(t.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in r&&r[n]!==Object.getPrototypeOf(r)?hh(r,n,n3(r[n],e[n],i)):hh(r,n,dh(e[n])))}),r),Q3e=(r,e,t)=>{let i=r.slice(0,0),n=0;return[r,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!bO.call(s,a)||(o.push(String(a)),s===r?hh(i,n++,s[a]):hh(i,n++,dh(s[a])));i=vO(i,s,Fm(s).filter(a=>!o.includes(a)),t)}),i};function n3(r,e,t){return t.concatArrays&&Array.isArray(r)&&Array.isArray(e)?Q3e(r,e,t):!Um(e)||!Um(r)?dh(e):vO(r,e,Fm(e),t)}_O.exports=function(...r){let e=n3(dh(mO),this!==W3e&&this||{},mO),t={_:{}};for(let i of r)if(i!==void 0){if(!Um(i))throw new TypeError("`"+i+"` is not an Option Object");t=n3(t,{_:i},e)}return t._}});var s3=p((Nwt,AO)=>{u();"use strict";var J3e=typeof navigator!="undefined"&&navigator.product==="ReactNative";function Z3e(){return J3e?"http://localhost":self.location.protocol+"//"+self.location.host}var Y0=self.URL,EO=Z3e(),SO=class{constructor(e="",t=EO){this.super=new Y0(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return Y0.createObjectURL(e)}static revokeObjectURL(e){Y0.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function e6e(r){if(typeof r=="string")return new Y0(r).toString();if(!(r instanceof Y0)){let e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",i=r.port?":"+r.port:"",n=r.protocol?r.protocol+"//":"",s=r.host||"",o=r.hostname||"",a=r.search||(r.query?"?"+r.query:""),c=r.hash||"",f=r.pathname||"",l=r.path||f+a;return`${n}${e||t}${s||o+i}${l}${c}`}}AO.exports={URLWithLegacySupport:SO,URLSearchParams:self.URLSearchParams,defaultBase:EO,format:e6e}});var TO=p((Dwt,IO)=>{u();"use strict";var{URLWithLegacySupport:xO,format:t6e}=s3();IO.exports=(r,e={},t={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(t[n]||i||n)+":";let s;try{s=new xO(r)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new xO(r,t6e(o)).toString()}});var Km=p((Mwt,RO)=>{u();"use strict";var{URLWithLegacySupport:r6e,format:i6e,URLSearchParams:n6e,defaultBase:s6e}=s3(),o6e=TO();RO.exports={URL:r6e,URLSearchParams:n6e,format:i6e,relative:o6e,defaultBase:s6e}});var vl=p((Lwt,jm)=>{u();"use strict";var{AbortController:PO,AbortSignal:a6e}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;jm.exports=PO;jm.exports.AbortSignal=a6e;jm.exports.default=PO});var Ji=p((Uwt,CO)=>{u();"use strict";var Vm;globalThis.AbortController&&globalThis.AbortSignal?Vm=globalThis:Vm=vl();CO.exports={AbortController:Vm.AbortController,AbortSignal:Vm.AbortSignal}});var wl=p((Fwt,o3)=>{u();var{AbortController:c6e}=Ji();function OO(r){let e=new c6e;function t(){e.abort();for(let i of r)!i||!i.removeEventListener||i.removeEventListener("abort",t)}for(let i of r)if(!(!i||!i.addEventListener)){if(i.aborted){t();break}i.addEventListener("abort",t)}return e.signal}o3.exports=OO;o3.exports.anySignal=OO});var X0=p((Kwt,MO)=>{u();"use strict";var{fetch:u6e,Request:l6e,Headers:f6e}=pO(),{TimeoutError:a3,HTTPError:qO}=JS(),kO=mr().bind({ignoreUndefined:!0}),{URL:BO,URLSearchParams:NO}=Km(),{AbortController:h6e}=Ji(),d6e=wl(),p6e=(r,e,t)=>{if(e===void 0)return r;let i=Date.now(),n=()=>Date.now()-i>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{n()&&(o(new a3),t.abort())},e),c=f=>h=>{if(clearTimeout(a),n()){o(new a3);return}f(h)};r.then(c(s),c(o))})},y6e={throwHttpErrors:!0,credentials:"same-origin"},gn=class{constructor(e={}){this.opts=kO(y6e,e)}async fetch(e,t={}){let i=kO(this.opts,t),n=new f6e(i.headers);if(typeof e!="string"&&!(e instanceof BO||e instanceof l6e))throw new TypeError("`resource` must be a string, URL, or Request");let s=new BO(e.toString(),i.base),{searchParams:o,transformSearchParams:a,json:c}=i;o&&(typeof a=="function"?s.search=a(new NO(i.searchParams)):s.search=new NO(i.searchParams)),c&&(i.body=JSON.stringify(i.json),n.set("content-type","application/json"));let f=new h6e,l=d6e([f.signal,i.signal]),h=await p6e(u6e(s.toString(),{...i,signal:l,timeout:void 0,headers:n}),i.timeout,f);if(!h.ok&&i.throwHttpErrors)throw i.handleError&&await i.handleError(h),new qO(h);return h.iterator=function(){return DO(h.body)},h.ndjson=async function*(){for await(let d of g6e(h.iterator()))t.transform?yield t.transform(d):yield d},h}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}},g6e=async function*(r){let e=new TextDecoder,t="";for await(let i of r){t+=e.decode(i,{stream:!0});let n=t.split(/\r?\n/);for(let s=0;s<n.length-1;s++){let o=n[s].trim();o.length>0&&(yield JSON.parse(o))}t=n[n.length-1]}t+=e.decode(),t=t.trim(),t.length!==0&&(yield JSON.parse(t))},DO=r=>{if(v6e(r)){let e=r[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(t){return r.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:t})}}}}}if(m6e(r)){let e=r.getReader();return async function*(){try{for(;;){let{done:t,value:i}=await e.read();if(t)return;i&&(yield i)}}finally{e.releaseLock()}}()}if(b6e(r))return r;throw new TypeError("Body can't be converted to AsyncIterable")},b6e=r=>typeof r=="object"&&r!==null&&typeof r[Symbol.asyncIterator]=="function",m6e=r=>r&&typeof r.getReader=="function",v6e=r=>Object.prototype.hasOwnProperty.call(r,"readable")&&Object.prototype.hasOwnProperty.call(r,"writable");gn.HTTPError=qO;gn.TimeoutError=a3;gn.streamToAsyncIterator=DO;gn.post=(r,e)=>new gn(e).post(r,e);gn.get=(r,e)=>new gn(e).get(r,e);gn.put=(r,e)=>new gn(e).put(r,e);gn.delete=(r,e)=>new gn(e).delete(r,e);gn.options=(r,e)=>new gn(e).options(r,e);MO.exports=gn});var c3=p((jwt,LO)=>{u();"use strict";var w6e=X0(),_6e=(r,e)=>({path:decodeURIComponent(new URL(r).pathname.split("/").pop()||""),content:E6e(r,e)});async function*E6e(r,e){yield*(await new w6e().get(r,e)).iterator()}LO.exports=_6e});function FO(r,e,t){e=e||[],t=t||0;for(var i=t;r>=I6e;)e[t++]=r&255|UO,r/=128;for(;r&x6e;)e[t++]=r&255|UO,r>>>=7;return e[t]=r|0,FO.bytes=t-i+1,e}function u3(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw u3.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&KO)<<i:(s&KO)*Math.pow(2,i),i+=7}while(s>=R6e);return u3.bytes=n-e,t}var S6e,UO,A6e,x6e,I6e,T6e,R6e,KO,P6e,C6e,O6e,q6e,k6e,B6e,N6e,D6e,M6e,L6e,U6e,F6e,Q0,jO=Ge(()=>{u();S6e=FO,UO=128,A6e=127,x6e=~A6e,I6e=Math.pow(2,31);T6e=u3,R6e=128,KO=127;P6e=Math.pow(2,7),C6e=Math.pow(2,14),O6e=Math.pow(2,21),q6e=Math.pow(2,28),k6e=Math.pow(2,35),B6e=Math.pow(2,42),N6e=Math.pow(2,49),D6e=Math.pow(2,56),M6e=Math.pow(2,63),L6e=function(r){return r<P6e?1:r<C6e?2:r<O6e?3:r<q6e?4:r<k6e?5:r<B6e?6:r<N6e?7:r<D6e?8:r<M6e?9:10},U6e={encode:S6e,decode:T6e,encodingLength:L6e},F6e=U6e,Q0=F6e});var J0={};Ht(J0,{decode:()=>ph,encodeTo:()=>_l,encodingLength:()=>El});var ph,_l,El,zm=Ge(()=>{u();jO();ph=r=>[Q0.decode(r),Q0.decode.bytes],_l=(r,e,t=0)=>(Q0.encode(r,e,t),e),El=r=>Q0.encodingLength(r)});var Sl={};Ht(Sl,{coerce:()=>eo,empty:()=>VO,equals:()=>l3,fromHex:()=>j6e,fromString:()=>f3,isBinary:()=>V6e,toHex:()=>K6e,toString:()=>h3});var VO,K6e,j6e,l3,eo,V6e,f3,h3,Jc=Ge(()=>{u();VO=new Uint8Array(0),K6e=r=>r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),j6e=r=>{let e=r.match(/../g);return e?new Uint8Array(e.map(t=>parseInt(t,16))):VO},l3=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},eo=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},V6e=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),f3=r=>new TextEncoder().encode(r),h3=r=>new TextDecoder().decode(r)});var bn={};Ht(bn,{Digest:()=>gh,create:()=>Z0,decode:()=>yh,equals:()=>d3});var Z0,yh,d3,gh,mn=Ge(()=>{u();Jc();zm();Z0=(r,e)=>{let t=e.byteLength,i=El(r),n=i+El(t),s=new Uint8Array(n+t);return _l(r,s,0),_l(t,s,i),s.set(e,n),new gh(r,t,e,s)},yh=r=>{let e=eo(r),[t,i]=ph(e),[n,s]=ph(e.subarray(i)),o=e.subarray(i+s);if(o.byteLength!==n)throw new Error("Incorrect length");return new gh(t,n,o,e)},d3=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&l3(r.bytes,e.bytes),gh=class{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}});function z6e(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var s=r.charAt(n),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=n}var a=r.length,c=r.charAt(0),f=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var m=0,E=0,_=0,T=g.length;_!==T&&g[_]===0;)_++,m++;for(var q=(T-_)*l+1>>>0,z=new Uint8Array(q);_!==T;){for(var V=g[_],M=0,$=q-1;(V!==0||M<E)&&$!==-1;$--,M++)V+=256*z[$]>>>0,z[$]=V%a>>>0,V=V/a>>>0;if(V!==0)throw new Error("Non-zero carry");E=M,_++}for(var X=q-E;X!==q&&z[X]===0;)X++;for(var Q=c.repeat(m);X<q;++X)Q+=r.charAt(z[X]);return Q}function d(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var m=0;if(g[m]!==" "){for(var E=0,_=0;g[m]===c;)E++,m++;for(var T=(g.length-m)*f+1>>>0,q=new Uint8Array(T);g[m];){var z=t[g.charCodeAt(m)];if(z===255)return;for(var V=0,M=T-1;(z!==0||V<_)&&M!==-1;M--,V++)z+=a*q[M]>>>0,q[M]=z%256>>>0,z=z/256>>>0;if(z!==0)throw new Error("Non-zero carry");_=V,m++}if(g[m]!==" "){for(var $=T-_;$!==T&&q[$]===0;)$++;for(var X=new Uint8Array(E+(T-$)),Q=E;$!==T;)X[Q++]=q[$++];return X}}}function y(g){var m=d(g);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:y}}var H6e,$6e,zO,HO=Ge(()=>{u();H6e=z6e,$6e=H6e,zO=$6e});var $O,GO,Hm,WO,$m,Zc,G6e,W6e,jr,Xo=Ge(()=>{u();HO();Jc();$O=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},GO=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){let t={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new Hm(t)}},Hm=class{constructor(e){this.decoders=e}or(e){let t=e.decoders||{[e.prefix]:e};return new Hm({...this.decoders,...t})}decode(e){let t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},WO=class{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new $O(e,t,i),this.decoder=new GO(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},$m=({name:r,prefix:e,encode:t,decode:i})=>new WO(r,e,t,i),Zc=({prefix:r,name:e,alphabet:t})=>{let{encode:i,decode:n}=zO(t,e);return $m({prefix:r,name:e,encode:i,decode:s=>eo(n(s))})},G6e=(r,e,t,i)=>{let n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=r.length;for(;r[s-1]==="=";)--s;let o=new Uint8Array(s*t/8|0),a=0,c=0,f=0;for(let l=0;l<s;++l){let h=n[r[l]];if(h===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},W6e=(r,e,t)=>{let i=e[e.length-1]==="=",n=(1<<t)-1,s="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,s+=e[n&a>>o];if(o&&(s+=e[n&a<<t-o]),i)for(;s.length*t&7;)s+="=";return s},jr=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>$m({prefix:e,name:r,encode(n){return W6e(n,i,t)},decode(n){return G6e(n,i,t,r)}})});var Vr={};Ht(Vr,{base58btc:()=>Qo,base58flickr:()=>Y6e});var Qo,Y6e,zr=Ge(()=>{u();Xo();Qo=Zc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Y6e=Zc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Zi={};Ht(Zi,{base32:()=>bh,base32hex:()=>Z6e,base32hexpad:()=>tAe,base32hexpadupper:()=>rAe,base32hexupper:()=>eAe,base32pad:()=>Q6e,base32padupper:()=>J6e,base32upper:()=>X6e,base32z:()=>iAe});var bh,X6e,Q6e,J6e,Z6e,eAe,tAe,rAe,iAe,en=Ge(()=>{u();Xo();bh=jr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),X6e=jr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Q6e=jr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),J6e=jr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Z6e=jr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eAe=jr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),tAe=jr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rAe=jr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),iAe=jr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Ce={};Ht(Ce,{CID:()=>tt});var tt,nAe,sAe,oAe,ey,aAe,YO,XO,Gm,Wm,cAe,uAe,lAe,xe=Ge(()=>{u();zm();mn();zr();en();Jc();tt=class{constructor(e,t,i,n){this.code=t,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Wm,byteLength:Wm,code:Gm,version:Gm,multihash:Gm,bytes:Gm,_baseCache:Wm,asCID:Wm})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==ey)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==aAe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return tt.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,i=Z0(e,t);return tt.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&d3(this.multihash,e.multihash)}toString(e){let{bytes:t,version:i,_baseCache:n}=this;switch(i){case 0:return sAe(t,n,e||Qo.encoder);default:return oAe(t,n,e||bh.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return uAe(/^0\.0/,lAe),!!(e&&(e[XO]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof tt)return e;if(e!=null&&e.asCID===e){let{version:t,code:i,multihash:n,bytes:s}=e;return new tt(t,i,n,s||YO(t,i,n.bytes))}else if(e!=null&&e[XO]===!0){let{version:t,multihash:i,code:n}=e,s=yh(i);return tt.create(t,n,s)}else return null}static create(e,t,i){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==ey)throw new Error(`Version 0 CID must use dag-pb (code: ${ey}) block encoding`);return new tt(e,t,i,i.bytes)}case 1:{let n=YO(e,t,i.bytes);return new tt(e,t,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return tt.create(0,ey,e)}static createV1(e,t){return tt.create(1,e,t)}static decode(e){let[t,i]=tt.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=tt.inspectBytes(e),i=t.size-t.multihashSize,n=eo(e.subarray(i,i+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=n.subarray(t.multihashSize-t.digestSize),o=new gh(t.multihashCode,t.digestSize,s,n);return[t.version===0?tt.createV0(o):tt.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0,i=()=>{let[h,d]=ph(e.subarray(t));return t+=d,h},n=i(),s=ey;if(n===18?(n=0,t=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=t,a=i(),c=i(),f=t+c,l=f-o;return{version:n,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:f}}static parse(e,t){let[i,n]=nAe(e,t),s=tt.decode(n);return s._baseCache.set(i,e),s}},nAe=(r,e)=>{switch(r[0]){case"Q":{let t=e||Qo;return[Qo.prefix,t.decode(`${Qo.prefix}${r}`)]}case Qo.prefix:{let t=e||Qo;return[Qo.prefix,t.decode(r)]}case bh.prefix:{let t=e||bh;return[bh.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},sAe=(r,e,t)=>{let{prefix:i}=t;if(i!==Qo.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let n=e.get(i);if(n==null){let s=t.encode(r).slice(1);return e.set(i,s),s}else return n},oAe=(r,e,t)=>{let{prefix:i}=t,n=e.get(i);if(n==null){let s=t.encode(r);return e.set(i,s),s}else return n},ey=112,aAe=18,YO=(r,e,t)=>{let i=El(r),n=i+El(e),s=new Uint8Array(n+t.byteLength);return _l(r,s,0),_l(e,s,i),s.set(t,n),s},XO=Symbol.for("@ipld/js-cid/CID"),Gm={writable:!1,configurable:!1,enumerable:!0},Wm={writable:!1,enumerable:!1,configurable:!1},cAe="0.0.0-dev",uAe=(r,e)=>{if(r.test(cAe))console.warn(e);else throw new Error(e)},lAe=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var Ym={};Ht(Ym,{base36:()=>fAe,base36upper:()=>hAe});var fAe,hAe,p3=Ge(()=>{u();Xo();fAe=Zc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),hAe=Zc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var mh={};Ht(mh,{base64:()=>dAe,base64pad:()=>pAe,base64url:()=>yAe,base64urlpad:()=>gAe});var dAe,pAe,yAe,gAe,ty=Ge(()=>{u();Xo();dAe=jr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pAe=jr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yAe=jr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),gAe=jr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var Xm={};Ht(Xm,{base16:()=>bAe,base16upper:()=>mAe});var bAe,mAe,y3=Ge(()=>{u();Xo();bAe=jr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),mAe=jr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var JO=p((a_t,QO)=>{u();"use strict";QO.exports=vAe;function vAe(r,e){for(var t=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)t[i++]=arguments[n++];return new Promise(function(a,c){t[i]=function(l){if(s)if(s=!1,l)c(l);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];a.apply(null,h)}};try{r.apply(e||null,t)}catch(f){s&&(s=!1,c(f))}})}});var rq=p(tq=>{u();"use strict";var Qm=tq;Qm.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var vh=new Array(64),ZO=new Array(123);for(var Jo=0;Jo<64;)ZO[vh[Jo]=Jo<26?Jo+65:Jo<52?Jo+71:Jo<62?Jo-4:Jo-59|43]=Jo++;Qm.encode=function(e,t,i){for(var n=null,s=[],o=0,a=0,c;t<i;){var f=e[t++];switch(a){case 0:s[o++]=vh[f>>2],c=(f&3)<<4,a=1;break;case 1:s[o++]=vh[c|f>>4],c=(f&15)<<2,a=2;break;case 2:s[o++]=vh[c|f>>6],s[o++]=vh[f&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=vh[c],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var eq="invalid encoding";Qm.decode=function(e,t,i){for(var n=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=ZO[c])===void 0)throw Error(eq);switch(s){case 0:o=c,s=1;break;case 1:t[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(eq);return i-n};Qm.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var nq=p((u_t,iq)=>{u();"use strict";iq.exports=Jm;function Jm(){this._listeners={}}Jm.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};Jm.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this};Jm.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}});var fq=p((l_t,lq)=>{u();"use strict";lq.exports=sq(sq);function sq(r){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function n(c,f,l){e[0]=c,f[l]=t[0],f[l+1]=t[1],f[l+2]=t[2],f[l+3]=t[3]}function s(c,f,l){e[0]=c,f[l]=t[3],f[l+1]=t[2],f[l+2]=t[1],f[l+3]=t[0]}r.writeFloatLE=i?n:s,r.writeFloatBE=i?s:n;function o(c,f){return t[0]=c[f],t[1]=c[f+1],t[2]=c[f+2],t[3]=c[f+3],e[0]}function a(c,f){return t[3]=c[f],t[2]=c[f+1],t[1]=c[f+2],t[0]=c[f+3],e[0]}r.readFloatLE=i?o:a,r.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(n)/Math.LN2),f=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|f)>>>0,s,o)}}r.writeFloatLE=e.bind(null,oq),r.writeFloatBE=e.bind(null,aq);function t(i,n,s){var o=i(n,s),a=(o>>31)*2+1,c=o>>>23&255,f=o&8388607;return c===255?f?NaN:a*(1/0):c===0?a*1401298464324817e-60*f:a*Math.pow(2,c-150)*(f+8388608)}r.readFloatLE=t.bind(null,cq),r.readFloatBE=t.bind(null,uq)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function n(c,f,l){e[0]=c,f[l]=t[0],f[l+1]=t[1],f[l+2]=t[2],f[l+3]=t[3],f[l+4]=t[4],f[l+5]=t[5],f[l+6]=t[6],f[l+7]=t[7]}function s(c,f,l){e[0]=c,f[l]=t[7],f[l+1]=t[6],f[l+2]=t[5],f[l+3]=t[4],f[l+4]=t[3],f[l+5]=t[2],f[l+6]=t[1],f[l+7]=t[0]}r.writeDoubleLE=i?n:s,r.writeDoubleBE=i?s:n;function o(c,f){return t[0]=c[f],t[1]=c[f+1],t[2]=c[f+2],t[3]=c[f+3],t[4]=c[f+4],t[5]=c[f+5],t[6]=c[f+6],t[7]=c[f+7],e[0]}function a(c,f){return t[7]=c[f],t[6]=c[f+1],t[5]=c[f+2],t[4]=c[f+3],t[3]=c[f+4],t[2]=c[f+5],t[1]=c[f+6],t[0]=c[f+7],e[0]}r.readDoubleLE=i?o:a,r.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,c){var f=o<0?1:0;if(f&&(o=-o),o===0)i(0,a,c+n),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+n),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+n),i((f<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,i(l>>>0,a,c+n),i((f<<31|l/4294967296)>>>0,a,c+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),l=o*Math.pow(2,-h),i(l*4503599627370496>>>0,a,c+n),i((f<<31|h+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}r.writeDoubleLE=e.bind(null,oq,0,4),r.writeDoubleBE=e.bind(null,aq,4,0);function t(i,n,s,o,a){var c=i(o,a+n),f=i(o,a+s),l=(f>>31)*2+1,h=f>>>20&2047,d=4294967296*(f&1048575)+c;return h===2047?d?NaN:l*(1/0):h===0?l*5e-324*d:l*Math.pow(2,h-1075)*(d+4503599627370496)}r.readDoubleLE=t.bind(null,cq,0,4),r.readDoubleBE=t.bind(null,uq,4,0)}(),r}function oq(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function aq(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function cq(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function uq(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var hq=p((exports,module)=>{u();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var pq=p(dq=>{u();"use strict";var g3=dq;g3.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t+=1:i<2048?t+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,t+=4):t+=3;return t};g3.read=function(e,t,i){var n=i-t;if(n<1)return"";for(var s=null,o=[],a=0,c;t<i;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};g3.write=function(e,t,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-n}});var gq=p((h_t,yq)=>{u();"use strict";yq.exports=wAe;function wAe(r,e,t){var i=t||8192,n=i>>>1,s=null,o=i;return function(c){if(c<1||c>n)return r(c);o+c>i&&(s=r(i),o=0);var f=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),f}}});var mq=p((d_t,bq)=>{u();"use strict";bq.exports=Ri;var ry=tu();function Ri(r,e){this.lo=r>>>0,this.hi=e>>>0}var Al=Ri.zero=new Ri(0,0);Al.toNumber=function(){return 0};Al.zzEncode=Al.zzDecode=function(){return this};Al.length=function(){return 1};var _Ae=Ri.zeroHash="\0\0\0\0\0\0\0\0";Ri.fromNumber=function(e){if(e===0)return Al;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new Ri(i,n)};Ri.from=function(e){if(typeof e=="number")return Ri.fromNumber(e);if(ry.isString(e))if(ry.Long)e=ry.Long.fromString(e);else return Ri.fromNumber(parseInt(e,10));return e.low||e.high?new Ri(e.low>>>0,e.high>>>0):Al};Ri.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};Ri.prototype.toLong=function(e){return ry.Long?new ry.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var eu=String.prototype.charCodeAt;Ri.fromHash=function(e){return e===_Ae?Al:new Ri((eu.call(e,0)|eu.call(e,1)<<8|eu.call(e,2)<<16|eu.call(e,3)<<24)>>>0,(eu.call(e,4)|eu.call(e,5)<<8|eu.call(e,6)<<16|eu.call(e,7)<<24)>>>0)};Ri.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Ri.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Ri.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Ri.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var tu=p(b3=>{u();"use strict";var He=b3;He.asPromise=JO();He.base64=rq();He.EventEmitter=nq();He.float=fq();He.inquire=hq();He.utf8=pq();He.pool=gq();He.LongBits=mq();He.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);He.global=He.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||b3;He.emptyArray=Object.freeze?Object.freeze([]):[];He.emptyObject=Object.freeze?Object.freeze({}):{};He.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};He.isString=function(e){return typeof e=="string"||e instanceof String};He.isObject=function(e){return e&&typeof e=="object"};He.isset=He.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};He.Buffer=function(){try{var r=He.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(e){return null}}();He._Buffer_from=null;He._Buffer_allocUnsafe=null;He.newBuffer=function(e){return typeof e=="number"?He.Buffer?He._Buffer_allocUnsafe(e):new He.Array(e):He.Buffer?He._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};He.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;He.Long=He.global.dcodeIO&&He.global.dcodeIO.Long||He.global.Long||He.inquire("long");He.key2Re=/^true|false|0|1$/;He.key32Re=/^-?(?:0|[1-9][0-9]*)$/;He.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;He.longToHash=function(e){return e?He.LongBits.from(e).toHash():He.LongBits.zeroHash};He.longFromHash=function(e,t){var i=He.LongBits.fromHash(e);return He.Long?He.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))};function vq(r,e,t){for(var i=Object.keys(e),n=0;n<i.length;++n)(r[i[n]]===void 0||!t)&&(r[i[n]]=e[i[n]]);return r}He.merge=vq;He.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function wq(r){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&vq(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return r}}),e.prototype.toString=function(){return this.name+": "+this.message},e}He.newError=wq;He.ProtocolError=wq("ProtocolError");He.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(t[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};He.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};He.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};He._configure=function(){var r=He.Buffer;if(!r){He._Buffer_from=He._Buffer_allocUnsafe=null;return}He._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,i){return new r(t,i)},He._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var A3=p((y_t,Aq)=>{u();"use strict";Aq.exports=Ct;var ys=tu(),m3,Zm=ys.LongBits,_q=ys.base64,Eq=ys.utf8;function iy(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function v3(){}function EAe(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function Ct(){this.len=0,this.head=new iy(v3,0,0),this.tail=this.head,this.states=null}var Sq=function(){return ys.Buffer?function(){return(Ct.create=function(){return new m3})()}:function(){return new Ct}};Ct.create=Sq();Ct.alloc=function(e){return new ys.Array(e)};ys.Array!==Array&&(Ct.alloc=ys.pool(Ct.alloc,ys.Array.prototype.subarray));Ct.prototype._push=function(e,t,i){return this.tail=this.tail.next=new iy(e,t,i),this.len+=t,this};function w3(r,e,t){e[t]=r&255}function SAe(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function _3(r,e){this.len=r,this.next=void 0,this.val=e}_3.prototype=Object.create(iy.prototype);_3.prototype.fn=SAe;Ct.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new _3((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Ct.prototype.int32=function(e){return e<0?this._push(E3,10,Zm.fromNumber(e)):this.uint32(e)};Ct.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function E3(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}Ct.prototype.uint64=function(e){var t=Zm.from(e);return this._push(E3,t.length(),t)};Ct.prototype.int64=Ct.prototype.uint64;Ct.prototype.sint64=function(e){var t=Zm.from(e).zzEncode();return this._push(E3,t.length(),t)};Ct.prototype.bool=function(e){return this._push(w3,1,e?1:0)};function S3(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}Ct.prototype.fixed32=function(e){return this._push(S3,4,e>>>0)};Ct.prototype.sfixed32=Ct.prototype.fixed32;Ct.prototype.fixed64=function(e){var t=Zm.from(e);return this._push(S3,4,t.lo)._push(S3,4,t.hi)};Ct.prototype.sfixed64=Ct.prototype.fixed64;Ct.prototype.float=function(e){return this._push(ys.float.writeFloatLE,4,e)};Ct.prototype.double=function(e){return this._push(ys.float.writeDoubleLE,8,e)};var AAe=ys.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};Ct.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(w3,1,0);if(ys.isString(e)){var i=Ct.alloc(t=_q.length(e));_q.decode(e,i,0),e=i}return this.uint32(t)._push(AAe,t,e)};Ct.prototype.string=function(e){var t=Eq.length(e);return t?this.uint32(t)._push(Eq.write,t,e):this._push(w3,1,0)};Ct.prototype.fork=function(){return this.states=new EAe(this),this.head=this.tail=new iy(v3,0,0),this.len=0,this};Ct.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new iy(v3,0,0),this.len=0),this};Ct.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};Ct.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};Ct._configure=function(r){m3=r,Ct.create=Sq(),m3._configure()}});var Tq=p((g_t,Iq)=>{u();"use strict";Iq.exports=Zo;var xq=A3();(Zo.prototype=Object.create(xq.prototype)).constructor=Zo;var ru=tu();function Zo(){xq.call(this)}Zo._configure=function(){Zo.alloc=ru._Buffer_allocUnsafe,Zo.writeBytesBuffer=ru.Buffer&&ru.Buffer.prototype instanceof Uint8Array&&ru.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}};Zo.prototype.bytes=function(e){ru.isString(e)&&(e=ru._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Zo.writeBytesBuffer,t,e),this};function xAe(r,e,t){r.length<40?ru.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}Zo.prototype.string=function(e){var t=ru.Buffer.byteLength(e);return this.uint32(t),t&&this._push(xAe,t,e),this};Zo._configure()});var T3=p((b_t,qq)=>{u();"use strict";qq.exports=ni;var ea=tu(),x3,Rq=ea.LongBits,IAe=ea.utf8;function to(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function ni(r){this.buf=r,this.pos=0,this.len=r.length}var Pq=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ni(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ni(e);throw Error("illegal buffer")},Cq=function(){return ea.Buffer?function(t){return(ni.create=function(n){return ea.Buffer.isBuffer(n)?new x3(n):Pq(n)})(t)}:Pq};ni.create=Cq();ni.prototype._slice=ea.Array.prototype.subarray||ea.Array.prototype.slice;ni.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,to(this,10);return e}}();ni.prototype.int32=function(){return this.uint32()|0};ni.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function I3(){var r=new Rq(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw to(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw to(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}ni.prototype.bool=function(){return this.uint32()!==0};function e1(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}ni.prototype.fixed32=function(){if(this.pos+4>this.len)throw to(this,4);return e1(this.buf,this.pos+=4)};ni.prototype.sfixed32=function(){if(this.pos+4>this.len)throw to(this,4);return e1(this.buf,this.pos+=4)|0};function Oq(){if(this.pos+8>this.len)throw to(this,8);return new Rq(e1(this.buf,this.pos+=4),e1(this.buf,this.pos+=4))}ni.prototype.float=function(){if(this.pos+4>this.len)throw to(this,4);var e=ea.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ni.prototype.double=function(){if(this.pos+8>this.len)throw to(this,4);var e=ea.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ni.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw to(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)};ni.prototype.string=function(){var e=this.bytes();return IAe.read(e,0,e.length)};ni.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw to(this,e);this.pos+=e}else do if(this.pos>=this.len)throw to(this);while(this.buf[this.pos++]&128);return this};ni.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!=4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};ni._configure=function(r){x3=r,ni.create=Cq(),x3._configure();var e=ea.Long?"toLong":"toNumber";ea.merge(ni.prototype,{int64:function(){return I3.call(this)[e](!1)},uint64:function(){return I3.call(this)[e](!0)},sint64:function(){return I3.call(this).zzDecode()[e](!1)},fixed64:function(){return Oq.call(this)[e](!0)},sfixed64:function(){return Oq.call(this)[e](!1)}})}});var Dq=p((m_t,Nq)=>{u();"use strict";Nq.exports=xl;var kq=T3();(xl.prototype=Object.create(kq.prototype)).constructor=xl;var Bq=tu();function xl(r){kq.call(this,r)}xl._configure=function(){Bq.Buffer&&(xl.prototype._slice=Bq.Buffer.prototype.slice)};xl.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};xl._configure()});var Lq=p((v_t,Mq)=>{u();"use strict";Mq.exports=ny;var R3=tu();(ny.prototype=Object.create(R3.EventEmitter.prototype)).constructor=ny;function ny(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");R3.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}ny.prototype.rpcCall=function r(e,t,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return R3.asPromise(r,o,e,t,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,f){if(c)return o.emit("error",c,e),s(c);if(f===null){o.end(!0);return}if(!(f instanceof i))try{f=i[o.responseDelimited?"decodeDelimited":"decode"](f)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",f,e),s(null,f)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};ny.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Fq=p(Uq=>{u();"use strict";var TAe=Uq;TAe.Service=Lq()});var jq=p((__t,Kq)=>{u();"use strict";Kq.exports={}});var Hq=p(zq=>{u();"use strict";var On=zq;On.build="minimal";On.Writer=A3();On.BufferWriter=Tq();On.Reader=T3();On.BufferReader=Dq();On.util=tu();On.rpc=Fq();On.roots=jq();On.configure=Vq;function Vq(){On.util._configure(),On.Writer._configure(On.BufferWriter),On.Reader._configure(On.BufferReader)}Vq()});var Pi=p((S_t,$q)=>{u();"use strict";$q.exports=Hq()});var r1=p((A_t,Wq)=>{u();"use strict";var Il=Pi(),t1=Il.Reader,Gq=Il.Writer,tn=Il.util,gs=Il.roots["libp2p-crypto-keys"]||(Il.roots["libp2p-crypto-keys"]={});gs.KeyType=function(){var r={},e=Object.create(r);return e[r[0]="RSA"]=0,e[r[1]="Ed25519"]=1,e[r[2]="Secp256k1"]=2,e}();gs.PublicKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=tn.newBuffer([]),r.encode=function(t,i){return i||(i=Gq.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof t1||(t=t1.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new gs.PublicKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw tn.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw tn.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof gs.PublicKey)return t;var i=new gs.PublicKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?tn.base64.decode(t.Data,i.Data=tn.newBuffer(tn.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=tn.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?gs.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?tn.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Il.util.toJSONOptions)},r}();gs.PrivateKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=tn.newBuffer([]),r.encode=function(t,i){return i||(i=Gq.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof t1||(t=t1.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new gs.PrivateKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw tn.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw tn.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof gs.PrivateKey)return t;var i=new gs.PrivateKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?tn.base64.decode(t.Data,i.Data=tn.newBuffer(tn.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=tn.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?gs.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?tn.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Il.util.toJSONOptions)},r}();Wq.exports=gs});var lt=p((x_t,Yq)=>{u();Yq.exports={options:{usePureJavaScript:!1}}});var Jq=p((I_t,Qq)=>{u();var P3={};Qq.exports=P3;var Xq={};P3.encode=function(r,e,t){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(t!==void 0&&typeof t!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(r instanceof Uint8Array))i=RAe(r,e);else{var n=0,s=e.length,o=e.charAt(0),a=[0];for(n=0;n<r.length;++n){for(var c=0,f=r[n];c<a.length;++c)f+=a[c]<<8,a[c]=f%s,f=f/s|0;for(;f>0;)a.push(f%s),f=f/s|0}for(n=0;r[n]===0&&n<r.length-1;++n)i+=o;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(t){var l=new RegExp(".{1,"+t+"}","g");i=i.match(l).join(`\r
`)}return i};P3.decode=function(r,e){if(typeof r!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var t=Xq[e];if(!t){t=Xq[e]=[];for(var i=0;i<e.length;++i)t[e.charCodeAt(i)]=i}r=r.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<r.length;i++){var a=t[r.charCodeAt(i)];if(a===void 0)return;for(var c=0,f=a;c<o.length;++c)f+=o[c]*n,o[c]=f&255,f>>=8;for(;f>0;)o.push(f&255),f>>=8}for(var l=0;r[l]===s&&l<r.length-1;++l)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function RAe(r,e){var t=0,i=e.length,n=e.charAt(0),s=[0];for(t=0;t<r.length();++t){for(var o=0,a=r.at(t);o<s.length;++o)a+=s[o]<<8,s[o]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var c="";for(t=0;r.at(t)===0&&t<r.length()-1;++t)c+=n;for(t=s.length-1;t>=0;--t)c+=e[s[t]];return c}});var $t=p((T_t,rk)=>{u();var Zq=lt(),ek=Jq(),re=rk.exports=Zq.util=Zq.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){re.nextTick=process.nextTick,typeof setImmediate=="function"?re.setImmediate=setImmediate:re.setImmediate=re.nextTick;return}if(typeof setImmediate=="function"){re.setImmediate=function(){return setImmediate.apply(void 0,arguments)},re.nextTick=function(a){return setImmediate(a)};return}if(re.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===r){c.stopPropagation();var f=e.slice();e.length=0,f.forEach(function(l){l()})}};var o=a,r="forge.setImmediate",e=[];re.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(r,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var t=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(f){f()})}).observe(n,{attributes:!0});var s=re.setImmediate;re.setImmediate=function(c){Date.now()-t>15?(t=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}re.nextTick=re.setImmediate})();re.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;re.globalScope=function(){return re.isNodejs?globalThis:typeof self=="undefined"?window:self}();re.isArray=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};re.isArrayBuffer=function(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer};re.isArrayBufferView=function(r){return r&&re.isArrayBuffer(r.buffer)&&r.byteLength!==void 0};function sy(r){if(!(r===8||r===16||r===24||r===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+r)}re.ByteBuffer=C3;function C3(r){if(this.data="",this.read=0,typeof r=="string")this.data=r;else if(re.isArrayBuffer(r)||re.isArrayBufferView(r))if(typeof Buffer!="undefined"&&r instanceof Buffer)this.data=r.toString("binary");else{var e=new Uint8Array(r);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var t=0;t<e.length;++t)this.putByte(e[t])}}else(r instanceof C3||typeof r=="object"&&typeof r.data=="string"&&typeof r.read=="number")&&(this.data=r.data,this.read=r.read);this._constructedStringLength=0}re.ByteStringBuffer=C3;var PAe=4096;re.ByteStringBuffer.prototype._optimizeConstructedString=function(r){this._constructedStringLength+=r,this._constructedStringLength>PAe&&(this.data.substr(0,1),this._constructedStringLength=0)};re.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};re.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};re.ByteStringBuffer.prototype.putByte=function(r){return this.putBytes(String.fromCharCode(r))};re.ByteStringBuffer.prototype.fillWithByte=function(r,e){r=String.fromCharCode(r);for(var t=this.data;e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return this.data=t,this._optimizeConstructedString(e),this};re.ByteStringBuffer.prototype.putBytes=function(r){return this.data+=r,this._optimizeConstructedString(r.length),this};re.ByteStringBuffer.prototype.putString=function(r){return this.putBytes(re.encodeUtf8(r))};re.ByteStringBuffer.prototype.putInt16=function(r){return this.putBytes(String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};re.ByteStringBuffer.prototype.putInt24=function(r){return this.putBytes(String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};re.ByteStringBuffer.prototype.putInt32=function(r){return this.putBytes(String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};re.ByteStringBuffer.prototype.putInt16Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255))};re.ByteStringBuffer.prototype.putInt24Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255))};re.ByteStringBuffer.prototype.putInt32Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>24&255))};re.ByteStringBuffer.prototype.putInt=function(r,e){sy(e);var t="";do e-=8,t+=String.fromCharCode(r>>e&255);while(e>0);return this.putBytes(t)};re.ByteStringBuffer.prototype.putSignedInt=function(r,e){return r<0&&(r+=2<<e-1),this.putInt(r,e)};re.ByteStringBuffer.prototype.putBuffer=function(r){return this.putBytes(r.getBytes())};re.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};re.ByteStringBuffer.prototype.getInt16=function(){var r=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,r};re.ByteStringBuffer.prototype.getInt24=function(){var r=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,r};re.ByteStringBuffer.prototype.getInt32=function(){var r=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,r};re.ByteStringBuffer.prototype.getInt16Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,r};re.ByteStringBuffer.prototype.getInt24Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,r};re.ByteStringBuffer.prototype.getInt32Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,r};re.ByteStringBuffer.prototype.getInt=function(r){sy(r);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),r-=8;while(r>0);return e};re.ByteStringBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};re.ByteStringBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.ByteStringBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};re.ByteStringBuffer.prototype.at=function(r){return this.data.charCodeAt(this.read+r)};re.ByteStringBuffer.prototype.setAt=function(r,e){return this.data=this.data.substr(0,this.read+r)+String.fromCharCode(e)+this.data.substr(this.read+r+1),this};re.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};re.ByteStringBuffer.prototype.copy=function(){var r=re.createBuffer(this.data);return r.read=this.read,r};re.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};re.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};re.ByteStringBuffer.prototype.truncate=function(r){var e=Math.max(0,this.length()-r);return this.data=this.data.substr(this.read,e),this.read=0,this};re.ByteStringBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.length;++e){var t=this.data.charCodeAt(e);t<16&&(r+="0"),r+=t.toString(16)}return r};re.ByteStringBuffer.prototype.toString=function(){return re.decodeUtf8(this.bytes())};function CAe(r,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var t=re.isArrayBuffer(r),i=re.isArrayBufferView(r);if(t||i){t?this.data=new DataView(r):this.data=new DataView(r.buffer,r.byteOffset,r.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,r!=null&&this.putBytes(r),"writeOffset"in e&&(this.write=e.writeOffset)}re.DataBuffer=CAe;re.DataBuffer.prototype.length=function(){return this.write-this.read};re.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};re.DataBuffer.prototype.accommodate=function(r,e){if(this.length()>=r)return this;e=Math.max(e||this.growSize,r);var t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(t),this.data=new DataView(i.buffer),this};re.DataBuffer.prototype.putByte=function(r){return this.accommodate(1),this.data.setUint8(this.write++,r),this};re.DataBuffer.prototype.fillWithByte=function(r,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(r);return this};re.DataBuffer.prototype.putBytes=function(r,e){if(re.isArrayBufferView(r)){var t=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),i=t.byteLength-t.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(t),this.write+=i,this}if(re.isArrayBuffer(r)){var t=new Uint8Array(r);this.accommodate(t.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(t,this.write),this.write+=t.byteLength,this}if(r instanceof re.DataBuffer||typeof r=="object"&&typeof r.read=="number"&&typeof r.write=="number"&&re.isArrayBufferView(r.data)){var t=new Uint8Array(r.data.byteLength,r.read,r.length());this.accommodate(t.byteLength);var n=new Uint8Array(r.data.byteLength,this.write);return n.set(t),this.write+=t.byteLength,this}if(r instanceof re.ByteStringBuffer&&(r=r.data,e="binary"),e=e||"binary",typeof r=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(r.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.hex.decode(r,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(r.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.base64.decode(r,s,this.write),this;if(e==="utf8"&&(r=re.encodeUtf8(r),e="binary"),e==="binary"||e==="raw")return this.accommodate(r.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(r.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=re.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+r)};re.DataBuffer.prototype.putBuffer=function(r){return this.putBytes(r),r.clear(),this};re.DataBuffer.prototype.putString=function(r){return this.putBytes(r,"utf16")};re.DataBuffer.prototype.putInt16=function(r){return this.accommodate(2),this.data.setInt16(this.write,r),this.write+=2,this};re.DataBuffer.prototype.putInt24=function(r){return this.accommodate(3),this.data.setInt16(this.write,r>>8&65535),this.data.setInt8(this.write,r>>16&255),this.write+=3,this};re.DataBuffer.prototype.putInt32=function(r){return this.accommodate(4),this.data.setInt32(this.write,r),this.write+=4,this};re.DataBuffer.prototype.putInt16Le=function(r){return this.accommodate(2),this.data.setInt16(this.write,r,!0),this.write+=2,this};re.DataBuffer.prototype.putInt24Le=function(r){return this.accommodate(3),this.data.setInt8(this.write,r>>16&255),this.data.setInt16(this.write,r>>8&65535,!0),this.write+=3,this};re.DataBuffer.prototype.putInt32Le=function(r){return this.accommodate(4),this.data.setInt32(this.write,r,!0),this.write+=4,this};re.DataBuffer.prototype.putInt=function(r,e){sy(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,r>>e&255);while(e>0);return this};re.DataBuffer.prototype.putSignedInt=function(r,e){return sy(e),this.accommodate(e/8),r<0&&(r+=2<<e-1),this.putInt(r,e)};re.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};re.DataBuffer.prototype.getInt16=function(){var r=this.data.getInt16(this.read);return this.read+=2,r};re.DataBuffer.prototype.getInt24=function(){var r=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,r};re.DataBuffer.prototype.getInt32=function(){var r=this.data.getInt32(this.read);return this.read+=4,r};re.DataBuffer.prototype.getInt16Le=function(){var r=this.data.getInt16(this.read,!0);return this.read+=2,r};re.DataBuffer.prototype.getInt24Le=function(){var r=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,r};re.DataBuffer.prototype.getInt32Le=function(){var r=this.data.getInt32(this.read,!0);return this.read+=4,r};re.DataBuffer.prototype.getInt=function(r){sy(r);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),r-=8;while(r>0);return e};re.DataBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};re.DataBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.DataBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};re.DataBuffer.prototype.at=function(r){return this.data.getUint8(this.read+r)};re.DataBuffer.prototype.setAt=function(r,e){return this.data.setUint8(r,e),this};re.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};re.DataBuffer.prototype.copy=function(){return new re.DataBuffer(this)};re.DataBuffer.prototype.compact=function(){if(this.read>0){var r=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(r.byteLength);e.set(r),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};re.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};re.DataBuffer.prototype.truncate=function(r){return this.write=Math.max(0,this.length()-r),this.read=Math.min(this.read,this.write),this};re.DataBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.byteLength;++e){var t=this.data.getUint8(e);t<16&&(r+="0"),r+=t.toString(16)}return r};re.DataBuffer.prototype.toString=function(r){var e=new Uint8Array(this.data,this.read,this.length());if(r=r||"utf8",r==="binary"||r==="raw")return re.binary.raw.encode(e);if(r==="hex")return re.binary.hex.encode(e);if(r==="base64")return re.binary.base64.encode(e);if(r==="utf8")return re.text.utf8.decode(e);if(r==="utf16")return re.text.utf16.decode(e);throw new Error("Invalid encoding: "+r)};re.createBuffer=function(r,e){return e=e||"raw",r!==void 0&&e==="utf8"&&(r=re.encodeUtf8(r)),new re.ByteBuffer(r)};re.fillString=function(r,e){for(var t="";e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return t};re.xorBytes=function(r,e,t){for(var i="",n="",s="",o=0,a=0;t>0;--t,++o)n=r.charCodeAt(o)^e.charCodeAt(o),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};re.hexToBytes=function(r){var e="",t=0;for(r.length&!0&&(t=1,e+=String.fromCharCode(parseInt(r[0],16)));t<r.length;t+=2)e+=String.fromCharCode(parseInt(r.substr(t,2),16));return e};re.bytesToHex=function(r){return re.createBuffer(r).toHex()};re.int32ToBytes=function(r){return String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255)};var iu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",nu=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],tk="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";re.encode64=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.length;)n=r.charCodeAt(a++),s=r.charCodeAt(a++),o=r.charCodeAt(a++),t+=iu.charAt(n>>2),t+=iu.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=iu.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":iu.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};re.decode64=function(r){r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",t,i,n,s,o=0;o<r.length;)t=nu[r.charCodeAt(o++)-43],i=nu[r.charCodeAt(o++)-43],n=nu[r.charCodeAt(o++)-43],s=nu[r.charCodeAt(o++)-43],e+=String.fromCharCode(t<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};re.encodeUtf8=function(r){return unescape(encodeURIComponent(r))};re.decodeUtf8=function(r){return decodeURIComponent(escape(r))};re.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:ek.encode,decode:ek.decode}};re.binary.raw.encode=function(r){return String.fromCharCode.apply(null,r)};re.binary.raw.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};re.binary.hex.encode=re.bytesToHex;re.binary.hex.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/2))),t=t||0;var n=0,s=t;for(r.length&1&&(n=1,i[s++]=parseInt(r[0],16));n<r.length;n+=2)i[s++]=parseInt(r.substr(n,2),16);return e?s-t:i};re.binary.base64.encode=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.byteLength;)n=r[a++],s=r[a++],o=r[a++],t+=iu.charAt(n>>2),t+=iu.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=iu.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":iu.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};re.binary.base64.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/4)*3)),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var n,s,o,a,c=0,f=t;c<r.length;)n=nu[r.charCodeAt(c++)-43],s=nu[r.charCodeAt(c++)-43],o=nu[r.charCodeAt(c++)-43],a=nu[r.charCodeAt(c++)-43],i[f++]=n<<2|s>>4,o!==64&&(i[f++]=(s&15)<<4|o>>2,a!==64&&(i[f++]=(o&3)<<6|a));return e?f-t:i.subarray(0,f)};re.binary.base58.encode=function(r,e){return re.binary.baseN.encode(r,tk,e)};re.binary.base58.decode=function(r,e){return re.binary.baseN.decode(r,tk,e)};re.text={utf8:{},utf16:{}};re.text.utf8.encode=function(r,e,t){r=re.encodeUtf8(r);var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};re.text.utf8.decode=function(r){return re.decodeUtf8(String.fromCharCode.apply(null,r))};re.text.utf16.encode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length*2));var n=new Uint16Array(i.buffer);t=t||0;for(var s=t,o=t,a=0;a<r.length;++a)n[o++]=r.charCodeAt(a),s+=2;return e?s-t:i};re.text.utf16.decode=function(r){return String.fromCharCode.apply(null,new Uint16Array(r.buffer))};re.deflate=function(r,e,t){if(e=re.decode64(r.deflate(re.encode64(e)).rval),t){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};re.inflate=function(r,e,t){var i=r.inflate(re.encode64(e)).rval;return i===null?null:re.decode64(i)};var O3=function(r,e,t){if(!r)throw new Error("WebStorage not available.");var i;if(t===null?i=r.removeItem(e):(t=re.encode64(JSON.stringify(t)),i=r.setItem(e,t)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},q3=function(r,e){if(!r)throw new Error("WebStorage not available.");var t=r.getItem(e);if(r.init)if(t.rval===null){if(t.error){var i=new Error(t.error.message);throw i.id=t.error.id,i.name=t.error.name,i}t=null}else t=t.rval;return t!==null&&(t=JSON.parse(re.decode64(t))),t},OAe=function(r,e,t,i){var n=q3(r,e);n===null&&(n={}),n[t]=i,O3(r,e,n)},qAe=function(r,e,t){var i=q3(r,e);return i!==null&&(i=t in i?i[t]:null),i},kAe=function(r,e,t){var i=q3(r,e);if(i!==null&&t in i){delete i[t];var n=!0;for(var s in i){n=!1;break}n&&(i=null),O3(r,e,i)}},BAe=function(r,e){O3(r,e,null)},i1=function(r,e,t){var i=null;typeof t=="undefined"&&(t=["web","flash"]);var n,s=!1,o=null;for(var a in t){n=t[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=r.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=r.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};re.setItem=function(r,e,t,i,n){i1(OAe,arguments,n)};re.getItem=function(r,e,t,i){return i1(qAe,arguments,i)};re.removeItem=function(r,e,t,i){i1(kAe,arguments,i)};re.clearItems=function(r,e,t){i1(BAe,arguments,t)};re.parseUrl=function(r){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var t=e.exec(r),i=t===null?null:{full:r,scheme:t[1],host:t[2],port:t[3],path:t[4]};return i&&(i.fullHost=i.host,i.port?(i.port!==80&&i.scheme==="http"||i.port!==443&&i.scheme==="https")&&(i.fullHost+=":"+i.port):i.scheme==="http"?i.port=80:i.scheme==="https"&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var n1=null;re.getQueryVariables=function(r){var e=function(i){for(var n={},s=i.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("="),c,f;a>0?(c=s[o].substring(0,a),f=s[o].substring(a+1)):(c=s[o],f=null),c in n||(n[c]=[]),!(c in Object.prototype)&&f!==null&&n[c].push(unescape(f))}return n},t;return typeof r=="undefined"?(n1===null&&(typeof window!="undefined"&&window.location&&window.location.search?n1=e(window.location.search.substring(1)):n1={}),t=n1):t=e(r),t};re.parseFragment=function(r){var e=r,t="",i=r.indexOf("?");i>0&&(e=r.substring(0,i),t=r.substring(i+1));var n=e.split("/");n.length>0&&n[0]===""&&n.shift();var s=t===""?{}:re.getQueryVariables(t);return{pathString:e,queryString:t,path:n,query:s}};re.makeRequest=function(r){var e=re.parseFragment(r),t={path:e.pathString,query:e.queryString,getPath:function(i){return typeof i=="undefined"?e.path:e.path[i]},getQuery:function(i,n){var s;return typeof i=="undefined"?s=e.query:(s=e.query[i],s&&typeof n!="undefined"&&(s=s[n])),s},getQueryLast:function(i,n){var s,o=t.getQuery(i);return o?s=o[o.length-1]:s=n,s}};return t};re.makeLink=function(r,e,t){r=jQuery.isArray(r)?r.join("/"):r;var i=jQuery.param(e||{});return t=t||"",r+(i.length>0?"?"+i:"")+(t.length>0?"#"+t:"")};re.isEmpty=function(r){for(var e in r)if(r.hasOwnProperty(e))return!1;return!0};re.format=function(r){for(var e=/%./g,t,i,n=0,s=[],o=0;t=e.exec(r);){i=r.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var a=t[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(r.substring(o)),s.join("")};re.formatNumber=function(r,e,t,i){var n=r,s=isNaN(e=Math.abs(e))?2:e,o=t===void 0?",":t,a=i===void 0?".":i,c=n<0?"-":"",f=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",l=f.length>3?f.length%3:0;return c+(l?f.substr(0,l)+a:"")+f.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(n-f).toFixed(s).slice(2):"")};re.formatSize=function(r){return r>=1073741824?r=re.formatNumber(r/1073741824,2,".","")+" GiB":r>=1048576?r=re.formatNumber(r/1048576,2,".","")+" MiB":r>=1024?r=re.formatNumber(r/1024,0)+" KiB":r=re.formatNumber(r,0)+" bytes",r};re.bytesFromIP=function(r){return r.indexOf(".")!==-1?re.bytesFromIPv4(r):r.indexOf(":")!==-1?re.bytesFromIPv6(r):null};re.bytesFromIPv4=function(r){if(r=r.split("."),r.length!==4)return null;for(var e=re.createBuffer(),t=0;t<r.length;++t){var i=parseInt(r[t],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};re.bytesFromIPv6=function(r){var e=0;r=r.split(":").filter(function(o){return o.length===0&&++e,!0});for(var t=(8-r.length+e)*2,i=re.createBuffer(),n=0;n<8;++n){if(!r[n]||r[n].length===0){i.fillWithByte(0,t),t=0;continue}var s=re.hexToBytes(r[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};re.bytesToIP=function(r){return r.length===4?re.bytesToIPv4(r):r.length===16?re.bytesToIPv6(r):null};re.bytesToIPv4=function(r){if(r.length!==4)return null;for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e.join(".")};re.bytesToIPv6=function(r){if(r.length!==16)return null;for(var e=[],t=[],i=0,n=0;n<r.length;n+=2){for(var s=re.bytesToHex(r[n]+r[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=t[t.length-1],a=e.length;!o||a!==o.end+1?t.push({start:a,end:a}):(o.end=a,o.end-o.start>t[i].end-t[i].start&&(i=t.length-1))}e.push(s)}if(t.length>0){var c=t[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};re.estimateCores=function(r,e){if(typeof r=="function"&&(e=r,r={}),r=r||{},"cores"in re&&!r.update)return e(null,re.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return re.cores=navigator.hardwareConcurrency,e(null,re.cores);if(typeof Worker=="undefined")return re.cores=1,e(null,re.cores);if(typeof Blob=="undefined")return re.cores=2,e(null,re.cores);var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,a,c){if(a===0){var f=Math.floor(o.reduce(function(l,h){return l+h},0)/o.length);return re.cores=Math.max(1,f),URL.revokeObjectURL(t),e(null,re.cores)}n(c,function(l,h){o.push(s(c,h)),i(o,a-1,c)})}function n(o,a){for(var c=[],f=[],l=0;l<o;++l){var h=new Worker(t);h.addEventListener("message",function(d){if(f.push(d.data),f.length===o){for(var y=0;y<o;++y)c[y].terminate();a(null,f)}}),c.push(h)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],f=0;f<o;++f)for(var l=a[f],h=c[f]=[],d=0;d<o;++d)if(f!==d){var y=a[d];(l.st>y.st&&l.st<y.et||y.st>l.st&&y.st<l.et)&&h.push(d)}return c.reduce(function(g,m){return Math.max(g,m.length)},0)}}});var wh=p((R_t,ik)=>{u();var oy=lt();oy.pki=oy.pki||{};var k3=ik.exports=oy.pki.oids=oy.oids=oy.oids||{};function Ae(r,e){k3[r]=e,k3[e]=r}function Ft(r,e){k3[r]=e}Ae("1.2.840.113549.1.1.1","rsaEncryption");Ae("1.2.840.113549.1.1.4","md5WithRSAEncryption");Ae("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Ae("1.2.840.113549.1.1.7","RSAES-OAEP");Ae("1.2.840.113549.1.1.8","mgf1");Ae("1.2.840.113549.1.1.9","pSpecified");Ae("1.2.840.113549.1.1.10","RSASSA-PSS");Ae("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Ae("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Ae("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Ae("1.3.101.112","EdDSA25519");Ae("1.2.840.10040.4.3","dsa-with-sha1");Ae("1.3.14.3.2.7","desCBC");Ae("1.3.14.3.2.26","sha1");Ae("2.16.840.1.101.3.4.2.1","sha256");Ae("2.16.840.1.101.3.4.2.2","sha384");Ae("2.16.840.1.101.3.4.2.3","sha512");Ae("1.2.840.113549.2.5","md5");Ae("1.2.840.113549.1.7.1","data");Ae("1.2.840.113549.1.7.2","signedData");Ae("1.2.840.113549.1.7.3","envelopedData");Ae("1.2.840.113549.1.7.4","signedAndEnvelopedData");Ae("1.2.840.113549.1.7.5","digestedData");Ae("1.2.840.113549.1.7.6","encryptedData");Ae("1.2.840.113549.1.9.1","emailAddress");Ae("1.2.840.113549.1.9.2","unstructuredName");Ae("1.2.840.113549.1.9.3","contentType");Ae("1.2.840.113549.1.9.4","messageDigest");Ae("1.2.840.113549.1.9.5","signingTime");Ae("1.2.840.113549.1.9.6","counterSignature");Ae("1.2.840.113549.1.9.7","challengePassword");Ae("1.2.840.113549.1.9.8","unstructuredAddress");Ae("1.2.840.113549.1.9.14","extensionRequest");Ae("1.2.840.113549.1.9.20","friendlyName");Ae("1.2.840.113549.1.9.21","localKeyId");Ae("1.2.840.113549.1.9.22.1","x509Certificate");Ae("1.2.840.113549.1.12.10.1.1","keyBag");Ae("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Ae("1.2.840.113549.1.12.10.1.3","certBag");Ae("1.2.840.113549.1.12.10.1.4","crlBag");Ae("1.2.840.113549.1.12.10.1.5","secretBag");Ae("1.2.840.113549.1.12.10.1.6","safeContentsBag");Ae("1.2.840.113549.1.5.13","pkcs5PBES2");Ae("1.2.840.113549.1.5.12","pkcs5PBKDF2");Ae("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Ae("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Ae("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Ae("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Ae("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Ae("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Ae("1.2.840.113549.2.7","hmacWithSHA1");Ae("1.2.840.113549.2.8","hmacWithSHA224");Ae("1.2.840.113549.2.9","hmacWithSHA256");Ae("1.2.840.113549.2.10","hmacWithSHA384");Ae("1.2.840.113549.2.11","hmacWithSHA512");Ae("1.2.840.113549.3.7","des-EDE3-CBC");Ae("2.16.840.1.101.3.4.1.2","aes128-CBC");Ae("2.16.840.1.101.3.4.1.22","aes192-CBC");Ae("2.16.840.1.101.3.4.1.42","aes256-CBC");Ae("2.5.4.3","commonName");Ae("2.5.4.5","serialName");Ae("2.5.4.6","countryName");Ae("2.5.4.7","localityName");Ae("2.5.4.8","stateOrProvinceName");Ae("2.5.4.9","streetAddress");Ae("2.5.4.10","organizationName");Ae("2.5.4.11","organizationalUnitName");Ae("2.5.4.13","description");Ae("2.5.4.15","businessCategory");Ae("2.5.4.17","postalCode");Ae("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Ae("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Ae("2.16.840.1.113730.1.1","nsCertType");Ae("2.16.840.1.113730.1.13","nsComment");Ft("2.5.29.1","authorityKeyIdentifier");Ft("2.5.29.2","keyAttributes");Ft("2.5.29.3","certificatePolicies");Ft("2.5.29.4","keyUsageRestriction");Ft("2.5.29.5","policyMapping");Ft("2.5.29.6","subtreesConstraint");Ft("2.5.29.7","subjectAltName");Ft("2.5.29.8","issuerAltName");Ft("2.5.29.9","subjectDirectoryAttributes");Ft("2.5.29.10","basicConstraints");Ft("2.5.29.11","nameConstraints");Ft("2.5.29.12","policyConstraints");Ft("2.5.29.13","basicConstraints");Ae("2.5.29.14","subjectKeyIdentifier");Ae("2.5.29.15","keyUsage");Ft("2.5.29.16","privateKeyUsagePeriod");Ae("2.5.29.17","subjectAltName");Ae("2.5.29.18","issuerAltName");Ae("2.5.29.19","basicConstraints");Ft("2.5.29.20","cRLNumber");Ft("2.5.29.21","cRLReason");Ft("2.5.29.22","expirationDate");Ft("2.5.29.23","instructionCode");Ft("2.5.29.24","invalidityDate");Ft("2.5.29.25","cRLDistributionPoints");Ft("2.5.29.26","issuingDistributionPoint");Ft("2.5.29.27","deltaCRLIndicator");Ft("2.5.29.28","issuingDistributionPoint");Ft("2.5.29.29","certificateIssuer");Ft("2.5.29.30","nameConstraints");Ae("2.5.29.31","cRLDistributionPoints");Ae("2.5.29.32","certificatePolicies");Ft("2.5.29.33","policyMappings");Ft("2.5.29.34","policyConstraints");Ae("2.5.29.35","authorityKeyIdentifier");Ft("2.5.29.36","policyConstraints");Ae("2.5.29.37","extKeyUsage");Ft("2.5.29.46","freshestCRL");Ft("2.5.29.54","inhibitAnyPolicy");Ae("1.3.6.1.4.1.11129.2.4.2","timestampList");Ae("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Ae("1.3.6.1.5.5.7.3.1","serverAuth");Ae("1.3.6.1.5.5.7.3.2","clientAuth");Ae("1.3.6.1.5.5.7.3.3","codeSigning");Ae("1.3.6.1.5.5.7.3.4","emailProtection");Ae("1.3.6.1.5.5.7.3.8","timeStamping")});var nc=p((P_t,sk)=>{u();var vr=lt();$t();wh();var De=sk.exports=vr.asn1=vr.asn1||{};De.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};De.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};De.create=function(r,e,t,i,n){if(vr.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var a={tagClass:r,type:e,constructed:t,composed:t||vr.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=De.copy(a)),a};De.copy=function(r,e){var t;if(vr.util.isArray(r)){t=[];for(var i=0;i<r.length;++i)t.push(De.copy(r[i],e));return t}return typeof r=="string"?r:(t={tagClass:r.tagClass,type:r.type,constructed:r.constructed,composed:r.composed,value:De.copy(r.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=r.bitStringContents),t)};De.equals=function(r,e,t){if(vr.util.isArray(r)){if(!vr.util.isArray(e)||r.length!==e.length)return!1;for(var i=0;i<r.length;++i)if(!De.equals(r[i],e[i]))return!1;return!0}if(typeof r!=typeof e)return!1;if(typeof r=="string")return r===e;var n=r.tagClass===e.tagClass&&r.type===e.type&&r.constructed===e.constructed&&r.composed===e.composed&&De.equals(r.value,e.value);return t&&t.includeBitStringContents&&(n=n&&r.bitStringContents===e.bitStringContents),n};De.getBerValueLength=function(r){var e=r.getByte();if(e!==128){var t,i=e&128;return i?t=r.getInt((e&127)<<3):t=e,t}};function ay(r,e,t){if(t>e){var i=new Error("Too few bytes to parse DER.");throw i.available=r.length(),i.remaining=e,i.requested=t,i}}var NAe=function(r,e){var t=r.getByte();if(e--,t!==128){var i,n=t&128;if(!n)i=t;else{var s=t&127;ay(r,e,s),i=r.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};De.fromDer=function(r,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof r=="string"&&(r=vr.util.createBuffer(r)),s1(r,r.length(),0,e)};function s1(r,e,t,i){var n;ay(r,e,2);var s=r.getByte();e--;var o=s&192,a=s&31;n=r.length();var c=NAe(r,e);if(e-=n-r.length(),c!==void 0&&c>e){if(i.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=r.length(),f.remaining=e,f.requested=c,f}c=e}var l,h,d=(s&32)==32;if(d)if(l=[],c===void 0)for(;;){if(ay(r,e,2),r.bytes(2)===String.fromCharCode(0,0)){r.getBytes(2),e-=2;break}n=r.length(),l.push(s1(r,e,t+1,i)),e-=n-r.length()}else for(;c>0;)n=r.length(),l.push(s1(r,c,t+1,i)),e-=n-r.length(),c-=n-r.length();if(l===void 0&&o===De.Class.UNIVERSAL&&a===De.Type.BITSTRING&&(h=r.bytes(c)),l===void 0&&i.decodeBitStrings&&o===De.Class.UNIVERSAL&&a===De.Type.BITSTRING&&c>1){var y=r.read,g=e,m=0;if(a===De.Type.BITSTRING&&(ay(r,e,1),m=r.getByte(),e--),m===0)try{n=r.length();var E={verbose:i.verbose,strict:!0,decodeBitStrings:!0},_=s1(r,e,t+1,E),T=n-r.length();e-=T,a==De.Type.BITSTRING&&T++;var q=_.tagClass;T===c&&(q===De.Class.UNIVERSAL||q===De.Class.CONTEXT_SPECIFIC)&&(l=[_])}catch(V){}l===void 0&&(r.read=y,e=g)}if(l===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===De.Type.BMPSTRING)for(l="";c>0;c-=2)ay(r,e,2),l+=String.fromCharCode(r.getInt16()),e-=2;else l=r.getBytes(c)}var z=h===void 0?null:{bitStringContents:h};return De.create(o,a,d,l,z)}De.toDer=function(r){var e=vr.util.createBuffer(),t=r.tagClass|r.type,i=vr.util.createBuffer(),n=!1;if("bitStringContents"in r&&(n=!0,r.original&&(n=De.equals(r,r.original))),n)i.putBytes(r.bitStringContents);else if(r.composed){r.constructed?t|=32:i.putByte(0);for(var s=0;s<r.value.length;++s)r.value[s]!==void 0&&i.putBuffer(De.toDer(r.value[s]))}else if(r.type===De.Type.BMPSTRING)for(var s=0;s<r.value.length;++s)i.putInt16(r.value.charCodeAt(s));else r.type===De.Type.INTEGER&&r.value.length>1&&(r.value.charCodeAt(0)===0&&(r.value.charCodeAt(1)&128)==0||r.value.charCodeAt(0)===255&&(r.value.charCodeAt(1)&128)==128)?i.putBytes(r.value.substr(1)):i.putBytes(r.value);if(e.putByte(t),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};De.oidToDer=function(r){var e=r.split("."),t=vr.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)t.putByte(n[c])}return t};De.derToOid=function(r){var e;typeof r=="string"&&(r=vr.util.createBuffer(r));var t=r.getByte();e=Math.floor(t/40)+"."+t%40;for(var i=0;r.length()>0;)t=r.getByte(),i=i<<7,t&128?i+=t&127:(e+="."+(i+t),i=0);return e};De.utcTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,2),10);t=t>=50?1900+t:2e3+t;var i=parseInt(r.substr(2,2),10)-1,n=parseInt(r.substr(4,2),10),s=parseInt(r.substr(6,2),10),o=parseInt(r.substr(8,2),10),a=0;if(r.length>11){var c=r.charAt(10),f=10;c!=="+"&&c!=="-"&&(a=parseInt(r.substr(10,2),10),f+=2)}if(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,0),f&&(c=r.charAt(f),c==="+"||c==="-")){var l=parseInt(r.substr(f+1,2),10),h=parseInt(r.substr(f+4,2),10),d=l*60+h;d*=6e4,c==="+"?e.setTime(+e-d):e.setTime(+e+d)}return e};De.generalizedTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,4),10),i=parseInt(r.substr(4,2),10)-1,n=parseInt(r.substr(6,2),10),s=parseInt(r.substr(8,2),10),o=parseInt(r.substr(10,2),10),a=parseInt(r.substr(12,2),10),c=0,f=0,l=!1;r.charAt(r.length-1)==="Z"&&(l=!0);var h=r.length-5,d=r.charAt(h);if(d==="+"||d==="-"){var y=parseInt(r.substr(h+1,2),10),g=parseInt(r.substr(h+4,2),10);f=y*60+g,f*=6e4,d==="+"&&(f*=-1),l=!0}return r.charAt(14)==="."&&(c=parseFloat(r.substr(14),10)*1e3),l?(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,c),e.setTime(+e+f)):(e.setFullYear(t,i,n),e.setHours(s,o,a,c)),e};De.dateToUtcTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push((""+r.getUTCFullYear()).substr(2)),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};De.dateToGeneralizedTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push(""+r.getUTCFullYear()),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};De.integerToDer=function(r){var e=vr.util.createBuffer();if(r>=-128&&r<128)return e.putSignedInt(r,8);if(r>=-32768&&r<32768)return e.putSignedInt(r,16);if(r>=-8388608&&r<8388608)return e.putSignedInt(r,24);if(r>=-2147483648&&r<2147483648)return e.putSignedInt(r,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=r,t};De.derToInteger=function(r){typeof r=="string"&&(r=vr.util.createBuffer(r));var e=r.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return r.getSignedInt(e)};De.validate=function(r,e,t,i){var n=!1;if((r.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(r.type===e.type||typeof e.type=="undefined"))if(r.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&vr.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,r.value[s]&&(n=De.validate(r.value[s],e.value[o],t,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+r.value.length+'"');if(n&&t&&(e.capture&&(t[e.capture]=r.value),e.captureAsn1&&(t[e.captureAsn1]=r),e.captureBitStringContents&&"bitStringContents"in r&&(t[e.captureBitStringContents]=r.bitStringContents),e.captureBitStringValue&&"bitStringContents"in r)){var a;if(r.bitStringContents.length<2)t[e.captureBitStringValue]="";else{var c=r.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=r.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+r.constructed+'"');else i&&(r.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+r.tagClass+'"'),r.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+r.type+'"'));return n};var nk=/[^\\u0000-\\u00ff]/;De.prettyPrint=function(r,e,t){var i="";e=e||0,t=t||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*t;++s)n+=" ";switch(i+=n+"Tag: ",r.tagClass){case De.Class.UNIVERSAL:i+="Universal:";break;case De.Class.APPLICATION:i+="Application:";break;case De.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case De.Class.PRIVATE:i+="Private:";break}if(r.tagClass===De.Class.UNIVERSAL)switch(i+=r.type,r.type){case De.Type.NONE:i+=" (None)";break;case De.Type.BOOLEAN:i+=" (Boolean)";break;case De.Type.INTEGER:i+=" (Integer)";break;case De.Type.BITSTRING:i+=" (Bit string)";break;case De.Type.OCTETSTRING:i+=" (Octet string)";break;case De.Type.NULL:i+=" (Null)";break;case De.Type.OID:i+=" (Object Identifier)";break;case De.Type.ODESC:i+=" (Object Descriptor)";break;case De.Type.EXTERNAL:i+=" (External or Instance of)";break;case De.Type.REAL:i+=" (Real)";break;case De.Type.ENUMERATED:i+=" (Enumerated)";break;case De.Type.EMBEDDED:i+=" (Embedded PDV)";break;case De.Type.UTF8:i+=" (UTF8)";break;case De.Type.ROID:i+=" (Relative Object Identifier)";break;case De.Type.SEQUENCE:i+=" (Sequence)";break;case De.Type.SET:i+=" (Set)";break;case De.Type.PRINTABLESTRING:i+=" (Printable String)";break;case De.Type.IA5String:i+=" (IA5String (ASCII))";break;case De.Type.UTCTIME:i+=" (UTC time)";break;case De.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case De.Type.BMPSTRING:i+=" (BMP String)";break}else i+=r.type;if(i+=`
`,i+=n+"Constructed: "+r.constructed+`
`,r.composed){for(var o=0,a="",s=0;s<r.value.length;++s)r.value[s]!==void 0&&(o+=1,a+=De.prettyPrint(r.value[s],e+1,t),s+1<r.value.length&&(a+=","));i+=n+"Sub values: "+o+a}else{if(i+=n+"Value: ",r.type===De.Type.OID){var c=De.derToOid(r.value);i+=c,vr.pki&&vr.pki.oids&&c in vr.pki.oids&&(i+=" ("+vr.pki.oids[c]+") ")}if(r.type===De.Type.INTEGER)try{i+=De.derToInteger(r.value)}catch(l){i+="0x"+vr.util.bytesToHex(r.value)}else if(r.type===De.Type.BITSTRING){if(r.value.length>1?i+="0x"+vr.util.bytesToHex(r.value.slice(1)):i+="(none)",r.value.length>0){var f=r.value.charCodeAt(0);f==1?i+=" (1 unused bit shown)":f>1&&(i+=" ("+f+" unused bits shown)")}}else r.type===De.Type.OCTETSTRING?(nk.test(r.value)||(i+="("+r.value+") "),i+="0x"+vr.util.bytesToHex(r.value)):r.type===De.Type.UTF8?i+=vr.util.decodeUtf8(r.value):r.type===De.Type.PRINTABLESTRING||r.type===De.Type.IA5String?i+=r.value:nk.test(r.value)?i+="0x"+vr.util.bytesToHex(r.value):r.value.length===0?i+="[null]":i+=r.value}return i}});var N3=p((C_t,ok)=>{u();var Ci=lt();$t();ok.exports=Ci.cipher=Ci.cipher||{};Ci.cipher.algorithms=Ci.cipher.algorithms||{};Ci.cipher.createCipher=function(r,e){var t=r;if(typeof t=="string"&&(t=Ci.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new Ci.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})};Ci.cipher.createDecipher=function(r,e){var t=r;if(typeof t=="string"&&(t=Ci.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new Ci.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})};Ci.cipher.registerAlgorithm=function(r,e){r=r.toUpperCase(),Ci.cipher.algorithms[r]=e};Ci.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in Ci.cipher.algorithms?Ci.cipher.algorithms[r]:null};var B3=Ci.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};B3.prototype.start=function(r){r=r||{};var e={};for(var t in r)e[t]=r[t];e.decrypt=this._decrypt,this._finish=!1,this._input=Ci.util.createBuffer(),this.output=r.output||Ci.util.createBuffer(),this.mode.start(e)};B3.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};B3.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(t){return r(this.blockSize,t,!1)},this.mode.unpad=function(t){return r(this.blockSize,t,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var M3=p((O_t,ak)=>{u();var Oi=lt();$t();Oi.cipher=Oi.cipher||{};var bt=ak.exports=Oi.cipher.modes=Oi.cipher.modes||{};bt.ecb=function(r){r=r||{},this.name="ECB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};bt.ecb.prototype.start=function(r){};bt.ecb.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};bt.ecb.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};bt.ecb.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};bt.ecb.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};bt.cbc=function(r){r=r||{},this.name="CBC",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};bt.cbc.prototype.start=function(r){if(r.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in r)this._iv=o1(r.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};bt.cbc.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};bt.cbc.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};bt.cbc.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};bt.cbc.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};bt.cfb=function(r){r=r||{},this.name="CFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Oi.util.createBuffer(),this._partialBytes=0};bt.cfb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=o1(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};bt.cfb.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};bt.cfb.prototype.decrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};bt.ofb=function(r){r=r||{},this.name="OFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Oi.util.createBuffer(),this._partialBytes=0};bt.ofb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=o1(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};bt.ofb.prototype.encrypt=function(r,e,t){var i=r.length();if(r.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};bt.ofb.prototype.decrypt=bt.ofb.prototype.encrypt;bt.ctr=function(r){r=r||{},this.name="CTR",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Oi.util.createBuffer(),this._partialBytes=0};bt.ctr.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=o1(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};bt.ctr.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0&&(r.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}a1(this._inBlock)};bt.ctr.prototype.decrypt=bt.ctr.prototype.encrypt;bt.gcm=function(r){r=r||{},this.name="GCM",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Oi.util.createBuffer(),this._partialBytes=0,this._R=3774873600};bt.gcm.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");var e=Oi.util.createBuffer(r.iv);this._cipherLength=0;var t;if("additionalData"in r?t=Oi.util.createBuffer(r.additionalData):t=Oi.util.createBuffer(),"tagLength"in r?this._tagLength=r.tagLength:this._tagLength=128,this._tag=null,r.decrypt&&(this._tag=Oi.util.createBuffer(r.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(D3(i*8)))}this._inBlock=this._j0.slice(0),a1(this._inBlock),this._partialBytes=0,t=Oi.util.createBuffer(t),this._aDataLength=D3(t.length()*8);var n=t.length()%this.blockSize;for(n&&t.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])};bt.gcm.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=r.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s<=0||t){if(t){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return r.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),a1(this._inBlock)};bt.gcm.prototype.decrypt=function(r,e,t){var i=r.length();if(i<this.blockSize&&!(t&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),a1(this._inBlock),this._hashBlock[0]=r.getInt32(),this._hashBlock[1]=r.getInt32(),this._hashBlock[2]=r.getInt32(),this._hashBlock[3]=r.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};bt.gcm.prototype.afterFinish=function(r,e){var t=!0;e.decrypt&&e.overflow&&r.truncate(this.blockSize-e.overflow),this.tag=Oi.util.createBuffer();var i=this._aDataLength.concat(D3(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t};bt.gcm.prototype.multiply=function(r,e){for(var t=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=r[n/32|0]&1<<31-n%32;s&&(t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]),this.pow(i,i)}return t};bt.gcm.prototype.pow=function(r,e){for(var t=r[3]&1,i=3;i>0;--i)e[i]=r[i]>>>1|(r[i-1]&1)<<31;e[0]=r[0]>>>1,t&&(e[0]^=this._R)};bt.gcm.prototype.tableMultiply=function(r){for(var e=[0,0,0,0],t=0;t<32;++t){var i=t/8|0,n=r[i]>>>(7-t%8)*4&15,s=this._m[t][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};bt.gcm.prototype.ghash=function(r,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)};bt.gcm.prototype.generateHashTable=function(r,e){for(var t=8/e,i=4*t,n=16*t,s=new Array(n),o=0;o<n;++o){var a=[0,0,0,0],c=o/i|0,f=(i-1-o%i)*e;a[c]=1<<e-1<<f,s[o]=this.generateSubHashTable(this.multiply(a,r),e)}return s};bt.gcm.prototype.generateSubHashTable=function(r,e){var t=1<<e,i=t>>>1,n=new Array(t);n[i]=r.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var a=n[s],c=n[o];n[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<t;++s){var f=n[s^i];n[s]=[r[0]^f[0],r[1]^f[1],r[2]^f[2],r[3]^f[3]]}return n};function o1(r,e){if(typeof r=="string"&&(r=Oi.util.createBuffer(r)),Oi.util.isArray(r)&&r.length>4){var t=r;r=Oi.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}if(r.length()<e)throw new Error("Invalid IV length; got "+r.length()+" bytes and expected "+e+" bytes.");if(!Oi.util.isArray(r)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(r.getInt32());r=n}return r}function a1(r){r[r.length-1]=r[r.length-1]+1&4294967295}function D3(r){return[r/4294967296|0,r&4294967295]}});var Sh=p((q_t,fk)=>{u();var er=lt();N3();M3();$t();fk.exports=er.aes=er.aes||{};er.aes.startEncrypting=function(r,e,t,i){var n=c1({key:r,output:t,decrypt:!1,mode:i});return n.start(e),n};er.aes.createEncryptionCipher=function(r,e){return c1({key:r,output:null,decrypt:!1,mode:e})};er.aes.startDecrypting=function(r,e,t,i){var n=c1({key:r,output:t,decrypt:!0,mode:i});return n.start(e),n};er.aes.createDecryptionCipher=function(r,e){return c1({key:r,output:null,decrypt:!0,mode:e})};er.aes.Algorithm=function(r,e){L3||uk();var t=this;t.name=r,t.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return F3(t._w,i,n,!1)},decrypt:function(i,n){return F3(t._w,i,n,!0)}}}),t._init=!1};er.aes.Algorithm.prototype.initialize=function(r){if(!this._init){var e=r.key,t;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=er.util.createBuffer(e);else if(er.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){t=e,e=er.util.createBuffer();for(var i=0;i<t.length;++i)e.putByte(t[i])}if(!er.util.isArray(e)){t=e,e=[];var n=t.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(t.getInt32())}}if(!er.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=lk(e,r.decrypt&&!o),this._init=!0}};er.aes._expandKey=function(r,e){return L3||uk(),lk(r,e)};er.aes._updateBlock=F3;_h("AES-ECB",er.cipher.modes.ecb);_h("AES-CBC",er.cipher.modes.cbc);_h("AES-CFB",er.cipher.modes.cfb);_h("AES-OFB",er.cipher.modes.ofb);_h("AES-CTR",er.cipher.modes.ctr);_h("AES-GCM",er.cipher.modes.gcm);function _h(r,e){var t=function(){return new er.aes.Algorithm(r,e)};er.cipher.registerAlgorithm(r,t)}var L3=!1,Eh=4,vn,U3,ck,Tl,ro;function uk(){L3=!0,ck=[0,1,2,4,8,16,32,64,128,27,54];for(var r=new Array(256),e=0;e<128;++e)r[e]=e<<1,r[e+128]=e+128<<1^283;vn=new Array(256),U3=new Array(256),Tl=new Array(4),ro=new Array(4);for(var e=0;e<4;++e)Tl[e]=new Array(256),ro[e]=new Array(256);for(var t=0,i=0,n,s,o,a,c,f,l,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,vn[t]=a,U3[a]=t,c=r[a],n=r[t],s=r[n],o=r[s],f=c<<24^a<<16^a<<8^(a^c),l=(n^s^o)<<24^(t^o)<<16^(t^s^o)<<8^(t^n^o);for(var h=0;h<4;++h)Tl[h][t]=f,ro[h][a]=l,f=f<<24|f>>>8,l=l<<24|l>>>8;t===0?t=i=1:(t=n^r[r[r[n^o]]],i^=r[r[i]])}}function lk(r,e){for(var t=r.slice(0),i,n=1,s=t.length,o=s+6+1,a=Eh*o,c=s;c<a;++c)i=t[c-1],c%s==0?(i=vn[i>>>16&255]<<24^vn[i>>>8&255]<<16^vn[i&255]<<8^vn[i>>>24]^ck[n]<<24,n++):s>6&&c%s==4&&(i=vn[i>>>24]<<24^vn[i>>>16&255]<<16^vn[i>>>8&255]<<8^vn[i&255]),t[c]=t[c-s]^i;if(e){var f,l=ro[0],h=ro[1],d=ro[2],y=ro[3],g=t.slice(0);a=t.length;for(var c=0,m=a-Eh;c<a;c+=Eh,m-=Eh)if(c===0||c===a-Eh)g[c]=t[m],g[c+1]=t[m+3],g[c+2]=t[m+2],g[c+3]=t[m+1];else for(var E=0;E<Eh;++E)f=t[m+E],g[c+(3&-E)]=l[vn[f>>>24]]^h[vn[f>>>16&255]]^d[vn[f>>>8&255]]^y[vn[f&255]];t=g}return t}function F3(r,e,t,i){var n=r.length/4-1,s,o,a,c,f;i?(s=ro[0],o=ro[1],a=ro[2],c=ro[3],f=U3):(s=Tl[0],o=Tl[1],a=Tl[2],c=Tl[3],f=vn);var l,h,d,y,g,m,E;l=e[0]^r[0],h=e[i?3:1]^r[1],d=e[2]^r[2],y=e[i?1:3]^r[3];for(var _=3,T=1;T<n;++T)g=s[l>>>24]^o[h>>>16&255]^a[d>>>8&255]^c[y&255]^r[++_],m=s[h>>>24]^o[d>>>16&255]^a[y>>>8&255]^c[l&255]^r[++_],E=s[d>>>24]^o[y>>>16&255]^a[l>>>8&255]^c[h&255]^r[++_],y=s[y>>>24]^o[l>>>16&255]^a[h>>>8&255]^c[d&255]^r[++_],l=g,h=m,d=E;t[0]=f[l>>>24]<<24^f[h>>>16&255]<<16^f[d>>>8&255]<<8^f[y&255]^r[++_],t[i?3:1]=f[h>>>24]<<24^f[d>>>16&255]<<16^f[y>>>8&255]<<8^f[l&255]^r[++_],t[2]=f[d>>>24]<<24^f[y>>>16&255]<<16^f[l>>>8&255]<<8^f[h&255]^r[++_],t[i?1:3]=f[y>>>24]<<24^f[l>>>16&255]<<16^f[h>>>8&255]<<8^f[d&255]^r[++_]}function c1(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="AES-"+e,i;r.decrypt?i=er.cipher.createDecipher(t,r.key):i=er.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof er.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var l1=p((k_t,dk)=>{u();var wr=lt();N3();M3();$t();dk.exports=wr.des=wr.des||{};wr.des.startEncrypting=function(r,e,t,i){var n=u1({key:r,output:t,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};wr.des.createEncryptionCipher=function(r,e){return u1({key:r,output:null,decrypt:!1,mode:e})};wr.des.startDecrypting=function(r,e,t,i){var n=u1({key:r,output:t,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};wr.des.createDecryptionCipher=function(r,e){return u1({key:r,output:null,decrypt:!0,mode:e})};wr.des.Algorithm=function(r,e){var t=this;t.name=r,t.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return hk(t._keys,i,n,!1)},decrypt:function(i,n){return hk(t._keys,i,n,!0)}}}),t._init=!1};wr.des.Algorithm.prototype.initialize=function(r){if(!this._init){var e=wr.util.createBuffer(r.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=zAe(e),this._init=!0}};ta("DES-ECB",wr.cipher.modes.ecb);ta("DES-CBC",wr.cipher.modes.cbc);ta("DES-CFB",wr.cipher.modes.cfb);ta("DES-OFB",wr.cipher.modes.ofb);ta("DES-CTR",wr.cipher.modes.ctr);ta("3DES-ECB",wr.cipher.modes.ecb);ta("3DES-CBC",wr.cipher.modes.cbc);ta("3DES-CFB",wr.cipher.modes.cfb);ta("3DES-OFB",wr.cipher.modes.ofb);ta("3DES-CTR",wr.cipher.modes.ctr);function ta(r,e){var t=function(){return new wr.des.Algorithm(r,e)};wr.cipher.registerAlgorithm(r,t)}var DAe=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],MAe=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],LAe=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],UAe=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],FAe=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],KAe=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],jAe=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],VAe=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function zAe(r){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=r.length()>8?3:1,E=[],_=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],T=0,q,z=0;z<m;z++){var V=r.getInt32(),M=r.getInt32();q=(V>>>4^M)&252645135,M^=q,V^=q<<4,q=(M>>>-16^V)&65535,V^=q,M^=q<<-16,q=(V>>>2^M)&858993459,M^=q,V^=q<<2,q=(M>>>-16^V)&65535,V^=q,M^=q<<-16,q=(V>>>1^M)&1431655765,M^=q,V^=q<<1,q=(M>>>8^V)&16711935,V^=q,M^=q<<8,q=(V>>>1^M)&1431655765,M^=q,V^=q<<1,q=V<<8|M>>>20&240,V=M<<24|M<<8&16711680|M>>>8&65280|M>>>24&240,M=q;for(var $=0;$<_.length;++$){_[$]?(V=V<<2|V>>>26,M=M<<2|M>>>26):(V=V<<1|V>>>27,M=M<<1|M>>>27),V&=-15,M&=-15;var X=e[V>>>28]|t[V>>>24&15]|i[V>>>20&15]|n[V>>>16&15]|s[V>>>12&15]|o[V>>>8&15]|a[V>>>4&15],Q=c[M>>>28]|f[M>>>24&15]|l[M>>>20&15]|h[M>>>16&15]|d[M>>>12&15]|y[M>>>8&15]|g[M>>>4&15];q=(Q>>>16^X)&65535,E[T++]=X^q,E[T++]=Q^q<<16}}return E}function hk(r,e,t,i){var n=r.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var f=0;f<n;f+=3){for(var l=s[f+1],h=s[f+2],d=s[f];d!=l;d+=h){var y=c^r[d],g=(c>>>4|c<<28)^r[d+1];o=a,a=c,c=o^(MAe[y>>>24&63]|UAe[y>>>16&63]|KAe[y>>>8&63]|VAe[y&63]|DAe[g>>>24&63]|LAe[g>>>16&63]|FAe[g>>>8&63]|jAe[g&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,t[0]=a,t[1]=c}function u1(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="DES-"+e,i;r.decrypt?i=wr.cipher.createDecipher(t,r.key):i=wr.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof wr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var su=p((B_t,pk)=>{u();var f1=lt();pk.exports=f1.md=f1.md||{};f1.md.algorithms=f1.md.algorithms||{}});var gk=p((N_t,yk)=>{u();var sc=lt();su();$t();var HAe=yk.exports=sc.hmac=sc.hmac||{};HAe.create=function(){var r=null,e=null,t=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in sc.md.algorithms)e=sc.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=r;else{if(typeof o=="string")o=sc.util.createBuffer(o);else if(sc.util.isArray(o)){var a=o;o=sc.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var f=o.length();f>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),t=sc.util.createBuffer(),i=sc.util.createBuffer(),f=o.length();for(var c=0;c<f;++c){var a=o.at(c);t.putByte(54^a),i.putByte(92^a)}if(f<e.blockLength)for(var a=e.blockLength-f,c=0;c<a;++c)t.putByte(54),i.putByte(92);r=o,t=t.bytes(),i=i.bytes()}e.start(),e.update(t)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var Ah=p(()=>{u()});var K3=p((L_t,bk)=>{u();var wn=lt();gk();su();$t();var $Ae=wn.pkcs5=wn.pkcs5||{},oc;wn.util.isNodejs&&!wn.options.usePureJavaScript&&(oc=Ah());bk.exports=wn.pbkdf2=$Ae.pbkdf2=function(r,e,t,i,n,s){if(typeof n=="function"&&(s=n,n=null),wn.util.isNodejs&&!wn.options.usePureJavaScript&&oc.pbkdf2&&(n===null||typeof n!="object")&&(oc.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),r=Buffer.from(r,"binary"),e=Buffer.from(e,"binary"),s?oc.pbkdf2Sync.length===4?oc.pbkdf2(r,e,t,i,function(q,z){if(q)return s(q);s(null,z.toString("binary"))}):oc.pbkdf2(r,e,t,i,n,function(q,z){if(q)return s(q);s(null,z.toString("binary"))}):oc.pbkdf2Sync.length===4?oc.pbkdf2Sync(r,e,t,i).toString("binary"):oc.pbkdf2Sync(r,e,t,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in wn.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=wn.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(i/o),f=i-(c-1)*o,l=wn.hmac.create();l.start(n,r);var h="",d,y,g;if(!s){for(var m=1;m<=c;++m){l.start(null,null),l.update(e),l.update(wn.util.int32ToBytes(m)),d=g=l.digest().getBytes();for(var E=2;E<=t;++E)l.start(null,null),l.update(g),y=l.digest().getBytes(),d=wn.util.xorBytes(d,y,o),g=y;h+=m<c?d:d.substr(0,f)}return h}var m=1,E;function _(){if(m>c)return s(null,h);l.start(null,null),l.update(e),l.update(wn.util.int32ToBytes(m)),d=g=l.digest().getBytes(),E=2,T()}function T(){if(E<=t)return l.start(null,null),l.update(g),y=l.digest().getBytes(),d=wn.util.xorBytes(d,y,o),g=y,++E,wn.util.setImmediate(T);h+=m<c?d:d.substr(0,f),++m,_()}_()}});var p1=p((U_t,vk)=>{u();var h1=lt();$t();var mk=vk.exports=h1.pem=h1.pem||{};mk.encode=function(r,e){e=e||{};var t="-----BEGIN "+r.type+`-----\r
`,i;if(r.procType&&(i={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},t+=d1(i)),r.contentDomain&&(i={name:"Content-Domain",values:[r.contentDomain]},t+=d1(i)),r.dekInfo&&(i={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&i.values.push(r.dekInfo.parameters),t+=d1(i)),r.headers)for(var n=0;n<r.headers.length;++n)t+=d1(r.headers[n]);return r.procType&&(t+=`\r
`),t+=h1.util.encode64(r.body,e.maxline||64)+`\r
`,t+="-----END "+r.type+`-----\r
`,t};mk.decode=function(r){for(var e=[],t=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=t.exec(r),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:h1.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var a=s[2].split(n),c=0;s&&c<a.length;){for(var f=a[c].replace(/\s+$/,""),l=c+1;l<a.length;++l){var h=a[l];if(!/\s/.test(h[0]))break;f+=h,c=l}if(s=f.match(i),s){for(var d={name:s[1],values:[]},y=s[2].split(","),g=0;g<y.length;++g)d.values.push(GAe(y[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=y[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:y[0],parameters:y[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:y[0],type:y[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function d1(r){for(var e=r.name+": ",t=[],i=function(c,f){return" "+f},n=0;n<r.values.length;++n)t.push(r.values[n].replace(/^(\S+\r\n)/,i));e+=t.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function GAe(r){return r.replace(/^\s+/,"")}});var xk=p((F_t,Ak)=>{u();var ra=lt();su();$t();var wk=Ak.exports=ra.sha256=ra.sha256||{};ra.md.sha256=ra.md.algorithms.sha256=wk;wk.create=function(){_k||WAe();var r=null,e=ra.util.createBuffer(),t=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=ra.util.createBuffer(),r={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=ra.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),Sk(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=ra.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(j3.substr(0,i.blockLength-o));for(var a,c,f=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,f+=c,n.putInt32(f>>>0),f=a>>>0;n.putInt32(f);var h={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4,h5:r.h5,h6:r.h6,h7:r.h7};Sk(h,t,n);var d=ra.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d.putInt32(h.h5),d.putInt32(h.h6),d.putInt32(h.h7),d},i};var j3=null,_k=!1,Ek=null;function WAe(){j3=String.fromCharCode(128),j3+=ra.util.fillString(String.fromCharCode(0),64),Ek=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_k=!0}function Sk(r,e,t){for(var i,n,s,o,a,c,f,l,h,d,y,g,m,E,_,T=t.length();T>=64;){for(f=0;f<16;++f)e[f]=t.getInt32();for(;f<64;++f)i=e[f-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[f-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[f]=i+e[f-7]+n+e[f-16]|0;for(l=r.h0,h=r.h1,d=r.h2,y=r.h3,g=r.h4,m=r.h5,E=r.h6,_=r.h7,f=0;f<64;++f)o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),a=E^g&(m^E),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&h|d&(l^h),i=_+o+a+Ek[f]+e[f],n=s+c,_=E,E=m,m=g,g=y+i>>>0,y=d,d=h,h=l,l=i+n>>>0;r.h0=r.h0+l|0,r.h1=r.h1+h|0,r.h2=r.h2+d|0,r.h3=r.h3+y|0,r.h4=r.h4+g|0,r.h5=r.h5+m|0,r.h6=r.h6+E|0,r.h7=r.h7+_|0,T-=64}}});var Tk=p((K_t,Ik)=>{u();var ia=lt();$t();var y1=null;ia.util.isNodejs&&!ia.options.usePureJavaScript&&!process.versions["node-webkit"]&&(y1=Ah());var YAe=Ik.exports=ia.prng=ia.prng||{};YAe.create=function(r){for(var e={plugin:r,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=r.md,i=new Array(32),n=0;n<32;++n)i[n]=t.create();e.pools=i,e.pool=0,e.generate=function(f,l){if(!l)return e.generateSync(f);var h=e.plugin.cipher,d=e.plugin.increment,y=e.plugin.formatKey,g=e.plugin.formatSeed,m=ia.util.createBuffer();e.key=null,E();function E(_){if(_)return l(_);if(m.length()>=f)return l(null,m.getBytes(f));if(e.generated>1048575&&(e.key=null),e.key===null)return ia.util.nextTick(function(){s(E)});var T=h(e.key,e.seed);e.generated+=T.length,m.putBytes(T),e.key=y(h(e.key,d(e.seed))),e.seed=g(h(e.key,e.seed)),ia.util.setImmediate(E)}},e.generateSync=function(f){var l=e.plugin.cipher,h=e.plugin.increment,d=e.plugin.formatKey,y=e.plugin.formatSeed;e.key=null;for(var g=ia.util.createBuffer();g.length()<f;){e.generated>1048575&&(e.key=null),e.key===null&&o();var m=l(e.key,e.seed);e.generated+=m.length,g.putBytes(m),e.key=d(l(e.key,h(e.seed))),e.seed=y(l(e.key,e.seed))}return g.getBytes(f)};function s(f){if(e.pools[0].messageLength>=32)return a(),f();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(h,d){if(h)return f(h);e.collect(d),a(),f()})}function o(){if(e.pools[0].messageLength>=32)return a();var f=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(f)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var f=e.plugin.md.create();f.update(e.keyBytes);for(var l=1,h=0;h<32;++h)e.reseeds%l==0&&(f.update(e.pools[h].digest().getBytes()),e.pools[h].start()),l=l<<1;e.keyBytes=f.digest().getBytes(),f.start(),f.update(e.keyBytes);var d=f.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(d),e.generated=0}function c(f){var l=null,h=ia.util.globalScope,d=h.crypto||h.msCrypto;d&&d.getRandomValues&&(l=function(V){return d.getRandomValues(V)});var y=ia.util.createBuffer();if(l)for(;y.length()<f;){var g=Math.max(1,Math.min(f-y.length(),65536)/4),m=new Uint32Array(Math.floor(g));try{l(m);for(var E=0;E<m.length;++E)y.putInt32(m[E])}catch(V){if(!(typeof QuotaExceededError!="undefined"&&V instanceof QuotaExceededError))throw V}}if(y.length()<f)for(var _,T,q,z=Math.floor(Math.random()*65536);y.length()<f;){T=16807*(z&65535),_=16807*(z>>16),T+=(_&32767)<<16,T+=_>>15,T=(T&2147483647)+(T>>31),z=T&4294967295;for(var E=0;E<3;++E)q=z>>>(E<<3),q^=Math.floor(Math.random()*256),y.putByte(String.fromCharCode(q&255))}return y.getBytes(f)}return y1?(e.seedFile=function(f,l){y1.randomBytes(f,function(h,d){if(h)return l(h);l(null,d.toString())})},e.seedFileSync=function(f){return y1.randomBytes(f).toString()}):(e.seedFile=function(f,l){try{l(null,c(f))}catch(h){l(h)}},e.seedFileSync=c),e.collect=function(f){for(var l=f.length,h=0;h<l;++h)e.pools[e.pool].update(f.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(f,l){for(var h="",d=0;d<l;d+=8)h+=String.fromCharCode(f>>d&255);e.collect(h)},e.registerWorker=function(f){if(f===self)e.seedFile=function(h,d){function y(g){var m=g.data;m.forge&&m.forge.prng&&(self.removeEventListener("message",y),d(m.forge.prng.err,m.forge.prng.bytes))}self.addEventListener("message",y),self.postMessage({forge:{prng:{needed:h}}})};else{var l=function(h){var d=h.data;d.forge&&d.forge.prng&&e.seedFile(d.forge.prng.needed,function(y,g){f.postMessage({forge:{prng:{err:y,bytes:g}}})})};f.addEventListener("message",l)}},e}});var ou=p((j_t,V3)=>{u();var qi=lt();Sh();xk();Tk();$t();(function(){if(qi.random&&qi.random.getBytes){V3.exports=qi.random;return}(function(r){var e={},t=new Array(4),i=qi.util.createBuffer();e.formatKey=function(h){var d=qi.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),qi.aes._expandKey(h,!1)},e.formatSeed=function(h){var d=qi.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),h},e.cipher=function(h,d){return qi.aes._updateBlock(h,d,t,!1),i.putInt32(t[0]),i.putInt32(t[1]),i.putInt32(t[2]),i.putInt32(t[3]),i.getBytes()},e.increment=function(h){return++h[3],h},e.md=qi.md.sha256;function n(){var h=qi.prng.create(e);return h.getBytes=function(d,y){return h.generate(d,y)},h.getBytesSync=function(d){return h.generate(d)},h}var s=n(),o=null,a=qi.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(h){return c.getRandomValues(h)}),qi.options.usePureJavaScript||!qi.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var f="";for(var l in navigator)try{typeof navigator[l]=="string"&&(f+=navigator[l])}catch(h){}s.collect(f),f=null}r&&(r().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),r().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!qi.random)qi.random=s;else for(var l in s)qi.random[l]=s[l];qi.random.createInstance=n,V3.exports=qi.random})(typeof jQuery!="undefined"?jQuery:null)})()});var Ok=p((V_t,Ck)=>{u();var qn=lt();$t();var z3=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Rk=[1,2,3,5],XAe=function(r,e){return r<<e&65535|(r&65535)>>16-e},QAe=function(r,e){return(r&65535)>>e|r<<16-e&65535};Ck.exports=qn.rc2=qn.rc2||{};qn.rc2.expandKey=function(r,e){typeof r=="string"&&(r=qn.util.createBuffer(r)),e=e||128;var t=r,i=r.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),a;for(a=i;a<128;a++)t.putByte(z3[t.at(a-1)+t.at(a-i)&255]);for(t.setAt(128-s,z3[t.at(128-s)&o]),a=127-s;a>=0;a--)t.setAt(a,z3[t.at(a+1)^t.at(a+s)]);return t};var Pk=function(r,e,t){var i=!1,n=null,s=null,o=null,a,c,f,l,h=[];for(r=qn.rc2.expandKey(r,e),f=0;f<64;f++)h.push(r.getInt16Le());t?(a=function(g){for(f=0;f<4;f++)g[f]+=h[l]+(g[(f+3)%4]&g[(f+2)%4])+(~g[(f+3)%4]&g[(f+1)%4]),g[f]=XAe(g[f],Rk[f]),l++},c=function(g){for(f=0;f<4;f++)g[f]+=h[g[(f+3)%4]&63]}):(a=function(g){for(f=3;f>=0;f--)g[f]=QAe(g[f],Rk[f]),g[f]-=h[l]+(g[(f+3)%4]&g[(f+2)%4])+(~g[(f+3)%4]&g[(f+1)%4]),l--},c=function(g){for(f=3;f>=0;f--)g[f]-=h[g[(f+3)%4]&63]});var d=function(g){var m=[];for(f=0;f<4;f++){var E=n.getInt16Le();o!==null&&(t?E^=o.getInt16Le():o.putInt16Le(E)),m.push(E&65535)}l=t?0:63;for(var _=0;_<g.length;_++)for(var T=0;T<g[_][0];T++)g[_][1](m);for(f=0;f<4;f++)o!==null&&(t?o.putInt16Le(m[f]):m[f]^=o.getInt16Le()),s.putInt16Le(m[f])},y=null;return y={start:function(g,m){g&&typeof g=="string"&&(g=qn.util.createBuffer(g)),i=!1,n=qn.util.createBuffer(),s=m||new qn.util.createBuffer,o=g,y.output=s},update:function(g){for(i||n.putBuffer(g);n.length()>=8;)d([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(g){var m=!0;if(t)if(g)m=g(8,n,!t);else{var E=n.length()===8?8:8-n.length();n.fillWithByte(E,E)}if(m&&(i=!0,y.update()),!t&&(m=n.length()===0,m))if(g)m=g(8,s,!t);else{var _=s.length(),T=s.at(_-1);T>_?m=!1:s.truncate(T)}return m}},y};qn.rc2.startEncrypting=function(r,e,t){var i=qn.rc2.createEncryptionCipher(r,128);return i.start(e,t),i};qn.rc2.createEncryptionCipher=function(r,e){return Pk(r,e,!0)};qn.rc2.startDecrypting=function(r,e,t){var i=qn.rc2.createDecryptionCipher(r,128);return i.start(e,t),i};qn.rc2.createDecryptionCipher=function(r,e){return Pk(r,e,!1)}});var uy=p((z_t,Uk)=>{u();var H3=lt();Uk.exports=H3.jsbn=H3.jsbn||{};var ac,JAe=244837814094590,qk=(JAe&16777215)==15715070;function we(r,e,t){this.data=[],r!=null&&(typeof r=="number"?this.fromNumber(r,e,t):e==null&&typeof r!="string"?this.fromString(r,256):this.fromString(r,e))}H3.jsbn.BigInteger=we;function Ot(){return new we(null)}function ZAe(r,e,t,i,n,s){for(;--s>=0;){var o=e*this.data[r++]+t.data[i]+n;n=Math.floor(o/67108864),t.data[i++]=o&67108863}return n}function exe(r,e,t,i,n,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[r]&32767,f=this.data[r++]>>15,l=a*c+f*o;c=o*c+((l&32767)<<15)+t.data[i]+(n&1073741823),n=(c>>>30)+(l>>>15)+a*f+(n>>>30),t.data[i++]=c&1073741823}return n}function kk(r,e,t,i,n,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[r]&16383,f=this.data[r++]>>14,l=a*c+f*o;c=o*c+((l&16383)<<14)+t.data[i]+n,n=(c>>28)+(l>>14)+a*f,t.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(we.prototype.am=kk,ac=28):qk&&navigator.appName=="Microsoft Internet Explorer"?(we.prototype.am=exe,ac=30):qk&&navigator.appName!="Netscape"?(we.prototype.am=ZAe,ac=26):(we.prototype.am=kk,ac=28);we.prototype.DB=ac;we.prototype.DM=(1<<ac)-1;we.prototype.DV=1<<ac;var $3=52;we.prototype.FV=Math.pow(2,$3);we.prototype.F1=$3-ac;we.prototype.F2=2*ac-$3;var txe="0123456789abcdefghijklmnopqrstuvwxyz",g1=new Array,xh,bs;xh="0".charCodeAt(0);for(bs=0;bs<=9;++bs)g1[xh++]=bs;xh="a".charCodeAt(0);for(bs=10;bs<36;++bs)g1[xh++]=bs;xh="A".charCodeAt(0);for(bs=10;bs<36;++bs)g1[xh++]=bs;function Bk(r){return txe.charAt(r)}function Nk(r,e){var t=g1[r.charCodeAt(e)];return t??-1}function rxe(r){for(var e=this.t-1;e>=0;--e)r.data[e]=this.data[e];r.t=this.t,r.s=this.s}function ixe(r){this.t=1,this.s=r<0?-1:0,r>0?this.data[0]=r:r<-1?this.data[0]=r+this.DV:this.t=0}function au(r){var e=Ot();return e.fromInt(r),e}function nxe(r,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(r,e);return}this.t=0,this.s=0;for(var i=r.length,n=!1,s=0;--i>=0;){var o=t==8?r[i]&255:Nk(r,i);if(o<0){r.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+t>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=t,s>=this.DB&&(s-=this.DB)}t==8&&(r[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&we.ZERO.subTo(this,this)}function sxe(){for(var r=this.s&this.DM;this.t>0&&this.data[this.t-1]==r;)--this.t}function oxe(r){if(this.s<0)return"-"+this.negate().toString(r);var e;if(r==16)e=4;else if(r==8)e=3;else if(r==2)e=1;else if(r==32)e=5;else if(r==4)e=2;else return this.toRadix(r);var t=(1<<e)-1,i,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this.data[o]>>a)>0&&(n=!0,s=Bk(i));o>=0;)a<e?(i=(this.data[o]&(1<<a)-1)<<e-a,i|=this.data[--o]>>(a+=this.DB-e)):(i=this.data[o]>>(a-=e)&t,a<=0&&(a+=this.DB,--o)),i>0&&(n=!0),n&&(s+=Bk(i));return n?s:"0"}function axe(){var r=Ot();return we.ZERO.subTo(this,r),r}function cxe(){return this.s<0?this.negate():this}function uxe(r){var e=this.s-r.s;if(e!=0)return e;var t=this.t;if(e=t-r.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this.data[t]-r.data[t])!=0)return e;return 0}function b1(r){var e=1,t;return(t=r>>>16)!=0&&(r=t,e+=16),(t=r>>8)!=0&&(r=t,e+=8),(t=r>>4)!=0&&(r=t,e+=4),(t=r>>2)!=0&&(r=t,e+=2),(t=r>>1)!=0&&(r=t,e+=1),e}function lxe(){return this.t<=0?0:this.DB*(this.t-1)+b1(this.data[this.t-1]^this.s&this.DM)}function fxe(r,e){var t;for(t=this.t-1;t>=0;--t)e.data[t+r]=this.data[t];for(t=r-1;t>=0;--t)e.data[t]=0;e.t=this.t+r,e.s=this.s}function hxe(r,e){for(var t=r;t<this.t;++t)e.data[t-r]=this.data[t];e.t=Math.max(this.t-r,0),e.s=this.s}function dxe(r,e){var t=r%this.DB,i=this.DB-t,n=(1<<i)-1,s=Math.floor(r/this.DB),o=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|o,o=(this.data[a]&n)<<t;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function pxe(r,e){e.s=this.s;var t=Math.floor(r/this.DB);if(t>=this.t){e.t=0;return}var i=r%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[t]>>i;for(var o=t+1;o<this.t;++o)e.data[o-t-1]|=(this.data[o]&s)<<n,e.data[o-t]=this.data[o]>>i;i>0&&(e.data[this.t-t-1]|=(this.s&s)<<n),e.t=this.t-t,e.clamp()}function yxe(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]-r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i-=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i-=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i-=r.s}e.s=i<0?-1:0,i<-1?e.data[t++]=this.DV+i:i>0&&(e.data[t++]=i),e.t=t,e.clamp()}function gxe(r,e){var t=this.abs(),i=r.abs(),n=t.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+t.t]=t.am(0,i.data[n],e,n,0,t.t);e.s=0,e.clamp(),this.s!=r.s&&we.ZERO.subTo(e,e)}function bxe(r){for(var e=this.abs(),t=r.t=2*e.t;--t>=0;)r.data[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e.data[t],r,2*t,0,1);(r.data[t+e.t]+=e.am(t+1,2*e.data[t],r,2*t+1,i,e.t-t-1))>=e.DV&&(r.data[t+e.t]-=e.DV,r.data[t+e.t+1]=1)}r.t>0&&(r.data[r.t-1]+=e.am(t,e.data[t],r,2*t,0,1)),r.s=0,r.clamp()}function mxe(r,e,t){var i=r.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=Ot());var s=Ot(),o=this.s,a=r.s,c=this.DB-b1(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,t)):(i.copyTo(s),n.copyTo(t));var f=s.t,l=s.data[f-1];if(l!=0){var h=l*(1<<this.F1)+(f>1?s.data[f-2]>>this.F2:0),d=this.FV/h,y=(1<<this.F1)/h,g=1<<this.F2,m=t.t,E=m-f,_=e??Ot();for(s.dlShiftTo(E,_),t.compareTo(_)>=0&&(t.data[t.t++]=1,t.subTo(_,t)),we.ONE.dlShiftTo(f,_),_.subTo(s,s);s.t<f;)s.data[s.t++]=0;for(;--E>=0;){var T=t.data[--m]==l?this.DM:Math.floor(t.data[m]*d+(t.data[m-1]+g)*y);if((t.data[m]+=s.am(0,T,t,E,0,f))<T)for(s.dlShiftTo(E,_),t.subTo(_,t);t.data[m]<--T;)t.subTo(_,t)}e!=null&&(t.drShiftTo(f,e),o!=a&&we.ZERO.subTo(e,e)),t.t=f,t.clamp(),c>0&&t.rShiftTo(c,t),o<0&&we.ZERO.subTo(t,t)}}}function vxe(r){var e=Ot();return this.abs().divRemTo(r,null,e),this.s<0&&e.compareTo(we.ZERO)>0&&r.subTo(e,e),e}function Rl(r){this.m=r}function wxe(r){return r.s<0||r.compareTo(this.m)>=0?r.mod(this.m):r}function _xe(r){return r}function Exe(r){r.divRemTo(this.m,null,r)}function Sxe(r,e,t){r.multiplyTo(e,t),this.reduce(t)}function Axe(r,e){r.squareTo(e),this.reduce(e)}Rl.prototype.convert=wxe;Rl.prototype.revert=_xe;Rl.prototype.reduce=Exe;Rl.prototype.mulTo=Sxe;Rl.prototype.sqrTo=Axe;function xxe(){if(this.t<1)return 0;var r=this.data[0];if((r&1)==0)return 0;var e=r&3;return e=e*(2-(r&15)*e)&15,e=e*(2-(r&255)*e)&255,e=e*(2-((r&65535)*e&65535))&65535,e=e*(2-r*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Pl(r){this.m=r,this.mp=r.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<r.DB-15)-1,this.mt2=2*r.t}function Ixe(r){var e=Ot();return r.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),r.s<0&&e.compareTo(we.ZERO)>0&&this.m.subTo(e,e),e}function Txe(r){var e=Ot();return r.copyTo(e),this.reduce(e),e}function Rxe(r){for(;r.t<=this.mt2;)r.data[r.t++]=0;for(var e=0;e<this.m.t;++e){var t=r.data[e]&32767,i=t*this.mpl+((t*this.mph+(r.data[e]>>15)*this.mpl&this.um)<<15)&r.DM;for(t=e+this.m.t,r.data[t]+=this.m.am(0,i,r,e,0,this.m.t);r.data[t]>=r.DV;)r.data[t]-=r.DV,r.data[++t]++}r.clamp(),r.drShiftTo(this.m.t,r),r.compareTo(this.m)>=0&&r.subTo(this.m,r)}function Pxe(r,e){r.squareTo(e),this.reduce(e)}function Cxe(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Pl.prototype.convert=Ixe;Pl.prototype.revert=Txe;Pl.prototype.reduce=Rxe;Pl.prototype.mulTo=Cxe;Pl.prototype.sqrTo=Pxe;function Oxe(){return(this.t>0?this.data[0]&1:this.s)==0}function qxe(r,e){if(r>4294967295||r<1)return we.ONE;var t=Ot(),i=Ot(),n=e.convert(this),s=b1(r)-1;for(n.copyTo(t);--s>=0;)if(e.sqrTo(t,i),(r&1<<s)>0)e.mulTo(i,n,t);else{var o=t;t=i,i=o}return e.revert(t)}function kxe(r,e){var t;return r<256||e.isEven()?t=new Rl(e):t=new Pl(e),this.exp(r,t)}we.prototype.copyTo=rxe;we.prototype.fromInt=ixe;we.prototype.fromString=nxe;we.prototype.clamp=sxe;we.prototype.dlShiftTo=fxe;we.prototype.drShiftTo=hxe;we.prototype.lShiftTo=dxe;we.prototype.rShiftTo=pxe;we.prototype.subTo=yxe;we.prototype.multiplyTo=gxe;we.prototype.squareTo=bxe;we.prototype.divRemTo=mxe;we.prototype.invDigit=xxe;we.prototype.isEven=Oxe;we.prototype.exp=qxe;we.prototype.toString=oxe;we.prototype.negate=axe;we.prototype.abs=cxe;we.prototype.compareTo=uxe;we.prototype.bitLength=lxe;we.prototype.mod=vxe;we.prototype.modPowInt=kxe;we.ZERO=au(0);we.ONE=au(1);function Bxe(){var r=Ot();return this.copyTo(r),r}function Nxe(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Dxe(){return this.t==0?this.s:this.data[0]<<24>>24}function Mxe(){return this.t==0?this.s:this.data[0]<<16>>16}function Lxe(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function Uxe(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Fxe(r){if(r==null&&(r=10),this.signum()==0||r<2||r>36)return"0";var e=this.chunkSize(r),t=Math.pow(r,e),i=au(t),n=Ot(),s=Ot(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(t+s.intValue()).toString(r).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(r)+o}function Kxe(r,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),i=Math.pow(e,t),n=!1,s=0,o=0,a=0;a<r.length;++a){var c=Nk(r,a);if(c<0){r.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+c,++s>=t&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&we.ZERO.subTo(this,this)}function jxe(r,e,t){if(typeof e=="number")if(r<2)this.fromInt(1);else for(this.fromNumber(r,t),this.testBit(r-1)||this.bitwiseTo(we.ONE.shiftLeft(r-1),G3,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>r&&this.subTo(we.ONE.shiftLeft(r-1),this);else{var i=new Array,n=r&7;i.length=(r>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function Vxe(){var r=this.t,e=new Array;e[0]=this.s;var t=this.DB-r*this.DB%8,i,n=0;if(r-- >0)for(t<this.DB&&(i=this.data[r]>>t)!=(this.s&this.DM)>>t&&(e[n++]=i|this.s<<this.DB-t);r>=0;)t<8?(i=(this.data[r]&(1<<t)-1)<<8-t,i|=this.data[--r]>>(t+=this.DB-8)):(i=this.data[r]>>(t-=8)&255,t<=0&&(t+=this.DB,--r)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function zxe(r){return this.compareTo(r)==0}function Hxe(r){return this.compareTo(r)<0?this:r}function $xe(r){return this.compareTo(r)>0?this:r}function Gxe(r,e,t){var i,n,s=Math.min(r.t,this.t);for(i=0;i<s;++i)t.data[i]=e(this.data[i],r.data[i]);if(r.t<this.t){for(n=r.s&this.DM,i=s;i<this.t;++i)t.data[i]=e(this.data[i],n);t.t=this.t}else{for(n=this.s&this.DM,i=s;i<r.t;++i)t.data[i]=e(n,r.data[i]);t.t=r.t}t.s=e(this.s,r.s),t.clamp()}function Wxe(r,e){return r&e}function Yxe(r){var e=Ot();return this.bitwiseTo(r,Wxe,e),e}function G3(r,e){return r|e}function Xxe(r){var e=Ot();return this.bitwiseTo(r,G3,e),e}function Dk(r,e){return r^e}function Qxe(r){var e=Ot();return this.bitwiseTo(r,Dk,e),e}function Mk(r,e){return r&~e}function Jxe(r){var e=Ot();return this.bitwiseTo(r,Mk,e),e}function Zxe(){for(var r=Ot(),e=0;e<this.t;++e)r.data[e]=this.DM&~this.data[e];return r.t=this.t,r.s=~this.s,r}function eIe(r){var e=Ot();return r<0?this.rShiftTo(-r,e):this.lShiftTo(r,e),e}function tIe(r){var e=Ot();return r<0?this.lShiftTo(-r,e):this.rShiftTo(r,e),e}function rIe(r){if(r==0)return-1;var e=0;return(r&65535)==0&&(r>>=16,e+=16),(r&255)==0&&(r>>=8,e+=8),(r&15)==0&&(r>>=4,e+=4),(r&3)==0&&(r>>=2,e+=2),(r&1)==0&&++e,e}function iIe(){for(var r=0;r<this.t;++r)if(this.data[r]!=0)return r*this.DB+rIe(this.data[r]);return this.s<0?this.t*this.DB:-1}function nIe(r){for(var e=0;r!=0;)r&=r-1,++e;return e}function sIe(){for(var r=0,e=this.s&this.DM,t=0;t<this.t;++t)r+=nIe(this.data[t]^e);return r}function oIe(r){var e=Math.floor(r/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<r%this.DB)!=0}function aIe(r,e){var t=we.ONE.shiftLeft(r);return this.bitwiseTo(t,e,t),t}function cIe(r){return this.changeBit(r,G3)}function uIe(r){return this.changeBit(r,Mk)}function lIe(r){return this.changeBit(r,Dk)}function fIe(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]+r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i+=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i+=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=r.s}e.s=i<0?-1:0,i>0?e.data[t++]=i:i<-1&&(e.data[t++]=this.DV+i),e.t=t,e.clamp()}function hIe(r){var e=Ot();return this.addTo(r,e),e}function dIe(r){var e=Ot();return this.subTo(r,e),e}function pIe(r){var e=Ot();return this.multiplyTo(r,e),e}function yIe(r){var e=Ot();return this.divRemTo(r,e,null),e}function gIe(r){var e=Ot();return this.divRemTo(r,null,e),e}function bIe(r){var e=Ot(),t=Ot();return this.divRemTo(r,e,t),new Array(e,t)}function mIe(r){this.data[this.t]=this.am(0,r-1,this,0,0,this.t),++this.t,this.clamp()}function vIe(r,e){if(r!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=r;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function cy(){}function Lk(r){return r}function wIe(r,e,t){r.multiplyTo(e,t)}function _Ie(r,e){r.squareTo(e)}cy.prototype.convert=Lk;cy.prototype.revert=Lk;cy.prototype.mulTo=wIe;cy.prototype.sqrTo=_Ie;function EIe(r){return this.exp(r,new cy)}function SIe(r,e,t){var i=Math.min(this.t+r.t,e);for(t.s=0,t.t=i;i>0;)t.data[--i]=0;var n;for(n=t.t-this.t;i<n;++i)t.data[i+this.t]=this.am(0,r.data[i],t,i,0,this.t);for(n=Math.min(r.t,e);i<n;++i)this.am(0,r.data[i],t,i,0,e-i);t.clamp()}function AIe(r,e,t){--e;var i=t.t=this.t+r.t-e;for(t.s=0;--i>=0;)t.data[i]=0;for(i=Math.max(e-this.t,0);i<r.t;++i)t.data[this.t+i-e]=this.am(e-i,r.data[i],t,0,0,this.t+i-e);t.clamp(),t.drShiftTo(1,t)}function Ih(r){this.r2=Ot(),this.q3=Ot(),we.ONE.dlShiftTo(2*r.t,this.r2),this.mu=this.r2.divide(r),this.m=r}function xIe(r){if(r.s<0||r.t>2*this.m.t)return r.mod(this.m);if(r.compareTo(this.m)<0)return r;var e=Ot();return r.copyTo(e),this.reduce(e),e}function IIe(r){return r}function TIe(r){for(r.drShiftTo(this.m.t-1,this.r2),r.t>this.m.t+1&&(r.t=this.m.t+1,r.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);r.compareTo(this.r2)<0;)r.dAddOffset(1,this.m.t+1);for(r.subTo(this.r2,r);r.compareTo(this.m)>=0;)r.subTo(this.m,r)}function RIe(r,e){r.squareTo(e),this.reduce(e)}function PIe(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Ih.prototype.convert=xIe;Ih.prototype.revert=IIe;Ih.prototype.reduce=TIe;Ih.prototype.mulTo=PIe;Ih.prototype.sqrTo=RIe;function CIe(r,e){var t=r.bitLength(),i,n=au(1),s;if(t<=0)return n;t<18?i=1:t<48?i=3:t<144?i=4:t<768?i=5:i=6,t<8?s=new Rl(e):e.isEven()?s=new Ih(e):s=new Pl(e);var o=new Array,a=3,c=i-1,f=(1<<i)-1;if(o[1]=s.convert(this),i>1){var l=Ot();for(s.sqrTo(o[1],l);a<=f;)o[a]=Ot(),s.mulTo(l,o[a-2],o[a]),a+=2}var h=r.t-1,d,y=!0,g=Ot(),m;for(t=b1(r.data[h])-1;h>=0;){for(t>=c?d=r.data[h]>>t-c&f:(d=(r.data[h]&(1<<t+1)-1)<<c-t,h>0&&(d|=r.data[h-1]>>this.DB+t-c)),a=i;(d&1)==0;)d>>=1,--a;if((t-=a)<0&&(t+=this.DB,--h),y)o[d].copyTo(n),y=!1;else{for(;a>1;)s.sqrTo(n,g),s.sqrTo(g,n),a-=2;a>0?s.sqrTo(n,g):(m=n,n=g,g=m),s.mulTo(g,o[d],n)}for(;h>=0&&(r.data[h]&1<<t)==0;)s.sqrTo(n,g),m=n,n=g,g=m,--t<0&&(t=this.DB-1,--h)}return s.revert(n)}function OIe(r){var e=this.s<0?this.negate():this.clone(),t=r.s<0?r.negate():r.clone();if(e.compareTo(t)<0){var i=e;e=t,t=i}var n=e.getLowestSetBit(),s=t.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),t.rShiftTo(s,t));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return s>0&&t.lShiftTo(s,t),t}function qIe(r){if(r<=0)return 0;var e=this.DV%r,t=this.s<0?r-1:0;if(this.t>0)if(e==0)t=this.data[0]%r;else for(var i=this.t-1;i>=0;--i)t=(e*t+this.data[i])%r;return t}function kIe(r){var e=r.isEven();if(this.isEven()&&e||r.signum()==0)return we.ZERO;for(var t=r.clone(),i=this.clone(),n=au(1),s=au(0),o=au(0),a=au(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(r,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(r,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(r,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(r,a),a.rShiftTo(1,a);t.compareTo(i)>=0?(t.subTo(i,t),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(t,i),e&&o.subTo(n,o),a.subTo(s,a))}if(i.compareTo(we.ONE)!=0)return we.ZERO;if(a.compareTo(r)>=0)return a.subtract(r);if(a.signum()<0)a.addTo(r,a);else return a;return a.signum()<0?a.add(r):a}var io=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],BIe=(1<<26)/io[io.length-1];function NIe(r){var e,t=this.abs();if(t.t==1&&t.data[0]<=io[io.length-1]){for(e=0;e<io.length;++e)if(t.data[0]==io[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<io.length;){for(var i=io[e],n=e+1;n<io.length&&i<BIe;)i*=io[n++];for(i=t.modInt(i);e<n;)if(i%io[e++]==0)return!1}return t.millerRabin(r)}function DIe(r){var e=this.subtract(we.ONE),t=e.getLowestSetBit();if(t<=0)return!1;for(var i=e.shiftRight(t),n=MIe(),s,o=0;o<r;++o){do s=new we(this.bitLength(),n);while(s.compareTo(we.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(we.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<t&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(we.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function MIe(){return{nextBytes:function(r){for(var e=0;e<r.length;++e)r[e]=Math.floor(Math.random()*256)}}}we.prototype.chunkSize=Lxe;we.prototype.toRadix=Fxe;we.prototype.fromRadix=Kxe;we.prototype.fromNumber=jxe;we.prototype.bitwiseTo=Gxe;we.prototype.changeBit=aIe;we.prototype.addTo=fIe;we.prototype.dMultiply=mIe;we.prototype.dAddOffset=vIe;we.prototype.multiplyLowerTo=SIe;we.prototype.multiplyUpperTo=AIe;we.prototype.modInt=qIe;we.prototype.millerRabin=DIe;we.prototype.clone=Bxe;we.prototype.intValue=Nxe;we.prototype.byteValue=Dxe;we.prototype.shortValue=Mxe;we.prototype.signum=Uxe;we.prototype.toByteArray=Vxe;we.prototype.equals=zxe;we.prototype.min=Hxe;we.prototype.max=$xe;we.prototype.and=Yxe;we.prototype.or=Xxe;we.prototype.xor=Qxe;we.prototype.andNot=Jxe;we.prototype.not=Zxe;we.prototype.shiftLeft=eIe;we.prototype.shiftRight=tIe;we.prototype.getLowestSetBit=iIe;we.prototype.bitCount=sIe;we.prototype.testBit=oIe;we.prototype.setBit=cIe;we.prototype.clearBit=uIe;we.prototype.flipBit=lIe;we.prototype.add=hIe;we.prototype.subtract=dIe;we.prototype.multiply=pIe;we.prototype.divide=yIe;we.prototype.remainder=gIe;we.prototype.divideAndRemainder=bIe;we.prototype.modPow=CIe;we.prototype.modInverse=kIe;we.prototype.pow=EIe;we.prototype.gcd=OIe;we.prototype.isProbablePrime=NIe});var zk=p((H_t,Vk)=>{u();var na=lt();su();$t();var Fk=Vk.exports=na.sha1=na.sha1||{};na.md.sha1=na.md.algorithms.sha1=Fk;Fk.create=function(){Kk||LIe();var r=null,e=na.util.createBuffer(),t=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=na.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=na.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),jk(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=na.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(W3.substr(0,i.blockLength-o));for(var a,c,f=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,f+=c,n.putInt32(f>>>0),f=a>>>0;n.putInt32(f);var h={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4};jk(h,t,n);var d=na.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d},i};var W3=null,Kk=!1;function LIe(){W3=String.fromCharCode(128),W3+=na.util.fillString(String.fromCharCode(0),64),Kk=!0}function jk(r,e,t){for(var i,n,s,o,a,c,f,l,h=t.length();h>=64;){for(n=r.h0,s=r.h1,o=r.h2,a=r.h3,c=r.h4,l=0;l<16;++l)i=t.getInt32(),e[l]=i,f=a^s&(o^a),i=(n<<5|n>>>27)+f+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<20;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,f=a^s&(o^a),i=(n<<5|n>>>27)+f+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<32;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,f=s^o^a,i=(n<<5|n>>>27)+f+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<40;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,f=s^o^a,i=(n<<5|n>>>27)+f+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<60;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,f=s&o|a&(s^o),i=(n<<5|n>>>27)+f+c+2400959708+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<80;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,f=s^o^a,i=(n<<5|n>>>27)+f+c+3395469782+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;r.h0=r.h0+n|0,r.h1=r.h1+s|0,r.h2=r.h2+o|0,r.h3=r.h3+a|0,r.h4=r.h4+c|0,h-=64}}});var Gk=p(($_t,$k)=>{u();var sa=lt();$t();ou();zk();var Hk=$k.exports=sa.pkcs1=sa.pkcs1||{};Hk.encode_rsa_oaep=function(r,e,t){var i,n,s,o;typeof t=="string"?(i=t,n=arguments[3]||void 0,s=arguments[4]||void 0):t&&(i=t.label||void 0,n=t.seed||void 0,s=t.md||void 0,t.mgf1&&t.mgf1.md&&(o=t.mgf1.md)),s?s.start():s=sa.md.sha1.create(),o||(o=s);var a=Math.ceil(r.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=e.length,f.maxLength=c,f}i||(i=""),s.update(i,"raw");for(var l=s.digest(),h="",d=c-e.length,y=0;y<d;y++)h+="\0";var g=l.getBytes()+h+""+e;if(!n)n=sa.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=n.length,f.digestLength=s.digestLength,f}var m=m1(n,a-s.digestLength-1,o),E=sa.util.xorBytes(g,m,g.length),_=m1(E,s.digestLength,o),T=sa.util.xorBytes(n,_,n.length);return"\0"+T+E};Hk.decode_rsa_oaep=function(r,e,t){var i,n,s;typeof t=="string"?(i=t,n=arguments[3]||void 0):t&&(i=t.label||void 0,n=t.md||void 0,t.mgf1&&t.mgf1.md&&(s=t.mgf1.md));var o=Math.ceil(r.n.bitLength()/8);if(e.length!==o){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=e.length,E.expectedLength=o,E}if(n===void 0?n=sa.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),c=e.charAt(0),f=e.substring(1,n.digestLength+1),l=e.substring(1+n.digestLength),h=m1(l,n.digestLength,s),d=sa.util.xorBytes(f,h,f.length),y=m1(d,o-n.digestLength-1,s),g=sa.util.xorBytes(l,y,l.length),m=g.substring(0,n.digestLength),E=c!=="\0",_=0;_<n.digestLength;++_)E|=a.charAt(_)!==m.charAt(_);for(var T=1,q=n.digestLength,z=n.digestLength;z<g.length;z++){var V=g.charCodeAt(z),M=V&1^1,$=T?65534:0;E|=V&$,T=T&M,q+=T}if(E||g.charCodeAt(q)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(q+1)};function m1(r,e,t){t||(t=sa.md.sha1.create());for(var i="",n=Math.ceil(e/t.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);t.start(),t.update(r+o),i+=t.digest().getBytes()}return i.substring(0,e)}});var Wk=p((G_t,Y3)=>{u();var cu=lt();$t();uy();ou();(function(){if(cu.prime){Y3.exports=cu.prime;return}var r=Y3.exports=cu.prime=cu.prime||{},e=cu.jsbn.BigInteger,t=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(h,d){return h|d};r.generateProbablePrime=function(h,d,y){typeof d=="function"&&(y=d,d={}),d=d||{};var g=d.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var m=d.prng||cu.random,E={nextBytes:function(_){for(var T=m.getBytesSync(_.length),q=0;q<_.length;++q)_[q]=T.charCodeAt(q)}};if(g.name==="PRIMEINC")return s(h,E,g.options,y);throw new Error("Invalid prime generation algorithm: "+g.name)};function s(h,d,y,g){return"workers"in y?c(h,d,y,g):o(h,d,y,g)}function o(h,d,y,g){var m=f(h,d),E=0,_=l(m.bitLength());"millerRabinTests"in y&&(_=y.millerRabinTests);var T=10;"maxBlockTime"in y&&(T=y.maxBlockTime),a(m,h,d,E,_,T,g)}function a(h,d,y,g,m,E,_){var T=+new Date;do{if(h.bitLength()>d&&(h=f(d,y)),h.isProbablePrime(m))return _(null,h);h.dAddOffset(t[g++%8],0)}while(E<0||+new Date-T<E);cu.util.setImmediate(function(){a(h,d,y,g,m,E,_)})}function c(h,d,y,g){if(typeof Worker=="undefined")return o(h,d,y,g);var m=f(h,d),E=y.workers,_=y.workLoad||100,T=_*30/8,q=y.workerScript||"forge/prime.worker.js";if(E===-1)return cu.util.estimateCores(function(V,M){V&&(M=2),E=M-1,z()});z();function z(){E=Math.max(1,E);for(var V=[],M=0;M<E;++M)V[M]=new Worker(q);for(var $=E,M=0;M<E;++M)V[M].addEventListener("message",Q);var X=!1;function Q(O){if(!X){--$;var b=O.data;if(b.found){for(var w=0;w<V.length;++w)V[w].terminate();return X=!0,g(null,new e(b.prime,16))}m.bitLength()>h&&(m=f(h,d));var S=m.toString(16);O.target.postMessage({hex:S,workLoad:_}),m.dAddOffset(T,0)}}}}function f(h,d){var y=new e(h,d),g=h-1;return y.testBit(g)||y.bitwiseTo(e.ONE.shiftLeft(g),n,y),y.dAddOffset(31-y.mod(i).byteValue(),0),y}function l(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var ly=p((W_t,tB)=>{u();var ot=lt();nc();uy();wh();Gk();Wk();ou();$t();typeof Tt=="undefined"&&(Tt=ot.jsbn.BigInteger);var Tt,X3=ot.util.isNodejs?Ah():null,se=ot.asn1,ms=ot.util;ot.pki=ot.pki||{};tB.exports=ot.pki.rsa=ot.rsa=ot.rsa||{};var at=ot.pki,UIe=[6,4,2,4,2,4,6,2],FIe={name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},KIe={name:"RSAPrivateKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},jIe={name:"RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},VIe=ot.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},zIe=function(r){var e;if(r.algorithm in at.oids)e=at.oids[r.algorithm];else{var t=new Error("Unknown message digest algorithm.");throw t.algorithm=r.algorithm,t}var i=se.oidToDer(e).getBytes(),n=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]),s=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]);s.value.push(se.create(se.Class.UNIVERSAL,se.Type.OID,!1,i)),s.value.push(se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,""));var o=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,r.digest().getBytes());return n.value.push(s),n.value.push(o),se.toDer(n).getBytes()},Yk=function(r,e,t){if(t)return r.modPow(e.e,e.n);if(!e.p||!e.q)return r.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Tt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Tt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new Tt(ot.util.bytesToHex(ot.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(Tt.ONE));r=r.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=r.mod(e.p).modPow(e.dP,e.p),s=r.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};at.rsa.encrypt=function(r,e,t){var i=t,n,s=Math.ceil(e.n.bitLength()/8);t!==!1&&t!==!0?(i=t===2,n=Xk(r,e,t)):(n=ot.util.createBuffer(),n.putBytes(r));for(var o=new Tt(n.toHex(),16),a=Yk(o,e,i),c=a.toString(16),f=ot.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)f.putByte(0),--l;return f.putBytes(ot.util.hexToBytes(c)),f.getBytes()};at.rsa.decrypt=function(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8);if(r.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=r.length,s.expected=n,s}var o=new Tt(ot.util.createBuffer(r).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Yk(o,e,t),c=a.toString(16),f=ot.util.createBuffer(),l=n-Math.ceil(c.length/2);l>0;)f.putByte(0),--l;return f.putBytes(ot.util.hexToBytes(c)),i!==!1?v1(f.getBytes(),e,t):f.getBytes()};at.rsa.createKeyPairGenerationState=function(r,e,t){typeof r=="string"&&(r=parseInt(r,10)),r=r||2048,t=t||{};var i=t.prng||ot.random,n={nextBytes:function(a){for(var c=i.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=c.charCodeAt(f)}},s=t.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:r,rng:n,eInt:e||65537,e:new Tt(null),p:null,q:null,qBits:r>>1,pBits:r-(r>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};at.rsa.stepKeyPairGenerationState=function(r,e){"algorithm"in r||(r.algorithm="PRIMEINC");var t=new Tt(null);t.fromInt(30);for(var i=0,n=function(h,d){return h|d},s=+new Date,o,a=0;r.keys===null&&(e<=0||a<e);){if(r.state===0){var c=r.p===null?r.pBits:r.qBits,f=c-1;r.pqState===0?(r.num=new Tt(c,r.rng),r.num.testBit(f)||r.num.bitwiseTo(Tt.ONE.shiftLeft(f),n,r.num),r.num.dAddOffset(31-r.num.mod(t).byteValue(),0),i=0,++r.pqState):r.pqState===1?r.num.bitLength()>c?r.pqState=0:r.num.isProbablePrime($Ie(r.num.bitLength()))?++r.pqState:r.num.dAddOffset(UIe[i++%8],0):r.pqState===2?r.pqState=r.num.subtract(Tt.ONE).gcd(r.e).compareTo(Tt.ONE)===0?3:0:r.pqState===3&&(r.pqState=0,r.p===null?r.p=r.num:r.q=r.num,r.p!==null&&r.q!==null&&++r.state,r.num=null)}else if(r.state===1)r.p.compareTo(r.q)<0&&(r.num=r.p,r.p=r.q,r.q=r.num),++r.state;else if(r.state===2)r.p1=r.p.subtract(Tt.ONE),r.q1=r.q.subtract(Tt.ONE),r.phi=r.p1.multiply(r.q1),++r.state;else if(r.state===3)r.phi.gcd(r.e).compareTo(Tt.ONE)===0?++r.state:(r.p=null,r.q=null,r.state=0);else if(r.state===4)r.n=r.p.multiply(r.q),r.n.bitLength()===r.bits?++r.state:(r.q=null,r.state=0);else if(r.state===5){var l=r.e.modInverse(r.phi);r.keys={privateKey:at.rsa.setPrivateKey(r.n,r.e,l,r.p,r.q,l.mod(r.p1),l.mod(r.q1),r.q.modInverse(r.p)),publicKey:at.rsa.setPublicKey(r.n,r.e)}}o=+new Date,a+=o-s,s=o}return r.keys!==null};at.rsa.generateKeyPair=function(r,e,t,i){if(arguments.length===1?typeof r=="object"?(t=r,r=void 0):typeof r=="function"&&(i=r,r=void 0):arguments.length===2?typeof r=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(t=e,e=void 0):(t=r,i=e,r=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof t=="function"&&(i=t,t=void 0):(i=t,t=e,e=void 0)),t=t||{},r===void 0&&(r=t.bits||2048),e===void 0&&(e=t.e||65537),!ot.options.usePureJavaScript&&!t.prng&&r>=256&&r<=16384&&(e===65537||e===3)){if(i){if(Qk("generateKeyPair"))return X3.generateKeyPair("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,f){if(a)return i(a);i(null,{privateKey:at.privateKeyFromPem(f),publicKey:at.publicKeyFromPem(c)})});if(Jk("generateKey")&&Jk("exportKey"))return ms.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:eB(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return ms.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var c=at.privateKeyFromAsn1(se.fromDer(ot.util.createBuffer(a)));i(null,{privateKey:c,publicKey:at.setRsaPublicKey(c.n,c.e)})}});if(Zk("generateKey")&&Zk("exportKey")){var n=ms.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:eB(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var c=a.target.result,f=ms.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(l){var h=l.target.result,d=at.privateKeyFromAsn1(se.fromDer(ot.util.createBuffer(h)));i(null,{privateKey:d,publicKey:at.setRsaPublicKey(d.n,d.e)})},f.onerror=function(l){i(l)}},n.onerror=function(a){i(a)};return}}else if(Qk("generateKeyPairSync")){var s=X3.generateKeyPairSync("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:at.privateKeyFromPem(s.privateKey),publicKey:at.publicKeyFromPem(s.publicKey)}}}var o=at.rsa.createKeyPairGenerationState(r,e,t);if(!i)return at.rsa.stepKeyPairGenerationState(o,0),o.keys;HIe(o,t,i)};at.setRsaPublicKey=at.rsa.setPublicKey=function(r,e){var t={n:r,e};return t.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,c,f){return Xk(a,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,c){return ot.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,t,!0);return at.rsa.encrypt(o,t,!0)},t.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=v1(c,t,!0);var f=se.fromDer(c);return a===f.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=v1(c,t,!0),a===c}});var o=at.rsa.decrypt(n,t,!0,!1);return s.verify(i,o,t.n.bitLength())},t};at.setRsaPrivateKey=at.rsa.setPrivateKey=function(r,e,t,i,n,s,o,a){var c={n:r,e,d:t,p:i,q:n,dP:s,dQ:o,qInv:a};return c.decrypt=function(f,l,h){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var d=at.rsa.decrypt(f,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:v1};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(y,g){return ot.pkcs1.decode_rsa_oaep(g,y,h)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(y){return y}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(d,c,!1)},c.sign=function(f,l){var h=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:zIe},h=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return f}},h=1);var d=l.encode(f,c.n.bitLength());return at.rsa.encrypt(d,c,h)},c};at.wrapRsaPrivateKey=function(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(at.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,se.toDer(r).getBytes())])};at.privateKeyFromAsn1=function(r){var e={},t=[];if(se.validate(r,FIe,e,t)&&(r=se.fromDer(ot.util.createBuffer(e.privateKey))),e={},t=[],!se.validate(r,KIe,e,t)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=t,i}var n,s,o,a,c,f,l,h;return n=ot.util.createBuffer(e.privateKeyModulus).toHex(),s=ot.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=ot.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=ot.util.createBuffer(e.privateKeyPrime1).toHex(),c=ot.util.createBuffer(e.privateKeyPrime2).toHex(),f=ot.util.createBuffer(e.privateKeyExponent1).toHex(),l=ot.util.createBuffer(e.privateKeyExponent2).toHex(),h=ot.util.createBuffer(e.privateKeyCoefficient).toHex(),at.setRsaPrivateKey(new Tt(n,16),new Tt(s,16),new Tt(o,16),new Tt(a,16),new Tt(c,16),new Tt(f,16),new Tt(l,16),new Tt(h,16))};at.privateKeyToAsn1=at.privateKeyToRSAPrivateKey=function(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.e)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.d)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.p)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.q)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.dP)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.dQ)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.qInv))])};at.publicKeyFromAsn1=function(r){var e={},t=[];if(se.validate(r,VIe,e,t)){var i=se.derToOid(e.publicKeyOid);if(i!==at.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}r=e.rsaPublicKey}if(t=[],!se.validate(r,jIe,e,t)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=t,n}var s=ot.util.createBuffer(e.publicKeyModulus).toHex(),o=ot.util.createBuffer(e.publicKeyExponent).toHex();return at.setRsaPublicKey(new Tt(s,16),new Tt(o,16))};at.publicKeyToAsn1=at.publicKeyToSubjectPublicKeyInfo=function(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(at.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.BITSTRING,!1,[at.publicKeyToRSAPublicKey(r)])])};at.publicKeyToRSAPublicKey=function(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,oa(r.e))])};function Xk(r,e,t){var i=ot.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(r.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=r.length,s.max=n-11,s}i.putByte(0),i.putByte(t);var o=n-3-r.length,a;if(t===0||t===1){a=t===0?0:255;for(var c=0;c<o;++c)i.putByte(a)}else for(;o>0;){for(var f=0,l=ot.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++f:i.putByte(a);o=f}return i.putByte(0),i.putBytes(r),i}function v1(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8),s=ot.util.createBuffer(r),o=s.getByte(),a=s.getByte();if(o!==0||t&&a!==0&&a!==1||!t&&a!=2||t&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=n-3-i;for(var f=0;f<c;++f)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function HIe(r,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(r.pBits,function(a,c){if(a)return t(a);if(r.p=c,r.q!==null)return o(a,r.q);s(r.qBits,o)})}function s(a,c){ot.prime.generateProbablePrime(a,i,c)}function o(a,c){if(a)return t(a);if(r.q=c,r.p.compareTo(r.q)<0){var f=r.p;r.p=r.q,r.q=f}if(r.p.subtract(Tt.ONE).gcd(r.e).compareTo(Tt.ONE)!==0){r.p=null,n();return}if(r.q.subtract(Tt.ONE).gcd(r.e).compareTo(Tt.ONE)!==0){r.q=null,s(r.qBits,o);return}if(r.p1=r.p.subtract(Tt.ONE),r.q1=r.q.subtract(Tt.ONE),r.phi=r.p1.multiply(r.q1),r.phi.gcd(r.e).compareTo(Tt.ONE)!==0){r.p=r.q=null,n();return}if(r.n=r.p.multiply(r.q),r.n.bitLength()!==r.bits){r.q=null,s(r.qBits,o);return}var l=r.e.modInverse(r.phi);r.keys={privateKey:at.rsa.setPrivateKey(r.n,r.e,l,r.p,r.q,l.mod(r.p1),l.mod(r.q1),r.q.modInverse(r.p)),publicKey:at.rsa.setPublicKey(r.n,r.e)},t(null,r.keys)}}function oa(r){var e=r.toString(16);e[0]>="8"&&(e="00"+e);var t=ot.util.hexToBytes(e);return t.length>1&&(t.charCodeAt(0)===0&&(t.charCodeAt(1)&128)==0||t.charCodeAt(0)===255&&(t.charCodeAt(1)&128)==128)?t.substr(1):t}function $Ie(r){return r<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2}function Qk(r){return ot.util.isNodejs&&typeof X3[r]=="function"}function Jk(r){return typeof ms.globalScope!="undefined"&&typeof ms.globalScope.crypto=="object"&&typeof ms.globalScope.crypto.subtle=="object"&&typeof ms.globalScope.crypto.subtle[r]=="function"}function Zk(r){return typeof ms.globalScope!="undefined"&&typeof ms.globalScope.msCrypto=="object"&&typeof ms.globalScope.msCrypto.subtle=="object"&&typeof ms.globalScope.msCrypto.subtle[r]=="function"}function eB(r){for(var e=ot.util.hexToBytes(r.toString(16)),t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=e.charCodeAt(i);return t}});var Q3=p((Y_t,oB)=>{u();var Le=lt();Sh();nc();l1();su();wh();K3();p1();ou();Ok();ly();$t();typeof rB=="undefined"&&(rB=Le.jsbn.BigInteger);var rB,fe=Le.asn1,ut=Le.pki=Le.pki||{};oB.exports=ut.pbe=Le.pbe=Le.pbe||{};var Cl=ut.oids,GIe={name:"EncryptedPrivateKeyInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},WIe={name:"PBES2Algorithms",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},YIe={name:"pkcs-12PbeParams",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"iterations"}]};ut.encryptPrivateKeyInfo=function(r,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var i=Le.random.getBytesSync(t.saltSize),n=t.count,s=fe.integerToDer(n),o,a,c;if(t.algorithm.indexOf("aes")===0||t.algorithm==="des"){var f,l,h;switch(t.algorithm){case"aes128":o=16,f=16,l=Cl["aes128-CBC"],h=Le.aes.createEncryptionCipher;break;case"aes192":o=24,f=16,l=Cl["aes192-CBC"],h=Le.aes.createEncryptionCipher;break;case"aes256":o=32,f=16,l=Cl["aes256-CBC"],h=Le.aes.createEncryptionCipher;break;case"des":o=8,f=8,l=Cl.desCBC,h=Le.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=t.algorithm,d}var y="hmacWith"+t.prfAlgorithm.toUpperCase(),g=sB(y),m=Le.pkcs5.pbkdf2(e,i,n,o,g),E=Le.random.getBytesSync(f),_=h(m);_.start(E),_.update(fe.toDer(r)),_.finish(),c=_.output.getBytes();var T=XIe(i,s,o,y);a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Cl.pkcs5PBES2).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Cl.pkcs5PBKDF2).getBytes()),T]),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(l).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,E)])])])}else if(t.algorithm==="3des"){o=24;var q=new Le.util.ByteBuffer(i),m=ut.pbe.generatePkcs12Key(e,q,1,n,o),E=ut.pbe.generatePkcs12Key(e,q,2,n,o),_=Le.des.createEncryptionCipher(m);_.start(E),_.update(fe.toDer(r)),_.finish(),c=_.output.getBytes(),a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Cl["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,i),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,s.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=t.algorithm,d}var z=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[a,fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,c)]);return z};ut.decryptPrivateKeyInfo=function(r,e){var t=null,i={},n=[];if(!fe.validate(r,GIe,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=fe.derToOid(i.encryptionOid),a=ut.pbe.getCipher(o,i.encryptionParams,e),c=Le.util.createBuffer(i.encryptedData);return a.update(c),a.finish()&&(t=fe.fromDer(a.output)),t};ut.encryptedPrivateKeyToPem=function(r,e){var t={type:"ENCRYPTED PRIVATE KEY",body:fe.toDer(r).getBytes()};return Le.pem.encode(t,{maxline:e})};ut.encryptedPrivateKeyFromPem=function(r){var e=Le.pem.decode(r)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var t=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return fe.fromDer(e.body)};ut.encryptRsaPrivateKey=function(r,e,t){if(t=t||{},!t.legacy){var i=ut.wrapRsaPrivateKey(ut.privateKeyToAsn1(r));return i=ut.encryptPrivateKeyInfo(i,e,t),ut.encryptedPrivateKeyToPem(i)}var n,s,o,a;switch(t.algorithm){case"aes128":n="AES-128-CBC",o=16,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=Le.random.getBytesSync(8),a=Le.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=Le.random.getBytesSync(8),a=Le.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+t.algorithm+'".');throw c.algorithm=t.algorithm,c}var f=Le.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(f);l.start(s),l.update(fe.toDer(ut.privateKeyToAsn1(r))),l.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:Le.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return Le.pem.encode(h)};ut.decryptRsaPrivateKey=function(r,e){var t=null,i=Le.pem.decode(r)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=Le.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=Le.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=Le.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=Le.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=Le.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return Le.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return Le.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return Le.rc2.createDecryptionCipher(h,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=Le.util.hexToBytes(i.dekInfo.parameters),c=Le.pbe.opensslDeriveBytes(e,a.substr(0,8),s),f=o(c);if(f.start(a),f.update(Le.util.createBuffer(i.body)),f.finish())t=f.output.getBytes();else return t}else t=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?t=ut.decryptPrivateKeyInfo(fe.fromDer(t),e):t=fe.fromDer(t),t!==null&&(t=ut.privateKeyFromAsn1(t)),t};ut.pbe.generatePkcs12Key=function(r,e,t,i,n,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in Le.md))throw new Error('"sha1" hash algorithm unavailable.');s=Le.md.sha1.create()}var c=s.digestLength,f=s.blockLength,l=new Le.util.ByteBuffer,h=new Le.util.ByteBuffer;if(r!=null){for(a=0;a<r.length;a++)h.putInt16(r.charCodeAt(a));h.putInt16(0)}var d=h.length(),y=e.length(),g=new Le.util.ByteBuffer;g.fillWithByte(t,f);var m=f*Math.ceil(y/f),E=new Le.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(e.at(a%y));var _=f*Math.ceil(d/f),T=new Le.util.ByteBuffer;for(a=0;a<_;a++)T.putByte(h.at(a%d));var q=E;q.putBuffer(T);for(var z=Math.ceil(n/c),V=1;V<=z;V++){var M=new Le.util.ByteBuffer;M.putBytes(g.bytes()),M.putBytes(q.bytes());for(var $=0;$<i;$++)s.start(),s.update(M.getBytes()),M=s.digest();var X=new Le.util.ByteBuffer;for(a=0;a<f;a++)X.putByte(M.at(a%c));var Q=Math.ceil(y/f)+Math.ceil(d/f),O=new Le.util.ByteBuffer;for(o=0;o<Q;o++){var b=new Le.util.ByteBuffer(q.getBytes(f)),w=511;for(a=X.length()-1;a>=0;a--)w=w>>8,w+=X.at(a)+b.at(a),b.setAt(a,w&255);O.putBuffer(b)}q=O,l.putBuffer(M)}return l.truncate(l.length()-n),l};ut.pbe.getCipher=function(r,e,t){switch(r){case ut.oids.pkcs5PBES2:return ut.pbe.getCipherForPBES2(r,e,t);case ut.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ut.oids["pbewithSHAAnd40BitRC2-CBC"]:return ut.pbe.getCipherForPKCS12PBE(r,e,t);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=r,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};ut.pbe.getCipherForPBES2=function(r,e,t){var i={},n=[];if(!fe.validate(e,WIe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(r=fe.derToOid(i.kdfOid),r!==ut.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=r,s.supportedOids=["pkcs5PBKDF2"],s}if(r=fe.derToOid(i.encOid),r!==ut.oids["aes128-CBC"]&&r!==ut.oids["aes192-CBC"]&&r!==ut.oids["aes256-CBC"]&&r!==ut.oids["des-EDE3-CBC"]&&r!==ut.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=r,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,a=Le.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var c,f;switch(ut.oids[r]){case"aes128-CBC":c=16,f=Le.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=Le.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=Le.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=Le.des.createDecryptionCipher;break;case"desCBC":c=8,f=Le.des.createDecryptionCipher;break}var l=nB(i.prfOid),h=Le.pkcs5.pbkdf2(t,o,a,c,l),d=i.encIv,y=f(h);return y.start(d),y};ut.pbe.getCipherForPKCS12PBE=function(r,e,t){var i={},n=[];if(!fe.validate(e,YIe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=Le.util.createBuffer(i.salt),a=Le.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var c,f,l;switch(r){case ut.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,l=Le.des.startDecrypting;break;case ut.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,l=function(m,E){var _=Le.rc2.createDecryptionCipher(m,40);return _.start(E,null),_};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=r,s}var h=nB(i.prfOid),d=ut.pbe.generatePkcs12Key(t,o,1,a,c,h);h.start();var y=ut.pbe.generatePkcs12Key(t,o,2,a,f,h);return l(d,y)};ut.pbe.opensslDeriveBytes=function(r,e,t,i){if(typeof i=="undefined"||i===null){if(!("md5"in Le.md))throw new Error('"md5" hash algorithm unavailable.');i=Le.md.md5.create()}e===null&&(e="");for(var n=[iB(i,r+e)],s=16,o=1;s<t;++o,s+=16)n.push(iB(i,n[o-1]+r+e));return n.join("").substr(0,t)};function iB(r,e){return r.start().update(e).digest().getBytes()}function nB(r){var e;if(!r)e="hmacWithSHA1";else if(e=ut.oids[fe.derToOid(r)],!e){var t=new Error("Unsupported PRF OID.");throw t.oid=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}return sB(e)}function sB(r){var e=Le.md;switch(r){case"hmacWithSHA224":e=Le.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":r=r.substr(8).toLowerCase();break;default:var t=new Error("Unsupported PRF algorithm.");throw t.algorithm=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}if(!e||!(r in e))throw new Error("Unknown hash algorithm: "+r);return e[r].create()}function XIe(r,e,t,i){var n=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,r),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,Le.util.hexToBytes(t.toString(16))),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(ut.oids[i]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.NULL,!1,"")])),n}});var ue=p((X_t,cB)=>{u();"use strict";function aB(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function QIe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return aB(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),aB(new n,t)}}cB.exports=QIe});var J3={};Ht(J3,{identity:()=>JIe});var JIe,uB=Ge(()=>{u();Xo();Jc();JIe=$m({prefix:"\0",name:"identity",encode:r=>h3(r),decode:r=>f3(r)})});var Z3={};Ht(Z3,{base2:()=>ZIe});var ZIe,lB=Ge(()=>{u();Xo();ZIe=jr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var e6={};Ht(e6,{base8:()=>e4e});var e4e,fB=Ge(()=>{u();Xo();e4e=jr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var t6={};Ht(t6,{base10:()=>t4e});var t4e,hB=Ge(()=>{u();Xo();t4e=Zc({prefix:"9",name:"base10",alphabet:"0123456789"})});var fy={};Ht(fy,{Hasher:()=>r6,from:()=>Th});var Th,r6,w1=Ge(()=>{u();mn();Th=({name:r,code:e,encode:t})=>new r6(r,e,t),r6=class{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}async digest(e){if(e instanceof Uint8Array){let t=await this.encode(e);return Z0(this.code,t)}else throw Error("Unknown type, must be binary type")}}});var Ir={};Ht(Ir,{sha256:()=>r4e,sha512:()=>i4e});var dB,r4e,i4e,Hr=Ge(()=>{u();w1();dB=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),r4e=Th({name:"sha2-256",code:18,encode:dB("SHA-256")}),i4e=Th({name:"sha2-512",code:19,encode:dB("SHA-512")})});var aa={};Ht(aa,{identity:()=>n4e});var n4e,cc=Ge(()=>{u();w1();Jc();n4e=Th({name:"identity",code:0,encode:r=>eo(r)})});var kn={};Ht(kn,{code:()=>o4e,decode:()=>c4e,encode:()=>a4e,name:()=>s4e});var pB,s4e,o4e,a4e,c4e,Xn=Ge(()=>{u();Jc();pB=r=>eo(r),{name:s4e,code:o4e,encode:a4e,decode:c4e}={name:"raw",code:85,decode:pB,encode:pB}});var hy={};Ht(hy,{code:()=>l4e,decode:()=>h4e,encode:()=>f4e,name:()=>u4e});var u4e,l4e,f4e,h4e,_1=Ge(()=>{u();({name:u4e,code:l4e,encode:f4e,decode:h4e}={name:"json",code:512,encode:r=>new TextEncoder().encode(JSON.stringify(r)),decode:r=>JSON.parse(new TextDecoder().decode(r))})});var Rh={};Ht(Rh,{CID:()=>tt,bytes:()=>Sl,digest:()=>bn,hasher:()=>fy,varint:()=>J0});var uu=Ge(()=>{u();xe();zm();Jc();w1();mn()});var i6={};Ht(i6,{CID:()=>tt,bases:()=>d4e,bytes:()=>Sl,codecs:()=>y4e,digest:()=>bn,hasher:()=>fy,hashes:()=>p4e,varint:()=>J0});var d4e,p4e,y4e,n6=Ge(()=>{u();uB();lB();fB();hB();y3();en();p3();zr();ty();Hr();cc();Xn();_1();uu();d4e={...J3,...Z3,...e6,...t6,...Xm,...Zi,...Ym,...Vr,...mh},p4e={...Ir,...aa},y4e={raw:kn,json:hy}});var o6=p((u2t,mB)=>{u();"use strict";var{bases:yB}=(n6(),i6);function gB(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}var bB=gB("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),s6=gB("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),g4e={utf8:bB,"utf-8":bB,hex:yB.base16,latin1:s6,ascii:s6,binary:s6,...yB};mB.exports=g4e});var ct=p((l2t,vB)=>{u();"use strict";var b4e=o6();function m4e(r,e="utf8"){let t=b4e[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}vB.exports=m4e});var _n=p((f2t,wB)=>{u();"use strict";function v4e(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}wB.exports=v4e});var dy=p(_B=>{u();"use strict";_B.get=(r=self)=>{let e=r.crypto||r.msCrypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var a6=p((d2t,SB)=>{u();"use strict";var w4e=_n(),EB=ct(),_4e=dy();function E4e({algorithm:r="AES-GCM",nonceLength:e=12,keyLength:t=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=_4e.get();t*=8;async function a(f,l){let h=o.getRandomValues(new Uint8Array(n)),d=o.getRandomValues(new Uint8Array(e)),y={name:r,iv:d},g={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},m=await o.subtle.importKey("raw",EB(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),E=await o.subtle.deriveKey(g,m,{name:r,length:t},!0,["encrypt"]),_=await o.subtle.encrypt(y,E,f);return w4e([h,y.iv,new Uint8Array(_)])}async function c(f,l){let h=f.slice(0,n),d=f.slice(n,n+e),y=f.slice(n+e),g={name:r,iv:d},m={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},E=await o.subtle.importKey("raw",EB(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),_=await o.subtle.deriveKey(m,E,{name:r,length:t},!0,["decrypt"]),T=await o.subtle.decrypt(g,_,y);return new Uint8Array(T)}return{encrypt:a,decrypt:c}}SB.exports={create:E4e}});var xB=p((p2t,AB)=>{u();"use strict";var{base64:S4e}=(ty(),mh),A4e=a6();AB.exports={import:async function(r,e){let t=S4e.decode(r);return await A4e.create().decrypt(t,e)}}});var fi=p((y2t,IB)=>{u();"use strict";function x4e(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}IB.exports=x4e});var Ze=p((g2t,TB)=>{u();"use strict";var I4e=o6();function T4e(r,e="utf8"){let t=I4e[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}TB.exports=T4e});var E1=p((b2t,OB)=>{u();var gr=lt();su();$t();var py=OB.exports=gr.sha512=gr.sha512||{};gr.md.sha512=gr.md.algorithms.sha512=py;var RB=gr.sha384=gr.sha512.sha384=gr.sha512.sha384||{};RB.create=function(){return py.create("SHA-384")};gr.md.sha384=gr.md.algorithms.sha384=RB;gr.sha512.sha256=gr.sha512.sha256||{create:function(){return py.create("SHA-512/256")}};gr.md["sha512/256"]=gr.md.algorithms["sha512/256"]=gr.sha512.sha256;gr.sha512.sha224=gr.sha512.sha224||{create:function(){return py.create("SHA-512/224")}};gr.md["sha512/224"]=gr.md.algorithms["sha512/224"]=gr.sha512.sha224;py.create=function(r){if(PB||R4e(),typeof r=="undefined"&&(r="SHA-512"),!(r in Ol))throw new Error("Invalid SHA-512 algorithm: "+r);for(var e=Ol[r],t=null,i=gr.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(r){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:r.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,f=0;f<c;++f)a.fullMessageLength.push(0);i=gr.util.createBuffer(),t=new Array(e.length);for(var f=0;f<e.length;++f)t[f]=e[f].slice(0);return a},a.start(),a.update=function(c,f){f==="utf8"&&(c=gr.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=l[1],l[1]=l[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,l[0]=l[1]/4294967296>>>0;return i.putBytes(c),CB(t,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var c=gr.util.createBuffer();c.putBytes(i.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=f&a.blockLength-1;c.putBytes(c6.substr(0,a.blockLength-l));for(var h,d,y=a.fullMessageLength[0]*8,g=0;g<a.fullMessageLength.length-1;++g)h=a.fullMessageLength[g+1]*8,d=h/4294967296>>>0,y+=d,c.putInt32(y>>>0),y=h>>>0;c.putInt32(y);for(var m=new Array(t.length),g=0;g<t.length;++g)m[g]=t[g].slice(0);CB(m,n,c);var E=gr.util.createBuffer(),_;r==="SHA-512"?_=m.length:r==="SHA-384"?_=m.length-2:_=m.length-4;for(var g=0;g<_;++g)E.putInt32(m[g][0]),(g!==_-1||r!=="SHA-512/224")&&E.putInt32(m[g][1]);return E},a};var c6=null,PB=!1,u6=null,Ol=null;function R4e(){c6=String.fromCharCode(128),c6+=gr.util.fillString(String.fromCharCode(0),128),u6=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Ol={},Ol["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Ol["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Ol["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Ol["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],PB=!0}function CB(r,e,t){for(var i,n,s,o,a,c,f,l,h,d,y,g,m,E,_,T,q,z,V,M,$,X,Q,O,b,w,S,C,B,G,F,N,v,D,ae,W=t.length();W>=128;){for(B=0;B<16;++B)e[B][0]=t.getInt32()>>>0,e[B][1]=t.getInt32()>>>0;for(;B<80;++B)N=e[B-2],G=N[0],F=N[1],i=((G>>>19|F<<13)^(F>>>29|G<<3)^G>>>6)>>>0,n=((G<<13|F>>>19)^(F<<3|G>>>29)^(G<<26|F>>>6))>>>0,D=e[B-15],G=D[0],F=D[1],s=((G>>>1|F<<31)^(G>>>8|F<<24)^G>>>7)>>>0,o=((G<<31|F>>>1)^(G<<24|F>>>8)^(G<<25|F>>>7))>>>0,v=e[B-7],ae=e[B-16],F=n+v[1]+o+ae[1],e[B][0]=i+v[0]+s+ae[0]+(F/4294967296>>>0)>>>0,e[B][1]=F>>>0;for(m=r[0][0],E=r[0][1],_=r[1][0],T=r[1][1],q=r[2][0],z=r[2][1],V=r[3][0],M=r[3][1],$=r[4][0],X=r[4][1],Q=r[5][0],O=r[5][1],b=r[6][0],w=r[6][1],S=r[7][0],C=r[7][1],B=0;B<80;++B)f=(($>>>14|X<<18)^($>>>18|X<<14)^(X>>>9|$<<23))>>>0,l=(($<<18|X>>>14)^($<<14|X>>>18)^(X<<23|$>>>9))>>>0,h=(b^$&(Q^b))>>>0,d=(w^X&(O^w))>>>0,a=((m>>>28|E<<4)^(E>>>2|m<<30)^(E>>>7|m<<25))>>>0,c=((m<<4|E>>>28)^(E<<30|m>>>2)^(E<<25|m>>>7))>>>0,y=(m&_|q&(m^_))>>>0,g=(E&T|z&(E^T))>>>0,F=C+l+d+u6[B][1]+e[B][1],i=S+f+h+u6[B][0]+e[B][0]+(F/4294967296>>>0)>>>0,n=F>>>0,F=c+g,s=a+y+(F/4294967296>>>0)>>>0,o=F>>>0,S=b,C=w,b=Q,w=O,Q=$,O=X,F=M+n,$=V+i+(F/4294967296>>>0)>>>0,X=F>>>0,V=q,M=z,q=_,z=T,_=m,T=E,F=n+o,m=i+s+(F/4294967296>>>0)>>>0,E=F>>>0;F=r[0][1]+E,r[0][0]=r[0][0]+m+(F/4294967296>>>0)>>>0,r[0][1]=F>>>0,F=r[1][1]+T,r[1][0]=r[1][0]+_+(F/4294967296>>>0)>>>0,r[1][1]=F>>>0,F=r[2][1]+z,r[2][0]=r[2][0]+q+(F/4294967296>>>0)>>>0,r[2][1]=F>>>0,F=r[3][1]+M,r[3][0]=r[3][0]+V+(F/4294967296>>>0)>>>0,r[3][1]=F>>>0,F=r[4][1]+X,r[4][0]=r[4][0]+$+(F/4294967296>>>0)>>>0,r[4][1]=F>>>0,F=r[5][1]+O,r[5][0]=r[5][0]+Q+(F/4294967296>>>0)>>>0,r[5][1]=F>>>0,F=r[6][1]+w,r[6][0]=r[6][0]+b+(F/4294967296>>>0)>>>0,r[6][1]=F>>>0,F=r[7][1]+C,r[7][0]=r[7][0]+S+(F/4294967296>>>0)>>>0,r[7][1]=F>>>0,W-=128}}});var qB=p(l6=>{u();var P4e=lt();nc();var ki=P4e.asn1;l6.privateKeyValidator={name:"PrivateKeyInfo",tagClass:ki.Class.UNIVERSAL,type:ki.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:ki.Class.UNIVERSAL,type:ki.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:ki.Class.UNIVERSAL,type:ki.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ki.Class.UNIVERSAL,type:ki.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:ki.Class.UNIVERSAL,type:ki.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};l6.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:ki.Class.UNIVERSAL,type:ki.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:ki.Class.UNIVERSAL,type:ki.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ki.Class.UNIVERSAL,type:ki.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:ki.Class.UNIVERSAL,type:ki.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var v6=p((v2t,zB)=>{u();var zi=lt();uy();ou();E1();$t();var kB=qB(),C4e=kB.publicKeyValidator,O4e=kB.privateKeyValidator;typeof BB=="undefined"&&(BB=zi.jsbn.BigInteger);var BB,f6=zi.util.ByteBuffer,Bn=typeof Buffer=="undefined"?Uint8Array:Buffer;zi.pki=zi.pki||{};zB.exports=zi.pki.ed25519=zi.ed25519=zi.ed25519||{};var mt=zi.ed25519;mt.constants={};mt.constants.PUBLIC_KEY_BYTE_LENGTH=32;mt.constants.PRIVATE_KEY_BYTE_LENGTH=64;mt.constants.SEED_BYTE_LENGTH=32;mt.constants.SIGN_BYTE_LENGTH=64;mt.constants.HASH_BYTE_LENGTH=64;mt.generateKeyPair=function(r){r=r||{};var e=r.seed;if(e===void 0)e=zi.random.getBytesSync(mt.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==mt.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+mt.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=uc({message:e,encoding:"binary"});for(var t=new Bn(mt.constants.PUBLIC_KEY_BYTE_LENGTH),i=new Bn(mt.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)i[n]=e[n];return N4e(t,i),{publicKey:t,privateKey:i}};mt.privateKeyFromAsn1=function(r){var e={},t=[],i=zi.asn1.validate(r,O4e,e,t);if(!i){var n=new Error("Invalid Key.");throw n.errors=t,n}var s=zi.asn1.derToOid(e.privateKeyOid),o=zi.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.privateKey,c=uc({message:zi.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:c}};mt.publicKeyFromAsn1=function(r){var e={},t=[],i=zi.asn1.validate(r,C4e,e,t);if(!i){var n=new Error("Invalid Key.");throw n.errors=t,n}var s=zi.asn1.derToOid(e.publicKeyOid),o=zi.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.ed25519PublicKey;if(a.length!==mt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return uc({message:a,encoding:"binary"})};mt.publicKeyFromPrivateKey=function(r){r=r||{};var e=uc({message:r.privateKey,encoding:"binary"});if(e.length!==mt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+mt.constants.PRIVATE_KEY_BYTE_LENGTH);for(var t=new Bn(mt.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<t.length;++i)t[i]=e[32+i];return t};mt.sign=function(r){r=r||{};var e=uc(r),t=uc({message:r.privateKey,encoding:"binary"});if(t.length===mt.constants.SEED_BYTE_LENGTH){var i=mt.generateKeyPair({seed:t});t=i.privateKey}else if(t.length!==mt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+mt.constants.SEED_BYTE_LENGTH+" or "+mt.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new Bn(mt.constants.SIGN_BYTE_LENGTH+e.length);D4e(n,e,e.length,t);for(var s=new Bn(mt.constants.SIGN_BYTE_LENGTH),o=0;o<s.length;++o)s[o]=n[o];return s};mt.verify=function(r){r=r||{};var e=uc(r);if(r.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var t=uc({message:r.signature,encoding:"binary"});if(t.length!==mt.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+mt.constants.SIGN_BYTE_LENGTH);var i=uc({message:r.publicKey,encoding:"binary"});if(i.length!==mt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+mt.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new Bn(mt.constants.SIGN_BYTE_LENGTH+e.length),s=new Bn(mt.constants.SIGN_BYTE_LENGTH+e.length),o;for(o=0;o<mt.constants.SIGN_BYTE_LENGTH;++o)n[o]=t[o];for(o=0;o<e.length;++o)n[o+mt.constants.SIGN_BYTE_LENGTH]=e[o];return M4e(s,n,n.length,i)>=0};function uc(r){var e=r.message;if(e instanceof Uint8Array||e instanceof Bn)return e;var t=r.encoding;if(e===void 0)if(r.md)e=r.md.digest().getBytes(),t="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!t)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.from(e,t);e=new f6(e,t)}else if(!(e instanceof f6))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new Bn(e.length()),n=0;n<i.length;++n)i[n]=e.at(n);return i}var h6=Ye(),S1=Ye([1]),q4e=Ye([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),k4e=Ye([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),NB=Ye([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),DB=Ye([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d6=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),B4e=Ye([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function yy(r,e){var t=zi.md.sha512.create(),i=new f6(r);t.update(i.getBytes(e),"binary");var n=t.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(n,"binary");for(var s=new Bn(mt.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)s[o]=n.charCodeAt(o);return s}function N4e(r,e){var t=[Ye(),Ye(),Ye(),Ye()],i,n=yy(e,32);for(n[0]&=248,n[31]&=127,n[31]|=64,b6(t,n),g6(r,t),i=0;i<32;++i)e[i+32]=r[i];return 0}function D4e(r,e,t,i){var n,s,o=new Float64Array(64),a=[Ye(),Ye(),Ye(),Ye()],c=yy(i,32);c[0]&=248,c[31]&=127,c[31]|=64;var f=t+64;for(n=0;n<t;++n)r[64+n]=e[n];for(n=0;n<32;++n)r[32+n]=c[32+n];var l=yy(r.subarray(32),t+32);for(p6(l),b6(a,l),g6(r,a),n=32;n<64;++n)r[n]=i[n];var h=yy(r,t+64);for(p6(h),n=32;n<64;++n)o[n]=0;for(n=0;n<32;++n)o[n]=l[n];for(n=0;n<32;++n)for(s=0;s<32;s++)o[n+s]+=h[n]*c[s];return MB(r.subarray(32),o),f}function M4e(r,e,t,i){var n,s,o=new Bn(32),a=[Ye(),Ye(),Ye(),Ye()],c=[Ye(),Ye(),Ye(),Ye()];if(s=-1,t<64||L4e(c,i))return-1;for(n=0;n<t;++n)r[n]=e[n];for(n=0;n<32;++n)r[n+32]=i[n];var f=yy(r,t);if(p6(f),jB(a,c,f),b6(c,e.subarray(32)),y6(a,c),g6(o,a),t-=64,FB(e,0,o,0)){for(n=0;n<t;++n)r[n]=0;return-1}for(n=0;n<t;++n)r[n]=e[n+64];return s=t,s}function MB(r,e){var t,i,n,s;for(i=63;i>=32;--i){for(t=0,n=i-32,s=i-12;n<s;++n)e[n]+=t-16*e[i]*d6[n-(i-32)],t=e[n]+128>>8,e[n]-=t*256;e[n]+=t,e[i]=0}for(t=0,n=0;n<32;++n)e[n]+=t-(e[31]>>4)*d6[n],t=e[n]>>8,e[n]&=255;for(n=0;n<32;++n)e[n]-=t*d6[n];for(i=0;i<32;++i)e[i+1]+=e[i]>>8,r[i]=e[i]&255}function p6(r){for(var e=new Float64Array(64),t=0;t<64;++t)e[t]=r[t],r[t]=0;MB(r,e)}function y6(r,e){var t=Ye(),i=Ye(),n=Ye(),s=Ye(),o=Ye(),a=Ye(),c=Ye(),f=Ye(),l=Ye();Ch(t,r[1],r[0]),Ch(l,e[1],e[0]),Gt(t,t,l),Ph(i,r[0],r[1]),Ph(l,e[0],e[1]),Gt(i,i,l),Gt(n,r[3],e[3]),Gt(n,n,k4e),Gt(s,r[2],e[2]),Ph(s,s,s),Ch(o,i,t),Ch(a,s,n),Ph(c,s,n),Ph(f,i,t),Gt(r[0],o,a),Gt(r[1],f,c),Gt(r[2],c,a),Gt(r[3],o,f)}function LB(r,e,t){for(var i=0;i<4;++i)VB(r[i],e[i],t)}function g6(r,e){var t=Ye(),i=Ye(),n=Ye();j4e(n,e[2]),Gt(t,e[0],n),Gt(i,e[1],n),A1(r,i),r[31]^=KB(t)<<7}function A1(r,e){var t,i,n,s=Ye(),o=Ye();for(t=0;t<16;++t)o[t]=e[t];for(m6(o),m6(o),m6(o),i=0;i<2;++i){for(s[0]=o[0]-65517,t=1;t<15;++t)s[t]=o[t]-65535-(s[t-1]>>16&1),s[t-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,VB(o,s,1-n)}for(t=0;t<16;t++)r[2*t]=o[t]&255,r[2*t+1]=o[t]>>8}function L4e(r,e){var t=Ye(),i=Ye(),n=Ye(),s=Ye(),o=Ye(),a=Ye(),c=Ye();return lu(r[2],S1),U4e(r[1],e),ql(n,r[1]),Gt(s,n,q4e),Ch(n,n,r[2]),Ph(s,r[2],s),ql(o,s),ql(a,o),Gt(c,a,o),Gt(t,c,n),Gt(t,t,s),F4e(t,t),Gt(t,t,n),Gt(t,t,s),Gt(t,t,s),Gt(r[0],t,s),ql(i,r[0]),Gt(i,i,s),UB(i,n)&&Gt(r[0],r[0],B4e),ql(i,r[0]),Gt(i,i,s),UB(i,n)?-1:(KB(r[0])===e[31]>>7&&Ch(r[0],h6,r[0]),Gt(r[3],r[0],r[1]),0)}function U4e(r,e){var t;for(t=0;t<16;++t)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function F4e(r,e){var t=Ye(),i;for(i=0;i<16;++i)t[i]=e[i];for(i=250;i>=0;--i)ql(t,t),i!==1&&Gt(t,t,e);for(i=0;i<16;++i)r[i]=t[i]}function UB(r,e){var t=new Bn(32),i=new Bn(32);return A1(t,r),A1(i,e),FB(t,0,i,0)}function FB(r,e,t,i){return K4e(r,e,t,i,32)}function K4e(r,e,t,i,n){var s,o=0;for(s=0;s<n;++s)o|=r[e+s]^t[i+s];return(1&o-1>>>8)-1}function KB(r){var e=new Bn(32);return A1(e,r),e[0]&1}function jB(r,e,t){var i,n;for(lu(r[0],h6),lu(r[1],S1),lu(r[2],S1),lu(r[3],h6),n=255;n>=0;--n)i=t[n/8|0]>>(n&7)&1,LB(r,e,i),y6(e,r),y6(r,r),LB(r,e,i)}function b6(r,e){var t=[Ye(),Ye(),Ye(),Ye()];lu(t[0],NB),lu(t[1],DB),lu(t[2],S1),Gt(t[3],NB,DB),jB(r,t,e)}function lu(r,e){var t;for(t=0;t<16;t++)r[t]=e[t]|0}function j4e(r,e){var t=Ye(),i;for(i=0;i<16;++i)t[i]=e[i];for(i=253;i>=0;--i)ql(t,t),i!==2&&i!==4&&Gt(t,t,e);for(i=0;i<16;++i)r[i]=t[i]}function m6(r){var e,t,i=1;for(e=0;e<16;++e)t=r[e]+i+65535,i=Math.floor(t/65536),r[e]=t-i*65536;r[0]+=i-1+37*(i-1)}function VB(r,e,t){for(var i,n=~(t-1),s=0;s<16;++s)i=n&(r[s]^e[s]),r[s]^=i,e[s]^=i}function Ye(r){var e,t=new Float64Array(16);if(r)for(e=0;e<r.length;++e)t[e]=r[e];return t}function Ph(r,e,t){for(var i=0;i<16;++i)r[i]=e[i]+t[i]}function Ch(r,e,t){for(var i=0;i<16;++i)r[i]=e[i]-t[i]}function ql(r,e){Gt(r,e,e)}function Gt(r,e,t){var i,n,s=0,o=0,a=0,c=0,f=0,l=0,h=0,d=0,y=0,g=0,m=0,E=0,_=0,T=0,q=0,z=0,V=0,M=0,$=0,X=0,Q=0,O=0,b=0,w=0,S=0,C=0,B=0,G=0,F=0,N=0,v=0,D=t[0],ae=t[1],W=t[2],ne=t[3],oe=t[4],de=t[5],pe=t[6],_e=t[7],P=t[8],U=t[9],H=t[10],J=t[11],x=t[12],L=t[13],K=t[14],k=t[15];i=e[0],s+=i*D,o+=i*ae,a+=i*W,c+=i*ne,f+=i*oe,l+=i*de,h+=i*pe,d+=i*_e,y+=i*P,g+=i*U,m+=i*H,E+=i*J,_+=i*x,T+=i*L,q+=i*K,z+=i*k,i=e[1],o+=i*D,a+=i*ae,c+=i*W,f+=i*ne,l+=i*oe,h+=i*de,d+=i*pe,y+=i*_e,g+=i*P,m+=i*U,E+=i*H,_+=i*J,T+=i*x,q+=i*L,z+=i*K,V+=i*k,i=e[2],a+=i*D,c+=i*ae,f+=i*W,l+=i*ne,h+=i*oe,d+=i*de,y+=i*pe,g+=i*_e,m+=i*P,E+=i*U,_+=i*H,T+=i*J,q+=i*x,z+=i*L,V+=i*K,M+=i*k,i=e[3],c+=i*D,f+=i*ae,l+=i*W,h+=i*ne,d+=i*oe,y+=i*de,g+=i*pe,m+=i*_e,E+=i*P,_+=i*U,T+=i*H,q+=i*J,z+=i*x,V+=i*L,M+=i*K,$+=i*k,i=e[4],f+=i*D,l+=i*ae,h+=i*W,d+=i*ne,y+=i*oe,g+=i*de,m+=i*pe,E+=i*_e,_+=i*P,T+=i*U,q+=i*H,z+=i*J,V+=i*x,M+=i*L,$+=i*K,X+=i*k,i=e[5],l+=i*D,h+=i*ae,d+=i*W,y+=i*ne,g+=i*oe,m+=i*de,E+=i*pe,_+=i*_e,T+=i*P,q+=i*U,z+=i*H,V+=i*J,M+=i*x,$+=i*L,X+=i*K,Q+=i*k,i=e[6],h+=i*D,d+=i*ae,y+=i*W,g+=i*ne,m+=i*oe,E+=i*de,_+=i*pe,T+=i*_e,q+=i*P,z+=i*U,V+=i*H,M+=i*J,$+=i*x,X+=i*L,Q+=i*K,O+=i*k,i=e[7],d+=i*D,y+=i*ae,g+=i*W,m+=i*ne,E+=i*oe,_+=i*de,T+=i*pe,q+=i*_e,z+=i*P,V+=i*U,M+=i*H,$+=i*J,X+=i*x,Q+=i*L,O+=i*K,b+=i*k,i=e[8],y+=i*D,g+=i*ae,m+=i*W,E+=i*ne,_+=i*oe,T+=i*de,q+=i*pe,z+=i*_e,V+=i*P,M+=i*U,$+=i*H,X+=i*J,Q+=i*x,O+=i*L,b+=i*K,w+=i*k,i=e[9],g+=i*D,m+=i*ae,E+=i*W,_+=i*ne,T+=i*oe,q+=i*de,z+=i*pe,V+=i*_e,M+=i*P,$+=i*U,X+=i*H,Q+=i*J,O+=i*x,b+=i*L,w+=i*K,S+=i*k,i=e[10],m+=i*D,E+=i*ae,_+=i*W,T+=i*ne,q+=i*oe,z+=i*de,V+=i*pe,M+=i*_e,$+=i*P,X+=i*U,Q+=i*H,O+=i*J,b+=i*x,w+=i*L,S+=i*K,C+=i*k,i=e[11],E+=i*D,_+=i*ae,T+=i*W,q+=i*ne,z+=i*oe,V+=i*de,M+=i*pe,$+=i*_e,X+=i*P,Q+=i*U,O+=i*H,b+=i*J,w+=i*x,S+=i*L,C+=i*K,B+=i*k,i=e[12],_+=i*D,T+=i*ae,q+=i*W,z+=i*ne,V+=i*oe,M+=i*de,$+=i*pe,X+=i*_e,Q+=i*P,O+=i*U,b+=i*H,w+=i*J,S+=i*x,C+=i*L,B+=i*K,G+=i*k,i=e[13],T+=i*D,q+=i*ae,z+=i*W,V+=i*ne,M+=i*oe,$+=i*de,X+=i*pe,Q+=i*_e,O+=i*P,b+=i*U,w+=i*H,S+=i*J,C+=i*x,B+=i*L,G+=i*K,F+=i*k,i=e[14],q+=i*D,z+=i*ae,V+=i*W,M+=i*ne,$+=i*oe,X+=i*de,Q+=i*pe,O+=i*_e,b+=i*P,w+=i*U,S+=i*H,C+=i*J,B+=i*x,G+=i*L,F+=i*K,N+=i*k,i=e[15],z+=i*D,V+=i*ae,M+=i*W,$+=i*ne,X+=i*oe,Q+=i*de,O+=i*pe,b+=i*_e,w+=i*P,S+=i*U,C+=i*H,B+=i*J,G+=i*x,F+=i*L,N+=i*K,v+=i*k,s+=38*V,o+=38*M,a+=38*$,c+=38*X,f+=38*Q,l+=38*O,h+=38*b,d+=38*w,y+=38*S,g+=38*C,m+=38*B,E+=38*G,_+=38*F,T+=38*N,q+=38*v,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,i=T+n+65535,n=Math.floor(i/65536),T=i-n*65536,i=q+n+65535,n=Math.floor(i/65536),q=i-n*65536,i=z+n+65535,n=Math.floor(i/65536),z=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,i=T+n+65535,n=Math.floor(i/65536),T=i-n*65536,i=q+n+65535,n=Math.floor(i/65536),q=i-n*65536,i=z+n+65535,n=Math.floor(i/65536),z=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=o,r[2]=a,r[3]=c,r[4]=f,r[5]=l,r[6]=h,r[7]=d,r[8]=y,r[9]=g,r[10]=m,r[11]=E,r[12]=_,r[13]=T,r[14]=q,r[15]=z}});var $B=p((w2t,HB)=>{u();"use strict";var x1=65536;function V4e(r){let e=new Uint8Array(r),t=0;if(r>0)if(r>x1)for(;t<r;)t+x1>r?(crypto.getRandomValues(e.subarray(t,t+(r-t))),t+=r-t):(crypto.getRandomValues(e.subarray(t,t+x1)),t+=x1);else crypto.getRandomValues(e);return e}HB.exports=V4e});var gy=p((_2t,GB)=>{u();"use strict";var z4e=$B(),H4e=ue();GB.exports=function(r){if(isNaN(r)||r<=0)throw H4e(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return z4e(r)}});var I1=p(by=>{u();"use strict";$t();uy();var $4e=lt(),G4e=ct(),WB=Ze(),YB=_n();by.bigIntegerToUintBase64url=(r,e)=>{let t=Uint8Array.from(r.abs().toByteArray());if(t=t[0]===0?t.slice(1):t,e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=YB([new Uint8Array(e-t.length),t])}return WB(t,"base64url")};by.base64urlToBigInteger=r=>{let e=by.base64urlToBuffer(r);return new $4e.jsbn.BigInteger(WB(e,"base16"),16)};by.base64urlToBuffer=(r,e)=>{let t=G4e(r,"base64urlpad");if(e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=YB([new Uint8Array(e-t.length),t])}return t}});var JB=p(my=>{u();"use strict";nc();ly();var fu=lt(),{bigIntegerToUintBase64url:ca,base64urlToBigInteger:ua}=I1(),XB=ct(),QB=Ze();my.pkcs1ToJwk=function(r){let e=fu.asn1.fromDer(QB(r,"ascii")),t=fu.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:ca(t.n),e:ca(t.e),d:ca(t.d),p:ca(t.p),q:ca(t.q),dp:ca(t.dP),dq:ca(t.dQ),qi:ca(t.qInv),alg:"RS256",kid:"2011-04-29"}};my.jwkToPkcs1=function(r){let e=fu.pki.privateKeyToAsn1({n:ua(r.n),e:ua(r.e),d:ua(r.d),p:ua(r.p),q:ua(r.q),dP:ua(r.dp),dQ:ua(r.dq),qInv:ua(r.qi)});return XB(fu.asn1.toDer(e).getBytes(),"ascii")};my.pkixToJwk=function(r){let e=fu.asn1.fromDer(QB(r,"ascii")),t=fu.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:ca(t.n),e:ca(t.e),alg:"RS256",kid:"2011-04-29"}};my.jwkToPkix=function(r){let e=fu.pki.publicKeyToAsn1({n:ua(r.n),e:ua(r.e)});return XB(fu.asn1.toDer(e).getBytes(),"ascii")}});var rN=p((A2t,tN)=>{u();"use strict";ly();var ZB=lt(),{base64urlToBigInteger:W4e}=I1();function eN(r,e){return e.map(t=>W4e(r[t]))}function Y4e(r){return ZB.pki.setRsaPrivateKey(...eN(r,["n","e","d","p","q","dp","dq","qi"]))}function X4e(r){return ZB.pki.setRsaPublicKey(...eN(r,["n","e"]))}tN.exports={jwk2pub:X4e,jwk2priv:Y4e}});var sN=p(fc=>{u();"use strict";var lc=dy(),Q4e=gy(),J4e=Ze(),Z4e=ct();fc.utils=JB();fc.generateKey=async function(r){let e=await lc.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),t=await iN(e);return{privateKey:t[0],publicKey:t[1]}};fc.unmarshalPrivateKey=async function(r){let t=[await lc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await e5e(r)],i=await iN({privateKey:t[0],publicKey:t[1]});return{privateKey:i[0],publicKey:i[1]}};fc.getRandomValues=Q4e;fc.hashAndSign=async function(r,e){let t=await lc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await lc.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},t,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};fc.hashAndVerify=async function(r,e,t){let i=await lc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return lc.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,t)};function iN(r){return Promise.all([lc.get().subtle.exportKey("jwk",r.privateKey),lc.get().subtle.exportKey("jwk",r.publicKey)])}function e5e(r){return lc.get().subtle.importKey("jwk",{kty:r.kty,n:r.n,e:r.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:t5e,jwk2priv:r5e}=rN();function nN(r,e,t,i){let n=e?t5e(r):r5e(r),s=J4e(Uint8Array.from(t),"ascii"),o=i(s,n);return Z4e(o,"ascii")}fc.encrypt=function(r,e){return nN(r,!0,e,(t,i)=>i.encrypt(t))};fc.decrypt=function(r,e){return nN(r,!1,e,(t,i)=>i.decrypt(t))}});var T1=p((I2t,oN)=>{u();"use strict";var{base64:i5e}=(ty(),mh),n5e=a6();oN.exports={export:async function(r,e){let i=await n5e.create().encrypt(r,e);return i5e.encode(i)}}});var fN=p((T2t,lN)=>{u();"use strict";var{sha256:aN}=(Hr(),Ir),cN=ue(),uN=fi(),s5e=Ze();E1();v6();var R1=lt(),vs=sN(),P1=r1(),o5e=T1(),C1=class{constructor(e){this._key=e}async verify(e,t){return vs.hashAndVerify(this._key,t,e)}marshal(){return vs.utils.jwkToPkix(this._key)}get bytes(){return P1.PublicKey.encode({Type:P1.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return vs.encrypt(this._key,e)}equals(e){return uN(this.bytes,e.bytes)}async hash(){let{bytes:e}=await aN.digest(this.bytes);return e}},vy=class{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return vs.getRandomValues(16)}async sign(e){return vs.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw cN(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new C1(this._publicKey)}decrypt(e){return vs.decrypt(this._key,e)}marshal(){return vs.utils.jwkToPkcs1(this._key)}get bytes(){return P1.PrivateKey.encode({Type:P1.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return uN(this.bytes,e.bytes)}async hash(){let{bytes:e}=await aN.digest(this.bytes);return e}async id(){let e=await this.public.hash();return s5e(e,"base58btc")}async export(e,t="pkcs-8"){if(t==="pkcs-8"){let i=new R1.util.ByteBuffer(this.marshal()),n=R1.asn1.fromDer(i),s=R1.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return R1.pki.encryptRsaPrivateKey(s,e,o)}else{if(t==="libp2p-key")return o5e.export(this.bytes,e);throw cN(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function a5e(r){let e=vs.utils.pkcs1ToJwk(r),t=await vs.unmarshalPrivateKey(e);return new vy(t.privateKey,t.publicKey)}function c5e(r){let e=vs.utils.pkixToJwk(r);return new C1(e)}async function u5e(r){let e=await vs.unmarshalPrivateKey(r);return new vy(e.privateKey,e.publicKey)}async function l5e(r){let e=await vs.generateKey(r);return new vy(e.privateKey,e.publicKey)}lN.exports={RsaPublicKey:C1,RsaPrivateKey:vy,unmarshalRsaPublicKey:c5e,unmarshalRsaPrivateKey:a5e,generateKeyPair:l5e,fromJwk:u5e}});var hN=p(kl=>{u();"use strict";v6();var Oh=lt();kl.publicKeyLength=Oh.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH;kl.privateKeyLength=Oh.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH;kl.generateKey=async function(){return Oh.pki.ed25519.generateKeyPair()};kl.generateKeyFromSeed=async function(r){return Oh.pki.ed25519.generateKeyPair({seed:r})};kl.hashAndSign=async function(r,e){return Oh.pki.ed25519.sign({message:e,privateKey:r})};kl.hashAndVerify=async function(r,e,t){return Oh.pki.ed25519.verify({signature:e,message:t,publicKey:r})}});var bN=p((P2t,gN)=>{u();"use strict";var dN=ue(),pN=fi(),{sha256:yN}=(Hr(),Ir),{base58btc:f5e}=(zr(),Vr),{identity:h5e}=(cc(),aa),rn=hN(),O1=r1(),d5e=T1(),q1=class{constructor(e){this._key=kh(e,rn.publicKeyLength)}async verify(e,t){return rn.hashAndVerify(this._key,t,e)}marshal(){return this._key}get bytes(){return O1.PublicKey.encode({Type:O1.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return pN(this.bytes,e.bytes)}async hash(){let{bytes:e}=await yN.digest(this.bytes);return e}},qh=class{constructor(e,t){this._key=kh(e,rn.privateKeyLength),this._publicKey=kh(t,rn.publicKeyLength)}async sign(e){return rn.hashAndSign(this._key,e)}get public(){return new q1(this._publicKey)}marshal(){return this._key}get bytes(){return O1.PrivateKey.encode({Type:O1.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return pN(this.bytes,e.bytes)}async hash(){let{bytes:e}=await yN.digest(this.bytes);return e}async id(){let e=await h5e.digest(this.public.bytes);return f5e.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if(t==="libp2p-key")return d5e.export(this.bytes,e);throw dN(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function p5e(r){if(r.length>rn.privateKeyLength){r=kh(r,rn.privateKeyLength+rn.publicKeyLength);let i=r.slice(0,rn.privateKeyLength),n=r.slice(rn.privateKeyLength,r.length);return new qh(i,n)}r=kh(r,rn.privateKeyLength);let e=r.slice(0,rn.privateKeyLength),t=r.slice(rn.publicKeyLength);return new qh(e,t)}function y5e(r){return r=kh(r,rn.publicKeyLength),new q1(r)}async function g5e(){let{privateKey:r,publicKey:e}=await rn.generateKey();return new qh(r,e)}async function b5e(r){let{privateKey:e,publicKey:t}=await rn.generateKeyFromSeed(r);return new qh(e,t)}function kh(r,e){if(r=Uint8Array.from(r||[]),r.length!==e)throw dN(new Error(`Key must be a Uint8Array of length ${e}, got ${r.length}`),"ERR_INVALID_KEY_TYPE");return r}gN.exports={Ed25519PublicKey:q1,Ed25519PrivateKey:qh,unmarshalEd25519PrivateKey:p5e,unmarshalEd25519PublicKey:y5e,generateKeyPair:g5e,generateKeyPairFromSeed:b5e}});var vN=p((C2t,mN)=>{u();var Bt={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function ws(r,e){if(!r)throw new Error(e)}function Rt(r,e,t){if(ws(e instanceof Uint8Array,`Expected ${r} to be an Uint8Array`),t!==void 0)if(Array.isArray(t)){let i=t.join(", "),n=`Expected ${r} to be an Uint8Array with length [${i}]`;ws(t.includes(e.length),n)}else{let i=`Expected ${r} to be an Uint8Array with length ${t}`;ws(e.length===t,i)}}function Bl(r){ws(Bh(r)==="Boolean","Expected compressed to be a Boolean")}function no(r=t=>new Uint8Array(t),e){return typeof r=="function"&&(r=r(e)),Rt("output",r,e),r}function Bh(r){return Object.prototype.toString.call(r).slice(8,-1)}mN.exports=r=>({contextRandomize(e){switch(ws(e===null||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),e!==null&&Rt("seed",e,32),r.contextRandomize(e)){case 1:throw new Error(Bt.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(e){return Rt("private key",e,32),r.privateKeyVerify(e)===0},privateKeyNegate(e){switch(Rt("private key",e,32),r.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(Bt.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(e,t){switch(Rt("private key",e,32),Rt("tweak",t,32),r.privateKeyTweakAdd(e,t)){case 0:return e;case 1:throw new Error(Bt.TWEAK_ADD)}},privateKeyTweakMul(e,t){switch(Rt("private key",e,32),Rt("tweak",t,32),r.privateKeyTweakMul(e,t)){case 0:return e;case 1:throw new Error(Bt.TWEAK_MUL)}},publicKeyVerify(e){return Rt("public key",e,[33,65]),r.publicKeyVerify(e)===0},publicKeyCreate(e,t=!0,i){switch(Rt("private key",e,32),Bl(t),i=no(i,t?33:65),r.publicKeyCreate(i,e)){case 0:return i;case 1:throw new Error(Bt.SECKEY_INVALID);case 2:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyConvert(e,t=!0,i){switch(Rt("public key",e,[33,65]),Bl(t),i=no(i,t?33:65),r.publicKeyConvert(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyNegate(e,t=!0,i){switch(Rt("public key",e,[33,65]),Bl(t),i=no(i,t?33:65),r.publicKeyNegate(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE);case 3:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyCombine(e,t=!0,i){ws(Array.isArray(e),"Expected public keys to be an Array"),ws(e.length>0,"Expected public keys array will have more than zero items");for(let n of e)Rt("public key",n,[33,65]);switch(Bl(t),i=no(i,t?33:65),r.publicKeyCombine(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.PUBKEY_COMBINE);case 3:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(e,t,i=!0,n){switch(Rt("public key",e,[33,65]),Rt("tweak",t,32),Bl(i),n=no(n,i?33:65),r.publicKeyTweakAdd(n,e,t)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.TWEAK_ADD)}},publicKeyTweakMul(e,t,i=!0,n){switch(Rt("public key",e,[33,65]),Rt("tweak",t,32),Bl(i),n=no(n,i?33:65),r.publicKeyTweakMul(n,e,t)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.TWEAK_MUL)}},signatureNormalize(e){switch(Rt("signature",e,64),r.signatureNormalize(e)){case 0:return e;case 1:throw new Error(Bt.SIG_PARSE)}},signatureExport(e,t){Rt("signature",e,64),t=no(t,72);let i={output:t,outputlen:72};switch(r.signatureExport(i,e)){case 0:return t.slice(0,i.outputlen);case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},signatureImport(e,t){switch(Rt("signature",e),t=no(t,64),r.signatureImport(t,e)){case 0:return t;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdsaSign(e,t,i={},n){Rt("message",e,32),Rt("private key",t,32),ws(Bh(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Rt("options.data",i.data),i.noncefn!==void 0&&ws(Bh(i.noncefn)==="Function","Expected options.noncefn to be a Function"),n=no(n,64);let s={signature:n,recid:null};switch(r.ecdsaSign(s,e,t,i.data,i.noncefn)){case 0:return s;case 1:throw new Error(Bt.SIGN);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdsaVerify(e,t,i){switch(Rt("signature",e,64),Rt("message",t,32),Rt("public key",i,[33,65]),r.ecdsaVerify(e,t,i)){case 0:return!0;case 3:return!1;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.PUBKEY_PARSE)}},ecdsaRecover(e,t,i,n=!0,s){switch(Rt("signature",e,64),ws(Bh(t)==="Number"&&t>=0&&t<=3,"Expected recovery id to be a Number within interval [0, 3]"),Rt("message",i,32),Bl(n),s=no(s,n?33:65),r.ecdsaRecover(s,e,t,i)){case 0:return s;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.RECOVER);case 3:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdh(e,t,i={},n){switch(Rt("public key",e,[33,65]),Rt("private key",t,32),ws(Bh(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Rt("options.data",i.data),i.hashfn!==void 0?(ws(Bh(i.hashfn)==="Function","Expected options.hashfn to be a Function"),i.xbuf!==void 0&&Rt("options.xbuf",i.xbuf,32),i.ybuf!==void 0&&Rt("options.ybuf",i.ybuf,32),Rt("output",n)):n=no(n,32),r.ecdh(n,e,t,i.data,i.hashfn,i.xbuf,i.ybuf)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.ECDH)}}})});var wN=p((O2t,m5e)=>{m5e.exports={_from:"elliptic@^6.5.2",_id:"elliptic@6.5.4",_inBundle:!1,_integrity:"sha512-iLhC6ULemrljPZb+QutR5TQGB+pdW6KGD5RSegS+8sorOZT+rdQFbsQFJgvN3eRqNALqJer4oQ16YvJHlU8hzQ==",_location:"/elliptic",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"elliptic@^6.5.2",name:"elliptic",escapedName:"elliptic",rawSpec:"^6.5.2",saveSpec:null,fetchSpec:"^6.5.2"},_requiredBy:["/secp256k1"],_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.5.4.tgz",_shasum:"da37cebd31e79a1367e941b592ed1fbebd58abbb",_spec:"elliptic@^6.5.2",_where:"/Users/alex/Documents/Workspaces/ipfs/js-ipfs/node_modules/secp256k1",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},bundleDependencies:!1,dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},deprecated:!1,description:"EC cryptography",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.5.4"}});var _N=p(()=>{u()});var la=p((EN,w6)=>{u();(function(r,e){"use strict";function t(O,b){if(!O)throw new Error(b||"Assertion failed")}function i(O,b){O.super_=b;var w=function(){};w.prototype=b.prototype,O.prototype=new w,O.prototype.constructor=O}function n(O,b,w){if(n.isBN(O))return O;this.negative=0,this.words=null,this.length=0,this.red=null,O!==null&&((b==="le"||b==="be")&&(w=b,b=10),this._init(O||0,b||10,w||"be"))}typeof r=="object"?r.exports=n:e.BN=n,n.BN=n,n.wordSize=26;var s;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?s=window.Buffer:s=_N().Buffer}catch(O){}n.isBN=function(b){return b instanceof n?!0:b!==null&&typeof b=="object"&&b.constructor.wordSize===n.wordSize&&Array.isArray(b.words)},n.max=function(b,w){return b.cmp(w)>0?b:w},n.min=function(b,w){return b.cmp(w)<0?b:w},n.prototype._init=function(b,w,S){if(typeof b=="number")return this._initNumber(b,w,S);if(typeof b=="object")return this._initArray(b,w,S);w==="hex"&&(w=16),t(w===(w|0)&&w>=2&&w<=36),b=b.toString().replace(/\s+/g,"");var C=0;b[0]==="-"&&(C++,this.negative=1),C<b.length&&(w===16?this._parseHex(b,C,S):(this._parseBase(b,w,C),S==="le"&&this._initArray(this.toArray(),w,S)))},n.prototype._initNumber=function(b,w,S){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[b&67108863],this.length=1):b<4503599627370496?(this.words=[b&67108863,b/67108864&67108863],this.length=2):(t(b<9007199254740992),this.words=[b&67108863,b/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),w,S)},n.prototype._initArray=function(b,w,S){if(t(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var B,G,F=0;if(S==="be")for(C=b.length-1,B=0;C>=0;C-=3)G=b[C]|b[C-1]<<8|b[C-2]<<16,this.words[B]|=G<<F&67108863,this.words[B+1]=G>>>26-F&67108863,F+=24,F>=26&&(F-=26,B++);else if(S==="le")for(C=0,B=0;C<b.length;C+=3)G=b[C]|b[C+1]<<8|b[C+2]<<16,this.words[B]|=G<<F&67108863,this.words[B+1]=G>>>26-F&67108863,F+=24,F>=26&&(F-=26,B++);return this.strip()};function o(O,b){var w=O.charCodeAt(b);return w>=65&&w<=70?w-55:w>=97&&w<=102?w-87:w-48&15}function a(O,b,w){var S=o(O,w);return w-1>=b&&(S|=o(O,w-1)<<4),S}n.prototype._parseHex=function(b,w,S){this.length=Math.ceil((b.length-w)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var B=0,G=0,F;if(S==="be")for(C=b.length-1;C>=w;C-=2)F=a(b,w,C)<<B,this.words[G]|=F&67108863,B>=18?(B-=18,G+=1,this.words[G]|=F>>>26):B+=8;else{var N=b.length-w;for(C=N%2==0?w+1:w;C<b.length;C+=2)F=a(b,w,C)<<B,this.words[G]|=F&67108863,B>=18?(B-=18,G+=1,this.words[G]|=F>>>26):B+=8}this.strip()};function c(O,b,w,S){for(var C=0,B=Math.min(O.length,w),G=b;G<B;G++){var F=O.charCodeAt(G)-48;C*=S,F>=49?C+=F-49+10:F>=17?C+=F-17+10:C+=F}return C}n.prototype._parseBase=function(b,w,S){this.words=[0],this.length=1;for(var C=0,B=1;B<=67108863;B*=w)C++;C--,B=B/w|0;for(var G=b.length-S,F=G%C,N=Math.min(G,G-F)+S,v=0,D=S;D<N;D+=C)v=c(b,D,D+C,w),this.imuln(B),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v);if(F!==0){var ae=1;for(v=c(b,D,b.length,w),D=0;D<F;D++)ae*=w;this.imuln(ae),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v)}this.strip()},n.prototype.copy=function(b){b.words=new Array(this.length);for(var w=0;w<this.length;w++)b.words[w]=this.words[w];b.length=this.length,b.negative=this.negative,b.red=this.red},n.prototype.clone=function(){var b=new n(null);return this.copy(b),b},n.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(b,w){b=b||10,w=w|0||1;var S;if(b===16||b==="hex"){S="";for(var C=0,B=0,G=0;G<this.length;G++){var F=this.words[G],N=((F<<C|B)&16777215).toString(16);B=F>>>24-C&16777215,B!==0||G!==this.length-1?S=f[6-N.length]+N+S:S=N+S,C+=2,C>=26&&(C-=26,G--)}for(B!==0&&(S=B.toString(16)+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(b===(b|0)&&b>=2&&b<=36){var v=l[b],D=h[b];S="";var ae=this.clone();for(ae.negative=0;!ae.isZero();){var W=ae.modn(D).toString(b);ae=ae.idivn(D),ae.isZero()?S=W+S:S=f[v-W.length]+W+S}for(this.isZero()&&(S="0"+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var b=this.words[0];return this.length===2?b+=this.words[1]*67108864:this.length===3&&this.words[2]===1?b+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-b:b},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(b,w){return t(typeof s!="undefined"),this.toArrayLike(s,b,w)},n.prototype.toArray=function(b,w){return this.toArrayLike(Array,b,w)},n.prototype.toArrayLike=function(b,w,S){var C=this.byteLength(),B=S||Math.max(1,C);t(C<=B,"byte array longer than desired length"),t(B>0,"Requested array length <= 0"),this.strip();var G=w==="le",F=new b(B),N,v,D=this.clone();if(G){for(v=0;!D.isZero();v++)N=D.andln(255),D.iushrn(8),F[v]=N;for(;v<B;v++)F[v]=0}else{for(v=0;v<B-C;v++)F[v]=0;for(v=0;!D.isZero();v++)N=D.andln(255),D.iushrn(8),F[B-v-1]=N}return F},Math.clz32?n.prototype._countBits=function(b){return 32-Math.clz32(b)}:n.prototype._countBits=function(b){var w=b,S=0;return w>=4096&&(S+=13,w>>>=13),w>=64&&(S+=7,w>>>=7),w>=8&&(S+=4,w>>>=4),w>=2&&(S+=2,w>>>=2),S+w},n.prototype._zeroBits=function(b){if(b===0)return 26;var w=b,S=0;return(w&8191)==0&&(S+=13,w>>>=13),(w&127)==0&&(S+=7,w>>>=7),(w&15)==0&&(S+=4,w>>>=4),(w&3)==0&&(S+=2,w>>>=2),(w&1)==0&&S++,S},n.prototype.bitLength=function(){var b=this.words[this.length-1],w=this._countBits(b);return(this.length-1)*26+w};function d(O){for(var b=new Array(O.bitLength()),w=0;w<b.length;w++){var S=w/26|0,C=w%26;b[w]=(O.words[S]&1<<C)>>>C}return b}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,w=0;w<this.length;w++){var S=this._zeroBits(this.words[w]);if(b+=S,S!==26)break}return b},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(b){return this.negative!==0?this.abs().inotn(b).iaddn(1):this.clone()},n.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var w=0;w<b.length;w++)this.words[w]=this.words[w]|b.words[w];return this.strip()},n.prototype.ior=function(b){return t((this.negative|b.negative)==0),this.iuor(b)},n.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},n.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},n.prototype.iuand=function(b){var w;this.length>b.length?w=b:w=this;for(var S=0;S<w.length;S++)this.words[S]=this.words[S]&b.words[S];return this.length=w.length,this.strip()},n.prototype.iand=function(b){return t((this.negative|b.negative)==0),this.iuand(b)},n.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},n.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},n.prototype.iuxor=function(b){var w,S;this.length>b.length?(w=this,S=b):(w=b,S=this);for(var C=0;C<S.length;C++)this.words[C]=w.words[C]^S.words[C];if(this!==w)for(;C<w.length;C++)this.words[C]=w.words[C];return this.length=w.length,this.strip()},n.prototype.ixor=function(b){return t((this.negative|b.negative)==0),this.iuxor(b)},n.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},n.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},n.prototype.inotn=function(b){t(typeof b=="number"&&b>=0);var w=Math.ceil(b/26)|0,S=b%26;this._expand(w),S>0&&w--;for(var C=0;C<w;C++)this.words[C]=~this.words[C]&67108863;return S>0&&(this.words[C]=~this.words[C]&67108863>>26-S),this.strip()},n.prototype.notn=function(b){return this.clone().inotn(b)},n.prototype.setn=function(b,w){t(typeof b=="number"&&b>=0);var S=b/26|0,C=b%26;return this._expand(S+1),w?this.words[S]=this.words[S]|1<<C:this.words[S]=this.words[S]&~(1<<C),this.strip()},n.prototype.iadd=function(b){var w;if(this.negative!==0&&b.negative===0)return this.negative=0,w=this.isub(b),this.negative^=1,this._normSign();if(this.negative===0&&b.negative!==0)return b.negative=0,w=this.isub(b),b.negative=1,w._normSign();var S,C;this.length>b.length?(S=this,C=b):(S=b,C=this);for(var B=0,G=0;G<C.length;G++)w=(S.words[G]|0)+(C.words[G]|0)+B,this.words[G]=w&67108863,B=w>>>26;for(;B!==0&&G<S.length;G++)w=(S.words[G]|0)+B,this.words[G]=w&67108863,B=w>>>26;if(this.length=S.length,B!==0)this.words[this.length]=B,this.length++;else if(S!==this)for(;G<S.length;G++)this.words[G]=S.words[G];return this},n.prototype.add=function(b){var w;return b.negative!==0&&this.negative===0?(b.negative=0,w=this.sub(b),b.negative^=1,w):b.negative===0&&this.negative!==0?(this.negative=0,w=b.sub(this),this.negative=1,w):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},n.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var w=this.iadd(b);return b.negative=1,w._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var S=this.cmp(b);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;var C,B;S>0?(C=this,B=b):(C=b,B=this);for(var G=0,F=0;F<B.length;F++)w=(C.words[F]|0)-(B.words[F]|0)+G,G=w>>26,this.words[F]=w&67108863;for(;G!==0&&F<C.length;F++)w=(C.words[F]|0)+G,G=w>>26,this.words[F]=w&67108863;if(G===0&&F<C.length&&C!==this)for(;F<C.length;F++)this.words[F]=C.words[F];return this.length=Math.max(this.length,F),C!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(b){return this.clone().isub(b)};function y(O,b,w){w.negative=b.negative^O.negative;var S=O.length+b.length|0;w.length=S,S=S-1|0;var C=O.words[0]|0,B=b.words[0]|0,G=C*B,F=G&67108863,N=G/67108864|0;w.words[0]=F;for(var v=1;v<S;v++){for(var D=N>>>26,ae=N&67108863,W=Math.min(v,b.length-1),ne=Math.max(0,v-O.length+1);ne<=W;ne++){var oe=v-ne|0;C=O.words[oe]|0,B=b.words[ne]|0,G=C*B+ae,D+=G/67108864|0,ae=G&67108863}w.words[v]=ae|0,N=D|0}return N!==0?w.words[v]=N|0:w.length--,w.strip()}var g=function(b,w,S){var C=b.words,B=w.words,G=S.words,F=0,N,v,D,ae=C[0]|0,W=ae&8191,ne=ae>>>13,oe=C[1]|0,de=oe&8191,pe=oe>>>13,_e=C[2]|0,P=_e&8191,U=_e>>>13,H=C[3]|0,J=H&8191,x=H>>>13,L=C[4]|0,K=L&8191,k=L>>>13,Y=C[5]|0,ee=Y&8191,Z=Y>>>13,ce=C[6]|0,ge=ce&8191,be=ce>>>13,Ke=C[7]|0,Te=Ke&8191,je=Ke>>>13,Je=C[8]|0,ze=Je&8191,Ve=Je>>>13,dt=C[9]|0,Vt=dt&8191,Jt=dt>>>13,yn=B[0]|0,Ut=yn&8191,Et=yn>>>13,ri=B[1]|0,it=ri&8191,xr=ri>>>13,_m=B[2]|0,Tr=_m&8191,Rr=_m>>>13,Em=B[3]|0,Pr=Em&8191,Cr=Em>>>13,Sm=B[4]|0,Or=Sm&8191,qr=Sm>>>13,Am=B[5]|0,kr=Am&8191,Br=Am>>>13,xm=B[6]|0,Nr=xm&8191,Dr=xm>>>13,Im=B[7]|0,Mr=Im&8191,Lr=Im>>>13,Tm=B[8]|0,Ur=Tm&8191,Fr=Tm>>>13,Rm=B[9]|0,Kr=Rm&8191,Zt=Rm>>>13;S.negative=b.negative^w.negative,S.length=19,N=Math.imul(W,Ut),v=Math.imul(W,Et),v=v+Math.imul(ne,Ut)|0,D=Math.imul(ne,Et);var nh=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(nh>>>26)|0,nh&=67108863,N=Math.imul(de,Ut),v=Math.imul(de,Et),v=v+Math.imul(pe,Ut)|0,D=Math.imul(pe,Et),N=N+Math.imul(W,it)|0,v=v+Math.imul(W,xr)|0,v=v+Math.imul(ne,it)|0,D=D+Math.imul(ne,xr)|0;var P0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(P0>>>26)|0,P0&=67108863,N=Math.imul(P,Ut),v=Math.imul(P,Et),v=v+Math.imul(U,Ut)|0,D=Math.imul(U,Et),N=N+Math.imul(de,it)|0,v=v+Math.imul(de,xr)|0,v=v+Math.imul(pe,it)|0,D=D+Math.imul(pe,xr)|0,N=N+Math.imul(W,Tr)|0,v=v+Math.imul(W,Rr)|0,v=v+Math.imul(ne,Tr)|0,D=D+Math.imul(ne,Rr)|0;var C0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(C0>>>26)|0,C0&=67108863,N=Math.imul(J,Ut),v=Math.imul(J,Et),v=v+Math.imul(x,Ut)|0,D=Math.imul(x,Et),N=N+Math.imul(P,it)|0,v=v+Math.imul(P,xr)|0,v=v+Math.imul(U,it)|0,D=D+Math.imul(U,xr)|0,N=N+Math.imul(de,Tr)|0,v=v+Math.imul(de,Rr)|0,v=v+Math.imul(pe,Tr)|0,D=D+Math.imul(pe,Rr)|0,N=N+Math.imul(W,Pr)|0,v=v+Math.imul(W,Cr)|0,v=v+Math.imul(ne,Pr)|0,D=D+Math.imul(ne,Cr)|0;var O0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(O0>>>26)|0,O0&=67108863,N=Math.imul(K,Ut),v=Math.imul(K,Et),v=v+Math.imul(k,Ut)|0,D=Math.imul(k,Et),N=N+Math.imul(J,it)|0,v=v+Math.imul(J,xr)|0,v=v+Math.imul(x,it)|0,D=D+Math.imul(x,xr)|0,N=N+Math.imul(P,Tr)|0,v=v+Math.imul(P,Rr)|0,v=v+Math.imul(U,Tr)|0,D=D+Math.imul(U,Rr)|0,N=N+Math.imul(de,Pr)|0,v=v+Math.imul(de,Cr)|0,v=v+Math.imul(pe,Pr)|0,D=D+Math.imul(pe,Cr)|0,N=N+Math.imul(W,Or)|0,v=v+Math.imul(W,qr)|0,v=v+Math.imul(ne,Or)|0,D=D+Math.imul(ne,qr)|0;var q0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(q0>>>26)|0,q0&=67108863,N=Math.imul(ee,Ut),v=Math.imul(ee,Et),v=v+Math.imul(Z,Ut)|0,D=Math.imul(Z,Et),N=N+Math.imul(K,it)|0,v=v+Math.imul(K,xr)|0,v=v+Math.imul(k,it)|0,D=D+Math.imul(k,xr)|0,N=N+Math.imul(J,Tr)|0,v=v+Math.imul(J,Rr)|0,v=v+Math.imul(x,Tr)|0,D=D+Math.imul(x,Rr)|0,N=N+Math.imul(P,Pr)|0,v=v+Math.imul(P,Cr)|0,v=v+Math.imul(U,Pr)|0,D=D+Math.imul(U,Cr)|0,N=N+Math.imul(de,Or)|0,v=v+Math.imul(de,qr)|0,v=v+Math.imul(pe,Or)|0,D=D+Math.imul(pe,qr)|0,N=N+Math.imul(W,kr)|0,v=v+Math.imul(W,Br)|0,v=v+Math.imul(ne,kr)|0,D=D+Math.imul(ne,Br)|0;var k0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(k0>>>26)|0,k0&=67108863,N=Math.imul(ge,Ut),v=Math.imul(ge,Et),v=v+Math.imul(be,Ut)|0,D=Math.imul(be,Et),N=N+Math.imul(ee,it)|0,v=v+Math.imul(ee,xr)|0,v=v+Math.imul(Z,it)|0,D=D+Math.imul(Z,xr)|0,N=N+Math.imul(K,Tr)|0,v=v+Math.imul(K,Rr)|0,v=v+Math.imul(k,Tr)|0,D=D+Math.imul(k,Rr)|0,N=N+Math.imul(J,Pr)|0,v=v+Math.imul(J,Cr)|0,v=v+Math.imul(x,Pr)|0,D=D+Math.imul(x,Cr)|0,N=N+Math.imul(P,Or)|0,v=v+Math.imul(P,qr)|0,v=v+Math.imul(U,Or)|0,D=D+Math.imul(U,qr)|0,N=N+Math.imul(de,kr)|0,v=v+Math.imul(de,Br)|0,v=v+Math.imul(pe,kr)|0,D=D+Math.imul(pe,Br)|0,N=N+Math.imul(W,Nr)|0,v=v+Math.imul(W,Dr)|0,v=v+Math.imul(ne,Nr)|0,D=D+Math.imul(ne,Dr)|0;var Xs=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(Xs>>>26)|0,Xs&=67108863,N=Math.imul(Te,Ut),v=Math.imul(Te,Et),v=v+Math.imul(je,Ut)|0,D=Math.imul(je,Et),N=N+Math.imul(ge,it)|0,v=v+Math.imul(ge,xr)|0,v=v+Math.imul(be,it)|0,D=D+Math.imul(be,xr)|0,N=N+Math.imul(ee,Tr)|0,v=v+Math.imul(ee,Rr)|0,v=v+Math.imul(Z,Tr)|0,D=D+Math.imul(Z,Rr)|0,N=N+Math.imul(K,Pr)|0,v=v+Math.imul(K,Cr)|0,v=v+Math.imul(k,Pr)|0,D=D+Math.imul(k,Cr)|0,N=N+Math.imul(J,Or)|0,v=v+Math.imul(J,qr)|0,v=v+Math.imul(x,Or)|0,D=D+Math.imul(x,qr)|0,N=N+Math.imul(P,kr)|0,v=v+Math.imul(P,Br)|0,v=v+Math.imul(U,kr)|0,D=D+Math.imul(U,Br)|0,N=N+Math.imul(de,Nr)|0,v=v+Math.imul(de,Dr)|0,v=v+Math.imul(pe,Nr)|0,D=D+Math.imul(pe,Dr)|0,N=N+Math.imul(W,Mr)|0,v=v+Math.imul(W,Lr)|0,v=v+Math.imul(ne,Mr)|0,D=D+Math.imul(ne,Lr)|0;var B0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(B0>>>26)|0,B0&=67108863,N=Math.imul(ze,Ut),v=Math.imul(ze,Et),v=v+Math.imul(Ve,Ut)|0,D=Math.imul(Ve,Et),N=N+Math.imul(Te,it)|0,v=v+Math.imul(Te,xr)|0,v=v+Math.imul(je,it)|0,D=D+Math.imul(je,xr)|0,N=N+Math.imul(ge,Tr)|0,v=v+Math.imul(ge,Rr)|0,v=v+Math.imul(be,Tr)|0,D=D+Math.imul(be,Rr)|0,N=N+Math.imul(ee,Pr)|0,v=v+Math.imul(ee,Cr)|0,v=v+Math.imul(Z,Pr)|0,D=D+Math.imul(Z,Cr)|0,N=N+Math.imul(K,Or)|0,v=v+Math.imul(K,qr)|0,v=v+Math.imul(k,Or)|0,D=D+Math.imul(k,qr)|0,N=N+Math.imul(J,kr)|0,v=v+Math.imul(J,Br)|0,v=v+Math.imul(x,kr)|0,D=D+Math.imul(x,Br)|0,N=N+Math.imul(P,Nr)|0,v=v+Math.imul(P,Dr)|0,v=v+Math.imul(U,Nr)|0,D=D+Math.imul(U,Dr)|0,N=N+Math.imul(de,Mr)|0,v=v+Math.imul(de,Lr)|0,v=v+Math.imul(pe,Mr)|0,D=D+Math.imul(pe,Lr)|0,N=N+Math.imul(W,Ur)|0,v=v+Math.imul(W,Fr)|0,v=v+Math.imul(ne,Ur)|0,D=D+Math.imul(ne,Fr)|0;var N0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(N0>>>26)|0,N0&=67108863,N=Math.imul(Vt,Ut),v=Math.imul(Vt,Et),v=v+Math.imul(Jt,Ut)|0,D=Math.imul(Jt,Et),N=N+Math.imul(ze,it)|0,v=v+Math.imul(ze,xr)|0,v=v+Math.imul(Ve,it)|0,D=D+Math.imul(Ve,xr)|0,N=N+Math.imul(Te,Tr)|0,v=v+Math.imul(Te,Rr)|0,v=v+Math.imul(je,Tr)|0,D=D+Math.imul(je,Rr)|0,N=N+Math.imul(ge,Pr)|0,v=v+Math.imul(ge,Cr)|0,v=v+Math.imul(be,Pr)|0,D=D+Math.imul(be,Cr)|0,N=N+Math.imul(ee,Or)|0,v=v+Math.imul(ee,qr)|0,v=v+Math.imul(Z,Or)|0,D=D+Math.imul(Z,qr)|0,N=N+Math.imul(K,kr)|0,v=v+Math.imul(K,Br)|0,v=v+Math.imul(k,kr)|0,D=D+Math.imul(k,Br)|0,N=N+Math.imul(J,Nr)|0,v=v+Math.imul(J,Dr)|0,v=v+Math.imul(x,Nr)|0,D=D+Math.imul(x,Dr)|0,N=N+Math.imul(P,Mr)|0,v=v+Math.imul(P,Lr)|0,v=v+Math.imul(U,Mr)|0,D=D+Math.imul(U,Lr)|0,N=N+Math.imul(de,Ur)|0,v=v+Math.imul(de,Fr)|0,v=v+Math.imul(pe,Ur)|0,D=D+Math.imul(pe,Fr)|0,N=N+Math.imul(W,Kr)|0,v=v+Math.imul(W,Zt)|0,v=v+Math.imul(ne,Kr)|0,D=D+Math.imul(ne,Zt)|0;var D0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(D0>>>26)|0,D0&=67108863,N=Math.imul(Vt,it),v=Math.imul(Vt,xr),v=v+Math.imul(Jt,it)|0,D=Math.imul(Jt,xr),N=N+Math.imul(ze,Tr)|0,v=v+Math.imul(ze,Rr)|0,v=v+Math.imul(Ve,Tr)|0,D=D+Math.imul(Ve,Rr)|0,N=N+Math.imul(Te,Pr)|0,v=v+Math.imul(Te,Cr)|0,v=v+Math.imul(je,Pr)|0,D=D+Math.imul(je,Cr)|0,N=N+Math.imul(ge,Or)|0,v=v+Math.imul(ge,qr)|0,v=v+Math.imul(be,Or)|0,D=D+Math.imul(be,qr)|0,N=N+Math.imul(ee,kr)|0,v=v+Math.imul(ee,Br)|0,v=v+Math.imul(Z,kr)|0,D=D+Math.imul(Z,Br)|0,N=N+Math.imul(K,Nr)|0,v=v+Math.imul(K,Dr)|0,v=v+Math.imul(k,Nr)|0,D=D+Math.imul(k,Dr)|0,N=N+Math.imul(J,Mr)|0,v=v+Math.imul(J,Lr)|0,v=v+Math.imul(x,Mr)|0,D=D+Math.imul(x,Lr)|0,N=N+Math.imul(P,Ur)|0,v=v+Math.imul(P,Fr)|0,v=v+Math.imul(U,Ur)|0,D=D+Math.imul(U,Fr)|0,N=N+Math.imul(de,Kr)|0,v=v+Math.imul(de,Zt)|0,v=v+Math.imul(pe,Kr)|0,D=D+Math.imul(pe,Zt)|0;var M0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(M0>>>26)|0,M0&=67108863,N=Math.imul(Vt,Tr),v=Math.imul(Vt,Rr),v=v+Math.imul(Jt,Tr)|0,D=Math.imul(Jt,Rr),N=N+Math.imul(ze,Pr)|0,v=v+Math.imul(ze,Cr)|0,v=v+Math.imul(Ve,Pr)|0,D=D+Math.imul(Ve,Cr)|0,N=N+Math.imul(Te,Or)|0,v=v+Math.imul(Te,qr)|0,v=v+Math.imul(je,Or)|0,D=D+Math.imul(je,qr)|0,N=N+Math.imul(ge,kr)|0,v=v+Math.imul(ge,Br)|0,v=v+Math.imul(be,kr)|0,D=D+Math.imul(be,Br)|0,N=N+Math.imul(ee,Nr)|0,v=v+Math.imul(ee,Dr)|0,v=v+Math.imul(Z,Nr)|0,D=D+Math.imul(Z,Dr)|0,N=N+Math.imul(K,Mr)|0,v=v+Math.imul(K,Lr)|0,v=v+Math.imul(k,Mr)|0,D=D+Math.imul(k,Lr)|0,N=N+Math.imul(J,Ur)|0,v=v+Math.imul(J,Fr)|0,v=v+Math.imul(x,Ur)|0,D=D+Math.imul(x,Fr)|0,N=N+Math.imul(P,Kr)|0,v=v+Math.imul(P,Zt)|0,v=v+Math.imul(U,Kr)|0,D=D+Math.imul(U,Zt)|0;var L0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(L0>>>26)|0,L0&=67108863,N=Math.imul(Vt,Pr),v=Math.imul(Vt,Cr),v=v+Math.imul(Jt,Pr)|0,D=Math.imul(Jt,Cr),N=N+Math.imul(ze,Or)|0,v=v+Math.imul(ze,qr)|0,v=v+Math.imul(Ve,Or)|0,D=D+Math.imul(Ve,qr)|0,N=N+Math.imul(Te,kr)|0,v=v+Math.imul(Te,Br)|0,v=v+Math.imul(je,kr)|0,D=D+Math.imul(je,Br)|0,N=N+Math.imul(ge,Nr)|0,v=v+Math.imul(ge,Dr)|0,v=v+Math.imul(be,Nr)|0,D=D+Math.imul(be,Dr)|0,N=N+Math.imul(ee,Mr)|0,v=v+Math.imul(ee,Lr)|0,v=v+Math.imul(Z,Mr)|0,D=D+Math.imul(Z,Lr)|0,N=N+Math.imul(K,Ur)|0,v=v+Math.imul(K,Fr)|0,v=v+Math.imul(k,Ur)|0,D=D+Math.imul(k,Fr)|0,N=N+Math.imul(J,Kr)|0,v=v+Math.imul(J,Zt)|0,v=v+Math.imul(x,Kr)|0,D=D+Math.imul(x,Zt)|0;var U0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(U0>>>26)|0,U0&=67108863,N=Math.imul(Vt,Or),v=Math.imul(Vt,qr),v=v+Math.imul(Jt,Or)|0,D=Math.imul(Jt,qr),N=N+Math.imul(ze,kr)|0,v=v+Math.imul(ze,Br)|0,v=v+Math.imul(Ve,kr)|0,D=D+Math.imul(Ve,Br)|0,N=N+Math.imul(Te,Nr)|0,v=v+Math.imul(Te,Dr)|0,v=v+Math.imul(je,Nr)|0,D=D+Math.imul(je,Dr)|0,N=N+Math.imul(ge,Mr)|0,v=v+Math.imul(ge,Lr)|0,v=v+Math.imul(be,Mr)|0,D=D+Math.imul(be,Lr)|0,N=N+Math.imul(ee,Ur)|0,v=v+Math.imul(ee,Fr)|0,v=v+Math.imul(Z,Ur)|0,D=D+Math.imul(Z,Fr)|0,N=N+Math.imul(K,Kr)|0,v=v+Math.imul(K,Zt)|0,v=v+Math.imul(k,Kr)|0,D=D+Math.imul(k,Zt)|0;var F0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(F0>>>26)|0,F0&=67108863,N=Math.imul(Vt,kr),v=Math.imul(Vt,Br),v=v+Math.imul(Jt,kr)|0,D=Math.imul(Jt,Br),N=N+Math.imul(ze,Nr)|0,v=v+Math.imul(ze,Dr)|0,v=v+Math.imul(Ve,Nr)|0,D=D+Math.imul(Ve,Dr)|0,N=N+Math.imul(Te,Mr)|0,v=v+Math.imul(Te,Lr)|0,v=v+Math.imul(je,Mr)|0,D=D+Math.imul(je,Lr)|0,N=N+Math.imul(ge,Ur)|0,v=v+Math.imul(ge,Fr)|0,v=v+Math.imul(be,Ur)|0,D=D+Math.imul(be,Fr)|0,N=N+Math.imul(ee,Kr)|0,v=v+Math.imul(ee,Zt)|0,v=v+Math.imul(Z,Kr)|0,D=D+Math.imul(Z,Zt)|0;var K0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(K0>>>26)|0,K0&=67108863,N=Math.imul(Vt,Nr),v=Math.imul(Vt,Dr),v=v+Math.imul(Jt,Nr)|0,D=Math.imul(Jt,Dr),N=N+Math.imul(ze,Mr)|0,v=v+Math.imul(ze,Lr)|0,v=v+Math.imul(Ve,Mr)|0,D=D+Math.imul(Ve,Lr)|0,N=N+Math.imul(Te,Ur)|0,v=v+Math.imul(Te,Fr)|0,v=v+Math.imul(je,Ur)|0,D=D+Math.imul(je,Fr)|0,N=N+Math.imul(ge,Kr)|0,v=v+Math.imul(ge,Zt)|0,v=v+Math.imul(be,Kr)|0,D=D+Math.imul(be,Zt)|0;var j0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(j0>>>26)|0,j0&=67108863,N=Math.imul(Vt,Mr),v=Math.imul(Vt,Lr),v=v+Math.imul(Jt,Mr)|0,D=Math.imul(Jt,Lr),N=N+Math.imul(ze,Ur)|0,v=v+Math.imul(ze,Fr)|0,v=v+Math.imul(Ve,Ur)|0,D=D+Math.imul(Ve,Fr)|0,N=N+Math.imul(Te,Kr)|0,v=v+Math.imul(Te,Zt)|0,v=v+Math.imul(je,Kr)|0,D=D+Math.imul(je,Zt)|0;var gi=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(gi>>>26)|0,gi&=67108863,N=Math.imul(Vt,Ur),v=Math.imul(Vt,Fr),v=v+Math.imul(Jt,Ur)|0,D=Math.imul(Jt,Fr),N=N+Math.imul(ze,Kr)|0,v=v+Math.imul(ze,Zt)|0,v=v+Math.imul(Ve,Kr)|0,D=D+Math.imul(Ve,Zt)|0;var V0=(F+N|0)+((v&8191)<<13)|0;F=(D+(v>>>13)|0)+(V0>>>26)|0,V0&=67108863,N=Math.imul(Vt,Kr),v=Math.imul(Vt,Zt),v=v+Math.imul(Jt,Kr)|0,D=Math.imul(Jt,Zt);var z0=(F+N|0)+((v&8191)<<13)|0;return F=(D+(v>>>13)|0)+(z0>>>26)|0,z0&=67108863,G[0]=nh,G[1]=P0,G[2]=C0,G[3]=O0,G[4]=q0,G[5]=k0,G[6]=Xs,G[7]=B0,G[8]=N0,G[9]=D0,G[10]=M0,G[11]=L0,G[12]=U0,G[13]=F0,G[14]=K0,G[15]=j0,G[16]=gi,G[17]=V0,G[18]=z0,F!==0&&(G[19]=F,S.length++),S};Math.imul||(g=y);function m(O,b,w){w.negative=b.negative^O.negative,w.length=O.length+b.length;for(var S=0,C=0,B=0;B<w.length-1;B++){var G=C;C=0;for(var F=S&67108863,N=Math.min(B,b.length-1),v=Math.max(0,B-O.length+1);v<=N;v++){var D=B-v,ae=O.words[D]|0,W=b.words[v]|0,ne=ae*W,oe=ne&67108863;G=G+(ne/67108864|0)|0,oe=oe+F|0,F=oe&67108863,G=G+(oe>>>26)|0,C+=G>>>26,G&=67108863}w.words[B]=F,S=G,G=C}return S!==0?w.words[B]=S:w.length--,w.strip()}function E(O,b,w){var S=new _;return S.mulp(O,b,w)}n.prototype.mulTo=function(b,w){var S,C=this.length+b.length;return this.length===10&&b.length===10?S=g(this,b,w):C<63?S=y(this,b,w):C<1024?S=m(this,b,w):S=E(this,b,w),S};function _(O,b){this.x=O,this.y=b}_.prototype.makeRBT=function(b){for(var w=new Array(b),S=n.prototype._countBits(b)-1,C=0;C<b;C++)w[C]=this.revBin(C,S,b);return w},_.prototype.revBin=function(b,w,S){if(b===0||b===S-1)return b;for(var C=0,B=0;B<w;B++)C|=(b&1)<<w-B-1,b>>=1;return C},_.prototype.permute=function(b,w,S,C,B,G){for(var F=0;F<G;F++)C[F]=w[b[F]],B[F]=S[b[F]]},_.prototype.transform=function(b,w,S,C,B,G){this.permute(G,b,w,S,C,B);for(var F=1;F<B;F<<=1)for(var N=F<<1,v=Math.cos(2*Math.PI/N),D=Math.sin(2*Math.PI/N),ae=0;ae<B;ae+=N)for(var W=v,ne=D,oe=0;oe<F;oe++){var de=S[ae+oe],pe=C[ae+oe],_e=S[ae+oe+F],P=C[ae+oe+F],U=W*_e-ne*P;P=W*P+ne*_e,_e=U,S[ae+oe]=de+_e,C[ae+oe]=pe+P,S[ae+oe+F]=de-_e,C[ae+oe+F]=pe-P,oe!==N&&(U=v*W-D*ne,ne=v*ne+D*W,W=U)}},_.prototype.guessLen13b=function(b,w){var S=Math.max(w,b)|1,C=S&1,B=0;for(S=S/2|0;S;S=S>>>1)B++;return 1<<B+1+C},_.prototype.conjugate=function(b,w,S){if(!(S<=1))for(var C=0;C<S/2;C++){var B=b[C];b[C]=b[S-C-1],b[S-C-1]=B,B=w[C],w[C]=-w[S-C-1],w[S-C-1]=-B}},_.prototype.normalize13b=function(b,w){for(var S=0,C=0;C<w/2;C++){var B=Math.round(b[2*C+1]/w)*8192+Math.round(b[2*C]/w)+S;b[C]=B&67108863,B<67108864?S=0:S=B/67108864|0}return b},_.prototype.convert13b=function(b,w,S,C){for(var B=0,G=0;G<w;G++)B=B+(b[G]|0),S[2*G]=B&8191,B=B>>>13,S[2*G+1]=B&8191,B=B>>>13;for(G=2*w;G<C;++G)S[G]=0;t(B===0),t((B&~8191)==0)},_.prototype.stub=function(b){for(var w=new Array(b),S=0;S<b;S++)w[S]=0;return w},_.prototype.mulp=function(b,w,S){var C=2*this.guessLen13b(b.length,w.length),B=this.makeRBT(C),G=this.stub(C),F=new Array(C),N=new Array(C),v=new Array(C),D=new Array(C),ae=new Array(C),W=new Array(C),ne=S.words;ne.length=C,this.convert13b(b.words,b.length,F,C),this.convert13b(w.words,w.length,D,C),this.transform(F,G,N,v,C,B),this.transform(D,G,ae,W,C,B);for(var oe=0;oe<C;oe++){var de=N[oe]*ae[oe]-v[oe]*W[oe];v[oe]=N[oe]*W[oe]+v[oe]*ae[oe],N[oe]=de}return this.conjugate(N,v,C),this.transform(N,v,ne,G,C,B),this.conjugate(ne,G,C),this.normalize13b(ne,C),S.negative=b.negative^w.negative,S.length=b.length+w.length,S.strip()},n.prototype.mul=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),this.mulTo(b,w)},n.prototype.mulf=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),E(this,b,w)},n.prototype.imul=function(b){return this.clone().mulTo(b,this)},n.prototype.imuln=function(b){t(typeof b=="number"),t(b<67108864);for(var w=0,S=0;S<this.length;S++){var C=(this.words[S]|0)*b,B=(C&67108863)+(w&67108863);w>>=26,w+=C/67108864|0,w+=B>>>26,this.words[S]=B&67108863}return w!==0&&(this.words[S]=w,this.length++),this},n.prototype.muln=function(b){return this.clone().imuln(b)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(b){var w=d(b);if(w.length===0)return new n(1);for(var S=this,C=0;C<w.length&&w[C]===0;C++,S=S.sqr());if(++C<w.length)for(var B=S.sqr();C<w.length;C++,B=B.sqr())w[C]!==0&&(S=S.mul(B));return S},n.prototype.iushln=function(b){t(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26,C=67108863>>>26-w<<26-w,B;if(w!==0){var G=0;for(B=0;B<this.length;B++){var F=this.words[B]&C,N=(this.words[B]|0)-F<<w;this.words[B]=N|G,G=F>>>26-w}G&&(this.words[B]=G,this.length++)}if(S!==0){for(B=this.length-1;B>=0;B--)this.words[B+S]=this.words[B];for(B=0;B<S;B++)this.words[B]=0;this.length+=S}return this.strip()},n.prototype.ishln=function(b){return t(this.negative===0),this.iushln(b)},n.prototype.iushrn=function(b,w,S){t(typeof b=="number"&&b>=0);var C;w?C=(w-w%26)/26:C=0;var B=b%26,G=Math.min((b-B)/26,this.length),F=67108863^67108863>>>B<<B,N=S;if(C-=G,C=Math.max(0,C),N){for(var v=0;v<G;v++)N.words[v]=this.words[v];N.length=G}if(G!==0)if(this.length>G)for(this.length-=G,v=0;v<this.length;v++)this.words[v]=this.words[v+G];else this.words[0]=0,this.length=1;var D=0;for(v=this.length-1;v>=0&&(D!==0||v>=C);v--){var ae=this.words[v]|0;this.words[v]=D<<26-B|ae>>>B,D=ae&F}return N&&D!==0&&(N.words[N.length++]=D),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(b,w,S){return t(this.negative===0),this.iushrn(b,w,S)},n.prototype.shln=function(b){return this.clone().ishln(b)},n.prototype.ushln=function(b){return this.clone().iushln(b)},n.prototype.shrn=function(b){return this.clone().ishrn(b)},n.prototype.ushrn=function(b){return this.clone().iushrn(b)},n.prototype.testn=function(b){t(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26,C=1<<w;if(this.length<=S)return!1;var B=this.words[S];return!!(B&C)},n.prototype.imaskn=function(b){t(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(w!==0&&S++,this.length=Math.min(S,this.length),w!==0){var C=67108863^67108863>>>w<<w;this.words[this.length-1]&=C}return this.strip()},n.prototype.maskn=function(b){return this.clone().imaskn(b)},n.prototype.iaddn=function(b){return t(typeof b=="number"),t(b<67108864),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(this.words[0]|0)<b?(this.words[0]=b-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},n.prototype._iaddn=function(b){this.words[0]+=b;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},n.prototype.isubn=function(b){if(t(typeof b=="number"),t(b<67108864),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this.strip()},n.prototype.addn=function(b){return this.clone().iaddn(b)},n.prototype.subn=function(b){return this.clone().isubn(b)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(b,w,S){var C=b.length+S,B;this._expand(C);var G,F=0;for(B=0;B<b.length;B++){G=(this.words[B+S]|0)+F;var N=(b.words[B]|0)*w;G-=N&67108863,F=(G>>26)-(N/67108864|0),this.words[B+S]=G&67108863}for(;B<this.length-S;B++)G=(this.words[B+S]|0)+F,F=G>>26,this.words[B+S]=G&67108863;if(F===0)return this.strip();for(t(F===-1),F=0,B=0;B<this.length;B++)G=-(this.words[B]|0)+F,F=G>>26,this.words[B]=G&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(b,w){var S=this.length-b.length,C=this.clone(),B=b,G=B.words[B.length-1]|0,F=this._countBits(G);S=26-F,S!==0&&(B=B.ushln(S),C.iushln(S),G=B.words[B.length-1]|0);var N=C.length-B.length,v;if(w!=="mod"){v=new n(null),v.length=N+1,v.words=new Array(v.length);for(var D=0;D<v.length;D++)v.words[D]=0}var ae=C.clone()._ishlnsubmul(B,1,N);ae.negative===0&&(C=ae,v&&(v.words[N]=1));for(var W=N-1;W>=0;W--){var ne=(C.words[B.length+W]|0)*67108864+(C.words[B.length+W-1]|0);for(ne=Math.min(ne/G|0,67108863),C._ishlnsubmul(B,ne,W);C.negative!==0;)ne--,C.negative=0,C._ishlnsubmul(B,1,W),C.isZero()||(C.negative^=1);v&&(v.words[W]=ne)}return v&&v.strip(),C.strip(),w!=="div"&&S!==0&&C.iushrn(S),{div:v||null,mod:C}},n.prototype.divmod=function(b,w,S){if(t(!b.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var C,B,G;return this.negative!==0&&b.negative===0?(G=this.neg().divmod(b,w),w!=="mod"&&(C=G.div.neg()),w!=="div"&&(B=G.mod.neg(),S&&B.negative!==0&&B.iadd(b)),{div:C,mod:B}):this.negative===0&&b.negative!==0?(G=this.divmod(b.neg(),w),w!=="mod"&&(C=G.div.neg()),{div:C,mod:G.mod}):(this.negative&b.negative)!=0?(G=this.neg().divmod(b.neg(),w),w!=="div"&&(B=G.mod.neg(),S&&B.negative!==0&&B.isub(b)),{div:G.div,mod:B}):b.length>this.length||this.cmp(b)<0?{div:new n(0),mod:this}:b.length===1?w==="div"?{div:this.divn(b.words[0]),mod:null}:w==="mod"?{div:null,mod:new n(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new n(this.modn(b.words[0]))}:this._wordDiv(b,w)},n.prototype.div=function(b){return this.divmod(b,"div",!1).div},n.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},n.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},n.prototype.divRound=function(b){var w=this.divmod(b);if(w.mod.isZero())return w.div;var S=w.div.negative!==0?w.mod.isub(b):w.mod,C=b.ushrn(1),B=b.andln(1),G=S.cmp(C);return G<0||B===1&&G===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},n.prototype.modn=function(b){t(b<=67108863);for(var w=(1<<26)%b,S=0,C=this.length-1;C>=0;C--)S=(w*S+(this.words[C]|0))%b;return S},n.prototype.idivn=function(b){t(b<=67108863);for(var w=0,S=this.length-1;S>=0;S--){var C=(this.words[S]|0)+w*67108864;this.words[S]=C/b|0,w=C%b}return this.strip()},n.prototype.divn=function(b){return this.clone().idivn(b)},n.prototype.egcd=function(b){t(b.negative===0),t(!b.isZero());var w=this,S=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var C=new n(1),B=new n(0),G=new n(0),F=new n(1),N=0;w.isEven()&&S.isEven();)w.iushrn(1),S.iushrn(1),++N;for(var v=S.clone(),D=w.clone();!w.isZero();){for(var ae=0,W=1;(w.words[0]&W)==0&&ae<26;++ae,W<<=1);if(ae>0)for(w.iushrn(ae);ae-- >0;)(C.isOdd()||B.isOdd())&&(C.iadd(v),B.isub(D)),C.iushrn(1),B.iushrn(1);for(var ne=0,oe=1;(S.words[0]&oe)==0&&ne<26;++ne,oe<<=1);if(ne>0)for(S.iushrn(ne);ne-- >0;)(G.isOdd()||F.isOdd())&&(G.iadd(v),F.isub(D)),G.iushrn(1),F.iushrn(1);w.cmp(S)>=0?(w.isub(S),C.isub(G),B.isub(F)):(S.isub(w),G.isub(C),F.isub(B))}return{a:G,b:F,gcd:S.iushln(N)}},n.prototype._invmp=function(b){t(b.negative===0),t(!b.isZero());var w=this,S=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var C=new n(1),B=new n(0),G=S.clone();w.cmpn(1)>0&&S.cmpn(1)>0;){for(var F=0,N=1;(w.words[0]&N)==0&&F<26;++F,N<<=1);if(F>0)for(w.iushrn(F);F-- >0;)C.isOdd()&&C.iadd(G),C.iushrn(1);for(var v=0,D=1;(S.words[0]&D)==0&&v<26;++v,D<<=1);if(v>0)for(S.iushrn(v);v-- >0;)B.isOdd()&&B.iadd(G),B.iushrn(1);w.cmp(S)>=0?(w.isub(S),C.isub(B)):(S.isub(w),B.isub(C))}var ae;return w.cmpn(1)===0?ae=C:ae=B,ae.cmpn(0)<0&&ae.iadd(b),ae},n.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var w=this.clone(),S=b.clone();w.negative=0,S.negative=0;for(var C=0;w.isEven()&&S.isEven();C++)w.iushrn(1),S.iushrn(1);do{for(;w.isEven();)w.iushrn(1);for(;S.isEven();)S.iushrn(1);var B=w.cmp(S);if(B<0){var G=w;w=S,S=G}else if(B===0||S.cmpn(1)===0)break;w.isub(S)}while(!0);return S.iushln(C)},n.prototype.invm=function(b){return this.egcd(b).a.umod(b)},n.prototype.isEven=function(){return(this.words[0]&1)==0},n.prototype.isOdd=function(){return(this.words[0]&1)==1},n.prototype.andln=function(b){return this.words[0]&b},n.prototype.bincn=function(b){t(typeof b=="number");var w=b%26,S=(b-w)/26,C=1<<w;if(this.length<=S)return this._expand(S+1),this.words[S]|=C,this;for(var B=C,G=S;B!==0&&G<this.length;G++){var F=this.words[G]|0;F+=B,B=F>>>26,F&=67108863,this.words[G]=F}return B!==0&&(this.words[G]=B,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(b){var w=b<0;if(this.negative!==0&&!w)return-1;if(this.negative===0&&w)return 1;this.strip();var S;if(this.length>1)S=1;else{w&&(b=-b),t(b<=67108863,"Number is too big");var C=this.words[0]|0;S=C===b?0:C<b?-1:1}return this.negative!==0?-S|0:S},n.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var w=this.ucmp(b);return this.negative!==0?-w|0:w},n.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var w=0,S=this.length-1;S>=0;S--){var C=this.words[S]|0,B=b.words[S]|0;if(C!==B){C<B?w=-1:C>B&&(w=1);break}}return w},n.prototype.gtn=function(b){return this.cmpn(b)===1},n.prototype.gt=function(b){return this.cmp(b)===1},n.prototype.gten=function(b){return this.cmpn(b)>=0},n.prototype.gte=function(b){return this.cmp(b)>=0},n.prototype.ltn=function(b){return this.cmpn(b)===-1},n.prototype.lt=function(b){return this.cmp(b)===-1},n.prototype.lten=function(b){return this.cmpn(b)<=0},n.prototype.lte=function(b){return this.cmp(b)<=0},n.prototype.eqn=function(b){return this.cmpn(b)===0},n.prototype.eq=function(b){return this.cmp(b)===0},n.red=function(b){return new X(b)},n.prototype.toRed=function(b){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(b){return this.red=b,this},n.prototype.forceRed=function(b){return t(!this.red,"Already a number in reduction context"),this._forceRed(b)},n.prototype.redAdd=function(b){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},n.prototype.redIAdd=function(b){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},n.prototype.redSub=function(b){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},n.prototype.redISub=function(b){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},n.prototype.redShl=function(b){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},n.prototype.redMul=function(b){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},n.prototype.redIMul=function(b){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(b){return t(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var T={k256:null,p224:null,p192:null,p25519:null};function q(O,b){this.name=O,this.p=new n(b,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}q.prototype._tmp=function(){var b=new n(null);return b.words=new Array(Math.ceil(this.n/13)),b},q.prototype.ireduce=function(b){var w=b,S;do this.split(w,this.tmp),w=this.imulK(w),w=w.iadd(this.tmp),S=w.bitLength();while(S>this.n);var C=S<this.n?-1:w.ucmp(this.p);return C===0?(w.words[0]=0,w.length=1):C>0?w.isub(this.p):w.strip!==void 0?w.strip():w._strip(),w},q.prototype.split=function(b,w){b.iushrn(this.n,0,w)},q.prototype.imulK=function(b){return b.imul(this.k)};function z(){q.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(z,q),z.prototype.split=function(b,w){for(var S=4194303,C=Math.min(b.length,9),B=0;B<C;B++)w.words[B]=b.words[B];if(w.length=C,b.length<=9){b.words[0]=0,b.length=1;return}var G=b.words[9];for(w.words[w.length++]=G&S,B=10;B<b.length;B++){var F=b.words[B]|0;b.words[B-10]=(F&S)<<4|G>>>22,G=F}G>>>=22,b.words[B-10]=G,G===0&&b.length>10?b.length-=10:b.length-=9},z.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var w=0,S=0;S<b.length;S++){var C=b.words[S]|0;w+=C*977,b.words[S]=w&67108863,w=C*64+(w/67108864|0)}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b};function V(){q.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(V,q);function M(){q.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(M,q);function $(){q.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i($,q),$.prototype.imulK=function(b){for(var w=0,S=0;S<b.length;S++){var C=(b.words[S]|0)*19+w,B=C&67108863;C>>>=26,b.words[S]=B,w=C}return w!==0&&(b.words[b.length++]=w),b},n._prime=function(b){if(T[b])return T[b];var w;if(b==="k256")w=new z;else if(b==="p224")w=new V;else if(b==="p192")w=new M;else if(b==="p25519")w=new $;else throw new Error("Unknown prime "+b);return T[b]=w,w};function X(O){if(typeof O=="string"){var b=n._prime(O);this.m=b.p,this.prime=b}else t(O.gtn(1),"modulus must be greater than 1"),this.m=O,this.prime=null}X.prototype._verify1=function(b){t(b.negative===0,"red works only with positives"),t(b.red,"red works only with red numbers")},X.prototype._verify2=function(b,w){t((b.negative|w.negative)==0,"red works only with positives"),t(b.red&&b.red===w.red,"red works only with red numbers")},X.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},X.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},X.prototype.add=function(b,w){this._verify2(b,w);var S=b.add(w);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},X.prototype.iadd=function(b,w){this._verify2(b,w);var S=b.iadd(w);return S.cmp(this.m)>=0&&S.isub(this.m),S},X.prototype.sub=function(b,w){this._verify2(b,w);var S=b.sub(w);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},X.prototype.isub=function(b,w){this._verify2(b,w);var S=b.isub(w);return S.cmpn(0)<0&&S.iadd(this.m),S},X.prototype.shl=function(b,w){return this._verify1(b),this.imod(b.ushln(w))},X.prototype.imul=function(b,w){return this._verify2(b,w),this.imod(b.imul(w))},X.prototype.mul=function(b,w){return this._verify2(b,w),this.imod(b.mul(w))},X.prototype.isqr=function(b){return this.imul(b,b.clone())},X.prototype.sqr=function(b){return this.mul(b,b)},X.prototype.sqrt=function(b){if(b.isZero())return b.clone();var w=this.m.andln(3);if(t(w%2==1),w===3){var S=this.m.add(new n(1)).iushrn(2);return this.pow(b,S)}for(var C=this.m.subn(1),B=0;!C.isZero()&&C.andln(1)===0;)B++,C.iushrn(1);t(!C.isZero());var G=new n(1).toRed(this),F=G.redNeg(),N=this.m.subn(1).iushrn(1),v=this.m.bitLength();for(v=new n(2*v*v).toRed(this);this.pow(v,N).cmp(F)!==0;)v.redIAdd(F);for(var D=this.pow(v,C),ae=this.pow(b,C.addn(1).iushrn(1)),W=this.pow(b,C),ne=B;W.cmp(G)!==0;){for(var oe=W,de=0;oe.cmp(G)!==0;de++)oe=oe.redSqr();t(de<ne);var pe=this.pow(D,new n(1).iushln(ne-de-1));ae=ae.redMul(pe),D=pe.redSqr(),W=W.redMul(D),ne=de}return ae},X.prototype.invm=function(b){var w=b._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},X.prototype.pow=function(b,w){if(w.isZero())return new n(1).toRed(this);if(w.cmpn(1)===0)return b.clone();var S=4,C=new Array(1<<S);C[0]=new n(1).toRed(this),C[1]=b;for(var B=2;B<C.length;B++)C[B]=this.mul(C[B-1],b);var G=C[0],F=0,N=0,v=w.bitLength()%26;for(v===0&&(v=26),B=w.length-1;B>=0;B--){for(var D=w.words[B],ae=v-1;ae>=0;ae--){var W=D>>ae&1;if(G!==C[0]&&(G=this.sqr(G)),W===0&&F===0){N=0;continue}F<<=1,F|=W,N++,!(N!==S&&(B!==0||ae!==0))&&(G=this.mul(G,C[F]),N=0,F=0)}v=26}return G},X.prototype.convertTo=function(b){var w=b.umod(this.m);return w===b?w.clone():w},X.prototype.convertFrom=function(b){var w=b.clone();return w.red=null,w},n.mont=function(b){return new Q(b)};function Q(O){X.call(this,O),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(Q,X),Q.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},Q.prototype.convertFrom=function(b){var w=this.imod(b.mul(this.rinv));return w.red=null,w},Q.prototype.imul=function(b,w){if(b.isZero()||w.isZero())return b.words[0]=0,b.length=1,b;var S=b.imul(w),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=S.isub(C).iushrn(this.shift),G=B;return B.cmp(this.m)>=0?G=B.isub(this.m):B.cmpn(0)<0&&(G=B.iadd(this.m)),G._forceRed(this)},Q.prototype.mul=function(b,w){if(b.isZero()||w.isZero())return new n(0)._forceRed(this);var S=b.mul(w),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=S.isub(C).iushrn(this.shift),G=B;return B.cmp(this.m)>=0?G=B.isub(this.m):B.cmpn(0)<0&&(G=B.iadd(this.m)),G._forceRed(this)},Q.prototype.invm=function(b){var w=this.imod(b._invmp(this.m).mul(this.r2));return w._forceRed(this)}})(typeof w6=="undefined"||w6,EN)});var hu=p((B2t,AN)=>{u();AN.exports=SN;function SN(r,e){if(!r)throw new Error(e||"Assertion failed")}SN.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)}});var _6=p(TN=>{u();"use strict";var k1=TN;function v5e(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r!="string"){for(var i=0;i<r.length;i++)t[i]=r[i]|0;return t}if(e==="hex"){r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!=0&&(r="0"+r);for(var i=0;i<r.length;i+=2)t.push(parseInt(r[i]+r[i+1],16))}else for(var i=0;i<r.length;i++){var n=r.charCodeAt(i),s=n>>8,o=n&255;s?t.push(s,o):t.push(o)}return t}k1.toArray=v5e;function xN(r){return r.length===1?"0"+r:r}k1.zero2=xN;function IN(r){for(var e="",t=0;t<r.length;t++)e+=xN(r[t].toString(16));return e}k1.toHex=IN;k1.encode=function(e,t){return t==="hex"?IN(e):e}});var Qn=p(RN=>{u();"use strict";var so=RN,w5e=la(),_5e=hu(),B1=_6();so.assert=_5e;so.toArray=B1.toArray;so.zero2=B1.zero2;so.toHex=B1.toHex;so.encode=B1.encode;function E5e(r,e,t){var i=new Array(Math.max(r.bitLength(),t)+1);i.fill(0);for(var n=1<<e+1,s=r.clone(),o=0;o<i.length;o++){var a,c=s.andln(n-1);s.isOdd()?(c>(n>>1)-1?a=(n>>1)-c:a=c,s.isubn(a)):a=0,i[o]=a,s.iushrn(1)}return i}so.getNAF=E5e;function S5e(r,e){var t=[[],[]];r=r.clone(),e=e.clone();for(var i=0,n=0,s;r.cmpn(-i)>0||e.cmpn(-n)>0;){var o=r.andln(3)+i&3,a=e.andln(3)+n&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)==0?c=0:(s=r.andln(7)+i&7,(s===3||s===5)&&a===2?c=-o:c=o),t[0].push(c);var f;(a&1)==0?f=0:(s=e.andln(7)+n&7,(s===3||s===5)&&o===2?f=-a:f=a),t[1].push(f),2*i===c+1&&(i=1-i),2*n===f+1&&(n=1-n),r.iushrn(1),e.iushrn(1)}return t}so.getJSF=S5e;function A5e(r,e,t){var i="_"+e;r.prototype[e]=function(){return this[i]!==void 0?this[i]:this[i]=t.call(this)}}so.cachedProperty=A5e;function x5e(r){return typeof r=="string"?so.toArray(r,"hex"):r}so.parseBytes=x5e;function I5e(r){return new w5e(r,"hex","le")}so.intFromLE=I5e});var x6=p((M2t,A6)=>{u();var E6;A6.exports=function(e){return E6||(E6=new du(null)),E6.generate(e)};function du(r){this.rand=r}A6.exports.Rand=du;du.prototype.generate=function(e){return this._rand(e)};du.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?du.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?du.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:typeof window=="object"&&(du.prototype._rand=function(){throw new Error("Not implemented yet")});else try{if(S6=Ah(),typeof S6.randomBytes!="function")throw new Error("Not supported");du.prototype._rand=function(e){return S6.randomBytes(e)}}catch(r){}var S6});var _y=p((L2t,PN)=>{u();"use strict";var Nl=la(),wy=Qn(),N1=wy.getNAF,T5e=wy.getJSF,D1=wy.assert;function pu(r,e){this.type=r,this.p=new Nl(e.p,16),this.red=e.prime?Nl.red(e.prime):Nl.mont(this.p),this.zero=new Nl(0).toRed(this.red),this.one=new Nl(1).toRed(this.red),this.two=new Nl(2).toRed(this.red),this.n=e.n&&new Nl(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}PN.exports=pu;pu.prototype.point=function(){throw new Error("Not implemented")};pu.prototype.validate=function(){throw new Error("Not implemented")};pu.prototype._fixedNafMul=function(e,t){D1(e.precomputed);var i=e._getDoubles(),n=N1(t,1,this._bitLength),s=(1<<i.step+1)-(i.step%2==0?2:1);s/=3;var o=[],a,c;for(a=0;a<n.length;a+=i.step){c=0;for(var f=a+i.step-1;f>=a;f--)c=(c<<1)+n[f];o.push(c)}for(var l=this.jpoint(null,null,null),h=this.jpoint(null,null,null),d=s;d>0;d--){for(a=0;a<o.length;a++)c=o[a],c===d?h=h.mixedAdd(i.points[a]):c===-d&&(h=h.mixedAdd(i.points[a].neg()));l=l.add(h)}return l.toP()};pu.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=N1(t,i,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var f=0;c>=0&&o[c]===0;c--)f++;if(c>=0&&f++,a=a.dblp(f),c<0)break;var l=o[c];D1(l!==0),e.type==="affine"?l>0?a=a.mixedAdd(s[l-1>>1]):a=a.mixedAdd(s[-l-1>>1].neg()):l>0?a=a.add(s[l-1>>1]):a=a.add(s[-l-1>>1].neg())}return e.type==="affine"?a.toP():a};pu.prototype._wnafMulAdd=function(e,t,i,n,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,f=0,l,h,d;for(l=0;l<n;l++){d=t[l];var y=d._getNAFPoints(e);o[l]=y.wnd,a[l]=y.points}for(l=n-1;l>=1;l-=2){var g=l-1,m=l;if(o[g]!==1||o[m]!==1){c[g]=N1(i[g],o[g],this._bitLength),c[m]=N1(i[m],o[m],this._bitLength),f=Math.max(c[g].length,f),f=Math.max(c[m].length,f);continue}var E=[t[g],null,null,t[m]];t[g].y.cmp(t[m].y)===0?(E[1]=t[g].add(t[m]),E[2]=t[g].toJ().mixedAdd(t[m].neg())):t[g].y.cmp(t[m].y.redNeg())===0?(E[1]=t[g].toJ().mixedAdd(t[m]),E[2]=t[g].add(t[m].neg())):(E[1]=t[g].toJ().mixedAdd(t[m]),E[2]=t[g].toJ().mixedAdd(t[m].neg()));var _=[-3,-1,-5,-7,0,7,5,1,3],T=T5e(i[g],i[m]);for(f=Math.max(T[0].length,f),c[g]=new Array(f),c[m]=new Array(f),h=0;h<f;h++){var q=T[0][h]|0,z=T[1][h]|0;c[g][h]=_[(q+1)*3+(z+1)],c[m][h]=0,a[g]=E}}var V=this.jpoint(null,null,null),M=this._wnafT4;for(l=f;l>=0;l--){for(var $=0;l>=0;){var X=!0;for(h=0;h<n;h++)M[h]=c[h][l]|0,M[h]!==0&&(X=!1);if(!X)break;$++,l--}if(l>=0&&$++,V=V.dblp($),l<0)break;for(h=0;h<n;h++){var Q=M[h];Q!==0&&(Q>0?d=a[h][Q-1>>1]:Q<0&&(d=a[h][-Q-1>>1].neg()),d.type==="affine"?V=V.mixedAdd(d):V=V.add(d))}}for(l=0;l<n;l++)a[l]=null;return s?V:V.toP()};function _s(r,e){this.curve=r,this.type=e,this.precomputed=null}pu.BasePoint=_s;_s.prototype.eq=function(){throw new Error("Not implemented")};_s.prototype.validate=function(){return this.curve.validate(this)};pu.prototype.decodePoint=function(e,t){e=wy.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1==2*i){e[0]===6?D1(e[e.length-1]%2==0):e[0]===7&&D1(e[e.length-1]%2==1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};_s.prototype.encodeCompressed=function(e){return this.encode(e,!0)};_s.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};_s.prototype.encode=function(e,t){return wy.encode(this._encode(t),e)};_s.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};_s.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};_s.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<t;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}};_s.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)t[s]=t[s-1].add(n);return{wnd:e,points:t}};_s.prototype._getBeta=function(){return null};_s.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t}});var Hi=p((U2t,I6)=>{u();typeof Object.create=="function"?I6.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:I6.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}});var ON=p((F2t,CN)=>{u();"use strict";var R5e=Qn(),$r=la(),T6=Hi(),Nh=_y(),P5e=R5e.assert;function Es(r){Nh.call(this,"short",r),this.a=new $r(r.a,16).toRed(this.red),this.b=new $r(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}T6(Es,Nh);CN.exports=Es;Es.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new $r(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(e.lambda)i=new $r(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?i=s[0]:(i=s[1],P5e(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new $r(a.a,16),b:new $r(a.b,16)}}):o=this._getEndoBasis(i),{beta:t,lambda:i,basis:o}}};Es.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:$r.mont(e),i=new $r(2).toRed(t).redInvm(),n=i.redNeg(),s=new $r(3).toRed(t).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]};Es.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new $r(1),o=new $r(0),a=new $r(0),c=new $r(1),f,l,h,d,y,g,m,E=0,_,T;i.cmpn(0)!==0;){var q=n.div(i);_=n.sub(q.mul(i)),T=a.sub(q.mul(s));var z=c.sub(q.mul(o));if(!h&&_.cmp(t)<0)f=m.neg(),l=s,h=_.neg(),d=T;else if(h&&++E==2)break;m=_,n=i,i=_,a=s,s=T,c=o,o=z}y=_.neg(),g=T;var V=h.sqr().add(d.sqr()),M=y.sqr().add(g.sqr());return M.cmp(V)>=0&&(y=f,g=l),h.negative&&(h=h.neg(),d=d.neg()),y.negative&&(y=y.neg(),g=g.neg()),[{a:h,b:d},{a:y,b:g}]};Es.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),c=o.mul(n.a),f=s.mul(i.b),l=o.mul(n.b),h=e.sub(a).sub(c),d=f.add(l).neg();return{k1:h,k2:d}};Es.prototype.pointFromX=function(e,t){e=new $r(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)};Es.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};Es.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(t[o]),c=e[o],f=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),f=f.neg(!0)),n[o*2]=c,n[o*2+1]=f,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var l=this._wnafMulAdd(1,n,s,o*2,i),h=0;h<o*2;h++)n[h]=null,s[h]=null;return l};function Bi(r,e,t,i){Nh.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new $r(e,16),this.y=new $r(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}T6(Bi,Nh.BasePoint);Es.prototype.point=function(e,t,i){return new Bi(this,e,t,i)};Es.prototype.pointFromJSON=function(e,t){return Bi.fromJSON(this,e,t)};Bi.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}};Bi.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Bi.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=t[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n};Bi.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Bi.prototype.isInfinity=function(){return this.inf};Bi.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};Bi.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};Bi.prototype.getX=function(){return this.x.fromRed()};Bi.prototype.getY=function(){return this.y.fromRed()};Bi.prototype.mul=function(e){return e=new $r(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Bi.prototype.mulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};Bi.prototype.jmulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};Bi.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Bi.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t};Bi.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function $i(r,e,t,i){Nh.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new $r(0)):(this.x=new $r(e,16),this.y=new $r(t,16),this.z=new $r(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}T6($i,Nh.BasePoint);Es.prototype.jpoint=function(e,t,i){return new $i(this,e,t,i)};$i.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)};$i.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};$i.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),s=e.x.redMul(i),o=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),c=n.redSub(s),f=o.redSub(a);if(c.cmpn(0)===0)return f.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=c.redSqr(),h=l.redMul(c),d=n.redMul(l),y=f.redSqr().redIAdd(h).redISub(d).redISub(d),g=f.redMul(d.redISub(y)).redISub(o.redMul(h)),m=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(y,g,m)};$i.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),s=this.y,o=e.y.redMul(t).redMul(this.z),a=i.redSub(n),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var f=a.redSqr(),l=f.redMul(a),h=i.redMul(f),d=c.redSqr().redIAdd(l).redISub(h).redISub(h),y=c.redMul(h.redISub(d)).redISub(s.redMul(l)),g=this.z.redMul(a);return this.curve.jpoint(d,y,g)};$i.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,f=c.redSqr().redSqr(),l=a.redAdd(a);for(t=0;t<e;t++){var h=o.redSqr(),d=l.redSqr(),y=d.redSqr(),g=h.redAdd(h).redIAdd(h).redIAdd(n.redMul(f)),m=o.redMul(d),E=g.redSqr().redISub(m.redAdd(m)),_=m.redISub(E),T=g.redMul(_);T=T.redIAdd(T).redISub(y);var q=l.redMul(c);t+1<e&&(f=f.redMul(y)),o=E,c=q,l=T}return this.curve.jpoint(o,l.redMul(s),c)};$i.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};$i.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n),f=c.redSqr().redISub(a).redISub(a),l=o.redIAdd(o);l=l.redIAdd(l),l=l.redIAdd(l),e=f,t=c.redMul(a.redISub(f)).redISub(l),i=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),d=this.y.redSqr(),y=d.redSqr(),g=this.x.redAdd(d).redSqr().redISub(h).redISub(y);g=g.redIAdd(g);var m=h.redAdd(h).redIAdd(h),E=m.redSqr(),_=y.redIAdd(y);_=_.redIAdd(_),_=_.redIAdd(_),e=E.redISub(g).redISub(g),t=m.redMul(g.redISub(e)).redISub(_),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};$i.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),f=c.redSqr().redISub(a).redISub(a);e=f;var l=o.redIAdd(o);l=l.redIAdd(l),l=l.redIAdd(l),t=c.redMul(a.redISub(f)).redISub(l),i=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),d=this.y.redSqr(),y=this.x.redMul(d),g=this.x.redSub(h).redMul(this.x.redAdd(h));g=g.redAdd(g).redIAdd(g);var m=y.redIAdd(y);m=m.redIAdd(m);var E=m.redAdd(m);e=g.redSqr().redISub(E),i=this.y.redAdd(this.z).redSqr().redISub(d).redISub(h);var _=d.redSqr();_=_.redIAdd(_),_=_.redIAdd(_),_=_.redIAdd(_),t=g.redMul(m.redISub(e)).redISub(_)}return this.curve.jpoint(e,t,i)};$i.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=t.redSqr(),a=i.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),f=t.redAdd(t);f=f.redIAdd(f);var l=f.redMul(a),h=c.redSqr().redISub(l.redAdd(l)),d=l.redISub(h),y=a.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=c.redMul(d).redISub(y),m=i.redAdd(i).redMul(n);return this.curve.jpoint(h,g,m)};$i.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),f=n.redIAdd(n);f=f.redIAdd(f),f=f.redIAdd(f),f=f.redIAdd(f);var l=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(f),h=t.redMul(l);h=h.redIAdd(h),h=h.redIAdd(h);var d=this.x.redMul(c).redISub(h);d=d.redIAdd(d),d=d.redIAdd(d);var y=this.y.redMul(l.redMul(f.redISub(l)).redISub(a.redMul(c)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=this.z.redAdd(a).redSqr().redISub(i).redISub(c);return this.curve.jpoint(d,y,g)};$i.prototype.mul=function(e,t){return e=new $r(e,t),this.curve._wnafMul(this,e)};$i.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};$i.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};$i.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};$i.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var BN=p((K2t,kN)=>{u();"use strict";var Dh=la(),qN=Hi(),M1=_y(),C5e=Qn();function Mh(r){M1.call(this,"mont",r),this.a=new Dh(r.a,16).toRed(this.red),this.b=new Dh(r.b,16).toRed(this.red),this.i4=new Dh(4).toRed(this.red).redInvm(),this.two=new Dh(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}qN(Mh,M1);kN.exports=Mh;Mh.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),n=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t),s=n.redSqrt();return s.redSqr().cmp(n)===0};function Ni(r,e,t){M1.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Dh(e,16),this.z=new Dh(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}qN(Ni,M1.BasePoint);Mh.prototype.decodePoint=function(e,t){return this.point(C5e.toArray(e,t),1)};Mh.prototype.point=function(e,t){return new Ni(this,e,t)};Mh.prototype.pointFromJSON=function(e){return Ni.fromJSON(this,e)};Ni.prototype.precompute=function(){};Ni.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Ni.fromJSON=function(e,t){return new Ni(e,t[0],t[1]||e.one)};Ni.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ni.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Ni.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=t.redSub(n),o=t.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};Ni.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Ni.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(i),c=s.redMul(n),f=t.z.redMul(a.redAdd(c).redSqr()),l=t.x.redMul(a.redISub(c).redSqr());return this.curve.point(f,l)};Ni.prototype.mul=function(e){for(var t=e.clone(),i=this,n=this.curve.point(null,null),s=this,o=[];t.cmpn(0)!==0;t.iushrn(1))o.push(t.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};Ni.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Ni.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Ni.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Ni.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Ni.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var MN=p((j2t,DN)=>{u();"use strict";var O5e=Qn(),hc=la(),NN=Hi(),L1=_y(),q5e=O5e.assert;function fa(r){this.twisted=(r.a|0)!=1,this.mOneA=this.twisted&&(r.a|0)==-1,this.extended=this.mOneA,L1.call(this,"edwards",r),this.a=new hc(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new hc(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new hc(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),q5e(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)==1}NN(fa,L1);DN.exports=fa;fa.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};fa.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};fa.prototype.jpoint=function(e,t,i,n){return this.point(e,t,i,n)};fa.prototype.pointFromX=function(e,t){e=new hc(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(t&&!c||!t&&c)&&(a=a.redNeg()),this.point(e,a)};fa.prototype.pointFromY=function(e,t){e=new hc(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)};fa.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),n=t.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return n.cmp(s)===0};function tr(r,e,t,i,n){L1.BasePoint.call(this,r,"projective"),e===null&&t===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new hc(e,16),this.y=new hc(t,16),this.z=i?new hc(i,16):this.curve.one,this.t=n&&new hc(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}NN(tr,L1.BasePoint);fa.prototype.pointFromJSON=function(e){return tr.fromJSON(this,e)};fa.prototype.point=function(e,t,i,n){return new tr(this,e,t,i,n)};tr.fromJSON=function(e,t){return new tr(e,t[0],t[1],t[2])};tr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};tr.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};tr.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=n.redAdd(t),a=o.redSub(i),c=n.redSub(t),f=s.redMul(a),l=o.redMul(c),h=s.redMul(c),d=a.redMul(o);return this.curve.point(f,l,d,h)};tr.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),i=this.y.redSqr(),n,s,o,a,c,f;if(this.curve.twisted){a=this.curve._mulA(t);var l=a.redAdd(i);this.zOne?(n=e.redSub(t).redSub(i).redMul(l.redSub(this.curve.two)),s=l.redMul(a.redSub(i)),o=l.redSqr().redSub(l).redSub(l)):(c=this.z.redSqr(),f=l.redSub(c).redISub(c),n=e.redSub(t).redISub(i).redMul(f),s=l.redMul(a.redSub(i)),o=l.redMul(f))}else a=t.redAdd(i),c=this.curve._mulC(this.z).redSqr(),f=a.redSub(c).redSub(c),n=this.curve._mulC(e.redISub(a)).redMul(f),s=this.curve._mulC(a).redMul(t.redISub(i)),o=a.redMul(f);return this.curve.point(n,s,o)};tr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};tr.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(t),a=s.redSub(n),c=s.redAdd(n),f=i.redAdd(t),l=o.redMul(a),h=c.redMul(f),d=o.redMul(f),y=a.redMul(c);return this.curve.point(l,h,y,d)};tr.prototype._projAdd=function(e){var t=this.z.redMul(e.z),i=t.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(s),a=i.redSub(o),c=i.redAdd(o),f=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),l=t.redMul(a).redMul(f),h,d;return this.curve.twisted?(h=t.redMul(c).redMul(s.redSub(this.curve._mulA(n))),d=a.redMul(c)):(h=t.redMul(c).redMul(s.redSub(n)),d=this.curve._mulC(a).redMul(c)),this.curve.point(l,h,d)};tr.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};tr.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};tr.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)};tr.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)};tr.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};tr.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};tr.prototype.getX=function(){return this.normalize(),this.x.fromRed()};tr.prototype.getY=function(){return this.normalize(),this.y.fromRed()};tr.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};tr.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),this.x.cmp(t)===0)return!0}};tr.prototype.toP=tr.prototype.normalize;tr.prototype.mixedAdd=tr.prototype.add});var R6=p(LN=>{u();"use strict";var U1=LN;U1.base=_y();U1.short=ON();U1.mont=BN();U1.edwards=MN()});var oo=p(Wt=>{u();"use strict";var k5e=hu(),B5e=Hi();Wt.inherits=B5e;function N5e(r,e){return(r.charCodeAt(e)&64512)!=55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)==56320}function D5e(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!=0&&(r="0"+r),n=0;n<r.length;n+=2)t.push(parseInt(r[n]+r[n+1],16))}else for(var i=0,n=0;n<r.length;n++){var s=r.charCodeAt(n);s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):N5e(r,n)?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128)}else for(n=0;n<r.length;n++)t[n]=r[n]|0;return t}Wt.toArray=D5e;function M5e(r){for(var e="",t=0;t<r.length;t++)e+=FN(r[t].toString(16));return e}Wt.toHex=M5e;function UN(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}Wt.htonl=UN;function L5e(r,e){for(var t="",i=0;i<r.length;i++){var n=r[i];e==="little"&&(n=UN(n)),t+=KN(n.toString(16))}return t}Wt.toHex32=L5e;function FN(r){return r.length===1?"0"+r:r}Wt.zero2=FN;function KN(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}Wt.zero8=KN;function U5e(r,e,t,i){var n=t-e;k5e(n%4==0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var c;i==="big"?c=r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3]:c=r[a+3]<<24|r[a+2]<<16|r[a+1]<<8|r[a],s[o]=c>>>0}return s}Wt.join32=U5e;function F5e(r,e){for(var t=new Array(r.length*4),i=0,n=0;i<r.length;i++,n+=4){var s=r[i];e==="big"?(t[n]=s>>>24,t[n+1]=s>>>16&255,t[n+2]=s>>>8&255,t[n+3]=s&255):(t[n+3]=s>>>24,t[n+2]=s>>>16&255,t[n+1]=s>>>8&255,t[n]=s&255)}return t}Wt.split32=F5e;function K5e(r,e){return r>>>e|r<<32-e}Wt.rotr32=K5e;function j5e(r,e){return r<<e|r>>>32-e}Wt.rotl32=j5e;function V5e(r,e){return r+e>>>0}Wt.sum32=V5e;function z5e(r,e,t){return r+e+t>>>0}Wt.sum32_3=z5e;function H5e(r,e,t,i){return r+e+t+i>>>0}Wt.sum32_4=H5e;function $5e(r,e,t,i,n){return r+e+t+i+n>>>0}Wt.sum32_5=$5e;function G5e(r,e,t,i){var n=r[e],s=r[e+1],o=i+s>>>0,a=(o<i?1:0)+t+n;r[e]=a>>>0,r[e+1]=o}Wt.sum64=G5e;function W5e(r,e,t,i){var n=e+i>>>0,s=(n<e?1:0)+r+t;return s>>>0}Wt.sum64_hi=W5e;function Y5e(r,e,t,i){var n=e+i;return n>>>0}Wt.sum64_lo=Y5e;function X5e(r,e,t,i,n,s,o,a){var c=0,f=e;f=f+i>>>0,c+=f<e?1:0,f=f+s>>>0,c+=f<s?1:0,f=f+a>>>0,c+=f<a?1:0;var l=r+t+n+o+c;return l>>>0}Wt.sum64_4_hi=X5e;function Q5e(r,e,t,i,n,s,o,a){var c=e+i+s+a;return c>>>0}Wt.sum64_4_lo=Q5e;function J5e(r,e,t,i,n,s,o,a,c,f){var l=0,h=e;h=h+i>>>0,l+=h<e?1:0,h=h+s>>>0,l+=h<s?1:0,h=h+a>>>0,l+=h<a?1:0,h=h+f>>>0,l+=h<f?1:0;var d=r+t+n+o+c+l;return d>>>0}Wt.sum64_5_hi=J5e;function Z5e(r,e,t,i,n,s,o,a,c,f){var l=e+i+s+a+f;return l>>>0}Wt.sum64_5_lo=Z5e;function eTe(r,e,t){var i=e<<32-t|r>>>t;return i>>>0}Wt.rotr64_hi=eTe;function tTe(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Wt.rotr64_lo=tTe;function rTe(r,e,t){return r>>>t}Wt.shr64_hi=rTe;function iTe(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Wt.shr64_lo=iTe});var Lh=p(VN=>{u();"use strict";var jN=oo(),nTe=hu();function F1(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}VN.BlockHash=F1;F1.prototype.update=function(e,t){if(e=jN.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=jN.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};F1.prototype.digest=function(e){return this.update(this._pad()),nTe(this.pending===null),this._digest(e)};F1.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n}});var P6=p(dc=>{u();"use strict";var sTe=oo(),ha=sTe.rotr32;function oTe(r,e,t,i){if(r===0)return zN(e,t,i);if(r===1||r===3)return $N(e,t,i);if(r===2)return HN(e,t,i)}dc.ft_1=oTe;function zN(r,e,t){return r&e^~r&t}dc.ch32=zN;function HN(r,e,t){return r&e^r&t^e&t}dc.maj32=HN;function $N(r,e,t){return r^e^t}dc.p32=$N;function aTe(r){return ha(r,2)^ha(r,13)^ha(r,22)}dc.s0_256=aTe;function cTe(r){return ha(r,6)^ha(r,11)^ha(r,25)}dc.s1_256=cTe;function uTe(r){return ha(r,7)^ha(r,18)^r>>>3}dc.g0_256=uTe;function lTe(r){return ha(r,17)^ha(r,19)^r>>>10}dc.g1_256=lTe});var YN=p((G2t,WN)=>{u();"use strict";var Uh=oo(),fTe=Lh(),hTe=P6(),C6=Uh.rotl32,Ey=Uh.sum32,dTe=Uh.sum32_5,pTe=hTe.ft_1,GN=fTe.BlockHash,yTe=[1518500249,1859775393,2400959708,3395469782];function da(){if(!(this instanceof da))return new da;GN.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Uh.inherits(da,GN);WN.exports=da;da.blockSize=512;da.outSize=160;da.hmacStrength=80;da.padLength=64;da.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=C6(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],f=this.h[4];for(n=0;n<i.length;n++){var l=~~(n/20),h=dTe(C6(s,5),pTe(l,o,a,c),f,i[n],yTe[l]);f=c,c=a,a=C6(o,30),o=s,s=h}this.h[0]=Ey(this.h[0],s),this.h[1]=Ey(this.h[1],o),this.h[2]=Ey(this.h[2],a),this.h[3]=Ey(this.h[3],c),this.h[4]=Ey(this.h[4],f)};da.prototype._digest=function(e){return e==="hex"?Uh.toHex32(this.h,"big"):Uh.split32(this.h,"big")}});var O6=p((W2t,QN)=>{u();"use strict";var Fh=oo(),gTe=Lh(),Kh=P6(),bTe=hu(),ao=Fh.sum32,mTe=Fh.sum32_4,vTe=Fh.sum32_5,wTe=Kh.ch32,_Te=Kh.maj32,ETe=Kh.s0_256,STe=Kh.s1_256,ATe=Kh.g0_256,xTe=Kh.g1_256,XN=gTe.BlockHash,ITe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function pa(){if(!(this instanceof pa))return new pa;XN.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=ITe,this.W=new Array(64)}Fh.inherits(pa,XN);QN.exports=pa;pa.blockSize=512;pa.outSize=256;pa.hmacStrength=192;pa.padLength=64;pa.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=mTe(xTe(i[n-2]),i[n-7],ATe(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],f=this.h[4],l=this.h[5],h=this.h[6],d=this.h[7];for(bTe(this.k.length===i.length),n=0;n<i.length;n++){var y=vTe(d,STe(f),wTe(f,l,h),this.k[n],i[n]),g=ao(ETe(s),_Te(s,o,a));d=h,h=l,l=f,f=ao(c,y),c=a,a=o,o=s,s=ao(y,g)}this.h[0]=ao(this.h[0],s),this.h[1]=ao(this.h[1],o),this.h[2]=ao(this.h[2],a),this.h[3]=ao(this.h[3],c),this.h[4]=ao(this.h[4],f),this.h[5]=ao(this.h[5],l),this.h[6]=ao(this.h[6],h),this.h[7]=ao(this.h[7],d)};pa.prototype._digest=function(e){return e==="hex"?Fh.toHex32(this.h,"big"):Fh.split32(this.h,"big")}});var eD=p((Y2t,ZN)=>{u();"use strict";var q6=oo(),JN=O6();function pc(){if(!(this instanceof pc))return new pc;JN.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}q6.inherits(pc,JN);ZN.exports=pc;pc.blockSize=512;pc.outSize=224;pc.hmacStrength=192;pc.padLength=64;pc.prototype._digest=function(e){return e==="hex"?q6.toHex32(this.h.slice(0,7),"big"):q6.split32(this.h.slice(0,7),"big")}});var N6=p((X2t,nD)=>{u();"use strict";var Nn=oo(),TTe=Lh(),RTe=hu(),ya=Nn.rotr64_hi,ga=Nn.rotr64_lo,tD=Nn.shr64_hi,rD=Nn.shr64_lo,yu=Nn.sum64,k6=Nn.sum64_hi,B6=Nn.sum64_lo,PTe=Nn.sum64_4_hi,CTe=Nn.sum64_4_lo,OTe=Nn.sum64_5_hi,qTe=Nn.sum64_5_lo,iD=TTe.BlockHash,kTe=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function co(){if(!(this instanceof co))return new co;iD.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=kTe,this.W=new Array(160)}Nn.inherits(co,iD);nD.exports=co;co.blockSize=1024;co.outSize=512;co.hmacStrength=192;co.padLength=128;co.prototype._prepareBlock=function(e,t){for(var i=this.W,n=0;n<32;n++)i[n]=e[t+n];for(;n<i.length;n+=2){var s=zTe(i[n-4],i[n-3]),o=HTe(i[n-4],i[n-3]),a=i[n-14],c=i[n-13],f=jTe(i[n-30],i[n-29]),l=VTe(i[n-30],i[n-29]),h=i[n-32],d=i[n-31];i[n]=PTe(s,o,a,c,f,l,h,d),i[n+1]=CTe(s,o,a,c,f,l,h,d)}};co.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],f=this.h[5],l=this.h[6],h=this.h[7],d=this.h[8],y=this.h[9],g=this.h[10],m=this.h[11],E=this.h[12],_=this.h[13],T=this.h[14],q=this.h[15];RTe(this.k.length===i.length);for(var z=0;z<i.length;z+=2){var V=T,M=q,$=FTe(d,y),X=KTe(d,y),Q=BTe(d,y,g,m,E,_),O=NTe(d,y,g,m,E,_),b=this.k[z],w=this.k[z+1],S=i[z],C=i[z+1],B=OTe(V,M,$,X,Q,O,b,w,S,C),G=qTe(V,M,$,X,Q,O,b,w,S,C);V=LTe(n,s),M=UTe(n,s),$=DTe(n,s,o,a,c,f),X=MTe(n,s,o,a,c,f);var F=k6(V,M,$,X),N=B6(V,M,$,X);T=E,q=_,E=g,_=m,g=d,m=y,d=k6(l,h,B,G),y=B6(h,h,B,G),l=c,h=f,c=o,f=a,o=n,a=s,n=k6(B,G,F,N),s=B6(B,G,F,N)}yu(this.h,0,n,s),yu(this.h,2,o,a),yu(this.h,4,c,f),yu(this.h,6,l,h),yu(this.h,8,d,y),yu(this.h,10,g,m),yu(this.h,12,E,_),yu(this.h,14,T,q)};co.prototype._digest=function(e){return e==="hex"?Nn.toHex32(this.h,"big"):Nn.split32(this.h,"big")};function BTe(r,e,t,i,n){var s=r&t^~r&n;return s<0&&(s+=4294967296),s}function NTe(r,e,t,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function DTe(r,e,t,i,n){var s=r&t^r&n^t&n;return s<0&&(s+=4294967296),s}function MTe(r,e,t,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function LTe(r,e){var t=ya(r,e,28),i=ya(e,r,2),n=ya(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function UTe(r,e){var t=ga(r,e,28),i=ga(e,r,2),n=ga(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function FTe(r,e){var t=ya(r,e,14),i=ya(r,e,18),n=ya(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function KTe(r,e){var t=ga(r,e,14),i=ga(r,e,18),n=ga(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function jTe(r,e){var t=ya(r,e,1),i=ya(r,e,8),n=tD(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function VTe(r,e){var t=ga(r,e,1),i=ga(r,e,8),n=rD(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function zTe(r,e){var t=ya(r,e,19),i=ya(e,r,29),n=tD(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}function HTe(r,e){var t=ga(r,e,19),i=ga(e,r,29),n=rD(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}});var aD=p((Q2t,oD)=>{u();"use strict";var D6=oo(),sD=N6();function yc(){if(!(this instanceof yc))return new yc;sD.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}D6.inherits(yc,sD);oD.exports=yc;yc.blockSize=1024;yc.outSize=384;yc.hmacStrength=192;yc.padLength=128;yc.prototype._digest=function(e){return e==="hex"?D6.toHex32(this.h.slice(0,12),"big"):D6.split32(this.h.slice(0,12),"big")}});var cD=p(jh=>{u();"use strict";jh.sha1=YN();jh.sha224=eD();jh.sha256=O6();jh.sha384=aD();jh.sha512=N6()});var pD=p(dD=>{u();"use strict";var Dl=oo(),$Te=Lh(),K1=Dl.rotl32,uD=Dl.sum32,Sy=Dl.sum32_3,lD=Dl.sum32_4,fD=$Te.BlockHash;function ba(){if(!(this instanceof ba))return new ba;fD.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Dl.inherits(ba,fD);dD.ripemd160=ba;ba.blockSize=512;ba.outSize=160;ba.hmacStrength=192;ba.padLength=64;ba.prototype._update=function(e,t){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=i,f=n,l=s,h=o,d=a,y=0;y<80;y++){var g=uD(K1(lD(i,hD(y,n,s,o),e[YTe[y]+t],GTe(y)),QTe[y]),a);i=a,a=o,o=K1(s,10),s=n,n=g,g=uD(K1(lD(c,hD(79-y,f,l,h),e[XTe[y]+t],WTe(y)),JTe[y]),d),c=d,d=h,h=K1(l,10),l=f,f=g}g=Sy(this.h[1],s,h),this.h[1]=Sy(this.h[2],o,d),this.h[2]=Sy(this.h[3],a,c),this.h[3]=Sy(this.h[4],i,f),this.h[4]=Sy(this.h[0],n,l),this.h[0]=g};ba.prototype._digest=function(e){return e==="hex"?Dl.toHex32(this.h,"little"):Dl.split32(this.h,"little")};function hD(r,e,t,i){return r<=15?e^t^i:r<=31?e&t|~e&i:r<=47?(e|~t)^i:r<=63?e&i|t&~i:e^(t|~i)}function GTe(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function WTe(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var YTe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],XTe=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],QTe=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],JTe=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]});var gD=p((eEt,yD)=>{u();"use strict";var ZTe=oo(),eRe=hu();function Vh(r,e,t){if(!(this instanceof Vh))return new Vh(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(ZTe.toArray(e,t))}yD.exports=Vh;Vh.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),eRe(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};Vh.prototype.update=function(e,t){return this.inner.update(e,t),this};Vh.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}});var j1=p(bD=>{u();var Gi=bD;Gi.utils=oo();Gi.common=Lh();Gi.sha=cD();Gi.ripemd=pD();Gi.hmac=gD();Gi.sha1=Gi.sha.sha1;Gi.sha256=Gi.sha.sha256;Gi.sha224=Gi.sha.sha224;Gi.sha384=Gi.sha.sha384;Gi.sha512=Gi.sha.sha512;Gi.ripemd160=Gi.ripemd.ripemd160});var vD=p((rEt,mD)=>{u();mD.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var V1=p(ED=>{u();"use strict";var M6=ED,gu=j1(),L6=R6(),tRe=Qn(),wD=tRe.assert;function _D(r){r.type==="short"?this.curve=new L6.short(r):r.type==="edwards"?this.curve=new L6.edwards(r):this.curve=new L6.mont(r),this.g=this.curve.g,this.n=this.curve.n,this.hash=r.hash,wD(this.g.validate(),"Invalid curve"),wD(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}M6.PresetCurve=_D;function bu(r,e){Object.defineProperty(M6,r,{configurable:!0,enumerable:!0,get:function(){var t=new _D(e);return Object.defineProperty(M6,r,{configurable:!0,enumerable:!0,value:t}),t}})}bu("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:gu.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});bu("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:gu.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});bu("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:gu.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});bu("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:gu.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});bu("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:gu.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});bu("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:gu.sha256,gRed:!1,g:["9"]});bu("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:gu.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var U6;try{U6=vD()}catch(r){U6=void 0}bu("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:gu.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",U6]})});var xD=p((nEt,AD)=>{u();"use strict";var rRe=j1(),Ml=_6(),SD=hu();function mu(r){if(!(this instanceof mu))return new mu(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Ml.toArray(r.entropy,r.entropyEnc||"hex"),t=Ml.toArray(r.nonce,r.nonceEnc||"hex"),i=Ml.toArray(r.pers,r.persEnc||"hex");SD(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}AD.exports=mu;mu.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};mu.prototype._hmac=function(){return new rRe.hmac(this.hash,this.K)};mu.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),!!e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};mu.prototype.reseed=function(e,t,i,n){typeof t!="string"&&(n=i,i=t,t=null),e=Ml.toArray(e,t),i=Ml.toArray(i,n),SD(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};mu.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=i,i=t,t=null),i&&(i=Ml.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,Ml.encode(o,t)}});var TD=p((sEt,ID)=>{u();"use strict";var iRe=la(),nRe=Qn(),F6=nRe.assert;function nn(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}ID.exports=nn;nn.fromPublic=function(e,t,i){return t instanceof nn?t:new nn(e,{pub:t,pubEnc:i})};nn.fromPrivate=function(e,t,i){return t instanceof nn?t:new nn(e,{priv:t,privEnc:i})};nn.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};nn.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};nn.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};nn.prototype._importPrivate=function(e,t){this.priv=new iRe(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};nn.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?F6(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&F6(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};nn.prototype.derive=function(e){return e.validate()||F6(e.validate(),"public point not validated"),e.mul(this.priv).getX()};nn.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};nn.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};nn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var CD=p((oEt,PD)=>{u();"use strict";var z1=la(),K6=Qn(),sRe=K6.assert;function H1(r,e){if(r instanceof H1)return r;this._importDER(r,e)||(sRe(r.r&&r.s,"Signature without r or s"),this.r=new z1(r.r,16),this.s=new z1(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}PD.exports=H1;function oRe(){this.place=0}function j6(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=r[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function RD(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}H1.prototype._importDER=function(e,t){e=K6.toArray(e,t);var i=new oRe;if(e[i.place++]!==48)return!1;var n=j6(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=j6(e,i);if(s===!1)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=j6(e,i);if(a===!1||e.length!==a+i.place)return!1;var c=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new z1(o),this.s=new z1(c),this.recoveryParam=null,!0};function V6(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}H1.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=RD(t),i=RD(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];V6(n,t.length),n=n.concat(t),n.push(2),V6(n,i.length);var s=n.concat(i),o=[48];return V6(o,s.length),o=o.concat(s),K6.encode(o,e)}});var BD=p((aEt,kD)=>{u();"use strict";var Ll=la(),OD=xD(),aRe=Qn(),z6=V1(),cRe=x6(),qD=aRe.assert,H6=TD(),$1=CD();function Ss(r){if(!(this instanceof Ss))return new Ss(r);typeof r=="string"&&(qD(Object.prototype.hasOwnProperty.call(z6,r),"Unknown curve "+r),r=z6[r]),r instanceof z6.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}kD.exports=Ss;Ss.prototype.keyPair=function(e){return new H6(this,e)};Ss.prototype.keyFromPrivate=function(e,t){return H6.fromPrivate(this,e,t)};Ss.prototype.keyFromPublic=function(e,t){return H6.fromPublic(this,e,t)};Ss.prototype.genKeyPair=function(e){e||(e={});for(var t=new OD({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||cRe(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new Ll(2));;){var s=new Ll(t.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Ss.prototype._truncateToN=function(e,t){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};Ss.prototype.sign=function(e,t,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new Ll(e,16));for(var s=this.n.byteLength(),o=t.getPrivate().toArray("be",s),a=e.toArray("be",s),c=new OD({hash:this.hash,entropy:o,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),f=this.n.sub(new Ll(1)),l=0;;l++){var h=n.k?n.k(l):new Ll(c.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(f)>=0)){var d=this.g.mul(h);if(!d.isInfinity()){var y=d.getX(),g=y.umod(this.n);if(g.cmpn(0)!==0){var m=h.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));if(m=m.umod(this.n),m.cmpn(0)!==0){var E=(d.getY().isOdd()?1:0)|(y.cmp(g)!==0?2:0);return n.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),E^=1),new $1({r:g,s:m,recoveryParam:E})}}}}}};Ss.prototype.verify=function(e,t,i,n){e=this._truncateToN(new Ll(e,16)),i=this.keyFromPublic(i,n),t=new $1(t,"hex");var s=t.r,o=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(e).umod(this.n),f=a.mul(s).umod(this.n),l;return this.curve._maxwellTrick?(l=this.g.jmulAdd(c,i.getPublic(),f),l.isInfinity()?!1:l.eqXToP(s)):(l=this.g.mulAdd(c,i.getPublic(),f),l.isInfinity()?!1:l.getX().umod(this.n).cmp(s)===0)};Ss.prototype.recoverPubKey=function(r,e,t,i){qD((3&t)===t,"The recovery param is more than two bits"),e=new $1(e,i);var n=this.n,s=new Ll(r),o=e.r,a=e.s,c=t&1,f=t>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&f)throw new Error("Unable to find sencond key candinate");f?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var l=e.r.invm(n),h=n.sub(s).mul(l).umod(n),d=a.mul(l).umod(n);return this.g.mulAdd(h,o,d)};Ss.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new $1(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(r,e,n)}catch(o){continue}if(s.eq(t))return n}throw new Error("Unable to find valid recovery factor")}});var LD=p((cEt,MD)=>{u();"use strict";var Ay=Qn(),ND=Ay.assert,DD=Ay.parseBytes,zh=Ay.cachedProperty;function Di(r,e){this.eddsa=r,this._secret=DD(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=DD(e.pub)}Di.fromPublic=function(e,t){return t instanceof Di?t:new Di(e,{pub:t})};Di.fromSecret=function(e,t){return t instanceof Di?t:new Di(e,{secret:t})};Di.prototype.secret=function(){return this._secret};zh(Di,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});zh(Di,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});zh(Di,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});zh(Di,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});zh(Di,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});zh(Di,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Di.prototype.sign=function(e){return ND(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};Di.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};Di.prototype.getSecret=function(e){return ND(this._secret,"KeyPair is public only"),Ay.encode(this.secret(),e)};Di.prototype.getPublic=function(e){return Ay.encode(this.pubBytes(),e)};MD.exports=Di});var FD=p((uEt,UD)=>{u();"use strict";var uRe=la(),G1=Qn(),lRe=G1.assert,W1=G1.cachedProperty,fRe=G1.parseBytes;function Ul(r,e){this.eddsa=r,typeof e!="object"&&(e=fRe(e)),Array.isArray(e)&&(e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),lRe(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof uRe&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}W1(Ul,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});W1(Ul,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});W1(Ul,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});W1(Ul,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});Ul.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};Ul.prototype.toHex=function(){return G1.encode(this.toBytes(),"hex").toUpperCase()};UD.exports=Ul});var HD=p((lEt,zD)=>{u();"use strict";var hRe=j1(),dRe=V1(),Hh=Qn(),pRe=Hh.assert,KD=Hh.parseBytes,jD=LD(),VD=FD();function Dn(r){if(pRe(r==="ed25519","only tested with ed25519 so far"),!(this instanceof Dn))return new Dn(r);r=dRe[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=hRe.sha512}zD.exports=Dn;Dn.prototype.sign=function(e,t){e=KD(e);var i=this.keyFromSecret(t),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),o=this.encodePoint(s),a=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),c=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};Dn.prototype.verify=function(e,t,i){e=KD(e),t=this.makeSignature(t);var n=this.keyFromPublic(i),s=this.hashInt(t.Rencoded(),n.pubBytes(),e),o=this.g.mul(t.S()),a=t.R().add(n.pub().mul(s));return a.eq(o)};Dn.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return Hh.intFromLE(e.digest()).umod(this.curve.n)};Dn.prototype.keyFromPublic=function(e){return jD.fromPublic(this,e)};Dn.prototype.keyFromSecret=function(e){return jD.fromSecret(this,e)};Dn.prototype.makeSignature=function(e){return e instanceof VD?e:new VD(this,e)};Dn.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};Dn.prototype.decodePoint=function(e){e=Hh.parseBytes(e);var t=e.length-1,i=e.slice(0,t).concat(e[t]&~128),n=(e[t]&128)!=0,s=Hh.intFromLE(i);return this.curve.pointFromY(s,n)};Dn.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Dn.prototype.decodeInt=function(e){return Hh.intFromLE(e)};Dn.prototype.isPoint=function(e){return e instanceof this.pointClass}});var GD=p($D=>{u();"use strict";var Fl=$D;Fl.version=wN().version;Fl.utils=Qn();Fl.rand=x6();Fl.curve=R6();Fl.curves=V1();Fl.ec=BD();Fl.eddsa=HD()});var YD=p((hEt,WD)=>{u();var yRe=GD().ec,ma=new yRe("secp256k1"),St=ma.curve,Yt=St.n.constructor;function gRe(r,e){let t=new Yt(e);if(t.cmp(St.p)>=0)return null;t=t.toRed(St.red);let i=t.redSqr().redIMul(t).redIAdd(St.b).redSqrt();return r===3!==i.isOdd()&&(i=i.redNeg()),ma.keyPair({pub:{x:t,y:i}})}function bRe(r,e,t){let i=new Yt(e),n=new Yt(t);if(i.cmp(St.p)>=0||n.cmp(St.p)>=0||(i=i.toRed(St.red),n=n.toRed(St.red),(r===6||r===7)&&n.isOdd()!==(r===7)))return null;let s=i.redSqr().redIMul(i);return n.redSqr().redISub(s.redIAdd(St.b)).isZero()?ma.keyPair({pub:{x:i,y:n}}):null}function vu(r){let e=r[0];switch(e){case 2:case 3:return r.length!==33?null:gRe(e,r.subarray(1,33));case 4:case 6:case 7:return r.length!==65?null:bRe(e,r.subarray(1,33),r.subarray(33,65));default:return null}}function Kl(r,e){let t=e.encode(null,r.length===33);for(let i=0;i<r.length;++i)r[i]=t[i]}WD.exports={contextRandomize(){return 0},privateKeyVerify(r){let e=new Yt(r);return e.cmp(St.n)<0&&!e.isZero()?0:1},privateKeyNegate(r){let e=new Yt(r),t=St.n.sub(e).umod(St.n).toArrayLike(Uint8Array,"be",32);return r.set(t),0},privateKeyTweakAdd(r,e){let t=new Yt(e);if(t.cmp(St.n)>=0||(t.iadd(new Yt(r)),t.cmp(St.n)>=0&&t.isub(St.n),t.isZero()))return 1;let i=t.toArrayLike(Uint8Array,"be",32);return r.set(i),0},privateKeyTweakMul(r,e){let t=new Yt(e);if(t.cmp(St.n)>=0||t.isZero())return 1;t.imul(new Yt(r)),t.cmp(St.n)>=0&&(t=t.umod(St.n));let i=t.toArrayLike(Uint8Array,"be",32);return r.set(i),0},publicKeyVerify(r){return vu(r)===null?1:0},publicKeyCreate(r,e){let t=new Yt(e);if(t.cmp(St.n)>=0||t.isZero())return 1;let i=ma.keyFromPrivate(e).getPublic();return Kl(r,i),0},publicKeyConvert(r,e){let t=vu(e);if(t===null)return 1;let i=t.getPublic();return Kl(r,i),0},publicKeyNegate(r,e){let t=vu(e);if(t===null)return 1;let i=t.getPublic();return i.y=i.y.redNeg(),Kl(r,i),0},publicKeyCombine(r,e){let t=new Array(e.length);for(let n=0;n<e.length;++n)if(t[n]=vu(e[n]),t[n]===null)return 1;let i=t[0].getPublic();for(let n=1;n<t.length;++n)i=i.add(t[n].pub);return i.isInfinity()?2:(Kl(r,i),0)},publicKeyTweakAdd(r,e,t){let i=vu(e);if(i===null)return 1;if(t=new Yt(t),t.cmp(St.n)>=0)return 2;let n=i.getPublic().add(St.g.mul(t));return n.isInfinity()?2:(Kl(r,n),0)},publicKeyTweakMul(r,e,t){let i=vu(e);if(i===null)return 1;if(t=new Yt(t),t.cmp(St.n)>=0||t.isZero())return 2;let n=i.getPublic().mul(t);return Kl(r,n),0},signatureNormalize(r){let e=new Yt(r.subarray(0,32)),t=new Yt(r.subarray(32,64));return e.cmp(St.n)>=0||t.cmp(St.n)>=0?1:(t.cmp(ma.nh)===1&&r.set(St.n.sub(t).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(r,e){let t=e.subarray(0,32),i=e.subarray(32,64);if(new Yt(t).cmp(St.n)>=0||new Yt(i).cmp(St.n)>=0)return 1;let{output:n}=r,s=n.subarray(4,4+33);s[0]=0,s.set(t,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=n.subarray(6+33,6+33+33);c[0]=0,c.set(i,1);let f=33,l=0;for(;f>1&&c[l]===0&&!(c[l+1]&128);--f,++l);return c=c.subarray(l),c[0]&128||f>1&&c[0]===0&&!(c[1]&128)?1:(r.outputlen=6+o+f,n[0]=48,n[1]=r.outputlen-2,n[2]=2,n[3]=s.length,n.set(s,4),n[4+o]=2,n[5+o]=c.length,n.set(c,6+o),0)},signatureImport(r,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return 1;let i=e[5+t];if(i===0||6+t+i!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||i>1&&e[t+6]===0&&!(e[t+7]&128))return 1;let n=e.subarray(4,4+t);if(n.length===33&&n[0]===0&&(n=n.subarray(1)),n.length>32)return 1;let s=e.subarray(6+t);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new Yt(n);o.cmp(St.n)>=0&&(o=new Yt(0));let a=new Yt(e.subarray(6+t));return a.cmp(St.n)>=0&&(a=new Yt(0)),r.set(o.toArrayLike(Uint8Array,"be",32),0),r.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(r,e,t,i,n){if(n){let a=n;n=c=>{let f=a(e,t,null,i,c);if(!(f instanceof Uint8Array&&f.length===32))throw new Error("This is the way");return new Yt(f)}}let s=new Yt(t);if(s.cmp(St.n)>=0||s.isZero())return 1;let o;try{o=ma.sign(e,t,{canonical:!0,k:n,pers:i})}catch(a){return 1}return r.signature.set(o.r.toArrayLike(Uint8Array,"be",32),0),r.signature.set(o.s.toArrayLike(Uint8Array,"be",32),32),r.recid=o.recoveryParam,0},ecdsaVerify(r,e,t){let i={r:r.subarray(0,32),s:r.subarray(32,64)},n=new Yt(i.r),s=new Yt(i.s);if(n.cmp(St.n)>=0||s.cmp(St.n)>=0)return 1;if(s.cmp(ma.nh)===1||n.isZero()||s.isZero())return 3;let o=vu(t);if(o===null)return 2;let a=o.getPublic();return ma.verify(e,i,a)?0:3},ecdsaRecover(r,e,t,i){let n={r:e.slice(0,32),s:e.slice(32,64)},s=new Yt(n.r),o=new Yt(n.s);if(s.cmp(St.n)>=0||o.cmp(St.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=ma.recoverPubKey(i,n,t)}catch(c){return 2}return Kl(r,a),0},ecdh(r,e,t,i,n,s,o){let a=vu(e);if(a===null)return 1;let c=new Yt(t);if(c.cmp(St.n)>=0||c.isZero())return 2;let f=a.getPublic().mul(c);if(n===void 0){let l=f.encode(null,!0),h=ma.hash().update(l).digest();for(let d=0;d<32;++d)r[d]=h[d]}else{s||(s=new Uint8Array(32));let l=f.getX().toArray("be",32);for(let g=0;g<32;++g)s[g]=l[g];o||(o=new Uint8Array(32));let h=f.getY().toArray("be",32);for(let g=0;g<32;++g)o[g]=h[g];let d=n(s,o,i);if(!(d instanceof Uint8Array&&d.length===r.length))return 2;r.set(d)}return 0}}});var QD=p((dEt,XD)=>{u();XD.exports=vN()(YD())});var eM=p((pEt,ZD)=>{u();"use strict";var uo=QD(),{sha256:JD}=(Hr(),Ir);ZD.exports=r=>{let e=32;function t(){let l;do l=r(32);while(!uo.privateKeyVerify(l));return l}async function i(l,h){let{digest:d}=await JD.digest(h),y=uo.ecdsaSign(d,l);return uo.signatureExport(y.signature)}async function n(l,h,d){let{digest:y}=await JD.digest(d);return h=uo.signatureImport(h),uo.ecdsaVerify(h,y,l)}function s(l){if(!uo.publicKeyVerify(l))throw new Error("Invalid public key");return uo.publicKeyConvert(l,!0)}function o(l){return uo.publicKeyConvert(l,!1)}function a(l){if(!uo.privateKeyVerify(l))throw new Error("Invalid private key")}function c(l){if(!uo.publicKeyVerify(l))throw new Error("Invalid public key")}function f(l){return a(l),uo.publicKeyCreate(l)}return{generateKey:t,privateKeyLength:e,hashAndSign:i,hashAndVerify:n,compressPublicKey:s,decompressPublicKey:o,validatePrivateKey:a,validatePublicKey:c,computePublicKey:f}}});var nM=p((yEt,iM)=>{u();"use strict";var{sha256:tM}=(Hr(),Ir),mRe=ue(),rM=fi(),vRe=Ze(),wRe=T1();iM.exports=(r,e,t)=>{t=t||eM()(e);class i{constructor(f){t.validatePublicKey(f),this._key=f}verify(f,l){return t.hashAndVerify(this._key,l,f)}marshal(){return t.compressPublicKey(this._key)}get bytes(){return r.PublicKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(f){return rM(this.bytes,f.bytes)}async hash(){let{bytes:f}=await tM.digest(this.bytes);return f}}class n{constructor(f,l){this._key=f,this._publicKey=l||t.computePublicKey(f),t.validatePrivateKey(this._key),t.validatePublicKey(this._publicKey)}sign(f){return t.hashAndSign(this._key,f)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return r.PrivateKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(f){return rM(this.bytes,f.bytes)}async hash(){let{bytes:f}=await tM.digest(this.bytes);return f}async id(){let f=await this.public.hash();return vRe(f,"base58btc")}async export(f,l="libp2p-key"){if(l==="libp2p-key")return wRe.export(this.bytes,f);throw mRe(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function o(c){return new i(c)}async function a(){let c=await t.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var oM=p((gEt,sM)=>{u();"use strict";sM.exports={SHA1:20,SHA256:32,SHA512:64}});var $6=p(cM=>{u();"use strict";var aM=dy(),_Re=oM(),ERe={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},SRe=async(r,e)=>{let t=await aM.get().subtle.sign({name:"HMAC"},r,e);return new Uint8Array(t,t.byteOffset,t.byteLength)};cM.create=async function(r,e){let t=ERe[r],i=await aM.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,["sign"]);return{async digest(n){return SRe(i,n)},length:_Re[r]}}});var dM=p((mEt,hM)=>{u();"use strict";var uM=ue(),lM=_n(),ARe=ct(),xRe=$6(),fM={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};hM.exports=async(r,e,t)=>{let i=fM[r];if(!i){let T=Object.keys(fM).join(" / ");throw uM(new Error(`unknown cipher type '${r}'. Must be ${T}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw uM(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,a=ARe("key expansion"),c=2*(s+n+o),f=await xRe.create(e,t),l=await f.digest(a),h=[],d=0;for(;d<c;){let T=await f.digest(lM([l,a])),q=T.length;d+q>c&&(q=c-d),h.push(T),d+=q,l=await f.digest(l)}let y=c/2,g=lM(h),m=g.slice(0,y),E=g.slice(y,c),_=T=>({iv:T.slice(0,s),cipherKey:T.slice(s,s+n),macKey:T.slice(s+n)});return{k1:_(m),k2:_(E)}}});var yM=p((vEt,pM)=>{u();"use strict";var IRe=ue();pM.exports=function(r,e){if(!r.includes(e)){let t=r.join(" / ");throw IRe(new Error(`Unknown curve: ${e}. Must be ${t}`),"ERR_INVALID_CURVE")}}});var _M=p(wM=>{u();"use strict";var TRe=ue(),xy=dy(),{base64urlToBuffer:gM}=I1(),RRe=yM(),G6=Ze(),PRe=_n(),CRe=fi(),bM={"P-256":256,"P-384":384,"P-521":521};wM.generateEphmeralKeyPair=async function(r){RRe(Object.keys(bM),r);let e=await xy.get().subtle.generateKey({name:"ECDH",namedCurve:r},!0,["deriveBits"]),t=async(n,s)=>{let o;s?o=await xy.get().subtle.importKey("jwk",qRe(r,s),{name:"ECDH",namedCurve:r},!1,["deriveBits"]):o=e.privateKey;let a=[await xy.get().subtle.importKey("jwk",vM(r,n),{name:"ECDH",namedCurve:r},!1,[]),o],c=await xy.get().subtle.deriveBits({name:"ECDH",namedCurve:r,public:a[0]},a[1],bM[r]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await xy.get().subtle.exportKey("jwk",e.publicKey);return{key:ORe(i),genSharedKey:t}};var mM={"P-256":32,"P-384":48,"P-521":66};function ORe(r){let e=mM[r.crv];return PRe([Uint8Array.from([4]),gM(r.x,e),gM(r.y,e)],1+e*2)}function vM(r,e){let t=mM[r];if(CRe(!e.slice(0,1),Uint8Array.from([4])))throw TRe(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:r,x:G6(e.slice(1,t+1),"base64url"),y:G6(e.slice(1+t),"base64url"),ext:!0}}var qRe=(r,e)=>({...vM(r,e.public),d:G6(e.private,"base64url")})});var SM=p((_Et,EM)=>{u();"use strict";var kRe=_M();EM.exports=async r=>kRe.generateEphmeralKeyPair(r)});var X1=p((EEt,xM)=>{u();"use strict";var va=r1();nc();Q3();var W6=lt(),Iy=ue(),BRe=ct(),NRe=xB(),As={rsa:fN(),ed25519:bN(),secp256k1:nM()(va,gy())},Y1={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function $h(r){let e=As[r.toLowerCase()];if(!e){let t=Object.keys(As).join(" / ");throw Iy(new Error(`invalid or unsupported key type ${r}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var DRe=async(r,e)=>$h(r).generateKeyPair(e),MRe=async(r,e,t)=>{let i=$h(r);if(r.toLowerCase()!=="ed25519")throw Iy(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,t)},LRe=r=>{let e=va.PublicKey.decode(r),t=e.Data;switch(e.Type){case va.KeyType.RSA:return As.rsa.unmarshalRsaPublicKey(t);case va.KeyType.Ed25519:return As.ed25519.unmarshalEd25519PublicKey(t);case va.KeyType.Secp256k1:if(As.secp256k1)return As.secp256k1.unmarshalSecp256k1PublicKey(t);throw Iy(new Error(Y1.message),Y1.code);default:$h(e.Type)}},URe=(r,e)=>(e=(e||"rsa").toLowerCase(),$h(e),r.bytes),AM=async r=>{let e=va.PrivateKey.decode(r),t=e.Data;switch(e.Type){case va.KeyType.RSA:return As.rsa.unmarshalRsaPrivateKey(t);case va.KeyType.Ed25519:return As.ed25519.unmarshalEd25519PrivateKey(t);case va.KeyType.Secp256k1:if(As.secp256k1)return As.secp256k1.unmarshalSecp256k1PrivateKey(t);throw Iy(new Error(Y1.message),Y1.code);default:$h(e.Type)}},FRe=(r,e)=>(e=(e||"rsa").toLowerCase(),$h(e),r.bytes),KRe=async(r,e)=>{try{let n=await NRe.import(r,e);return AM(n)}catch(n){}let t=W6.pki.decryptRsaPrivateKey(r,e);if(t===null)throw Iy(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=W6.asn1.toDer(W6.pki.privateKeyToAsn1(t));return i=BRe(i.getBytes(),"ascii"),As.rsa.unmarshalRsaPrivateKey(i)};xM.exports={supportedKeys:As,keysPBM:va,keyStretcher:dM(),generateEphemeralKeyPair:SM(),generateKeyPair:DRe,generateKeyPairFromSeed:MRe,unmarshalPublicKey:LRe,marshalPublicKey:URe,unmarshalPrivateKey:AM,marshalPrivateKey:FRe,import:KRe}});var Q1=p((SEt,Y6)=>{u();"use strict";function jRe(r,{className:e,symbolName:t}){let i=Symbol.for(t),n={[e]:class extends r{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function VRe(r,{className:e,symbolName:t,withoutNew:i}){let n=Symbol.for(t),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let a=r.call(this,...o)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(r.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}Y6.exports=jRe;Y6.exports.proto=VRe});var RM=p((AEt,TM)=>{u();"use strict";var Gh=Pi(),IM=Gh.Reader,zRe=Gh.Writer,bi=Gh.util,Ty=Gh.roots["libp2p-peer-id"]||(Gh.roots["libp2p-peer-id"]={});Ty.PeerIdProto=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.id=bi.newBuffer([]),r.prototype.pubKey=bi.newBuffer([]),r.prototype.privKey=bi.newBuffer([]),r.encode=function(t,i){return i||(i=zRe.create()),i.uint32(10).bytes(t.id),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(18).bytes(t.pubKey),t.privKey!=null&&Object.hasOwnProperty.call(t,"privKey")&&i.uint32(26).bytes(t.privKey),i},r.decode=function(t,i){t instanceof IM||(t=IM.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ty.PeerIdProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.id=t.bytes();break;case 2:s.pubKey=t.bytes();break;case 3:s.privKey=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw bi.ProtocolError("missing required 'id'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Ty.PeerIdProto)return t;var i=new Ty.PeerIdProto;return t.id!=null&&(typeof t.id=="string"?bi.base64.decode(t.id,i.id=bi.newBuffer(bi.base64.length(t.id)),0):t.id.length&&(i.id=t.id)),t.pubKey!=null&&(typeof t.pubKey=="string"?bi.base64.decode(t.pubKey,i.pubKey=bi.newBuffer(bi.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.privKey!=null&&(typeof t.privKey=="string"?bi.base64.decode(t.privKey,i.privKey=bi.newBuffer(bi.base64.length(t.privKey)),0):t.privKey.length&&(i.privKey=t.privKey)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=bi.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=bi.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=bi.newBuffer(n.privKey)))),t.id!=null&&t.hasOwnProperty("id")&&(n.id=i.bytes===String?bi.base64.encode(t.id,0,t.id.length):i.bytes===Array?Array.prototype.slice.call(t.id):t.id),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?bi.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.privKey!=null&&t.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?bi.base64.encode(t.privKey,0,t.privKey.length):i.bytes===Array?Array.prototype.slice.call(t.privKey):t.privKey),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Gh.util.toJSONOptions)},r}();TM.exports=Ty});var rt=p((sn,DM)=>{u();"use strict";var{CID:X6}=(xe(),Ce),HRe=(en(),Zi),$Re=(p3(),Ym),GRe=(zr(),Vr),WRe=(ty(),mh),{base58btc:Q6}=(zr(),Vr),{base32:YRe}=(en(),Zi),{base16:PM}=(y3(),Xm),Ry=(mn(),bn),wa=X1(),XRe=Q1(),{PeerIdProto:CM}=RM(),jl=fi(),Py=ct(),QRe=Ze(),{identity:J1}=(cc(),aa),OM={...HRe,...$Re,...GRe,...WRe},JRe=Object.keys(OM).reduce((r,e)=>r.or(OM[e]),YRe.decoder),ZRe=112,qM=114,kM=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(t&&i&&!jl(t.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=Q6.encode(this.id).substring(1),this._privKey=t,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=Ry.decode(this.id);e.code===J1.code&&(this._pubKey=wa.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return wa.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return wa.marshalPrivateKey(this.privKey)}marshal(e){return CM.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let t=6;return e.length<t&&(t=e.length),"<peer.ID "+e.substr(0,t)+">"}toJSON(){return{id:this.toB58String(),privKey:NM(this.marshalPrivKey()),pubKey:NM(this.marshalPubKey())}}toHexString(){return PM.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=X6.createV1(qM,Ry.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return jl(this.id,e);if(e.id)return jl(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&jl(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(Ry.decode(this.id).code===J1.code)return!0}catch(e){}return!1}},_a=XRe(kM,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});sn=DM.exports=_a;var Cy=r=>r.bytes.length<=42?Ry.create(J1.code,r.bytes).bytes:r.hash(),J6=async(r,e)=>{let t=await Cy(e);return new _a(t,r,e)};sn.create=async r=>{r=r||{},r.bits=r.bits||2048,r.keyType=r.keyType||"RSA";let e=await wa.generateKeyPair(r.keyType,r.bits);return J6(e,e.public)};sn.createFromHexString=r=>new _a(PM.decode("f"+r));sn.createFromBytes=r=>{try{let e=X6.decode(r);if(!BM(e))throw new Error("Supplied PeerID CID is invalid");return sn.createFromCID(e)}catch{if(Ry.decode(r).code!==J1.code)throw new Error("Supplied PeerID CID is invalid");return new _a(r)}};sn.createFromB58String=r=>sn.createFromBytes(Q6.decode("z"+r));var BM=r=>r.code===qM||r.code===ZRe;sn.createFromCID=r=>{if(r=X6.asCID(r),!r||!BM(r))throw new Error("Supplied PeerID CID is invalid");return new _a(r.multihash.bytes)};sn.createFromPubKey=async r=>{let e=r;if(typeof e=="string"&&(e=Py(r,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let t=await wa.unmarshalPublicKey(e);return J6(void 0,t)};sn.createFromPrivKey=async r=>{if(typeof r=="string"&&(r=Py(r,"base64pad")),!(r instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await wa.unmarshalPrivateKey(r);return J6(e,e.public)};sn.createFromJSON=async r=>{let e=Q6.decode("z"+r.id),t=r.privKey&&Py(r.privKey,"base64pad"),i=r.pubKey&&Py(r.pubKey,"base64pad"),n=i&&await wa.unmarshalPublicKey(i);if(!t)return new _a(e,void 0,n);let s=await wa.unmarshalPrivateKey(t),o=await Cy(s.public),a;if(n&&(a=await Cy(n)),n&&!jl(o,a))throw new Error("Public and private key do not match");if(e&&!jl(o,e))throw new Error("Id and private key do not match");return new _a(e,s,n)};sn.createFromProtobuf=async r=>{typeof r=="string"&&(r=Py(r,"base16"));let{id:e,privKey:t,pubKey:i}=CM.decode(r);t=t?await wa.unmarshalPrivateKey(t):!1,i=i?await wa.unmarshalPublicKey(i):!1;let n,s;if(t&&(s=await Cy(t.public)),i&&(n=await Cy(i)),t){if(i&&!jl(s,n))throw new Error("Public and private key do not match");return new _a(s,t,t.public)}if(i)return new _a(n,void 0,i);if(e)return new _a(e);throw new Error("Protobuf did not contain any usable key material")};sn.parse=r=>((r.charAt(0)==="1"||r.charAt(0)==="Q")&&(r=`z${r}`),sn.createFromBytes(JRe.decode(r)));sn.isPeerId=r=>Boolean(typeof r=="object"&&r._id&&r._idB58String);function NM(r){if(r)return QRe(r,"base64pad")}});var UM=p((xEt,LM)=>{u();"use strict";Sh();var Z1=lt(),Wh=Ze(),MM=ct();LM.exports={createCipheriv:(r,e,t)=>{let i=Z1.cipher.createCipher("AES-CTR",Wh(e,"ascii"));return i.start({iv:Wh(t,"ascii")}),{update:n=>(i.update(Z1.util.createBuffer(Wh(n,"ascii"))),MM(i.output.getBytes(),"ascii"))}},createDecipheriv:(r,e,t)=>{let i=Z1.cipher.createDecipher("AES-CTR",Wh(e,"ascii"));return i.start({iv:Wh(t,"ascii")}),{update:n=>(i.update(Z1.util.createBuffer(Wh(n,"ascii"))),MM(i.output.getBytes(),"ascii"))}}}});var jM=p((IEt,KM)=>{u();"use strict";var e8e=ue(),FM={16:"aes-128-ctr",32:"aes-256-ctr"};KM.exports=function(r){let e=FM[r.length];if(!e){let t=Object.entries(FM).map(([i,n])=>`${i} (${n})`).join(" / ");throw e8e(new Error(`Invalid key length ${r.length} bytes. Must be ${t}`),"ERR_INVALID_KEY_LENGTH")}return e}});var HM=p(zM=>{u();"use strict";var VM=UM(),t8e=jM();zM.create=async function(r,e){let t=t8e(r),i=VM.createCipheriv(t,r,e),n=VM.createDecipheriv(t,r,e);return{async encrypt(o){return i.update(o)},async decrypt(o){return n.update(o)}}}});var WM=p((REt,GM)=>{u();"use strict";var r8e=K3(),i8e=$t(),n8e=ue(),$M={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function s8e(r,e,t,i,n){let s=$M[n];if(!s){let a=Object.keys($M).join(" / ");throw n8e(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=r8e(r,e,t,i,s);return i8e.encode64(o)}GM.exports=s8e});var Ea=p(Yh=>{u();"use strict";var o8e=$6(),a8e=HM(),c8e=X1();Yh.aes=a8e;Yh.hmac=o8e;Yh.keys=c8e;Yh.randomBytes=gy();Yh.pbkdf2=WM()});var eA=p((CEt,XM)=>{u();"use strict";var YM="[a-fA-F\\d:]",wu=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${YM})|(?<=${YM})(?=\\s|$))`:"",lo="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",hi="[a-fA-F\\d]{1,4}",ev=`
(?:
(?:${hi}:){7}(?:${hi}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${hi}:){6}(?:${lo}|:${hi}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${hi}:){5}(?::${lo}|(?::${hi}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${hi}:){4}(?:(?::${hi}){0,1}:${lo}|(?::${hi}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${hi}:){3}(?:(?::${hi}){0,2}:${lo}|(?::${hi}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${hi}:){2}(?:(?::${hi}){0,3}:${lo}|(?::${hi}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${hi}:){1}(?:(?::${hi}){0,4}:${lo}|(?::${hi}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${hi}){0,5}:${lo}|(?::${hi}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),u8e=new RegExp(`(?:^${lo}$)|(?:^${ev}$)`),l8e=new RegExp(`^${lo}$`),f8e=new RegExp(`^${ev}$`),Z6=r=>r&&r.exact?u8e:new RegExp(`(?:${wu(r)}${lo}${wu(r)})|(?:${wu(r)}${ev}${wu(r)})`,"g");Z6.v4=r=>r&&r.exact?l8e:new RegExp(`${wu(r)}${lo}${wu(r)}`,"g");Z6.v6=r=>r&&r.exact?f8e:new RegExp(`${wu(r)}${ev}${wu(r)}`,"g");XM.exports=Z6});var JM=p((OEt,QM)=>{u();"use strict";var tA=eA(),Xh=r=>tA({exact:!0}).test(r);Xh.v4=r=>tA.v4({exact:!0}).test(r);Xh.v6=r=>tA.v6({exact:!0}).test(r);Xh.version=r=>Xh(r)?Xh.v4(r)?4:6:void 0;QM.exports=Xh});var i7=p((qEt,r7)=>{u();"use strict";var rA=JM(),ZM=Ze(),h8e=rA,iA=rA.v4,e7=rA.v6,t7=function(r,e,t){t=~~t;let i;if(iA(r))i=e||new Uint8Array(t+4),r.split(/\./g).map(function(n){i[t++]=parseInt(n,10)&255});else if(e7(r)){let n=r.split(":",8),s;for(s=0;s<n.length;s++){let o=iA(n[s]),a;o&&(a=t7(n[s]),n[s]=ZM(a.slice(0,2),"base16")),a&&++s<8&&n.splice(s,0,ZM(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);let o=[s,"1"];for(s=9-n.length;s>0;s--)o.push("0");n.splice.apply(n,o)}for(i=e||new Uint8Array(t+16),s=0;s<n.length;s++){let o=parseInt(n[s],16);i[t++]=o>>8&255,i[t++]=o&255}}if(!i)throw Error("Invalid ip address: "+r);return i},d8e=function(r,e,t){e=~~e,t=t||r.length-e;let i=[],n,s=new DataView(r.buffer);if(t===4){for(let o=0;o<t;o++)i.push(r[e+o]);n=i.join(".")}else if(t===16){for(let o=0;o<t;o+=2)i.push(s.getUint16(e+o).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};r7.exports={isIP:h8e,isV4:iA,isV6:e7,toBytes:t7,toString:d8e}});var Oy=p((kEt,s7)=>{u();"use strict";function Mn(r){if(typeof r=="number"){if(Mn.codes[r])return Mn.codes[r];throw new Error("no protocol with code: "+r)}else if(typeof r=="string"){if(Mn.names[r])return Mn.names[r];throw new Error("no protocol with name: "+r)}throw new Error("invalid protocol id type: "+r)}var xs=-1;Mn.lengthPrefixedVarSize=xs;Mn.V=xs;Mn.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,xs,"ip6zone"],[53,xs,"dns","resolvable"],[54,xs,"dns4","resolvable"],[55,xs,"dns6","resolvable"],[56,xs,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,xs,"unix",!1,"path"],[421,xs,"ipfs"],[421,xs,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,xs,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,xs,"memory"]];Mn.names={};Mn.codes={};Mn.table.map(r=>{let e=n7.apply(null,r);return Mn.codes[e.code]=e,Mn.names[e.name]=e,null});Mn.object=n7;function n7(r,e,t,i,n){return{code:r,size:e,name:t,resolvable:Boolean(i),path:Boolean(n)}}s7.exports=Mn});var c7=p((BEt,a7)=>{u();a7.exports=nA;var o7=128,p8e=127,y8e=~p8e,g8e=Math.pow(2,31);function nA(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw nA.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=g8e;)e[t++]=r&255|o7,r/=128;for(;r&y8e;)e[t++]=r&255|o7,r>>>=7;return e[t]=r|0,nA.bytes=t-i+1,e}});var f7=p((NEt,l7)=>{u();l7.exports=sA;var b8e=128,u7=127;function sA(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw sA.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&u7)<<i:(s&u7)*Math.pow(2,i),i+=7}while(s>=b8e);return sA.bytes=n-e,t}});var d7=p((DEt,h7)=>{u();var m8e=Math.pow(2,7),v8e=Math.pow(2,14),w8e=Math.pow(2,21),_8e=Math.pow(2,28),E8e=Math.pow(2,35),S8e=Math.pow(2,42),A8e=Math.pow(2,49),x8e=Math.pow(2,56),I8e=Math.pow(2,63);h7.exports=function(r){return r<m8e?1:r<v8e?2:r<w8e?3:r<_8e?4:r<E8e?5:r<S8e?6:r<A8e?7:r<x8e?8:r<I8e?9:10}});var Jn=p((MEt,p7)=>{u();p7.exports={encode:c7(),decode:f7(),encodingLength:d7()}});var E7=p((LEt,_7)=>{u();"use strict";var tv=i7(),y7=Oy(),{CID:T8e}=(xe(),Ce),{base32:g7}=(en(),Zi),{base58btc:R8e}=(zr(),Vr),P8e=(mn(),bn),Qh=Jn(),rv=Ze(),b7=ct(),iv=_n();_7.exports=qy;function qy(r,e){return e instanceof Uint8Array?qy.toString(r,e):qy.toBytes(r,e)}qy.toString=function(e,t){switch(y7(e).code){case 4:case 41:return C8e(t);case 6:case 273:case 33:case 132:return v7(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return q8e(t);case 421:return B8e(t);case 444:return w7(t);case 445:return w7(t);default:return rv(t,"base16")}};qy.toBytes=function(e,t){switch(y7(e).code){case 4:return m7(t);case 41:return m7(t);case 6:case 273:case 33:case 132:return oA(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return O8e(t);case 421:return k8e(t);case 444:return N8e(t);case 445:return D8e(t);default:return b7(t,"base16")}};function m7(r){if(!tv.isIP(r))throw new Error("invalid ip address");return tv.toBytes(r)}function C8e(r){let e=tv.toString(r);if(!e||!tv.isIP(e))throw new Error("invalid ip address");return e}function oA(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function v7(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function O8e(r){let e=b7(r),t=Uint8Array.from(Qh.encode(e.length));return iv([t,e],t.length+e.length)}function q8e(r){let e=Qh.decode(r);if(r=r.slice(Qh.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return rv(r)}function k8e(r){let e;r[0]==="Q"||r[0]==="1"?e=P8e.decode(R8e.decode(`z${r}`)).bytes:e=T8e.parse(r).multihash.bytes;let t=Uint8Array.from(Qh.encode(e.length));return iv([t,e],t.length+e.length)}function B8e(r){let e=Qh.decode(r),t=r.slice(Qh.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return rv(t,"base58btc")}function N8e(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let t=g7.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=oA(i);return iv([t,n],t.length+n.length)}function D8e(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let t=g7.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=oA(i);return iv([t,n],t.length+n.length)}function w7(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),i=rv(e,"base32"),n=v7(t);return i+":"+n}});var B7=p((UEt,k7)=>{u();"use strict";var S7=E7(),aA=Oy(),ky=Jn(),A7=_n(),M8e=Ze();k7.exports={stringToStringTuples:x7,stringTuplesToString:I7,tuplesToStringTuples:R7,stringTuplesToTuples:T7,bytesToTuples:cA,tuplesToBytes:P7,bytesToString:L8e,stringToBytes:O7,fromString:U8e,fromBytes:q7,validateBytes:uA,isValidBytes:F8e,cleanPath:nv,ParseError:lA,protoFromTuple:By,sizeForAddr:C7};function x7(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let i=0;i<t.length;i++){let n=t[i],s=aA(n);if(s.size===0){e.push([n]);continue}if(i++,i>=t.length)throw lA("invalid address: "+r);if(s.path){e.push([n,nv(t.slice(i).join("/"))]);break}e.push([n,t[i]])}return e}function I7(r){let e=[];return r.map(t=>{let i=By(t);return e.push(i.name),t.length>1&&e.push(t[1]),null}),nv(e.join("/"))}function T7(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=By(e);return e.length>1?[t.code,S7.toBytes(t.code,e[1])]:[t.code]})}function R7(r){return r.map(e=>{let t=By(e);return e[1]?[t.code,S7.toString(t.code,e[1])]:[t.code]})}function P7(r){return q7(A7(r.map(e=>{let t=By(e),i=Uint8Array.from(ky.encode(t.code));return e.length>1&&(i=A7([i,e[1]])),i})))}function C7(r,e){return r.size>0?r.size/8:r.size===0?0:ky.decode(e)+ky.decode.bytes}function cA(r){let e=[],t=0;for(;t<r.length;){let i=ky.decode(r,t),n=ky.decode.bytes,s=aA(i),o=C7(s,r.slice(t+n));if(o===0){e.push([i]),t+=n;continue}let a=r.slice(t+n,t+n+o);if(t+=o+n,t>r.length)throw lA("Invalid address Uint8Array: "+M8e(r,"base16"));e.push([i,a])}return e}function L8e(r){let e=cA(r),t=R7(e);return I7(t)}function O7(r){r=nv(r);let e=x7(r),t=T7(e);return P7(t)}function U8e(r){return O7(r)}function q7(r){let e=uA(r);if(e)throw e;return Uint8Array.from(r)}function uA(r){try{cA(r)}catch(e){return e}}function F8e(r){return uA(r)===void 0}function nv(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function lA(r){return new Error("Error parsing address: "+r)}function By(r){return aA(r[0])}});var et=p((FEt,M7)=>{u();"use strict";var fo=B7(),Jh=Oy(),N7=Jn(),{CID:K8e}=(xe(),Ce),{base58btc:j8e}=(zr(),Vr),V8e=ue(),z8e=Symbol.for("nodejs.util.inspect.custom"),sv=Ze(),H8e=fi(),fA=new Map,D7=Symbol.for("@multiformats/js-multiaddr/multiaddr"),En=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,D7,{value:!0}),e instanceof Uint8Array)this.bytes=fo.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=fo.fromString(e)}else if(En.isMultiaddr(e))this.bytes=fo.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return fo.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},t=this.toString().split("/");return e.family=t[1]==="ip4"?4:6,e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},Jh(e)))}protoCodes(){let e=[],t=this.bytes,i=0;for(;i<t.length;){let n=N7.decode(t,i),s=N7.decode.bytes,o=Jh(n);i+=fo.sizeForAddr(o,t.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return fo.bytesToTuples(this.bytes)}stringTuples(){let e=fo.bytesToTuples(this.bytes);return fo.tuplesToStringTuples(e)}encapsulate(e){return e=new En(e),new En(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),i=this.toString(),n=i.lastIndexOf(t);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new En(i.slice(0,n))}decapsulateCode(e){let t=this.tuples();for(let i=t.length-1;i>=0;i--)if(t[i][0]===e)return new En(fo.tuplesToBytes(t.slice(0,i)));return this}getPeerId(){try{let t=this.stringTuples().filter(i=>i[0]===Jh.names.ipfs.code).pop();if(t&&t[1]){let i=t[1];return i[0]==="Q"||i[0]==="1"?sv(j8e.decode(`z${i}`),"base58btc"):sv(K8e.parse(i).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>!!Jh(t[0]).path)[0][1],e||(e=null)}catch(t){e=null}return e}equals(e){return H8e(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let t=fA.get(e.name);if(!t)throw V8e(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map(n=>new En(n))}nodeAddress(){let e=this.protoCodes(),t=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let t=(e||this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}static fromNodeAddress(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new En("/"+[i,e.address,t,e.port].join("/"))}static isName(e){return En.isMultiaddr(e)?e.protos().some(t=>t.resolvable):!1}static isMultiaddr(e){return e instanceof En||Boolean(e&&e[D7])}[z8e](){return"<Multiaddr "+sv(this.bytes,"base16")+" - "+fo.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+sv(this.bytes,"base16")+" - "+fo.bytesToString(this.bytes)+">"}};En.protocols=Jh;En.resolvers=fA;function $8e(r){return new En(r)}M7.exports={Multiaddr:En,multiaddr:$8e,protocols:Jh,resolvers:fA}});var zl=p((KEt,G7)=>{u();"use strict";var{Multiaddr:hA}=et(),L7=Xe("dns4"),U7=Xe("dns6"),F7=Xe("dnsaddr"),Vl=on(Xe("dns"),F7,L7,U7),Ny=on(Xe("ip4"),Xe("ip6")),Zh=on(ft(Ny,Xe("tcp")),ft(Vl,Xe("tcp"))),dA=ft(Ny,Xe("udp")),K7=ft(dA,Xe("utp")),j7=ft(dA,Xe("quic")),ed=on(ft(Zh,Xe("ws")),ft(Vl,Xe("ws"))),td=on(ft(Zh,Xe("wss")),ft(Vl,Xe("wss"))),ov=on(ft(Zh,Xe("http")),ft(Ny,Xe("http")),ft(Vl,Xe("http"))),av=on(ft(Zh,Xe("https")),ft(Ny,Xe("https")),ft(Vl,Xe("https"))),pA=on(ft(ed,Xe("p2p-webrtc-star"),Xe("p2p")),ft(td,Xe("p2p-webrtc-star"),Xe("p2p")),ft(ed,Xe("p2p-webrtc-star")),ft(td,Xe("p2p-webrtc-star"))),G8e=on(ft(ed,Xe("p2p-websocket-star"),Xe("p2p")),ft(td,Xe("p2p-websocket-star"),Xe("p2p")),ft(ed,Xe("p2p-websocket-star")),ft(td,Xe("p2p-websocket-star"))),yA=on(ft(ov,Xe("p2p-webrtc-direct"),Xe("p2p")),ft(av,Xe("p2p-webrtc-direct"),Xe("p2p")),ft(ov,Xe("p2p-webrtc-direct")),ft(av,Xe("p2p-webrtc-direct"))),rd=on(ed,td,ov,av,pA,yA,Zh,K7,j7,Vl),W8e=on(ft(rd,Xe("p2p-stardust"),Xe("p2p")),ft(rd,Xe("p2p-stardust"))),_u=on(ft(rd,Xe("p2p")),pA,yA,Xe("p2p")),V7=on(ft(_u,Xe("p2p-circuit"),_u),ft(_u,Xe("p2p-circuit")),ft(Xe("p2p-circuit"),_u),ft(rd,Xe("p2p-circuit")),ft(Xe("p2p-circuit"),rd),Xe("p2p-circuit")),z7=()=>on(ft(V7,z7),V7),id=z7(),H7=on(ft(id,_u,id),ft(_u,id),ft(id,_u),id,_u);G7.exports={DNS:Vl,DNS4:L7,DNS6:U7,DNSADDR:F7,IP:Ny,TCP:Zh,UDP:dA,QUIC:j7,UTP:K7,HTTP:ov,HTTPS:av,WebSockets:ed,WebSocketsSecure:td,WebSocketStar:G8e,WebRTCStar:pA,WebRTCDirect:yA,Reliable:rd,Stardust:W8e,Circuit:id,P2P:H7,IPFS:H7};function $7(r){function e(t){if(!hA.isMultiaddr(t))try{t=new hA(t)}catch(n){return!1}let i=r(t.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function ft(...r){function e(t){if(t.length<r.length)return null;let i=t;return r.some(n=>(i=typeof n=="function"?n().partialMatch(t):n.partialMatch(t),Array.isArray(i)&&(t=i),i===null)),i}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:$7(e),partialMatch:e}}function on(...r){function e(i){let n=null;return r.some(s=>{let o=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return o?(n=o,!0):!1}),n}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:$7(e),partialMatch:e}}function Xe(r){let e=r;function t(n){let s;if(typeof n=="string"||n instanceof Uint8Array)try{s=new hA(n)}catch(a){return!1}else s=n;let o=s.protoNames();return o.length===1&&o[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:t,partialMatch:i}}});var sd=p((jEt,oL)=>{u();"use strict";var{base58btc:Y8e}=(zr(),Vr),{base32:X8e}=(en(),Zi),Q8e=(mn(),bn),{Multiaddr:W7}=et(),J8e=zl(),{CID:gA}=(xe(),Ce),{URL:Z8e}=Km(),ePe=Ze(),bA=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,nd=/^\/(ip[fn]s)\/([^/?#]+)/,Y7=1,X7=2,Dy=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,Q7=1,J7=2,tPe=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function rPe(r){let e=mA(r);try{Q8e.decode(Y8e.decode("z"+e))}catch{return!1}return!0}function iPe(r){try{X8e.decode(r)}catch{return!1}return!0}function My(r){try{return typeof r=="string"?Boolean(gA.parse(r)):r instanceof Uint8Array?Boolean(gA.decode(r)):Boolean(gA.asCID(r))}catch(e){return!1}}function Z7(r){if(!r)return!1;if(W7.isMultiaddr(r))return!0;try{return new W7(r),!0}catch(e){return!1}}function nPe(r){return Z7(r)&&J8e.P2P.matches(r)}function Ly(r,e,t=Y7,i=X7){let n=mA(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipfs")return!1;let o=s[i];return o&&e===Dy&&(o=o.toLowerCase()),My(o)}function cv(r,e,t=Y7,i=X7){let n=mA(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipns")return!1;let o=s[i];if(o&&e===Dy){if(o=o.toLowerCase(),My(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new Z8e(`http://${o}`);return tPe.test(a)}catch(a){return!1}}return!0}function eL(r){return typeof r=="string"}function mA(r){return r instanceof Uint8Array?ePe(r,"base58btc"):eL(r)?r:!1}var vA=r=>Ly(r,Dy,J7,Q7),wA=r=>cv(r,Dy,J7,Q7),tL=r=>vA(r)||wA(r),rL=r=>Ly(r,bA)||vA(r),iL=r=>cv(r,bA)||wA(r),nL=r=>rL(r)||iL(r)||tL(r),sL=r=>Ly(r,nd)||cv(r,nd);oL.exports={multihash:rPe,multiaddr:Z7,peerMultiaddr:nPe,cid:My,base32cid:r=>iPe(r)&&My(r),ipfsSubdomain:vA,ipnsSubdomain:wA,subdomain:tL,subdomainGatewayPattern:Dy,ipfsUrl:rL,ipnsUrl:iL,url:nL,pathGatewayPattern:bA,ipfsPath:r=>Ly(r,nd),ipnsPath:r=>cv(r,nd),path:sL,pathPattern:nd,urlOrPath:r=>nL(r)||sL(r),cidPath:r=>eL(r)&&!My(r)&&Ly(`/ipfs/${r}`,nd)}});var cL=p((VEt,aL)=>{u();var od=1e3,ad=od*60,cd=ad*60,Hl=cd*24,sPe=Hl*7,oPe=Hl*365.25;aL.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return aPe(r);if(t==="number"&&isFinite(r))return e.long?uPe(r):cPe(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function aPe(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*oPe;case"weeks":case"week":case"w":return t*sPe;case"days":case"day":case"d":return t*Hl;case"hours":case"hour":case"hrs":case"hr":case"h":return t*cd;case"minutes":case"minute":case"mins":case"min":case"m":return t*ad;case"seconds":case"second":case"secs":case"sec":case"s":return t*od;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function cPe(r){var e=Math.abs(r);return e>=Hl?Math.round(r/Hl)+"d":e>=cd?Math.round(r/cd)+"h":e>=ad?Math.round(r/ad)+"m":e>=od?Math.round(r/od)+"s":r+"ms"}function uPe(r){var e=Math.abs(r);return e>=Hl?uv(r,e,Hl,"day"):e>=cd?uv(r,e,cd,"hour"):e>=ad?uv(r,e,ad,"minute"):e>=od?uv(r,e,od,"second"):r+" ms"}function uv(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var lL=p((zEt,uL)=>{u();function lPe(r){t.debug=t,t.default=t,t.coerce=c,t.disable=s,t.enable=n,t.enabled=o,t.humanize=cL(),t.destroy=f,Object.keys(r).forEach(l=>{t[l]=r[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let h=0;for(let d=0;d<l.length;d++)h=(h<<5)-h+l.charCodeAt(d),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(l){let h,d=null,y,g;function m(...E){if(!m.enabled)return;let _=m,T=Number(new Date),q=T-(h||T);_.diff=q,_.prev=h,_.curr=T,h=T,E[0]=t.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let z=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(M,$)=>{if(M==="%%")return"%";z++;let X=t.formatters[$];if(typeof X=="function"){let Q=E[z];M=X.call(_,Q),E.splice(z,1),z--}return M}),t.formatArgs.call(_,E),(_.log||t.log).apply(_,E)}return m.namespace=l,m.useColors=t.useColors(),m.color=t.selectColor(l),m.extend=i,m.destroy=t.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(y!==t.namespaces&&(y=t.namespaces,g=t.enabled(l)),g),set:E=>{d=E}}),typeof t.init=="function"&&t.init(m),m}function i(l,h){let d=t(this.namespace+(typeof h=="undefined"?":":h)+l);return d.log=this.log,d}function n(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let h,d=(typeof l=="string"?l:"").split(/[\s,]+/),y=d.length;for(h=0;h<y;h++)!d[h]||(l=d[h].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.substr(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...t.names.map(a),...t.skips.map(a).map(h=>"-"+h)].join(",");return t.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let h,d;for(h=0,d=t.skips.length;h<d;h++)if(t.skips[h].test(l))return!1;for(h=0,d=t.names.length;h<d;h++)if(t.names[h].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}uL.exports=lPe});var me=p((Zn,lv)=>{u();Zn.formatArgs=hPe;Zn.save=dPe;Zn.load=pPe;Zn.useColors=fPe;Zn.storage=yPe();Zn.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Zn.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function fPe(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function hPe(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+lv.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(i=t))}),r.splice(i,0,e)}Zn.log=console.debug||console.log||(()=>{});function dPe(r){try{r?Zn.storage.setItem("debug",r):Zn.storage.removeItem("debug")}catch(e){}}function pPe(){let r;try{r=Zn.storage.getItem("debug")}catch(e){}return!r&&typeof process!="undefined"&&"env"in process&&(r=process.env.DEBUG),r}function yPe(){try{return localStorage}catch(r){}}lv.exports=lL()(Zn);var{formatters:gPe}=lv.exports;gPe.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var hL=p((HEt,fL)=>{u();"use strict";var Eu=Pi(),ud=Eu.Reader,_A=Eu.Writer,Qe=Eu.util,Mi=Eu.roots["ipfs-unixfs"]||(Eu.roots["ipfs-unixfs"]={});Mi.Data=function(){function r(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=Qe.newBuffer([]),r.prototype.filesize=Qe.Long?Qe.Long.fromBits(0,0,!0):0,r.prototype.blocksizes=Qe.emptyArray,r.prototype.hashType=Qe.Long?Qe.Long.fromBits(0,0,!0):0,r.prototype.fanout=Qe.Long?Qe.Long.fromBits(0,0,!0):0,r.prototype.mode=0,r.prototype.mtime=null,r.encode=function(t,i){if(i||(i=_A.create()),i.uint32(8).int32(t.Type),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&i.uint32(18).bytes(t.Data),t.filesize!=null&&Object.hasOwnProperty.call(t,"filesize")&&i.uint32(24).uint64(t.filesize),t.blocksizes!=null&&t.blocksizes.length)for(var n=0;n<t.blocksizes.length;++n)i.uint32(32).uint64(t.blocksizes[n]);return t.hashType!=null&&Object.hasOwnProperty.call(t,"hashType")&&i.uint32(40).uint64(t.hashType),t.fanout!=null&&Object.hasOwnProperty.call(t,"fanout")&&i.uint32(48).uint64(t.fanout),t.mode!=null&&Object.hasOwnProperty.call(t,"mode")&&i.uint32(56).uint32(t.mode),t.mtime!=null&&Object.hasOwnProperty.call(t,"mtime")&&Mi.UnixTime.encode(t.mtime,i.uint32(66).fork()).ldelim(),i},r.decode=function(t,i){t instanceof ud||(t=ud.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Mi.Data;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;case 3:s.filesize=t.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)==2)for(var a=t.uint32()+t.pos;t.pos<a;)s.blocksizes.push(t.uint64());else s.blocksizes.push(t.uint64());break;case 5:s.hashType=t.uint64();break;case 6:s.fanout=t.uint64();break;case 7:s.mode=t.uint32();break;case 8:s.mtime=Mi.UnixTime.decode(t,t.uint32());break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Qe.ProtocolError("missing required 'Type'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Mi.Data)return t;var i=new Mi.Data;switch(t.Type){case"Raw":case 0:i.Type=0;break;case"Directory":case 1:i.Type=1;break;case"File":case 2:i.Type=2;break;case"Metadata":case 3:i.Type=3;break;case"Symlink":case 4:i.Type=4;break;case"HAMTShard":case 5:i.Type=5;break}if(t.Data!=null&&(typeof t.Data=="string"?Qe.base64.decode(t.Data,i.Data=Qe.newBuffer(Qe.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),t.filesize!=null&&(Qe.Long?(i.filesize=Qe.Long.fromValue(t.filesize)).unsigned=!0:typeof t.filesize=="string"?i.filesize=parseInt(t.filesize,10):typeof t.filesize=="number"?i.filesize=t.filesize:typeof t.filesize=="object"&&(i.filesize=new Qe.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");i.blocksizes=[];for(var n=0;n<t.blocksizes.length;++n)Qe.Long?(i.blocksizes[n]=Qe.Long.fromValue(t.blocksizes[n])).unsigned=!0:typeof t.blocksizes[n]=="string"?i.blocksizes[n]=parseInt(t.blocksizes[n],10):typeof t.blocksizes[n]=="number"?i.blocksizes[n]=t.blocksizes[n]:typeof t.blocksizes[n]=="object"&&(i.blocksizes[n]=new Qe.LongBits(t.blocksizes[n].low>>>0,t.blocksizes[n].high>>>0).toNumber(!0))}if(t.hashType!=null&&(Qe.Long?(i.hashType=Qe.Long.fromValue(t.hashType)).unsigned=!0:typeof t.hashType=="string"?i.hashType=parseInt(t.hashType,10):typeof t.hashType=="number"?i.hashType=t.hashType:typeof t.hashType=="object"&&(i.hashType=new Qe.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),t.fanout!=null&&(Qe.Long?(i.fanout=Qe.Long.fromValue(t.fanout)).unsigned=!0:typeof t.fanout=="string"?i.fanout=parseInt(t.fanout,10):typeof t.fanout=="number"?i.fanout=t.fanout:typeof t.fanout=="object"&&(i.fanout=new Qe.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),t.mode!=null&&(i.mode=t.mode>>>0),t.mtime!=null){if(typeof t.mtime!="object")throw TypeError(".Data.mtime: object expected");i.mtime=Mi.UnixTime.fromObject(t.mtime)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocksizes=[]),i.defaults){if(n.Type=i.enums===String?"Raw":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Qe.newBuffer(n.Data))),Qe.Long){var s=new Qe.Long(0,0,!0);n.filesize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.filesize=i.longs===String?"0":0;if(Qe.Long){var s=new Qe.Long(0,0,!0);n.hashType=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.hashType=i.longs===String?"0":0;if(Qe.Long){var s=new Qe.Long(0,0,!0);n.fanout=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.fanout=i.longs===String?"0":0;n.mode=0,n.mtime=null}if(t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?Mi.Data.DataType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Qe.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.filesize!=null&&t.hasOwnProperty("filesize")&&(typeof t.filesize=="number"?n.filesize=i.longs===String?String(t.filesize):t.filesize:n.filesize=i.longs===String?Qe.Long.prototype.toString.call(t.filesize):i.longs===Number?new Qe.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){n.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)typeof t.blocksizes[o]=="number"?n.blocksizes[o]=i.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:n.blocksizes[o]=i.longs===String?Qe.Long.prototype.toString.call(t.blocksizes[o]):i.longs===Number?new Qe.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return t.hashType!=null&&t.hasOwnProperty("hashType")&&(typeof t.hashType=="number"?n.hashType=i.longs===String?String(t.hashType):t.hashType:n.hashType=i.longs===String?Qe.Long.prototype.toString.call(t.hashType):i.longs===Number?new Qe.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),t.fanout!=null&&t.hasOwnProperty("fanout")&&(typeof t.fanout=="number"?n.fanout=i.longs===String?String(t.fanout):t.fanout:n.fanout=i.longs===String?Qe.Long.prototype.toString.call(t.fanout):i.longs===Number?new Qe.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),t.mode!=null&&t.hasOwnProperty("mode")&&(n.mode=t.mode),t.mtime!=null&&t.hasOwnProperty("mtime")&&(n.mtime=Mi.UnixTime.toObject(t.mtime,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Eu.util.toJSONOptions)},r.DataType=function(){var e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),r}();Mi.UnixTime=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Seconds=Qe.Long?Qe.Long.fromBits(0,0,!1):0,r.prototype.FractionalNanoseconds=0,r.encode=function(t,i){return i||(i=_A.create()),i.uint32(8).int64(t.Seconds),t.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&i.uint32(21).fixed32(t.FractionalNanoseconds),i},r.decode=function(t,i){t instanceof ud||(t=ud.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Mi.UnixTime;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Seconds=t.int64();break;case 2:s.FractionalNanoseconds=t.fixed32();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw Qe.ProtocolError("missing required 'Seconds'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Mi.UnixTime)return t;var i=new Mi.UnixTime;return t.Seconds!=null&&(Qe.Long?(i.Seconds=Qe.Long.fromValue(t.Seconds)).unsigned=!1:typeof t.Seconds=="string"?i.Seconds=parseInt(t.Seconds,10):typeof t.Seconds=="number"?i.Seconds=t.Seconds:typeof t.Seconds=="object"&&(i.Seconds=new Qe.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),t.FractionalNanoseconds!=null&&(i.FractionalNanoseconds=t.FractionalNanoseconds>>>0),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(Qe.Long){var s=new Qe.Long(0,0,!1);n.Seconds=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Seconds=i.longs===String?"0":0;n.FractionalNanoseconds=0}return t.Seconds!=null&&t.hasOwnProperty("Seconds")&&(typeof t.Seconds=="number"?n.Seconds=i.longs===String?String(t.Seconds):t.Seconds:n.Seconds=i.longs===String?Qe.Long.prototype.toString.call(t.Seconds):i.longs===Number?new Qe.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),t.FractionalNanoseconds!=null&&t.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=t.FractionalNanoseconds),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Eu.util.toJSONOptions)},r}();Mi.Metadata=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.MimeType="",r.encode=function(t,i){return i||(i=_A.create()),t.MimeType!=null&&Object.hasOwnProperty.call(t,"MimeType")&&i.uint32(10).string(t.MimeType),i},r.decode=function(t,i){t instanceof ud||(t=ud.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Mi.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.MimeType=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Mi.Metadata)return t;var i=new Mi.Metadata;return t.MimeType!=null&&(i.MimeType=String(t.MimeType)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.MimeType=""),t.MimeType!=null&&t.hasOwnProperty("MimeType")&&(n.MimeType=t.MimeType),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Eu.util.toJSONOptions)},r}();fL.exports=Mi});var mi=p(($Et,gL)=>{u();"use strict";var{Data:gc}=hL(),EA=ue(),dL=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],bPe=["directory","hamt-sharded-directory"],pL=parseInt("0644",8),yL=parseInt("0755",8);function fv(r){if(r!=null)return typeof r=="number"?r&4095:(r=r.toString(),r.substring(0,1)==="0"?parseInt(r,8)&4095:parseInt(r,10)&4095)}function SA(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw EA(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var hv=class{static unmarshal(e){let t=gc.decode(e),i=gc.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new hv({type:dL[i.Type],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:i.mtime?{secs:i.mtime.Seconds,nsecs:i.mtime.FractionalNanoseconds}:void 0});return n._originalMode=i.mode||0,n}constructor(e={type:"file"}){let{type:t,data:i,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(t&&!dL.includes(t))throw EA(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=i,this.hashType=s,this.fanout=o,this.blockSizes=n||[],this._originalMode=0,this.mode=fv(c),a&&(this.mtime=SA(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?yL:pL;let t=fv(e);t!==void 0&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&bPe.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(t=>{e+=t}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=gc.DataType.Raw;break;case"directory":e=gc.DataType.Directory;break;case"file":e=gc.DataType.File;break;case"metadata":e=gc.DataType.Metadata;break;case"symlink":e=gc.DataType.Symlink;break;case"hamt-sharded-directory":e=gc.DataType.HAMTShard;break;default:throw EA(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t=this.data;(!this.data||!this.data.length)&&(t=void 0);let i;this.mode!=null&&(i=this._originalMode&4294963200|(fv(this.mode)||0),i===pL&&!this.isDirectory()&&(i=void 0),i===yL&&this.isDirectory()&&(i=void 0));let n;if(this.mtime!=null){let o=SA(this.mtime);o&&(n={Seconds:o.secs,FractionalNanoseconds:o.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let s={Type:e,Data:t,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:i,mtime:n};return gc.encode(s).finish()}};gL.exports={UnixFS:hv,parseMode:fv,parseMtime:SA}});function AA(r,e){let t=0;for(let i=0;;i+=7){if(i>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let n=r[e++];if(t+=i<28?(n&127)<<i:(n&127)*2**i,n<128)break}return[t,e]}function dv(r,e){let t;[t,e]=AA(r,e);let i=e+t;if(t<0||i<0)throw new Error("protobuf: invalid length");if(i>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,i),i]}function bL(r,e){let t;return[t,e]=AA(r,e),[t&7,t>>3,e]}function vPe(r){let e={},t=r.length,i=0;for(;i<t;){let n,s;if([n,s,i]=bL(r,i),s===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,i]=dv(r,i)}else if(s===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,i]=dv(r,i),e.Name=mPe.decode(o)}else if(s===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(n!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,i]=AA(r,i)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(i>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function mL(r){let e=r.length,t=0,i,n=!1,s;for(;t<e;){let a,c;if([a,c,t]=bL(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,t]=dv(r,t),i&&(n=!0)}else if(c===2){if(n)throw new Error("protobuf: (PBNode) duplicate Links section");i||(i=[]);let f;[f,t]=dv(r,t),i.push(vPe(f))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let o={};return s&&(o.Data=s),o.Links=i||[],o}var mPe,vL=Ge(()=>{u();mPe=new TextDecoder});function _Pe(r,e){let t=e.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=Uy(e,t,r.Tsize)-1,e[t]=24}if(typeof r.Name=="string"){let i=wL.encode(r.Name);t-=i.length,e.set(i,t),t=Uy(e,t,i.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=Uy(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function EL(r){let e=SPe(r),t=new Uint8Array(e),i=e;if(r.Data&&(i-=r.Data.length,t.set(r.Data,i),i=Uy(t,i,r.Data.length)-1,t[i]=10),r.Links)for(let n=r.Links.length-1;n>=0;n--){let s=_Pe(r.Links[n],t.subarray(0,i));i-=s,i=Uy(t,i,s)-1,t[i]=18}return t}function EPe(r){let e=0;if(r.Hash){let t=r.Hash.length;e+=1+t+ld(t)}if(typeof r.Name=="string"){let t=wL.encode(r.Name).length;e+=1+t+ld(t)}return typeof r.Tsize=="number"&&(e+=1+ld(r.Tsize)),e}function SPe(r){let e=0;if(r.Data){let t=r.Data.length;e+=1+t+ld(t)}if(r.Links)for(let t of r.Links){let i=EPe(t);e+=1+i+ld(i)}return e}function Uy(r,e,t){e-=ld(t);let i=e;for(;t>=wPe;)r[e++]=t&127|128,t/=128;for(;t>=128;)r[e++]=t&127|128,t>>>=7;return r[e]=t,i}function ld(r){return r%2==0&&r++,Math.floor((APe(r)+6)/7)}function APe(r){let e=0;return r>=_L&&(r=Math.floor(r/_L),e=32),r>=1<<16&&(r>>>=16,e+=16),r>=1<<8&&(r>>>=8,e+=8),e+xPe[r]}var wL,_L,wPe,xPe,SL=Ge(()=>{u();wL=new TextEncoder,_L=2**32,wPe=2**31;xPe=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]});function AL(r,e){if(r===e)return 0;let t=r.Name?xA.encode(r.Name):[],i=e.Name?xA.encode(e.Name):[],n=t.length,s=i.length;for(let o=0,a=Math.min(n,s);o<a;++o)if(t[o]!==i[o]){n=t[o],s=i[o];break}return n<s?-1:s<n?1:0}function xL(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function IL(r){if(typeof r.asCID=="object"){let t=tt.asCID(r);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let e={};if(r.Hash){let t=tt.asCID(r.Hash);try{t||(typeof r.Hash=="string"?t=tt.parse(r.Hash):r.Hash instanceof Uint8Array&&(t=tt.decode(r.Hash)))}catch(i){throw new TypeError(`Invalid DAG-PB form: ${i.message}`)}t&&(e.Hash=t)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof r.Name=="string"&&(e.Name=r.Name),typeof r.Tsize=="number"&&(e.Tsize=r.Tsize),e}function IA(r){if((r instanceof Uint8Array||typeof r=="string")&&(r={Data:r}),typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let e={};if(r.Data!==void 0)if(typeof r.Data=="string")e.Data=xA.encode(r.Data);else if(r.Data instanceof Uint8Array)e.Data=r.Data;else throw new TypeError("Invalid DAG-PB form");if(r.Links!==void 0)if(Array.isArray(r.Links))e.Links=r.Links.map(IL),e.Links.sort(AL);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function TA(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");if(!xL(r,IPe))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<r.Links.length;e++){let t=r.Links[e];if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!xL(t,TPe))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0&&(typeof t.Tsize!="number"||t.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&AL(t,r.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function TL(r,e=[]){return IA({Data:r,Links:e})}function RL(r,e,t){return IL({Hash:t,Name:r,Tsize:e})}var IPe,TPe,xA,PL=Ge(()=>{u();xe();IPe=["Data","Links"],TPe=["Hash","Name","Tsize"],xA=new TextEncoder});var At={};Ht(At,{code:()=>PPe,createLink:()=>RL,createNode:()=>TL,decode:()=>OPe,encode:()=>CPe,name:()=>RPe,prepare:()=>IA,validate:()=>TA});function CPe(r){TA(r);let e={};return r.Links&&(e.Links=r.Links.map(t=>{let i={};return t.Hash&&(i.Hash=t.Hash.bytes),t.Name!==void 0&&(i.Name=t.Name),t.Tsize!==void 0&&(i.Tsize=t.Tsize),i})),r.Data&&(e.Data=r.Data),EL(e)}function OPe(r){let e=mL(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(i=>{let n={};try{n.Hash=tt.decode(i.Hash)}catch(s){}if(!n.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(n.Name=i.Name),i.Tsize!==void 0&&(n.Tsize=i.Tsize),n})),t}var RPe,PPe,xt=Ge(()=>{u();xe();vL();SL();PL();RPe="dag-pb",PPe=112});function CL(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(qPe.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(BPe(r))return"Buffer";let t=NPe(r);return t||"Object"}function BPe(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function NPe(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(kPe.includes(e))return e}var qPe,kPe,OL=Ge(()=>{u();qPe=["string","number","bigint","symbol"],kPe=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var he,Ue,es=Ge(()=>{u();he=class{constructor(e,t,i){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};he.uint=new he(0,"uint",!0);he.negint=new he(1,"negint",!0);he.bytes=new he(2,"bytes",!0);he.string=new he(3,"string",!0);he.array=new he(4,"array",!1);he.map=new he(5,"map",!1);he.tag=new he(6,"tag",!1);he.float=new he(7,"float",!0);he.false=new he(7,"false",!0);he.true=new he(7,"true",!0);he.null=new he(7,"null",!0);he.undefined=new he(7,"undefined",!0);he.break=new he(7,"break",!0);Ue=class{constructor(e,t,i){this.type=e,this.value=t,this.encodedLength=i,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function pv(r){return fd&&globalThis.Buffer.isBuffer(r)}function RA(r){return r instanceof Uint8Array?pv(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}function DL(r,e){if(pv(r)&&pv(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function ML(r,e=1/0){let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function LL(r,e,t){let i=[];for(;e<t;){let n=r[e],s=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=t){let a,c,f,l;switch(o){case 1:n<128&&(s=n);break;case 2:a=r[e+1],(a&192)==128&&(l=(n&31)<<6|a&63,l>127&&(s=l));break;case 3:a=r[e+1],c=r[e+2],(a&192)==128&&(c&192)==128&&(l=(n&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:a=r[e+1],c=r[e+2],f=r[e+3],(a&192)==128&&(c&192)==128&&(f&192)==128&&(l=(n&15)<<18|(a&63)<<12|(c&63)<<6|f&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),e+=o}return LPe(i)}function LPe(r){let e=r.length;if(e<=UL)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=UL));return t}var fd,DPe,MPe,qL,kL,Sa,yv,BL,NL,UL,hd=Ge(()=>{u();fd=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",DPe=new TextDecoder,MPe=new TextEncoder;qL=fd?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):LL(r,e,t):(r,e,t)=>t-e>64?DPe.decode(r.subarray(e,t)):LL(r,e,t),kL=fd?r=>r.length>64?globalThis.Buffer.from(r):ML(r):r=>r.length>64?MPe.encode(r):ML(r),Sa=r=>Uint8Array.from(r),yv=fd?(r,e,t)=>pv(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),BL=fd?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),RA(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),i=0;for(let n of r)i+n.length>t.length&&(n=n.subarray(0,t.length-i)),t.set(n,i),i+=n.length;return t},NL=fd?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);UL=4096});var UPe,gv,FL=Ge(()=>{u();hd();UPe=256,gv=class{constructor(e=UPe){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){let n=t.length-(this.maxCursor-this.cursor)-1;n<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=NL(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let i=this.chunks[0];e&&this.cursor>i.length/2?(t=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=yv(i,0,this.cursor)}else t=BL(this.chunks,this.cursor);return e&&this.reset(),t}}});function bc(r,e,t){if(r.length-e<t)throw new Error(`${st} not enough data for type`)}var st,PA,Fy,ho=Ge(()=>{u();st="CBOR decode error:",PA="CBOR encode error:",Fy=[];Fy[23]=1;Fy[24]=2;Fy[25]=3;Fy[26]=5;Fy[27]=9});function ts(r,e,t){bc(r,e,1);let i=r[e];if(t.strict===!0&&i<Li[0])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function rs(r,e,t){bc(r,e,2);let i=r[e]<<8|r[e+1];if(t.strict===!0&&i<Li[1])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function is(r,e,t){bc(r,e,4);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&i<Li[2])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function ns(r,e,t){bc(r,e,8);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],n=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],s=(BigInt(i)<<BigInt(32))+BigInt(n);if(t.strict===!0&&s<Li[3])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(t.allowBigInt===!0)return s;throw new Error(`${st} integers outside of the safe integer range are not supported`)}function KL(r,e,t,i){return new Ue(he.uint,ts(r,e+1,i),2)}function jL(r,e,t,i){return new Ue(he.uint,rs(r,e+1,i),3)}function VL(r,e,t,i){return new Ue(he.uint,is(r,e+1,i),5)}function zL(r,e,t,i){return new Ue(he.uint,ns(r,e+1,i),9)}function Is(r,e){return Ln(r,0,e.value)}function Ln(r,e,t){if(t<Li[0]){let i=Number(t);r.push([e|i])}else if(t<Li[1]){let i=Number(t);r.push([e|24,i])}else if(t<Li[2]){let i=Number(t);r.push([e|25,i>>>8,i&255])}else if(t<Li[3]){let i=Number(t);r.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(t);if(i<Li[4]){let n=[e|27,0,0,0,0,0,0,0],s=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));n[8]=s&255,s=s>>8,n[7]=s&255,s=s>>8,n[6]=s&255,s=s>>8,n[5]=s&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,r.push(n)}else throw new Error(`${st} encountered BigInt larger than allowable range`)}}var Li,Aa=Ge(()=>{u();es();ho();Li=[24,256,65536,4294967296,BigInt("18446744073709551616")];Is.encodedSize=function(e){return Ln.encodedSize(e.value)};Ln.encodedSize=function(e){return e<Li[0]?1:e<Li[1]?2:e<Li[2]?3:e<Li[3]?5:9};Is.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}});function HL(r,e,t,i){return new Ue(he.negint,-1-ts(r,e+1,i),2)}function $L(r,e,t,i){return new Ue(he.negint,-1-rs(r,e+1,i),3)}function GL(r,e,t,i){return new Ue(he.negint,-1-is(r,e+1,i),5)}function YL(r,e,t,i){let n=ns(r,e+1,i);if(typeof n!="bigint"){let s=-1-n;if(s>=Number.MIN_SAFE_INTEGER)return new Ue(he.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${st} integers outside of the safe integer range are not supported`);return new Ue(he.negint,CA-BigInt(n),9)}function bv(r,e){let t=e.value,i=typeof t=="bigint"?t*CA-WL:t*-1-1;Ln(r,e.type.majorEncoded,i)}var CA,WL,OA=Ge(()=>{u();es();Aa();ho();CA=BigInt(-1),WL=BigInt(1);bv.encodedSize=function(e){let t=e.value,i=typeof t=="bigint"?t*CA-WL:t*-1-1;return i<Li[0]?1:i<Li[1]?2:i<Li[2]?3:i<Li[3]?5:9};bv.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}});function Ky(r,e,t,i){bc(r,e,t+i);let n=yv(r,e+t,e+t+i);return new Ue(he.bytes,n,t+i)}function XL(r,e,t,i){return Ky(r,e,1,t)}function QL(r,e,t,i){return Ky(r,e,2,ts(r,e+1,i))}function JL(r,e,t,i){return Ky(r,e,3,rs(r,e+1,i))}function ZL(r,e,t,i){return Ky(r,e,5,is(r,e+1,i))}function e9(r,e,t,i){let n=ns(r,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer bytes lengths not supported`);return Ky(r,e,9,n)}function mv(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===he.string?kL(r.value):r.value),r.encodedBytes}function dd(r,e){let t=mv(e);Ln(r,e.type.majorEncoded,t.length),r.push(t)}function FPe(r,e){return r.length<e.length?-1:r.length>e.length?1:DL(r,e)}var vv=Ge(()=>{u();es();ho();Aa();hd();dd.encodedSize=function(e){let t=mv(e);return Ln.encodedSize(t.length)+t.length};dd.compareTokens=function(e,t){return FPe(mv(e),mv(t))}});function jy(r,e,t,i){let n=t+i;return bc(r,e,n),new Ue(he.string,qL(r,e+t,e+n),n)}function t9(r,e,t,i){return jy(r,e,1,t)}function r9(r,e,t,i){return jy(r,e,2,ts(r,e+1,i))}function i9(r,e,t,i){return jy(r,e,3,rs(r,e+1,i))}function n9(r,e,t,i){return jy(r,e,5,is(r,e+1,i))}function s9(r,e,t,i){let n=ns(r,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer string lengths not supported`);return jy(r,e,9,n)}var o9,qA=Ge(()=>{u();es();ho();Aa();vv();hd();o9=dd});function pd(r,e,t,i){return new Ue(he.array,i,t)}function a9(r,e,t,i){return pd(r,e,1,t)}function c9(r,e,t,i){return pd(r,e,2,ts(r,e+1,i))}function u9(r,e,t,i){return pd(r,e,3,rs(r,e+1,i))}function l9(r,e,t,i){return pd(r,e,5,is(r,e+1,i))}function f9(r,e,t,i){let n=ns(r,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer array lengths not supported`);return pd(r,e,9,n)}function h9(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return pd(r,e,1,1/0)}function kA(r,e){Ln(r,he.array.majorEncoded,e.value)}var BA=Ge(()=>{u();es();Aa();ho();kA.compareTokens=Is.compareTokens});function yd(r,e,t,i){return new Ue(he.map,i,t)}function d9(r,e,t,i){return yd(r,e,1,t)}function p9(r,e,t,i){return yd(r,e,2,ts(r,e+1,i))}function y9(r,e,t,i){return yd(r,e,3,rs(r,e+1,i))}function g9(r,e,t,i){return yd(r,e,5,is(r,e+1,i))}function b9(r,e,t,i){let n=ns(r,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer map lengths not supported`);return yd(r,e,9,n)}function m9(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return yd(r,e,1,1/0)}function NA(r,e){Ln(r,he.map.majorEncoded,e.value)}var DA=Ge(()=>{u();es();Aa();ho();NA.compareTokens=Is.compareTokens});function v9(r,e,t,i){return new Ue(he.tag,t,1)}function w9(r,e,t,i){return new Ue(he.tag,ts(r,e+1,i),2)}function _9(r,e,t,i){return new Ue(he.tag,rs(r,e+1,i),3)}function E9(r,e,t,i){return new Ue(he.tag,is(r,e+1,i),5)}function S9(r,e,t,i){return new Ue(he.tag,ns(r,e+1,i),9)}function MA(r,e){Ln(r,he.tag.majorEncoded,e.value)}var LA=Ge(()=>{u();es();Aa();MA.compareTokens=Is.compareTokens});function A9(r,e,t,i){if(i.allowUndefined===!1)throw new Error(`${st} undefined values are not supported`);return new Ue(he.undefined,void 0,1)}function x9(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return new Ue(he.break,void 0,1)}function UA(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${st} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${st} Infinity values are not supported`)}return new Ue(he.float,r,e)}function I9(r,e,t,i){return UA(FA(r,e+1),3,i)}function T9(r,e,t,i){return UA(KA(r,e+1),5,i)}function R9(r,e,t,i){return UA(q9(r,e+1),9,i)}function wv(r,e,t){let i=e.value;if(i===!1)r.push([he.float.majorEncoded|KPe]);else if(i===!0)r.push([he.float.majorEncoded|jPe]);else if(i===null)r.push([he.float.majorEncoded|VPe]);else if(i===void 0)r.push([he.float.majorEncoded|zPe]);else{let n,s=!1;(!t||t.float64!==!0)&&(C9(i),n=FA(po,1),i===n||Number.isNaN(i)?(po[0]=249,r.push(po.slice(0,3)),s=!0):(O9(i),n=KA(po,1),i===n&&(po[0]=250,r.push(po.slice(0,5)),s=!0))),s||(HPe(i),n=q9(po,1),po[0]=251,r.push(po.slice(0,9)))}}function C9(r){if(r===1/0)Ts.setUint16(0,31744,!1);else if(r===-1/0)Ts.setUint16(0,64512,!1);else if(Number.isNaN(r))Ts.setUint16(0,32256,!1);else{Ts.setFloat32(0,r);let e=Ts.getUint32(0),t=(e&2139095040)>>23,i=e&8388607;if(t===255)Ts.setUint16(0,31744,!1);else if(t===0)Ts.setUint16(0,(r&2147483648)>>16|i>>13,!1);else{let n=t-127;n<-24?Ts.setUint16(0,0):n<-14?Ts.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):Ts.setUint16(0,(e&2147483648)>>16|n+15<<10|i>>13,!1)}}}function FA(r,e){if(r.length-e<2)throw new Error(`${st} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let i=t>>10&31,n=t&1023,s;return i===0?s=n*2**-24:i!==31?s=(n+1024)*2**(i-25):s=n===0?1/0:NaN,t&32768?-s:s}function O9(r){Ts.setFloat32(0,r,!1)}function KA(r,e){if(r.length-e<4)throw new Error(`${st} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function HPe(r){Ts.setFloat64(0,r,!1)}function q9(r,e){if(r.length-e<8)throw new Error(`${st} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}var KPe,jPe,VPe,zPe,P9,Ts,po,jA=Ge(()=>{u();es();ho();Aa();KPe=20,jPe=21,VPe=22,zPe=23;wv.encodedSize=function(e,t){let i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;let n;if(!t||t.float64!==!0){if(C9(i),n=FA(po,1),i===n||Number.isNaN(i))return 3;if(O9(i),n=KA(po,1),i===n)return 5}return 9};P9=new ArrayBuffer(9),Ts=new DataView(P9,1),po=new Uint8Array(P9,0);wv.compareTokens=Is.compareTokens});function Nt(r,e,t){throw new Error(`${st} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function _v(r){return()=>{throw new Error(`${st} ${r}`)}}function k9(r){switch(r.type){case he.false:return Sa([244]);case he.true:return Sa([245]);case he.null:return Sa([246]);case he.bytes:return r.value.length?void 0:Sa([64]);case he.string:return r.value===""?Sa([96]):void 0;case he.array:return r.value===0?Sa([128]):void 0;case he.map:return r.value===0?Sa([160]):void 0;case he.uint:return r.value<24?Sa([Number(r.value)]):void 0;case he.negint:if(r.value>=-24)return Sa([31-Number(r.value)])}}var ke,yo,VA=Ge(()=>{u();es();Aa();OA();vv();qA();BA();DA();LA();jA();ho();hd();ke=[];for(let r=0;r<=23;r++)ke[r]=Nt;ke[24]=KL;ke[25]=jL;ke[26]=VL;ke[27]=zL;ke[28]=Nt;ke[29]=Nt;ke[30]=Nt;ke[31]=Nt;for(let r=32;r<=55;r++)ke[r]=Nt;ke[56]=HL;ke[57]=$L;ke[58]=GL;ke[59]=YL;ke[60]=Nt;ke[61]=Nt;ke[62]=Nt;ke[63]=Nt;for(let r=64;r<=87;r++)ke[r]=XL;ke[88]=QL;ke[89]=JL;ke[90]=ZL;ke[91]=e9;ke[92]=Nt;ke[93]=Nt;ke[94]=Nt;ke[95]=_v("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)ke[r]=t9;ke[120]=r9;ke[121]=i9;ke[122]=n9;ke[123]=s9;ke[124]=Nt;ke[125]=Nt;ke[126]=Nt;ke[127]=_v("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)ke[r]=a9;ke[152]=c9;ke[153]=u9;ke[154]=l9;ke[155]=f9;ke[156]=Nt;ke[157]=Nt;ke[158]=Nt;ke[159]=h9;for(let r=160;r<=183;r++)ke[r]=d9;ke[184]=p9;ke[185]=y9;ke[186]=g9;ke[187]=b9;ke[188]=Nt;ke[189]=Nt;ke[190]=Nt;ke[191]=m9;for(let r=192;r<=215;r++)ke[r]=v9;ke[216]=w9;ke[217]=_9;ke[218]=E9;ke[219]=S9;ke[220]=Nt;ke[221]=Nt;ke[222]=Nt;ke[223]=Nt;for(let r=224;r<=243;r++)ke[r]=_v("simple values are not supported");ke[244]=Nt;ke[245]=Nt;ke[246]=Nt;ke[247]=A9;ke[248]=_v("simple values are not supported");ke[249]=I9;ke[250]=T9;ke[251]=R9;ke[252]=Nt;ke[253]=Nt;ke[254]=Nt;ke[255]=x9;yo=[];for(let r=0;r<24;r++)yo[r]=new Ue(he.uint,r,1);for(let r=-1;r>=-24;r--)yo[31-r]=new Ue(he.negint,r,1);yo[64]=new Ue(he.bytes,new Uint8Array(0),1);yo[96]=new Ue(he.string,"",1);yo[128]=new Ue(he.array,0,1);yo[160]=new Ue(he.map,0,1);yo[244]=new Ue(he.false,!1,1);yo[245]=new Ue(he.true,!0,1);yo[246]=new Ue(he.null,null,1)});function Ev(r,e={},t){let i=CL(r),n=e&&e.typeEncoders&&e.typeEncoders[i]||Au[i];if(typeof n=="function"){let o=n(r,i,e,t);if(o!=null)return o}let s=Au[i];if(!s)throw new Error(`${PA} unsupported type: ${i}`);return s(r,i,e,t)}function GPe(r,e){e.mapSorter&&r.sort(e.mapSorter)}function WPe(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==i.type)return t.type.compare(i.type);let n=t.type.major,s=xa[n].compareTokens(t,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function N9(r,e,t,i){if(Array.isArray(e))for(let n of e)N9(r,n,t,i);else t[e.type.major](r,e,i)}function YPe(r,e,t){let i=Ev(r,t);if(!Array.isArray(i)&&t.quickEncodeToken){let n=t.quickEncodeToken(i);if(n)return n;let s=e[i.type.major];if(s.encodedSize){let o=s.encodedSize(i,t),a=new gv(o);if(s(a,i,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return RA(a.chunks[0])}}return N9(B9,i,e,t),B9.toBytes(!0)}function Sv(r,e){return e=Object.assign({},$Pe,e),YPe(r,xa,e)}var $Pe,xa,B9,Vy,Su,Au,D9=Ge(()=>{u();OL();es();FL();ho();VA();hd();Aa();OA();vv();qA();BA();DA();LA();jA();$Pe={float64:!1,mapSorter:WPe,quickEncodeToken:k9},xa=[];xa[he.uint.major]=Is;xa[he.negint.major]=bv;xa[he.bytes.major]=dd;xa[he.string.major]=o9;xa[he.array.major]=kA;xa[he.map.major]=NA;xa[he.tag.major]=MA;xa[he.float.major]=wv;B9=new gv,Vy=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${PA} object contains circular references`);return new Vy(t,e)}},Su={null:new Ue(he.null,null),undefined:new Ue(he.undefined,void 0),true:new Ue(he.true,!0),false:new Ue(he.false,!1),emptyArray:new Ue(he.array,0),emptyMap:new Ue(he.map,0)},Au={number(r,e,t,i){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new Ue(he.float,r):r>=0?new Ue(he.uint,r):new Ue(he.negint,r)},bigint(r,e,t,i){return r>=BigInt(0)?new Ue(he.uint,r):new Ue(he.negint,r)},Uint8Array(r,e,t,i){return new Ue(he.bytes,r)},string(r,e,t,i){return new Ue(he.string,r)},boolean(r,e,t,i){return r?Su.true:Su.false},null(r,e,t,i){return Su.null},undefined(r,e,t,i){return Su.undefined},ArrayBuffer(r,e,t,i){return new Ue(he.bytes,new Uint8Array(r))},DataView(r,e,t,i){return new Ue(he.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,i){if(!r.length)return t.addBreakTokens===!0?[Su.emptyArray,new Ue(he.break)]:Su.emptyArray;i=Vy.createCheck(i,r);let n=[],s=0;for(let o of r)n[s++]=Ev(o,t,i);return t.addBreakTokens?[new Ue(he.array,r.length),n,new Ue(he.break)]:[new Ue(he.array,r.length),n]},Object(r,e,t,i){let n=e!=="Object",s=n?r.keys():Object.keys(r),o=n?r.size:s.length;if(!o)return t.addBreakTokens===!0?[Su.emptyMap,new Ue(he.break)]:Su.emptyMap;i=Vy.createCheck(i,r);let a=[],c=0;for(let f of s)a[c++]=[Ev(f,t,i),Ev(n?r.get(f):r[f],t,i)];return GPe(a,t),t.addBreakTokens?[new Ue(he.map,o),a,new Ue(he.break)]:[new Ue(he.map,o),a]}};Au.Map=Au.Object;Au.Buffer=Au.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Au[`${r}Array`]=Au.DataView});function QPe(r,e,t){let i=[];for(let n=0;n<r.value;n++){let s=Hy(e,t);if(s===Av){if(r.value===1/0)break;throw new Error(`${st} got unexpected break to lengthed array`)}if(s===zy)throw new Error(`${st} found array but not enough entries (got ${n}, expected ${r.value})`);i[n]=s}return i}function JPe(r,e,t){let i=t.useMaps===!0,n=i?void 0:{},s=i?new Map:void 0;for(let o=0;o<r.value;o++){let a=Hy(e,t);if(a===Av){if(r.value===1/0)break;throw new Error(`${st} got unexpected break to lengthed map`)}if(a===zy)throw new Error(`${st} found map but not enough entries (got ${o} [no key], expected ${r.value})`);if(i!==!0&&typeof a!="string")throw new Error(`${st} non-string keys not supported (got ${typeof a})`);let c=Hy(e,t);if(c===zy)throw new Error(`${st} found map but not enough entries (got ${o} [no value], expected ${r.value})`);i?s.set(a,c):n[a]=c}return i?s:n}function Hy(r,e){if(r.done())return zy;let t=r.next();if(t.type===he.break)return Av;if(t.type.terminal)return t.value;if(t.type===he.array)return QPe(t,r,e);if(t.type===he.map)return JPe(t,r,e);if(t.type===he.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let i=Hy(r,e);return e.tags[t.value](i)}throw new Error(`${st} tag not supported (${t.value})`)}throw new Error("unsupported")}function xv(r,e){if(!(r instanceof Uint8Array))throw new Error(`${st} data to decode must be a Uint8Array`);e=Object.assign({},XPe,e);let t=e.tokenizer||new M9(r,e),i=Hy(t,e);if(i===zy)throw new Error(`${st} did not find any content to decode`);if(i===Av)throw new Error(`${st} got unexpected break`);if(!t.done())throw new Error(`${st} too many terminals, data makes no sense`);return i}var XPe,M9,zy,Av,L9=Ge(()=>{u();ho();es();VA();XPe={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},M9=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=yo[e];if(t===void 0){let i=ke[e];if(!i)throw new Error(`${st} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;t=i(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}},zy=Symbol.for("DONE"),Av=Symbol.for("BREAK")});var Iv={};Ht(Iv,{Token:()=>Ue,Type:()=>he,decode:()=>xv,encode:()=>Sv});var $y=Ge(()=>{u();D9();L9();es()});var $l={};Ht($l,{code:()=>sCe,decode:()=>HA,encode:()=>zA,name:()=>nCe});function ZPe(r){if(r.asCID!==r)return null;let e=tt.asCID(r);if(!e)return null;let t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new Ue(he.tag,U9),new Ue(he.bytes,t)]}function eCe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function tCe(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function iCe(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return tt.decode(r.subarray(1))}var U9,rCe,F9,nCe,sCe,zA,HA,mc=Ge(()=>{u();$y();xe();U9=42;rCe={float64:!0,typeEncoders:{Object:ZPe,undefined:eCe,number:tCe}};F9={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};F9.tags[U9]=iCe;nCe="dag-cbor",sCe=113,zA=r=>Sv(r,rCe),HA=r=>xv(r,F9)});var j9=p((E3t,K9)=>{u();"use strict";K9.exports=()=>{}});var Iu=p(xu=>{u();"use strict";var Gy=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=Gy.code}};Gy.code="ERR_NOT_INITIALIZED";xu.NotInitializedError=Gy;var $A=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=gd.code}};$A.code="ERR_ALREADY_INITIALIZING";xu.AlreadyInitializingError=$A;var gd=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=gd.code}};gd.code="ERR_ALREADY_INITIALIZED";xu.AlreadyInitializedError=gd;var Wy=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=Wy.code}};Wy.code="ERR_NOT_STARTED";xu.NotStartedError=Wy;var Yy=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=Yy.code}};Yy.code="ERR_ALREADY_STARTING";xu.AlreadyStartingError=Yy;var Xy=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=Xy.code}};Xy.code="ERR_ALREADY_STARTED";xu.AlreadyStartedError=Xy;var Qy=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=Qy.code}};Qy.code="ERR_NOT_ENABLED";xu.NotEnabledError=Qy});var V9,z9=Ge(()=>{u();V9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"});var Jy={};Ht(Jy,{customAlphabet:()=>oCe,customRandom:()=>$9,nanoid:()=>aCe,random:()=>H9,urlAlphabet:()=>V9});var H9,$9,oCe,aCe,Zy=Ge(()=>{u();z9();H9=r=>crypto.getRandomValues(new Uint8Array(r)),$9=(r,e,t)=>{let i=(2<<Math.log(r.length-1)/Math.LN2)-1,n=-~(1.6*i*e/r.length);return()=>{let s="";for(;;){let o=t(n),a=n;for(;a--;)if(s+=r[o[a]&i]||"",s.length===e)return s}}},oCe=(r,e)=>$9(r,e,H9),aCe=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r));for(;r--;){let i=t[r]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e}});var GA=p((I3t,W9)=>{u();"use strict";var{nanoid:cCe}=(Zy(),Jy),uCe=Ze(),lCe=ct(),vc="/",G9=new TextEncoder().encode(vc),Tv=G9[0],Rs=class{constructor(e,t){if(typeof e=="string")this._buf=lCe(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Tv)throw new Error("Invalid key")}toString(e="utf8"){return uCe(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Rs(e.join(vc))}static random(){return new Rs(cCe().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=G9),this._buf[0]!==Tv){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Tv,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Tv;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),i=e.list();for(let n=0;n<t.length;n++){if(i.length<n+1)return!1;let s=t[n],o=i[n];if(s<o)return!0;if(s>o)return!1}return t.length<i.length}reverse(){return Rs.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(vc).slice(1)}type(){return fCe(this.baseNamespace())}name(){return hCe(this.baseNamespace())}instance(e){return new Rs(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(vc)||(e+=vc),e+=this.type(),new Rs(e)}parent(){let e=this.list();return e.length===1?new Rs(vc):new Rs(e.slice(0,-1).join(vc))}child(e){return this.toString()===vc?e:e.toString()===vc?this:new Rs(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Rs.withNamespaces([...this.namespaces(),...dCe(e.map(t=>t.namespaces()))])}};function fCe(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function hCe(r){let e=r.split(":");return e[e.length-1]}function dCe(r){return[].concat(...r)}W9.exports=Rs});var X9=p((T3t,Y9)=>{u();"use strict";var{nanoid:pCe}=(Zy(),Jy),yCe=(r=e=>e)=>r(pCe());Y9.exports=yCe});var bd=p((R3t,Q9)=>{u();"use strict";var gCe=async r=>{let e=[];for await(let t of r)e.push(t);return e};Q9.exports=gCe});var WA=p((P3t,J9)=>{u();"use strict";var bCe=X9(),mCe=bd(),vCe=(r,e)=>async function*(){yield*(await mCe(r)).sort(e)}(),wCe=(r,e)=>{let t=new RegExp("^"+e);return r.replace(t,"")};J9.exports={sortAll:vCe,tmpdir:bCe,replaceStartWith:wCe}});var Ia=p((C3t,Z9)=>{u();"use strict";var _Ce=async r=>{for await(let e of r);};Z9.exports=_Ce});var wc=p((O3t,eU)=>{u();"use strict";var ECe=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};eU.exports=ECe});var md=p((q3t,tU)=>{u();"use strict";var SCe=async function*(r,e){let t=0;if(!(e<1)){for await(let i of r)if(yield i,t++,t===e)return}};tU.exports=SCe});var YA=p((k3t,oU)=>{u();"use strict";var{sortAll:rU}=WA(),iU=Ia(),vd=wc(),nU=md(),sU=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await iU(this.putMany(e,i)),e=[],await iU(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=vd(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>vd(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>rU(n,s),i)),e.offset!=null){let n=0;i=vd(i,()=>n++>=e.offset)}return e.limit!=null&&(i=nU(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=vd(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>vd(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>rU(n,s),i)),e.offset!=null){let n=0;i=vd(i,()=>n++>=e.offset)}return e.limit!=null&&(i=nU(i,e.limit)),i}};oU.exports=sU});var XA=p((B3t,aU)=>{u();"use strict";var eg=ue();function ACe(r){return r=r||new Error("Cannot open database"),eg(r,"ERR_DB_OPEN_FAILED")}function xCe(r){return r=r||new Error("Delete failed"),eg(r,"ERR_DB_DELETE_FAILED")}function ICe(r){return r=r||new Error("Write failed"),eg(r,"ERR_DB_WRITE_FAILED")}function TCe(r){return r=r||new Error("Not Found"),eg(r,"ERR_NOT_FOUND")}function RCe(r){return r=r||new Error("Aborted"),eg(r,"ERR_ABORTED")}aU.exports={dbOpenFailedError:ACe,dbDeleteFailedError:xCe,dbWriteFailedError:ICe,notFoundError:TCe,abortedError:RCe}});var fU=p((N3t,lU)=>{u();"use strict";var cU=GA(),PCe=YA(),CCe=XA(),uU=class extends PCe{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw CCe.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new cU(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new cU(e))}};lU.exports=uU});var Lt=p((D3t,hU)=>{u();"use strict";var OCe=GA(),qCe=fU(),kCe=WA(),BCe=XA(),NCe=YA();hU.exports={Key:OCe,MemoryDatastore:qCe,utils:kCe,Errors:BCe,Adapter:NCe}});var pU=p((M3t,dU)=>{u();"use strict";dU.exports=function(){return Date.now()}});var gU=p((L3t,yU)=>{u();"use strict";var QA=pU();function JA(r,e,t){var i=this;this._started=QA(),this._rescheduled=0,this._scheduled=e,this._args=t,this._timer=setTimeout(n,e);function n(){i._rescheduled>0?(i._scheduled=i._rescheduled-(QA()-i._started),i._timer=setTimeout(n,i._scheduled),i._rescheduled=0):r.apply(null,i._args)}}JA.prototype.reschedule=function(r){var e=QA();return e+r-(this._started+this._scheduled)<0?!1:(this._started=e,this._rescheduled=r,!0)};JA.prototype.clear=function(){clearTimeout(this._timer)};function DCe(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");var r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new JA(arguments[0],arguments[1],r)}yU.exports=DCe});var ex=p((U3t,ZA)=>{u();"use strict";var{AbortController:MCe}=typeof self!="undefined"?self:typeof window!="undefined"?window:vl(),bU=gU(),tg=class extends MCe{constructor(e){super();this._ms=e,this._timer=bU(()=>this.abort(),e),Object.setPrototypeOf(this,tg.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=bU(()=>this.abort(),this._ms)}};ZA.exports=tg;ZA.exports.TimeoutController=tg});var rg=p((F3t,tx)=>{u();"use strict";var LCe=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;tx.exports=ht;tx.exports.default=ht;ht.nanosecond=ht.ns=1/1e6;ht.\u00B5s=ht.\u03BCs=ht.us=ht.microsecond=1/1e3;ht.millisecond=ht.ms=ht[""]=1;ht.second=ht.sec=ht.s=ht.ms*1e3;ht.minute=ht.min=ht.m=ht.s*60;ht.hour=ht.hr=ht.h=ht.m*60;ht.day=ht.d=ht.h*24;ht.week=ht.wk=ht.w=ht.d*7;ht.month=ht.b=ht.d*(365.25/12);ht.year=ht.yr=ht.y=ht.d*365.25;function ht(r="",e="ms"){var t=null;return r=(r+"").replace(/(\d)[,_](\d)/g,"$1$2"),r.replace(LCe,function(i,n,s){s=mU(s),s&&(t=(t||0)+parseFloat(n,10)*s)}),t&&t/(mU(e)||1)}function mU(r){return ht[r]||ht[r.toLowerCase().replace(/s$/,"")]}});var wU=p(vU=>{u();"use strict";var ig=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=ig.code}};ig.code="ERR_TIMEOUT";vU.TimeoutError=ig});var Oe=p((j3t,_U)=>{u();"use strict";var UCe=ex(),{anySignal:FCe}=wl(),{default:KCe}=rg(),{TimeoutError:rx}=wU();function jCe(r,e){return(...t)=>{let i=t[e??t.length-1];if(!i||!i.timeout)return r(...t);let n=typeof i.timeout=="string"?KCe(i.timeout):i.timeout,s=new UCe(n);i.signal=FCe([i.signal,s.signal]);let o=r(...t),a=new Promise((l,h)=>{s.signal.addEventListener("abort",()=>{h(new rx)})}),c=Date.now(),f=()=>{if(s.signal.aborted)throw new rx;if(Date.now()-c>n)throw s.abort(),new rx};return o[Symbol.asyncIterator]?async function*(){let l=o[Symbol.asyncIterator]();try{for(;;){let{value:h,done:d}=await Promise.race([l.next(),a]);if(d)break;f(),yield h}}catch(h){throw f(),h}finally{s.clear(),l.return&&l.return()}}():(async()=>{try{let l=await Promise.race([o,a]);return f(),l}catch(l){throw f(),l}finally{s.clear()}})()}}_U.exports=jCe});var ng=p((V3t,AU)=>{u();"use strict";var{CID:ix}=(xe(),Ce),EU=ue(),SU="/ipfs/",VCe=r=>{if(r instanceof Uint8Array)try{r=ix.decode(r)}catch(n){throw EU(n,"ERR_INVALID_CID")}if(r instanceof ix)return{cid:r,path:void 0};r.startsWith(SU)&&(r=r.substring(SU.length));let e=r.split("/"),t,i;try{t=ix.parse(e.shift()||"")}catch(n){throw EU(n,"ERR_INVALID_CID")}return e.length&&(i=`/${e.join("/")}`),{cid:t,path:i}};AU.exports=VCe});var Ui=p((z3t,IU)=>{u();"use strict";var zCe=sd(),{CID:wd}=(xe(),Ce),HCe=Lt().Key,nx=ue(),$Ce=Oe(),GCe=ng(),WCe=(xt(),At),YCe="ERR_BAD_PATH",XCe=r=>{if(r instanceof wd)return`/ipfs/${r}`;try{wd.parse(r),r=`/ipfs/${r}`}catch{}if(zCe.path(r))return r;throw nx(new Error(`invalid path: ${r}`),YCe)},QCe=r=>r instanceof Uint8Array?wd.decode(r).toString():r instanceof wd?r.toString():(r.indexOf("/ipfs/")===0&&(r=r.substring("/ipfs/".length)),r.charAt(r.length-1)==="/"&&(r=r.substring(0,r.length-1)),r),JCe=async function(r,e,t,i={}){let{cid:n,path:s}=GCe(t);s&&(i.path=s);let o=n,a=i.path||"";if(a.startsWith("/")&&(a=a.substring(1)),i.path)try{for await(let{value:c,remainderPath:f}of xU(n,i.path,e,r,{signal:i.signal})){if(!(c instanceof wd))break;a=f,o=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${a.split("/")[0]}" under ${o}`,c.code="ERR_NO_LINK"),c}return{cid:o,remainderPath:a||""}},ZCe=(r,e={})=>{if(r.type!=="file"&&r.type!=="directory"&&r.type!=="raw")throw new Error(`Unknown node type '${r.type}'`);let t={cid:r.cid,path:r.path,name:r.name,depth:r.path.split("/").length,size:r.size,type:"file"};return r.type==="directory"&&(t.type="dir"),r.type==="file"&&(t.size=r.unixfs.fileSize()),(r.type==="file"||r.type==="directory")&&(t.mode=r.unixfs.mode,r.unixfs.mtime!==void 0&&(t.mtime=r.unixfs.mtime)),e.includeContent&&(r.type==="file"||r.type==="raw")&&(t.content=r.content()),t},eOe=$Ce(async(r,e)=>await r),xU=async function*(r,e,t,i,n){let s=async f=>{let l=await t.getCodec(f.code),h=await i.blocks.get(f,n);return l.decode(h)},o=e.split("/").filter(Boolean),a=await s(r),c=r;for(o.length||(yield{value:a,remainderPath:""});o.length;){let f=o.shift();if(!f)throw nx(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(r.code===WCe.code&&Array.isArray(a.Links)){let l=a.Links.find(h=>h.Name===f);if(l){yield{value:l.Hash,remainderPath:o.join("/")},a=await s(l.Hash),c=l.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,f))a=a[f],yield{value:a,remainderPath:o.join("/")};else throw nx(new Error(`no link named "${f}" under ${c}`),"ERR_NO_LINK");a instanceof wd&&(c=a,a=await s(a))}};IU.exports={normalizePath:XCe,normalizeCidPath:QCe,resolvePath:JCe,mapFile:ZCe,withTimeout:eOe,resolve:xU,OFFLINE_ERROR:"This command must be run in online mode. Try running 'ipfs daemon' first.",MFS_ROOT_KEY:new HCe("/local/filesroot"),MFS_MAX_CHUNK_SIZE:262144,MFS_MAX_LINKS:174}});var Rv=p((H3t,TU)=>{u();"use strict";var{NotStartedError:tOe,AlreadyStartingError:rOe,AlreadyStartedError:iOe}=Iu(),{withTimeout:nOe}=Ui(),Ta=class{static create({start:e,stop:t}){return new Ta(e,t)}static async start(e,t){let{state:i,activate:n}=e;switch(i.status){case"stopped":try{let s=n(t);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new rOe;case"started":throw new iOe;case"stopping":return await i.ready,await Ta.start(e,t);default:return Ta.panic(e)}}static async stop(e){let{state:t,deactivate:i}=e;switch(t.status){case"stopped":break;case"starting":{try{await t.ready}catch(n){}return await Ta.stop(e)}case"stopping":return await t.ready;case"started":{i&&await i(t.value),e.state={status:"stopped"};break}default:Ta.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await nOe(e.ready,t);default:throw new tOe}}static panic({state:e}){let t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await Ta.use(this,e)}try(){return Ta.try(this)}};TU.exports=Ta});var PU=p(($3t,RU)=>{u();"use strict";var sOe=Rv();RU.exports=({network:r,preload:e,peerId:t,keychain:i,repo:n,ipns:s,mfsPreload:o,print:a,options:c})=>async()=>{let{libp2p:l}=await sOe.start(r,{peerId:t,repo:n,print:a,options:c});await Promise.all([s.startOnline({keychain:i,libp2p:l,peerId:t,repo:n}),e.start(),o.start()])}});var OU=p((G3t,CU)=>{u();"use strict";var oOe=Rv();CU.exports=({network:r,preload:e,ipns:t,repo:i,mfsPreload:n})=>async()=>{await Promise.all([e.stop(),t.stop(),n.stop(),oOe.stop(r),i.close()])}});var sg=p((W3t,qU)=>{u();qU.exports=function(r){if(!r)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,t=Object.create(null),i=Object.create(null);function n(s,o){t[s]=o,e++,e>=r&&(e=0,i=t,t=Object.create(null))}return{has:function(s){return t[s]!==void 0||i[s]!==void 0},remove:function(s){t[s]!==void 0&&(t[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var o=t[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return n(s,o),o},set:function(s,o){t[s]!==void 0?t[s]=o:n(s,o)},clear:function(){t=Object.create(null),i=Object.create(null)}}}});var sx=p((Y3t,BU)=>{u();"use strict";var aOe=sg(),kU=class{constructor(e){this.lru=aOe(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,i){this.lru.set(e,{value:t,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};BU.exports=kU});var DU=p((X3t,ox)=>{u();"use strict";var cOe=Object.prototype.hasOwnProperty,Sn="~";function og(){}Object.create&&(og.prototype=Object.create(null),new og().__proto__||(Sn=!1));function uOe(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function NU(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new uOe(t,i||r,n),o=Sn?Sn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function Pv(r,e){--r._eventsCount==0?r._events=new og:delete r._events[e]}function an(){this._events=new og,this._eventsCount=0}an.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)cOe.call(t,i)&&e.push(Sn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};an.prototype.listeners=function(e){var t=Sn?Sn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};an.prototype.listenerCount=function(e){var t=Sn?Sn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};an.prototype.emit=function(e,t,i,n,s,o){var a=Sn?Sn+e:e;if(!this._events[a])return!1;var c=this._events[a],f=arguments.length,l,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(h=1,l=new Array(f-1);h<f;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var d=c.length,y;for(h=0;h<d;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),f){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,i);break;case 4:c[h].fn.call(c[h].context,t,i,n);break;default:if(!l)for(y=1,l=new Array(f-1);y<f;y++)l[y-1]=arguments[y];c[h].fn.apply(c[h].context,l)}}return!0};an.prototype.on=function(e,t,i){return NU(this,e,t,i,!1)};an.prototype.once=function(e,t,i){return NU(this,e,t,i,!0)};an.prototype.removeListener=function(e,t,i,n){var s=Sn?Sn+e:e;if(!this._events[s])return this;if(!t)return Pv(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&Pv(this,s);else{for(var a=0,c=[],f=o.length;a<f;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:Pv(this,s)}return this};an.prototype.removeAllListeners=function(e){var t;return e?(t=Sn?Sn+e:e,this._events[t]&&Pv(this,t)):(this._events=new og,this._eventsCount=0),this};an.prototype.off=an.prototype.removeListener;an.prototype.addListener=an.prototype.on;an.prefixed=Sn;an.EventEmitter=an;typeof ox!="undefined"&&(ox.exports=an)});var LU=p((Q3t,MU)=>{u();"use strict";MU.exports=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(i=>{i(e())}).then(()=>t),t=>new Promise(i=>{i(e())}).then(()=>{throw t})))});var FU=p((J3t,Cv)=>{u();"use strict";var lOe=LU(),ax=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},UU=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new ax(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);lOe(r.then(i,n),()=>{clearTimeout(s)})});Cv.exports=UU;Cv.exports.default=UU;Cv.exports.TimeoutError=ax});var KU=p(cx=>{u();"use strict";Object.defineProperty(cx,"__esModule",{value:!0});function fOe(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}cx.default=fOe});var VU=p(ux=>{u();"use strict";Object.defineProperty(ux,"__esModule",{value:!0});var hOe=KU(),jU=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=hOe.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};ux.default=jU});var _c=p(lx=>{u();"use strict";Object.defineProperty(lx,"__esModule",{value:!0});var dOe=DU(),zU=FU(),pOe=VU(),Ov=()=>{},yOe=new zU.TimeoutError,HU=class extends dOe{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Ov,this._resolveIdle=Ov,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:pOe.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Ov,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Ov,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():zU.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(yOe)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};lx.default=HU});var WU=p((r6t,GU)=>{u();"use strict";var gOe=sx(),{default:bOe}=_c(),mOe=X0(),fx=new gOe(1e3),vOe=60*1e3,wOe=new bOe({concurrency:4}),$U=r=>{if(r.Path)return r.Path;throw new Error(r.Message)};GU.exports=async(r,e)=>(async(i,n={})=>{let s=new URLSearchParams(n);s.set("arg",i);let o=s.toString();if(!n.nocache&&fx.has(o)){let c=fx.get(o);return $U(c)}let a=await wOe.add(async()=>{let c=await mOe.get("https://ipfs.io/api/v0/dns",{searchParams:s}),f=new URL(c.url).search.slice(1),l=await c.json();return fx.set(f,l,vOe),l});return $U(a)})(r,e)});var XU=p((i6t,YU)=>{u();"use strict";var _Oe=WU(),EOe=Oe();function SOe(r){return r.endsWith(".eth")&&(r=r.replace(/.eth$/,".eth.link")),r}YU.exports=()=>EOe(async(e,t={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=SOe(e),_Oe(e,t)})});var JU=p((n6t,QU)=>{u();"use strict";QU.exports=({network:r})=>()=>{let e=r.try();return e!=null&&Boolean(e.libp2p.isStarted())}});var rF=p((s6t,tF)=>{u();"use strict";var ZU=sd(),{CID:eF}=(xe(),Ce),AOe=Oe(),{resolve:xOe}=Ui();tF.exports=({repo:r,codecs:e,bases:t,name:i})=>{async function n(s,o={}){if(!ZU.path(s))throw new Error("invalid argument "+s);if(ZU.ipnsPath(s))for await(let m of i.resolve(s,o))s=m;let[,a,c,...f]=s.split("/"),l=eF.parse(c),h=o.cidBase?await t.getBase(o.cidBase):void 0;if(f.length===0)return`/${a}/${l.toString(h&&h.encoder)}`;s=f.join("/");let d=xOe(l,s,e,r,o),y=l,g=s;for await(let m of d)m.value instanceof eF&&(y=m.value,g=m.remainderPath);return`/ipfs/${y.toString(h&&h.encoder)}${g?"/"+g:""}`}return AOe(n)}});var Un=p((o6t,iF)=>{u();"use strict";var IOe=async r=>{let e;for await(let t of r)e=t;return e};iF.exports=IOe});var sF=p((a6t,nF)=>{u();"use strict";var TOe=Un(),{CID:ROe}=(xe(),Ce);nF.exports=({addAll:r})=>(e,t={})=>{let i;return e instanceof ROe?i=r([{cid:e,...t}],t):i=r([{path:e.toString(),...t}],t),TOe(i)}});var _d=p((c6t,oF)=>{u();"use strict";var ag=ue(),{CID:hx}=(xe(),Ce);oF.exports=async function*(e){if(e==null)throw ag(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(e instanceof hx){yield go({cid:e});return}if(e instanceof String||typeof e=="string"){yield go({path:e});return}if(e.cid!=null||e.path!=null)return yield go(e);if(Symbol.iterator in e){let t=e[Symbol.iterator](),i=t.next();if(i.done)return t;if(i.value instanceof hx||i.value instanceof String||typeof i.value=="string"){yield go({cid:i.value});for(let n of t)yield go({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield go(i.value);for(let n of t)yield go(n);return}throw ag(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){let t=e[Symbol.asyncIterator](),i=await t.next();if(i.done)return t;if(i.value instanceof hx||i.value instanceof String||typeof i.value=="string"){yield go({cid:i.value});for await(let n of t)yield go({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield go(i.value);for await(let n of t)yield go(n);return}throw ag(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw ag(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")};function go(r){let e=r.cid||`${r.path}`;if(!e)throw ag(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let t={path:e,recursive:r.recursive!==!1};return r.metadata!=null&&(t.metadata=r.metadata),t}});var dx=p((u6t,aF)=>{u();aF.exports=POe;function POe(r,e,t){if(!r)return t;var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(n=i.shift(),!r||(r=r[n],r===void 0))return t;return r}});var px=p((l6t,cF)=>{u();"use strict";var COe=async r=>{let e=0;for await(let t of r)e++;return e};cF.exports=COe});var pF=p((f6t,dF)=>{u();"use strict";var{CID:uF}=(xe(),Ce),lF=Lt().Key,OOe=me()("ipfs:repo:migrator:migration-8"),qOe=px(),{base32:qv}=(en(),Zi),kOe=(Xn(),kn),BOe=(mn(),bn);function fF(r){return r.child?fF(r.child):r}function NOe(r){try{let e=qv.decode(`b${r.toString().toLowerCase().slice(1)}`),t=uF.decode(e).multihash.bytes,i=qv.encode(t).slice(1).toUpperCase();return new lF(`/${i}`,!1)}catch(e){return r}}function DOe(r){try{let e=qv.decode(`b${r.toString().toLowerCase().slice(1)}`),t=BOe.decode(e),i=qv.encode(uF.createV1(kOe.code,t).bytes).slice(1);return new lF(`/${i.toUpperCase()}`,!1)}catch{return r}}async function hF(r,e,t){let i=r.blocks;await i.open();let n=fF(i),s;s=await qOe(n.queryKeys({filters:[o=>t(o).toString()!==o.toString()]}));try{let o=0;for await(let a of n.query({})){let c=t(a.key);c.toString()!==a.key.toString()&&(o+=1,OOe(`Migrating Block from ${a.key} to ${c}`,await n.has(a.key)),await n.delete(a.key),await n.put(c,a.value),e(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await i.close()}}dF.exports={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e=()=>{})=>hF(r,e,NOe),revert:(r,e=()=>{})=>hF(r,e,DOe)}});var bF=p((d6t,gF)=>{u();"use strict";var Ed=Pi(),yF=Ed.Reader,MOe=Ed.Writer,h6t=Ed.util,cg=Ed.roots.default||(Ed.roots.default={});cg.ipfs=function(){var r={};return r.pin=function(){var e={};return e.Set=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(n,s){return s||(s=MOe.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&s.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&s.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&s.uint32(29).fixed32(n.seed),s},t.decode=function(n,s){n instanceof yF||(n=yF.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new cg.ipfs.pin.Set;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof cg.ipfs.pin.Set)return n;var s=new cg.ipfs.pin.Set;return n.version!=null&&(s.version=n.version>>>0),n.fanout!=null&&(s.fanout=n.fanout>>>0),n.seed!=null&&(s.seed=n.seed>>>0),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ed.util.toJSONOptions)},t}(),e}(),r}();gF.exports=cg});var vF=p((p6t,mF)=>{u();yx.BASE=2166136261;function yx(r){for(var e=yx.BASE,t=0,i=r.length;t<i;t++)e^=r.charCodeAt(t),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}mF.exports=yx});var gx=p((y6t,_F)=>{u();"use strict";var{Key:wF}=Lt(),{base32:LOe}=(en(),Zi),{CID:UOe}=(uu(),Rh),FOe=new wF("/local/pins"),KOe=256,jOe=8192,VOe=UOe.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),zOe={direct:"direct",recursive:"recursive"};function HOe(r){return new wF(`/${LOe.encode(r.multihash.bytes).toUpperCase().substring(1)}`)}_F.exports={PIN_DS_KEY:FOe,DEFAULT_FANOUT:KOe,MAX_ITEMS:jOe,EMPTY_KEY:VOe,PinTypes:zOe,cidToKey:HOe}});var SF=p((g6t,EF)=>{u();"use strict";function $Oe(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}EF.exports=$Oe});var PF=p((b6t,RF)=>{u();"use strict";var{CID:AF}=(xe(),Ce),{ipfs:{pin:{Set:bx}}}=bF(),GOe=vF(),mx=Jn(),kv=(xt(),At),{DEFAULT_FANOUT:vx,MAX_ITEMS:WOe,EMPTY_KEY:xF}=gx(),wx=_n(),YOe=SF(),XOe=Ze(),QOe=ct(),{sha256:IF}=(Hr(),Ir);function JOe(r){let e=r.Data;if(!e)throw new Error("No data present");let t=mx.decode(e),i=mx.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+t>e.length)throw new Error("Impossibly large set header length");let n=e.slice(i,t+i),s=bx.toObject(bx.decode(n),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(t+i)}}function ZOe(r,e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);let n=QOe(e.toString()),s=wx([t,n],t.byteLength+n.byteLength);return GOe(XOe(s))}async function*TF(r,e){let t=JOe(e),i=0;for(let n of e.Links){if(i<t.header.fanout){let s=n.Hash;if(!xF.equals(s)){let o=await r.get(s),a=kv.decode(o);yield*TF(r,a)}}else yield n.Hash;i++}}async function*eqe(r,e,t){let i=e.Links.find(o=>o.Name===t);if(!i)throw new Error("No link found with name "+t);let n=await r.get(i.Hash),s=kv.decode(n);yield*TF(r,s)}function tqe(r,e){return t(e,0);async function t(i,n){let s=bx.encode({version:1,fanout:vx,seed:n}).finish(),o=mx.encode(s.length),a=wx([o,s]),c=[];for(let l=0;l<vx;l++)c.push({Name:"",Tsize:1,Hash:xF});if(i.length<=WOe){let l=i.map(y=>({link:{Name:"",Tsize:1,Hash:y.key},data:y.data||new Uint8Array})).sort((y,g)=>YOe(y.link.Hash.bytes,g.link.Hash.bytes)),h=c.concat(l.map(y=>y.link));return{Data:wx([a,...l.map(y=>y.data)]),Links:h}}else{let l=i.reduce((d,y)=>{let g=ZOe(n,y.key)%vx;return d[g]=g in d?d[g].concat([y]):[y],d},[]),h=0;for(let d of l){let y=await t(d,n+1);await f(y,h),h++}return{Data:a,Links:c}}async function f(l,h){let d=kv.encode(l),y=await IF.digest(d),g=AF.createV0(y);await r.put(g,d);let m=l.Links.reduce((E,_)=>E+(_?.Tsize||0),0)+d.length;c[h]={Name:"",Tsize:m,Hash:g}}}}async function rqe(r,e,t){let i=await tqe(r,t.map(c=>({key:c}))),n=kv.encode(i),s=await IF.digest(n),o=AF.createV0(s);await r.put(o,n);let a=i.Links.reduce((c,f)=>c+f.Tsize,0)+n.length;return{Name:e,Tsize:a,Hash:o}}RF.exports={loadSet:eqe,storeSet:rqe}});var kF=p((m6t,qF)=>{u();"use strict";var{CID:_x}=(xe(),Ce),ug=(xt(),At),Ex=($y(),Iv),Sd=PF(),{cidToKey:CF,PIN_DS_KEY:Bv,PinTypes:Ad}=gx(),Sx=px(),{sha256:iqe}=(Hr(),Ir),nqe=(mn(),bn),{base32:sqe}=(en(),Zi);async function oqe(r,e,t,i){if(!await e.has(Bv))return;let n=await e.get(Bv),s=_x.decode(n),o=await r.get(s),a=ug.decode(o),c=0,f;f=await Sx(Sd.loadSet(r,a,Ad.recursive))+await Sx(Sd.loadSet(r,a,Ad.direct));for await(let l of Sd.loadSet(r,a,Ad.recursive)){c++;let h={depth:1/0};l.version!==0&&(h.version=l.version),l.code!==ug.code&&(h.codec=l.code),await t.put(CF(l),Ex.encode(h)),i(c/f*100,`Migrated recursive pin ${l}`)}for await(let l of Sd.loadSet(r,a,Ad.direct)){c++;let h={depth:0};l.version!==0&&(h.version=l.version),l.code!==ug.code&&(h.codec=l.code),await t.put(CF(l),Ex.encode(h)),i(c/f*100,`Migrated direct pin ${l}`)}await r.delete(s),await e.delete(Bv)}async function aqe(r,e,t,i){let n=[],s=[],o=0,a=await Sx(t.queryKeys({}));for await(let{key:d,value:y}of t.query({})){o++;let g=Ex.decode(y),m=_x.create(g.version||0,g.codec||ug.code,nqe.decode(sqe.decode("b"+d.toString().toLowerCase().split("/").pop())));g.depth===0?(i(o/a*100,`Reverted direct pin ${m}`),s.push(m)):(i(o/a*100,`Reverted recursive pin ${m}`),n.push(m))}i(100,"Updating pin root");let c={Links:[await Sd.storeSet(r,Ad.direct,s),await Sd.storeSet(r,Ad.recursive,n)]},f=ug.encode(c),l=await iqe.digest(f),h=_x.createV0(l);await r.put(h,f),await e.put(Bv,h.bytes)}async function OF(r,e,t){let i=r.blocks,n=r.datastore,s=r.pins;await i.open(),await n.open(),await s.open();try{await t(i,n,s,e)}finally{await s.close(),await n.close(),await i.close()}}qF.exports={version:9,description:"Migrates pins to datastore",migrate:(r,e=()=>{})=>OF(r,e,oqe),revert:(r,e=()=>{})=>OF(r,e,aqe)}});var Gl=p((v6t,LF)=>{u();"use strict";var{Key:BF,Errors:NF}=Lt(),cqe=new BF("/config"),uqe=new BF("/version");function Ax(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function DF(r,e,t){let i=await e(r);if(i)return i;let n=Ax(t);return n?new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function MF(r,e,t,i){if(await t(r))return e(r);let n=Ax(i);if(!n)throw NF.notFoundError();return new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(NF.notFoundError())}})}function Nv(r){let e=r.get.bind(r),t=r.has.bind(r);return r.get=i=>MF(i,e,t,r),r.has=i=>DF(i,t,r),r}function lqe(r){return{...r,root:Nv(r.root),datastore:Nv(r.datastore),pins:Nv(r.pins),keys:Nv(r.keys)}}LF.exports={wrapBackends:lqe,hasWithFallback:DF,getWithFallback:MF,findLevelJs:Ax,CONFIG_KEY:cqe,VERSION_KEY:uqe}});var zF=p((w6t,VF)=>{u();"use strict";var{findLevelJs:UF}=Gl(),fqe=ct(),hqe=Ze();async function dqe(r,e,t=()=>{}){let i=UF(e);if(!i){t(`${r} did not need an upgrade`);return}t(`Upgrading ${r}`),await jF(i,(s,o)=>[{type:"del",key:s},{type:"put",key:fqe(s),value:o}])}async function pqe(r,e,t=()=>{}){let i=UF(e);if(!i){t(`${r} did not need a downgrade`);return}t(`Downgrading ${r}`),await jF(i,(s,o)=>[{type:"del",key:s},{type:"put",key:hqe(s),value:o}])}function FF(r){return r.child?FF(r.child):r}async function KF(r,e,t){let i=Object.entries(r).map(([s,o])=>({key:s,backend:FF(o)})).filter(({key:s,backend:o})=>o.constructor.name==="LevelDatastore").map(({key:s,backend:o})=>({name:s,store:o}));e(0,`Migrating ${i.length} dbs`);let n=0;for(let{name:s,store:o}of i){await o.open();try{await t(s,o,c=>{e(Math.round(n/i.length*100),c)})}finally{n++,o.close()}}e(100,`Migrated ${i.length} dbs`)}VF.exports={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e=()=>{})=>KF(r,e,dqe),revert:(r,e=()=>{})=>KF(r,e,pqe)};function jF(r,e){function t(i,n){let s=r.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>n(c||o.error||new Error("aborted by user")),o.oncomplete=()=>n();function f(){var l=i[a++],h=l.key;try{var d=l.type==="del"?s.delete(h):s.put(l.value,h)}catch(y){c=y,o.abort();return}a<i.length&&(d.onsuccess=f)}f()}return new Promise((i,n)=>{let s=r.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(f,l,h)=>{if(f||l===void 0){let d=y=>{if(y){n(y);return}i()};s.end(d);return}t(e(l,h),a)};s.next(c)}})}});var $F=p((_6t,HF)=>{u();"use strict";var Wl={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};HF.exports=[Object.assign({version:1},Wl),Object.assign({version:2},Wl),Object.assign({version:3},Wl),Object.assign({version:4},Wl),Object.assign({version:5},Wl),Object.assign({version:6},Wl),Object.assign({version:7},Wl),pF(),kF(),zF()]});var Dv=p((E6t,GF)=>{u();"use strict";var xx=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code="ERR_NON_REVERSIBLE_MIGRATION",this.message=e}};xx.code="ERR_NON_REVERSIBLE_MIGRATION";var Ix=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code="ERR_NOT_INITIALIZED_REPO",this.message=e}};Ix.code="ERR_NOT_INITIALIZED_REPO";var Tx=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code="ERR_REQUIRED_PARAMETER",this.message=e}};Tx.code="ERR_REQUIRED_PARAMETER";var Rx=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code="ERR_INVALID_VALUE",this.message=e}};Rx.code="ERR_INVALID_VALUE";var Px=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code="ERR_MISSING_REPO_OPTIONS",this.message=e}};Px.code="ERR_MISSING_REPO_OPTIONS";GF.exports={NonReversibleMigrationError:xx,NotInitializedRepoError:Ix,RequiredParameterError:Tx,InvalidValueError:Rx,MissingRepoOptionsError:Px}});var YF=p((S6t,WF)=>{u();"use strict";var Cx=me()("ipfs:repo:migrator:repo:init"),{CONFIG_KEY:yqe,VERSION_KEY:gqe}=Gl(),{MissingRepoOptionsError:bqe}=Dv();async function mqe(r){if(!r)throw new bqe("Please pass repo options when trying to open a repo");let e=r.root;try{await e.open();let t=await e.has(gqe),i=await e.has(yqe);return!t||!i?(Cx(`Version entry present: ${t}`),Cx(`Config entry present: ${i}`),!1):!0}catch(t){return Cx("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}WF.exports={isRepoInitialized:mqe}});var JF=p((A6t,QF)=>{u();"use strict";var vqe=YF(),{MissingRepoOptionsError:wqe,NotInitializedRepoError:_qe}=Dv(),{VERSION_KEY:XF}=Gl(),Eqe=ct(),Sqe=Ze();async function Aqe(r){if(!await vqe.isRepoInitialized(r))throw new _qe("Repo is not initialized!");let e=r.root;await e.open();try{return parseInt(Sqe(await e.get(XF)))}finally{await e.close()}}async function xqe(r,e){if(!e)throw new wqe("Please pass repo options when trying to open a repo");let t=e.root;await t.open(),await t.put(XF,Eqe(String(r))),await t.close()}QF.exports={getVersion:Aqe,setVersion:xqe}});var iK=p((x6t,rK)=>{u();"use strict";var Ox=$F(),Yl=JF(),ss=Dv(),{wrapBackends:ZF}=Gl(),bo=me()("ipfs:repo:migrator");function eK(r){return r=r||Ox,!Array.isArray(r)||r.length===0?0:r[r.length-1].version}async function Iqe(r,e,t,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||Ox,!r)throw new ss.RequiredParameterError("Path argument is required!");if(!t)throw new ss.RequiredParameterError("repoOptions argument is required!");if(!i)throw new ss.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(i)||i<=0)throw new ss.InvalidValueError("Version has to be positive integer!");e=ZF(e);let c=await Yl.getVersion(e);if(c===i){bo("Nothing to migrate.");return}if(c>i)throw new ss.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${i}), you probably wanted to revert it?`);tK(a,c,i);let f;!o&&!n&&(f=await t.repoLock.lock(r));try{for(let l of a){if(i!==void 0&&l.version>i)break;if(!(l.version<=c)){bo(`Migrating version ${l.version}`);try{if(!o){let h=()=>{};s&&(h=(d,y)=>s(l.version,d.toFixed(2),y)),await l.migrate(e,h)}}catch(h){let d=l.version-1;throw bo(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${d}`),await Yl.setVersion(d,e),new Error(`During migration to version ${l.version} exception was raised: ${h.stack||h.message||h}`)}bo(`Migrating to version ${l.version} finished`)}}o||await Yl.setVersion(i||eK(a),e),bo("Repo successfully migrated",i!==void 0?`to version ${i}!`:"to latest version!")}finally{!o&&!n&&f&&await f.close()}}async function Tqe(r,e,t,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||Ox,!r)throw new ss.RequiredParameterError("Path argument is required!");if(!t)throw new ss.RequiredParameterError("repoOptions argument is required!");if(!i)throw new ss.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(i)||i<=0)throw new ss.InvalidValueError("Version has to be positive integer!");e=ZF(e);let c=await Yl.getVersion(e);if(c===i){bo("Nothing to revert.");return}if(c<i)throw new ss.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${i}), you probably wanted to migrate it?`);tK(a,i,c,!0);let f;!o&&!n&&(f=await t.repoLock.lock(r)),bo(`Reverting from version ${c} to ${i}`);try{let l=a.slice().reverse();for(let h of l){if(h.version<=i)break;if(!(h.version>c)){bo(`Reverting migration version ${h.version}`);try{if(!o){let d=()=>{};s&&(d=(y,g)=>s(h.version,y.toFixed(2),g)),await h.revert(e,d)}}catch(d){let y=h.version;throw bo(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${y}`),await Yl.setVersion(y,e),d.message=`During reversion to version ${h.version} exception was raised: ${d.message}`,d}bo(`Reverting to version ${h.version} finished`)}}o||await Yl.setVersion(i,e),bo(`All migrations successfully reverted to version ${i}!`)}finally{!o&&!n&&f&&await f.close()}}function tK(r,e,t,i=!1){let n=0;for(let s of r){if(s.version>t)break;if(s.version>e){if(i&&!s.revert)throw new ss.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);n++}}if(n!==t-e)throw new ss.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}rK.exports={getCurrentRepoVersion:Yl.getVersion,getLatestMigrationVersion:eK,errors:ss,migrate:Iqe,revert:Tqe}});var oK=p((I6t,Mv)=>{u();"use strict";Mv.exports=Oqe;Mv.exports.format=nK;Mv.exports.parse=sK;var Rqe=/\B(?=(\d{3})+(?!\d))/g,Pqe=/(?:\.0*|(\.[^0]+)0+)$/,Tu={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},Cqe=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function Oqe(r,e){return typeof r=="string"?sK(r):typeof r=="number"?nK(r,e):null}function nK(r,e){if(!Number.isFinite(r))return null;var t=Math.abs(r),i=e&&e.thousandsSeparator||"",n=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!Tu[a.toLowerCase()])&&(t>=Tu.pb?a="PB":t>=Tu.tb?a="TB":t>=Tu.gb?a="GB":t>=Tu.mb?a="MB":t>=Tu.kb?a="KB":a="B");var c=r/Tu[a.toLowerCase()],f=c.toFixed(s);return o||(f=f.replace(Pqe,"$1")),i&&(f=f.replace(Rqe,i)),f+n+a}function sK(r){if(typeof r=="number"&&!isNaN(r))return r;if(typeof r!="string")return null;var e=Cqe.exec(r),t,i="b";return e?(t=parseFloat(e[1]),i=e[4].toLowerCase()):(t=parseInt(r,10),i="b"),Math.floor(Tu[i]*t)}});var cK=p((T6t,aK)=>{u();"use strict";aK.exports={repoVersion:10}});var lK=p((R6t,uK)=>{u();"use strict";var qqe=Lt().Key,kqe=me(),Bqe=kqe("ipfs:repo:version"),Nqe=Ze(),Dqe=ct(),{hasWithFallback:Mqe,getWithFallback:Lqe}=Gl(),qx=new qqe("version");uK.exports=r=>({async exists(){return Mqe(qx,r.has.bind(r),r)},async get(){let e=await Lqe(qx,r.get.bind(r),r.has.bind(r),r);return parseInt(Nqe(e),10)},set(e){return r.put(qx,Dqe(String(e)))},async check(e){let t=await this.get();return Bqe("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}})});var kx=p((P6t,hK)=>{u();hK.exports=Uqe;function Uqe(r,e,t){typeof e=="string"&&(e=e.split(".")),typeof e=="symbol"&&(e=[e]);var i=e.pop();if(!i)return!1;fK(i);for(var n;n=e.shift();)if(fK(n),typeof r[n]=="undefined"&&(r[n]={}),r=r[n],!r||typeof r!="object")return!1;return r[i]=t,!0}function fK(r){if(r==="__proto__"||r==="constructor"||r==="prototype")throw new Error("setting of prototype values not supported")}});var Lv=p(Xl=>{u();"use strict";var lg=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=lg.code}};lg.code="ERR_LOCK_EXISTS";Xl.LockExistsError=lg;var fg=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=fg.code}};fg.code="ERR_NOT_FOUND";Xl.NotFoundError=fg;var hg=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=hg.code}};hg.code="ERR_INVALID_REPO_VERSION";Xl.InvalidRepoVersionError=hg;Xl.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED";Xl.ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN";Xl.ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED"});var yK=p((O6t,pK)=>{u();"use strict";var{Key:Fqe}=Lt(),{default:Kqe}=_c(),jqe=dx(),Vqe=kx(),Bx=ue(),dK=Lv(),zqe=Ze(),Hqe=ct(),{hasWithFallback:$qe,getWithFallback:Gqe}=Gl(),Nx=new Fqe("config");pK.exports=r=>{let e=new Kqe({concurrency:1}),t={async getAll(s={}){let o=await Gqe(Nx,r.get.bind(r),r.has.bind(r),r,{signal:s.signal});return JSON.parse(zqe(o))},async get(s,o={}){if(s==null)throw new dK.NotFoundError(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=jqe(a,s);if(c===void 0)throw new dK.NotFoundError(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw Bx(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw Bx(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>i({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw Bx(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:s},o.signal))},async exists(){return $qe(Nx,r.has.bind(r),r)}};return t;async function i(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let f=await t.getAll();return typeof f=="object"&&f!==null&&Vqe(f,a,c),n(f)}return n(c)}function n(s){let o=Hqe(JSON.stringify(s,null,2));return r.put(Nx,o)}}});var bK=p((q6t,gK)=>{u();"use strict";gK.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var vK=p((k6t,mK)=>{u();"use strict";var Dx=bK();mK.exports=(r,e={})=>{if(!Dx(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");let{deep:t}=e,i=[],n=[],s=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let f=[];return i.push(a),n.push(f),f.push(...a.map(l=>Array.isArray(l)?s(l):Dx(l)?o(l):l)),f},o=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let f={},l=Object.keys(a).sort(e.compare);i.push(a),n.push(f);for(let h of l){let d=a[h],y;t&&Array.isArray(d)?y=s(d):y=t&&Dx(d)?o(d):d,Object.defineProperty(f,h,{...Object.getOwnPropertyDescriptor(a,h),value:y})}return f};return Array.isArray(r)?t?s(r):r.slice():o(r)}});var _K=p((B6t,wK)=>{u();"use strict";var Wqe=Lt().Key,Yqe=vK(),Xqe=Ze(),Qqe=ct(),Mx=new Wqe("datastore_spec");wK.exports=r=>({exists(){return r.has(Mx)},async get(){let e=await r.get(Mx);return JSON.parse(Xqe(e))},async set(e){return r.put(Mx,Qqe(JSON.stringify(Yqe(e,{deep:!0}))))}})});var SK=p((N6t,EK)=>{u();"use strict";var Jqe=Lt().Key,Zqe=ct(),Lx=new Jqe("api");EK.exports=r=>({async get(){let e=await r.get(Lx);return e&&e.toString()},set(e){return r.put(Lx,Zqe(e.toString()))},delete(){return r.delete(Lx)}})});var xK=p((M6t,AK)=>{u();AK.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var Ux=p((U6t,TK)=>{u();var IK=xK();TK.exports=class{constructor(e){this.hwm=e||16,this.head=new IK(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new IK(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var Ra=p((F6t,RK)=>{u();var Fx=Ux();RK.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new Fx,i,n,s,o=()=>{if(!t.isEmpty()){if(r.writev){let m,E=[];for(;!t.isEmpty();){if(m=t.shift(),m.error)throw m.error;E.push(m.value)}return{done:m.done,value:E}}let g=t.shift();if(g.error)throw g.error;return g}return s?{done:!0}:new Promise((g,m)=>{n=E=>(n=null,E.error?m(E.error):r.writev&&!E.done?g({done:E.done,value:[E.value]}):g(E),i)})},a=g=>n?n(g):(t.push(g),i),c=g=>(t=new Fx,n?n({error:g}):(t.push({error:g}),i)),f=g=>s?i:a({done:!1,value:g}),l=g=>s?i:(s=!0,g?c(g):a({done:!0})),h=()=>(t=new Fx,l(),{done:!0}),d=g=>(l(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:h,throw:d,push:f,end:l},!e)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),e&&(e(g),e=null),{done:!0}},return(){return y.return(),e&&(e(),e=null),{done:!0}},push:f,end(g){return y.end(g),e&&(e(g),e=null),i}},i}});var CK=p((K6t,PK)=>{u();"use strict";var eke=wc(),tke=Ra(),rke=Ia(),{CID:ike}=(xe(),Ce),nke=ue(),{identity:ske}=(cc(),aa);PK.exports=oke;function oke(r){return{open(){return r.open()},close(){return r.close()},query(e,t){return r.query(e,t)},queryKeys(e,t){return r.queryKeys(e,t)},async get(e,t){let i=Ru(e);return i.isIdentity?Promise.resolve(i.digest):r.get(e,t)},async*getMany(e,t){for await(let i of e)yield this.get(i,t)},async put(e,t,i){let{isIdentity:n}=Ru(e);n||await r.put(e,t,i)},async*putMany(e,t){let i=tke();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{await rke(r.putMany(async function*(){for await(let{key:s,value:o}of e)Ru(s).isIdentity||(yield{key:s,value:o}),i.push({key:s,value:o})}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,t){let{isIdentity:i}=Ru(e);return i?Promise.resolve(!0):r.has(e,t)},delete(e,t){let{isIdentity:i}=Ru(e);return i?Promise.resolve():r.delete(e,t)},deleteMany(e,t){return r.deleteMany(eke(e,i=>!Ru(i).isIdentity),t)},batch(){let e=r.batch();return{put(t,i){let{isIdentity:n}=Ru(t);n||e.put(t,i)},delete(t){let{isIdentity:i}=Ru(t);i||e.delete(t)},commit:t=>e.commit(t)}}}}function Ru(r){let e=ike.asCID(r);if(e==null)throw nke(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==ske.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}});var Uv=p(Kx=>{u();"use strict";var ake=Lv(),cke=me(),OK=cke("ipfs:repo:lock:memory"),qK="repo.lock",dg={};Kx.lock=async r=>{let e=r+"/"+qK;if(OK("locking %s",e),dg[e]===!0)throw new ake.LockExistsError(`Lock already being held for file: ${e}`);return dg[e]=!0,{async close(){dg[e]&&delete dg[e]}}};Kx.locked=async r=>{let e=r+"/"+qK;return OK(`checking lock: ${e}`),Boolean(dg[e])}});var BK=p((V6t,kK)=>{u();"use strict";kK.exports={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:Uv()}});var DK=p((z6t,NK)=>{u();"use strict";NK.exports={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}});var xd=p((H6t,MK)=>{u();"use strict";var uke=async r=>{for await(let e of r)return e};MK.exports=uke});var Kv={};Ht(Kv,{Block:()=>pg,create:()=>dke,createUnsafe:()=>LK,decode:()=>hke,encode:()=>fke});var Fv,jx,Vx,lke,pg,fke,hke,LK,dke,jv=Ge(()=>{u();uu();Fv=({enumerable:r=!0,configurable:e=!1}={})=>({enumerable:r,configurable:e,writable:!1}),jx=function*(r,e){if(r!=null&&!(r instanceof Uint8Array))for(let[t,i]of Object.entries(r)){let n=[...e,t];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=tt.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*jx(o,a))}else{let s=tt.asCID(i);s?yield[n.join("/"),s]:yield*jx(i,n)}}},Vx=function*(r,e){if(r!=null)for(let[t,i]of Object.entries(r)){let n=[...e,t];if(yield n.join("/"),i!=null&&!(i instanceof Uint8Array)&&typeof i=="object"&&!tt.asCID(i))if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s];yield a.join("/"),typeof o=="object"&&!tt.asCID(o)&&(yield*Vx(o,a))}else yield*Vx(i,n)}},lke=(r,e)=>{let t=r;for(let[i,n]of e.entries()){if(t=t[n],t==null)throw new Error(`Object has no property at ${e.slice(0,i+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);let s=tt.asCID(t);if(s)return{value:s,remaining:e.slice(i+1).join("/")}}return{value:t}},pg=class{constructor({cid:e,bytes:t,value:i}){if(!e||!t||typeof i=="undefined")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=i,this.asBlock=this,Object.defineProperties(this,{cid:Fv(),bytes:Fv(),value:Fv(),asBlock:Fv()})}links(){return jx(this.value,[])}tree(){return Vx(this.value,[])}get(e="/"){return lke(this.value,e.split("/").filter(Boolean))}},fke=async({value:r,codec:e,hasher:t})=>{if(typeof r=="undefined")throw new Error('Missing required argument "value"');if(!e||!t)throw new Error("Missing required argument: codec or hasher");let i=e.encode(r),n=await t.digest(i),s=tt.create(1,e.code,n);return new pg({value:r,bytes:i,cid:s})},hke=async({bytes:r,codec:e,hasher:t})=>{if(!r)throw new Error('Missing required argument "bytes"');if(!e||!t)throw new Error("Missing required argument: codec or hasher");let i=e.decode(r),n=await t.digest(r),s=tt.create(1,e.code,n);return new pg({value:i,bytes:r,cid:s})},LK=({bytes:r,cid:e,value:t,codec:i})=>{let n=t!==void 0?t:i&&i.decode(r);if(n===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new pg({cid:e,bytes:r,value:n})},dke=async({bytes:r,cid:e,hasher:t,codec:i})=>{if(!r)throw new Error('Missing required argument "bytes"');if(!t)throw new Error('Missing required argument "hasher"');let n=i.decode(r),s=await t.digest(r);if(!Sl.equals(e.multihash.bytes,s.bytes))throw new Error("CID hash does not match bytes");return LK({bytes:r,cid:e,value:n,codec:i})}});var zx=p((G6t,jK)=>{u();"use strict";var{Key:pke}=Lt(),{CID:UK}=(uu(),Rh),yke=(Xn(),kn),gke=ue(),{base32:FK}=(en(),Zi),bke=(mn(),bn);function mke(r){let e=UK.asCID(r);if(e==null)throw gke(new Error("Not a valid cid"),"ERR_INVALID_CID");let t=FK.encode(e.multihash.bytes);return new pke("/"+t.slice(1).toUpperCase(),!1)}function vke(r){return UK.createV1(yke.code,KK(r))}function KK(r){return bke.decode(FK.decode(`b${r.toString().toLowerCase().substring(1)}`))}jK.exports={cidToKey:mke,keyToCid:vke,keyToMultihash:KK}});var Hx=p((W6t,zK)=>{u();"use strict";var wke=me()("ipfs:repo:utils:walk-dag"),_ke=(jv(),Kv);async function*VK(r,e,t,i){try{let n=await e.get(r,i),s=await t(r.code),o=_ke.createUnsafe({bytes:n,cid:r,codec:s});for(let[,a]of o.links())yield a,yield*VK(a,e,t,i)}catch(n){throw wke("Could not walk DAG for CID",r.toString(),n),n}}zK.exports=VK});var $x=p((Y6t,XK)=>{u();"use strict";var{CID:HK}=(xe(),Ce),Eke=ue(),Ske=me(),$K=xd(),Ake=(jv(),Kv),Pu=($y(),Iv),Vv=(xt(),At),{cidToKey:zv,keyToMultihash:GK}=zx(),WK=Hx();function xke(r){let e=`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`;return Eke(new Error(e),"ERR_INVALID_PIN_TYPE")}var Ps={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"},YK=class{constructor({pinstore:e,blockstore:t,loadCodec:i}){this.pinstore=e,this.blockstore=t,this.loadCodec=i,this.log=Ske("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let i={depth:0};return e.version!==0&&(i.version=e.version),e.code!==Vv.code&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),this.pinstore.put(zv(e),Pu.encode(i))}unpin(e,t){return this.pinstore.delete(zv(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let i={depth:1/0};e.version!==0&&(i.version=e.version),e.code!==Vv.code&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),await this.pinstore.put(zv(e),Pu.encode(i))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[i=>Pu.decode(i.value).depth===0]})){let i=Pu.decode(t.value),n=i.version||0,s=i.codec!=null?i.codec:Vv.code,o=GK(t.key);yield{cid:HK.create(n,s,o),metadata:i.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[i=>Pu.decode(i.value).depth===1/0]})){let i=Pu.decode(t.value),n=i.version||0,s=i.codec!=null?i.codec:Vv.code,o=GK(t.key);yield{cid:HK.create(n,s,o),metadata:i.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let i of WK(t,this.blockstore,this.loadCodec,e)){let n=[Ps.recursive];(await this.isPinnedWithType(i,n)).pinned||(yield i)}}async isPinnedWithType(e,t,i){Array.isArray(t)||(t=[t]);let n=t.includes(Ps.all),s=t.includes(Ps.direct),o=t.includes(Ps.recursive),a=t.includes(Ps.indirect);if(o||s||n){let l=await $K(this.pinstore.query({prefix:zv(e).toString(),filters:[h=>{if(n)return!0;let d=Pu.decode(h.value);return t.includes(d.depth===0?Ps.direct:Ps.recursive)}],limit:1}));if(l){let h=Pu.decode(l.value);return{cid:e,pinned:!0,reason:h.depth===0?Ps.direct:Ps.recursive,metadata:h.metadata}}}let c=this;async function*f(l,h){for await(let{cid:d}of h)for await(let y of WK(d,c.blockstore,c.loadCodec))if(y.equals(l)){yield d;return}}if(n||a){let l=await $K(f(e,this.recursiveKeys()));if(l)return{cid:e,pinned:!0,reason:Ps.indirect,parent:l}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t){let i=new Set,n=async(s,o)=>{if(i.has(s.toString()))return;i.add(s.toString());let a=await this.blockstore.get(s,o),c=await this.loadCodec(s.code),f=Ake.createUnsafe({bytes:a,cid:s,codec:c});await Promise.all([...f.links()].map(([,l])=>n(l,o)))};await n(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Ps).includes(e))throw xke(e);return!0}};XK.exports={PinManager:YK,PinTypes:Ps}});var mo=p((X6t,QK)=>{u();"use strict";var Ike=async function*(r,e){for await(let t of r)yield e(t)};QK.exports=Ike});var ej=p((Q6t,ZK)=>{u();"use strict";var Tke=mo(),Rke=ue(),{PinTypes:Pke}=$x();ZK.exports=Cke;function Cke(r,e){return{open(){return e.open()},close(){return e.close()},query(t,i){return e.query(t,i)},queryKeys(t,i){return e.queryKeys(t,i)},async get(t,i){return e.get(t,i)},async*getMany(t,i){yield*e.getMany(t,i)},async put(t,i,n){await e.put(t,i,n)},async*putMany(t,i){yield*e.putMany(t,i)},has(t,i){return e.has(t,i)},async delete(t,i){return await JK(t,r),e.delete(t,i)},deleteMany(t,i){return e.deleteMany(Tke(t,async n=>(await JK(n,r),n)),i)},batch(){return e.batch()}}}async function JK(r,e){let{pinned:t,reason:i}=await e.isPinnedWithType(r,Pke.all);if(t)throw Rke(new Error(`pinned: ${i}`),"ERR_BLOCK_PINNED")}});var br=p((J6t,Gx)=>{u();"use strict";var Id=typeof Reflect=="object"?Reflect:null,tj=Id&&typeof Id.apply=="function"?Id.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},Hv;Id&&typeof Id.ownKeys=="function"?Hv=Id.ownKeys:Object.getOwnPropertySymbols?Hv=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Hv=function(e){return Object.getOwnPropertyNames(e)};function Oke(r){console&&console.warn&&console.warn(r)}var rj=Number.isNaN||function(e){return e!==e};function zt(){zt.init.call(this)}Gx.exports=zt;Gx.exports.once=Nke;zt.EventEmitter=zt;zt.prototype._events=void 0;zt.prototype._eventsCount=0;zt.prototype._maxListeners=void 0;var ij=10;function $v(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(zt,"defaultMaxListeners",{enumerable:!0,get:function(){return ij},set:function(r){if(typeof r!="number"||r<0||rj(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");ij=r}});zt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};zt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||rj(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function nj(r){return r._maxListeners===void 0?zt.defaultMaxListeners:r._maxListeners}zt.prototype.getMaxListeners=function(){return nj(this)};zt.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")tj(c,this,t);else for(var f=c.length,l=uj(c,f),i=0;i<f;++i)tj(l[i],this,t);return!0};function sj(r,e,t,i){var n,s,o;if($v(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),o=s[e]),o===void 0)o=s[e]=t,++r._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),n=nj(r),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,Oke(a)}return r}zt.prototype.addListener=function(e,t){return sj(this,e,t,!1)};zt.prototype.on=zt.prototype.addListener;zt.prototype.prependListener=function(e,t){return sj(this,e,t,!0)};function qke(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function oj(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=qke.bind(i);return n.listener=t,i.wrapFn=n,n}zt.prototype.once=function(e,t){return $v(t),this.on(e,oj(this,e,t)),this};zt.prototype.prependOnceListener=function(e,t){return $v(t),this.prependListener(e,oj(this,e,t)),this};zt.prototype.removeListener=function(e,t){var i,n,s,o,a;if($v(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():kke(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};zt.prototype.off=zt.prototype.removeListener;zt.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function aj(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?Bke(n):uj(n,n.length)}zt.prototype.listeners=function(e){return aj(this,e,!0)};zt.prototype.rawListeners=function(e){return aj(this,e,!1)};zt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):cj.call(r,e)};zt.prototype.listenerCount=cj;function cj(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}zt.prototype.eventNames=function(){return this._eventsCount>0?Hv(this._events):[]};function uj(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function kke(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Bke(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Nke(r,e){return new Promise(function(t,i){function n(o){r.removeListener(e,s),i(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}lj(r,e,s,{once:!0}),e!=="error"&&Dke(r,n,{once:!0})})}function Dke(r,e,t){typeof r.on=="function"&&lj(r,"error",e,t)}function lj(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(s){i.once&&r.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var Wx=p((Z6t,fj)=>{u();fj.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var hj=p(()=>{u()});var Ej=p((rAt,_j)=>{u();var Mke=br().EventEmitter,{nanoid:Lke}=(Zy(),Jy),{WORKER_REQUEST_READ_LOCK:dj,WORKER_RELEASE_READ_LOCK:pj,MASTER_GRANT_READ_LOCK:yj,WORKER_REQUEST_WRITE_LOCK:gj,WORKER_RELEASE_WRITE_LOCK:bj,MASTER_GRANT_WRITE_LOCK:mj}=Wx(),yg,vj=(r,e,t,i,n)=>(s,o)=>{o&&o.type===t&&r.emit(e,o.name,()=>(s.send({type:n,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=f=>{f&&f.type===i&&f.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},wj=(r,e,t,i)=>()=>{let n=Lke();return process.send({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{a&&a.type===t&&a.identifier===n&&(process.removeListener("message",o),s(()=>{process.send({type:i,identifier:n,name:r})}))};process.on("message",o)})};_j.exports=r=>{try{if(yg=hj(),!Object.keys(yg).length)return}catch(e){return}if(yg.isMaster||r.singleProcess){let e=new Mke;return yg.on("message",vj(e,"requestReadLock",dj,pj,yj)),yg.on("message",vj(e,"requestWriteLock",gj,bj,mj)),e}return{isWorker:!0,readLock:e=>wj(e,dj,yj,pj),writeLock:e=>wj(e,gj,mj,bj)}}});var Yx=p((iAt,Sj)=>{u();var Cu={},Td=r=>{r.addEventListener("message",e=>{Td.dispatchEvent("message",r,e)}),r.port&&r.port.addEventListener("message",e=>{Td.dispatchEvent("message",r,e)})};Td.addEventListener=(r,e)=>{Cu[r]||(Cu[r]=[]),Cu[r].push(e)};Td.removeEventListener=(r,e)=>{!Cu[r]||(Cu[r]=Cu[r].filter(t=>t===e))};Td.dispatchEvent=function(){let r=Array.prototype.slice.call(arguments),e=r.shift();!Cu[e]||Cu[e].forEach(t=>t.apply(null,r))};Sj.exports=Td});var Bj=p((nAt,kj)=>{u();var Uke=br().EventEmitter,{nanoid:Fke}=(Zy(),Jy),{WORKER_REQUEST_READ_LOCK:Aj,WORKER_RELEASE_READ_LOCK:xj,MASTER_GRANT_READ_LOCK:Ij,WORKER_REQUEST_WRITE_LOCK:Tj,WORKER_RELEASE_WRITE_LOCK:Rj,MASTER_GRANT_WRITE_LOCK:Pj}=Wx(),Cj=Yx(),Oj=(r,e,t,i,n)=>(s,o)=>{if(!o||!o.data||o.data.type!==t)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};r.emit(e,a.name,()=>(s.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(c=>{let f=l=>{if(!l||!l.data)return;let h={type:l.data.type,name:l.data.name,identifier:l.data.identifier};h&&h.type===i&&h.identifier===a.identifier&&(s.removeEventListener("message",f),c())};s.addEventListener("message",f)})))},qj=(r,e,t,i)=>()=>{let n=Fke();return globalThis.postMessage({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===t&&c.identifier===n&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:i,identifier:n,name:r})}))};globalThis.addEventListener("message",o)})},Kke={singleProcess:!1};kj.exports=r=>{if(r=Object.assign({},Kke,r),!!globalThis.document||r.singleProcess){let t=new Uke;return Cj.addEventListener("message",Oj(t,"requestReadLock",Aj,xj,Ij)),Cj.addEventListener("message",Oj(t,"requestWriteLock",Tj,Rj,Pj)),t}return{isWorker:!0,readLock:t=>qj(t,Aj,Ij,xj),writeLock:t=>qj(t,Tj,Pj,Rj)}}});var Nj=p((oAt,Xx)=>{u();"use strict";var Gv,sAt=Xx.exports.timeout=function(r,e){var t=new Gv,i;return Promise.race([r,new Promise(function(n,s){i=setTimeout(function(){s(t)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};Gv=Xx.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};Gv.prototype=Object.create(Error.prototype);Gv.prototype.name="TimeoutError"});var Zx=p((aAt,Jx)=>{u();var jke=Ej(),Vke=Bj(),{default:Dj}=_c(),{timeout:zke}=Nj(),Hke=Yx(),Ql={},Ou;function Qx(r,e){let t,i=new Promise(n=>{t=n});return r.add(()=>zke((()=>new Promise(n=>{t(()=>{n()})}))(),e.timeout)),i}var $ke=(r,e)=>{if(Ou.isWorker)return{readLock:Ou.readLock(r,e),writeLock:Ou.writeLock(r,e)};let t=new Dj({concurrency:1}),i=null;return{readLock:()=>{if(i)return Qx(i,e);i=new Dj({concurrency:e.concurrency,autoStart:!1});let n=i,s=Qx(i,e);return t.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,Qx(t,e))}},Gke={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};Jx.exports=(r,e)=>(e||(e={}),typeof r=="object"&&(e=r,r="lock"),r||(r="lock"),e=Object.assign({},Gke,e),Ou||(Ou=jke(e)||Vke(e),Ou.isWorker||(Ou.on("requestReadLock",(t,i)=>{!Ql[t]||Ql[t].readLock().then(n=>i().finally(()=>n()))}),Ou.on("requestWriteLock",async(t,i)=>{!Ql[t]||Ql[t].writeLock().then(n=>i().finally(()=>n()))}))),Ql[r]||(Ql[r]=$ke(r,e)),Ql[r]);Jx.exports.Worker=function(r,e){e=e||globalThis.Worker;let t;try{t=new e(r)}catch(i){i.message.includes("not a constructor")&&(t=e(r))}if(!t)throw new Error("Could not create Worker from",e);return Hke(t),t}});var Wv=p((cAt,Mj)=>{u();"use strict";async function*Wke(r,e=1){let t=[];e<1&&(e=1);for await(let i of r)for(t.push(i);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length;)yield t.slice(0,e),t=t.slice(e)}Mj.exports=Wke});var Yv=p((uAt,Lj)=>{u();"use strict";var Yke=Wv();async function*Xke(r,e=1){for await(let t of Yke(r,e)){let i=t.map(n=>n().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let n=0;n<i.length;n++){let s=await i[n];if(s.ok)yield s.value;else throw s.err}}}Lj.exports=Xke});var Gr=p((lAt,Rd)=>{u();var Uj=(...r)=>{let e;for(;r.length;)e=r.shift()(e);return e},eI=r=>r&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),Xv=r=>r&&typeof r.sink=="function"&&eI(r.source),Qke=r=>e=>(r.sink(e),r.source),Fj=(...r)=>{if(Xv(r[0])){let e=r[0];r[0]=()=>e.source}else if(eI(r[0])){let e=r[0];r[0]=()=>e}if(r.length>1&&Xv(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)Xv(r[e])&&(r[e]=Qke(r[e]));return Uj(...r)};Rd.exports=Fj;Rd.exports.pipe=Fj;Rd.exports.rawPipe=Uj;Rd.exports.isIterable=eI;Rd.exports.isDuplex=Xv});var Pd=p((fAt,Kj)=>{u();"use strict";var Jke=Ra(),Zke=async function*(...r){let e=Jke();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let i of t)e.push(i)})),e.end()}catch(t){e.end(t)}},0),yield*e};Kj.exports=Zke});var Hj=p((hAt,zj)=>{u();"use strict";var{CID:eBe}=(xe(),Ce),gg=me()("ipfs:repo:gc"),{Errors:tBe}=Lt(),rBe=tBe.notFoundError().code,iBe=Yv(),{pipe:nBe}=Gr(),jj=Pd(),tI=mo(),sBe=wc(),{Key:oBe}=Lt(),{base32:Vj}=(en(),Zi),aBe=Hx(),cBe=256,uBe=new oBe("/local/filesroot");zj.exports=({gcLock:r,pins:e,blockstore:t,root:i,loadCodec:n})=>{async function*s(){let o=Date.now();gg("Creating set of marked blocks");let a=await r.writeLock();try{let c=await lBe({pins:e,blockstore:t,root:i,loadCodec:n}),f=t.queryKeys({});yield*fBe({blockstore:t},c,f),gg(`Complete (${Date.now()-o}ms)`)}finally{a()}}return s};async function lBe({pins:r,blockstore:e,loadCodec:t,root:i}){let n=async function*(){let a;try{a=await i.get(uBe)}catch(f){if(f.code===rBe){gg("No blocks in MFS");return}throw f}let c=eBe.decode(a);yield c,yield*aBe(c,e,t)}(),s=jj(tI(r.recursiveKeys(),({cid:a})=>a),r.indirectKeys(),tI(r.directKeys(),({cid:a})=>a),n),o=new Set;for await(let a of jj(s,n))o.add(Vj.encode(a.multihash.bytes));return o}async function*fBe({blockstore:r},e,t){let i=0,n=0;yield*nBe(iBe(tI(t,async o=>async function(){i++;try{let c=Vj.encode(o.multihash.bytes);if(e.has(c))return null;try{await r.delete(o),n++}catch(f){return{err:new Error(`Could not delete block with CID ${o}: ${f.message}`)}}return{cid:o}}catch(c){let f=`Could delete block with CID ${o}`;return gg(f,c),{err:new Error(f+`: ${c.message}`)}}}),cBe),o=>sBe(o,Boolean)),gg(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${n} blocks.`)}});var Jl=p((dAt,Qj)=>{u();"use strict";var $j=dx(),hBe=me(),Cd=ue(),Gj=iK(),dBe=oK(),pBe=mr(),Qv=cK(),yBe=lK(),gBe=yK(),bBe=_K(),mBe=SK(),vBe=CK(),wBe=BK(),Wj=DK(),Ec=Lv(),{PinManager:_Be,PinTypes:EBe}=$x(),SBe=ej(),ABe=Zx(),xBe=Hj(),IBe=Uv(),TBe=Uv(),Fn=hBe("ipfs:repo"),RBe=Number.MAX_SAFE_INTEGER,PBe="repoAutoMigrate",Yj=class{constructor(e,t,i,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=pBe(wBe,n),this.closed=!0,this.path=e,this.root=i.root,this.datastore=i.datastore,this.keys=i.keys;let s=i.blocks,o=i.pins;this.pins=new _Be({pinstore:o,blockstore:s,loadCodec:t});let a=SBe(this.pins,s);this.blocks=vBe(a),this.version=yBe(this.root),this.config=gBe(this.root),this.spec=bBe(this.root),this.apiAddr=mBe(this.root),this.gcLock=ABe(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=xBe({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){Fn("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(OBe(e)),await this.spec.set(qBe(e)),await this.version.set(Qv.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw Cd(new Error("repo is already open"),Ec.ERR_REPO_ALREADY_OPEN);Fn("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),Fn("acquired repo.lock"),!await this.version.check(Qv.repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(Qv.repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new Ec.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");Fn("creating datastore"),await this.datastore.open(),Fn("creating blocks"),this.blocks.open(),Fn("creating keystore"),await this.keys.open(),Fn("creating pins"),await this.pins.pinstore.open(),this.closed=!1,Fn("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){Fn("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw Cd(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){Fn("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?Cd(new Error("repo is not initialized yet"),Ec.ERR_REPO_NOT_INITIALIZED,{path:this.path}):t}if(!e)throw Cd(new Error("repo is not initialized yet"),Ec.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw Cd(new Error("repo is already closed"),Ec.ERR_REPO_ALREADY_CLOSED);Fn("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Ec.ERR_REPO_NOT_INITIALIZED&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),Fn("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,i,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),Xj(this.datastore),Xj(this.keys)]),o=t.size+n+s;return{repoPath:this.path,storageMax:e,version:i,numObjects:t.count,repoSize:o}}throw Cd(new Error("repo is not initialized yet"),Ec.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(PBe)}catch(t){if(t.code===Ec.NotFoundError.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(Fn(`reverting to version ${e}`),Gj.revert(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Fn(`migrating to version ${e}`),Gj.migrate(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt(dBe(e))}catch(e){return BigInt(RBe)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:i,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(i.bytes.byteLength);return{count:e,size:t}}};async function Xj(r){let e=BigInt(0);for await(let t of r.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}function CBe(r,e,t,i){return new Yj(r,e,t,i)}Qj.exports={createRepo:CBe,repoVersion:Qv.repoVersion,errors:Ec,utils:{blockstore:zx()},locks:{memory:IBe,fs:TBe},PinTypes:EBe};function OBe(r){return r.Datastore=Object.assign({},Wj,$j(r,"datastore")),r}function qBe(r){let e={...Wj.Spec,...$j(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}});var eV=p((pAt,Zj)=>{u();"use strict";var{resolvePath:kBe}=Ui(),BBe=Oe(),NBe=_d(),{PinTypes:Jj}=Jl();Zj.exports=({repo:r,codecs:e})=>{async function*t(i,n={}){let s=async function*(){for await(let{path:c,recursive:f,metadata:l}of NBe(i)){let{cid:h}=await kBe(r,e,c),{reason:d}=await r.pins.isPinnedWithType(h,[Jj.recursive,Jj.direct]);if(d==="recursive"&&!f)throw new Error(`${h} already pinned recursively`);f?await r.pins.pinRecursively(h,{metadata:l}):await r.pins.pinDirectly(h,{metadata:l}),yield h}};if(!Boolean(n.lock)){yield*s();return}let a=await r.gcLock.readLock();try{yield*s()}finally{a()}}return BBe(t)}});var iV=p((yAt,rV)=>{u();"use strict";var{PinTypes:Kn}=Jl(),DBe=_d(),{resolvePath:MBe}=Ui(),LBe=Oe(),tV=ue();function bg(r,e,t){let i={type:r,cid:e};return t&&(i.metadata=t),i}rV.exports=({repo:r,codecs:e})=>{async function*t(i={}){let n=Kn.all;if(i.type&&(n=i.type,!Object.keys(Kn).includes(n)))throw tV(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(i.paths){let s=!1;for await(let{path:o}of DBe(i.paths)){let{cid:a}=await MBe(r,e,o),{reason:c,pinned:f,parent:l,metadata:h}=await r.pins.isPinnedWithType(a,n);if(!f)throw tV(new Error(`path '${o}' is not pinned`),"ERR_NOT_PINNED");switch(c){case Kn.direct:case Kn.recursive:s=!0,yield bg(c,a,h);break;default:s=!0,yield bg(`${Kn.indirect} through ${l}`,a,h)}}if(!s)throw new Error("No match found");return}if(n===Kn.recursive||n===Kn.all)for await(let{cid:s,metadata:o}of r.pins.recursiveKeys())yield bg(Kn.recursive,s,o);if(n===Kn.indirect||n===Kn.all)for await(let s of r.pins.indirectKeys(i))yield bg(Kn.indirect,s);if(n===Kn.direct||n===Kn.all)for await(let{cid:s,metadata:o}of r.pins.directKeys())yield bg(Kn.direct,s,o)}return LBe(t)}});var sV=p((gAt,nV)=>{u();"use strict";var UBe=Un();nV.exports=({rmAll:r})=>(e,t={})=>UBe(r([{path:e,...t}],t))});var aV=p((bAt,oV)=>{u();"use strict";var FBe=_d(),{resolvePath:KBe}=Ui(),jBe=Oe(),{PinTypes:rI}=Jl();oV.exports=({repo:r,codecs:e})=>{async function*t(i,n={}){let s=await r.gcLock.readLock();try{for await(let{path:o,recursive:a}of FBe(i)){let{cid:c}=await KBe(r,e,o),{pinned:f,reason:l}=await r.pins.isPinnedWithType(c,rI.all);if(!f)throw new Error(`${c} is not pinned`);switch(l){case rI.recursive:if(!a)throw new Error(`${c} is pinned recursively`);await r.pins.unpin(c),yield c;break;case rI.direct:await r.pins.unpin(c),yield c;break;default:throw new Error(`${c} is pinned indirectly under ${l}`)}}}finally{s()}}return jBe(t)}});var lV=p((mAt,uV)=>{u();"use strict";var VBe=sF(),zBe=eV(),HBe=iV(),$Be=sV(),GBe=aV(),cV=class{constructor({codecs:e,repo:t}){let i=zBe({codecs:e,repo:t});this.addAll=i,this.add=VBe({addAll:i});let n=GBe({codecs:e,repo:t});this.rmAll=n,this.rm=$Be({rmAll:n}),this.ls=HBe({codecs:e,repo:t}),this.remote={add:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:async function*(s,o={}){return Promise.reject(new Error("Not implemented"))},rm:(s,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(s,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(s,o)=>Promise.reject(new Error("Not implemented")),rm:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:(s={})=>Promise.reject(new Error("Not implemented"))}}}};uV.exports=cV});var fV=p((wAt,iI)=>{u();var vAt=function(){typeof iI!="undefined"&&(iI.exports=_);var r=24*3600,e=3200,t=(365*400+97)*e/400,i=r*t,n=i*1e3,s=1e3*1e4*1e4*r,o=16777216,a=65536*65536,c=1e3*1e3,f=1e3*1e3*1e3,l="000000000",h=Math.trunc||N,d=_.prototype;_.fromDate=Q,_.fromInt64BE=G(0,1,2,3,0,4),_.fromInt64LE=G(3,2,1,0,4,0),_.fromString=X,_.fromTimeT=O,d.year=0,d.time=0,d.nano=0,d.addNano=M,d.getNano=$,d.getTimeT=w,d.getYear=T,d.toDate=z,d.toJSON=S,d.toString=C,d.writeInt64BE=B(0,1,2,3,0,4),d.writeInt64LE=B(3,2,1,0,4,0);var y="%Y-%m-%dT%H:%M:%S.%NZ",g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return _;function _(W,ne,oe){var de=this;if(!(de instanceof _))return new _(W,ne,oe);de.time=+W||0,de.nano=+ne||0,de.year=+oe||0,q(de)}function T(){var W=this.toDate().getUTCFullYear();return W+this.year}function q(W){var ne=W.year,oe=W.time,de=W.nano,pe,_e;if(de<0||c<=de){var P=Math.floor(de/c);de-=P*c,oe+=P,pe=1}var U=ne%e;if(oe<-s||s<oe||U){_e=h(oe/n),_e&&(ne+=_e*e,oe-=_e*n);var H=V(oe);H.setUTCFullYear(U+H.getUTCFullYear()),ne-=U,oe=+H,_e=h(ne/e);var J=oe+_e*n;_e&&-s<=J&&J<=s&&(ne-=_e*e,oe=J),pe=1}return pe&&(W.year=ne,W.time=oe,W.nano=de),W}function z(){var W=q(this);return V(W.time)}function V(W){var ne=new Date(0);return ne.setTime(W),ne}function M(W){return this.nano+=+W||0,this}function $(){var W=q(this);return(W.time%1e3*c+ +W.nano+f)%f}function X(W){var ne,oe=new _;W+="";var de=W.replace(/^\s*[+\-]?\d+/,function(pe){var _e=+pe,P=1970+(_e-1970)%400;return oe.year=_e-P,P}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(pe,_e,P){return _e<0&&(P*=-1),ne=(+_e*60+ +P)*6e4,""}).replace(/\.\d+$/,function(pe){return oe.nano=+(pe+l).substr(1,9),""}).split(/\D+/);if(de.length>1?de[1]--:de[1]=0,oe.time=ne=Date.UTC.apply(Date,de)-(ne||0),isNaN(ne))throw new TypeError("Invalid Date");return q(oe)}function Q(W){return new _(+W)}function O(W){return b(W,0)}function b(W,ne){ne|=0,ne*=a,W=+W||0;var oe=h(ne/i)+h(W/i),de=ne%i+W%i,pe=h(de/i);return pe&&(oe+=pe,de-=pe*i),new _(de*1e3,0,oe*e)}function w(){var W=q(this),ne=Math.floor(W.time/1e3),oe=W.year;return oe&&(ne+=oe*t*r/e),ne}function S(){return this.toString().replace(/0{1,6}Z$/,"Z")}function C(W){var ne=this,oe=ne.toDate(),de={H:J,L:K,M:x,N:k,S:L,Y:_e,a:Y,b:ee,d:U,e:H,m:P};return pe(W||y);function pe(Z){return Z.replace(/%./g,function(ce){var ge=ce[1],be=E[ge],Ke=de[ge];return be?pe(be):Ke?Ke():ce})}function _e(){var Z=ne.getYear();return Z>999999?"+"+Z:Z>9999?"+"+ae(Z,6):Z>=0?ae(Z,4):Z>=-999999?"-"+ae(-Z,6):Z}function P(){return D(oe.getUTCMonth()+1)}function U(){return D(oe.getUTCDate())}function H(){return v(oe.getUTCDate())}function J(){return D(oe.getUTCHours())}function x(){return D(oe.getUTCMinutes())}function L(){return D(oe.getUTCSeconds())}function K(){return ae(oe.getUTCMilliseconds(),3)}function k(){return ae(ne.getNano(),9)}function Y(){return m[oe.getUTCDay()]}function ee(){return g[oe.getUTCMonth()]}}function B(W,ne,oe,de,pe,_e){return P;function P(H,J){var x=q(this);H||(H=new Array(8)),F(H,J|=0);var L=Math.floor(x.time/1e3),K=x.year*(t*r/e),k=h(K/a)+h(L/a),Y=K%a+L%a,ee=Math.floor(Y/a);return ee&&(k+=ee,Y-=ee*a),U(H,J+pe,k),U(H,J+_e,Y),H}function U(H,J,x){H[J+W]=x>>24&255,H[J+ne]=x>>16&255,H[J+oe]=x>>8&255,H[J+de]=x&255}}function G(W,ne,oe,de,pe,_e){return P;function P(H,J){F(H,J|=0);var x=U(H,J+pe),L=U(H,J+_e);return b(L,x)}function U(H,J){return H[J+W]*o+(H[J+ne]<<16|H[J+oe]<<8|H[J+de])}}function F(W,ne){var oe=W&&W.length;if(oe==null)throw new TypeError("Invalid Buffer");if(oe<ne+8)throw new RangeError("Out of range")}function N(W){var ne=W-W%1;return ne===0&&(W<0||W===0&&1/W!=1/0)?-0:ne}function v(W){return(W>9?"":" ")+(W|0)}function D(W){return(W>9?"":"0")+(W|0)}function ae(W,ne){return(l+(W|0)).substr(-ne)}}()});var EV=p((_At,_V)=>{u();_V.exports=rr;var Cs=null;try{Cs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function rr(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}rr.prototype.__isLong__;Object.defineProperty(rr.prototype,"__isLong__",{value:!0});function jn(r){return(r&&r.__isLong__)===!0}rr.isLong=jn;var hV={},dV={};function Zl(r,e){var t,i,n;return e?(r>>>=0,(n=0<=r&&r<256)&&(i=dV[r],i)?i:(t=ir(r,(r|0)<0?-1:0,!0),n&&(dV[r]=t),t)):(r|=0,(n=-128<=r&&r<128)&&(i=hV[r],i)?i:(t=ir(r,r<0?-1:0,!1),n&&(hV[r]=t),t))}rr.fromInt=Zl;function Os(r,e){if(isNaN(r))return e?ef:qs;if(e){if(r<0)return ef;if(r>=yV)return wV}else{if(r<=-gV)return Vn;if(r+1>=gV)return vV}return r<0?Os(-r,e).neg():ir(r%Od|0,r/Od|0,e)}rr.fromNumber=Os;function ir(r,e,t){return new rr(r,e,t)}rr.fromBits=ir;var Jv=Math.pow;function nI(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return qs;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=r.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return nI(r.substring(1),e,t).neg();for(var n=Os(Jv(t,8)),s=qs,o=0;o<r.length;o+=8){var a=Math.min(8,r.length-o),c=parseInt(r.substring(o,o+a),t);if(a<8){var f=Os(Jv(t,a));s=s.mul(f).add(Os(c))}else s=s.mul(n),s=s.add(Os(c))}return s.unsigned=e,s}rr.fromString=nI;function vo(r,e){return typeof r=="number"?Os(r,e):typeof r=="string"?nI(r,e):ir(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}rr.fromValue=vo;var pV=1<<16,WBe=1<<24,Od=pV*pV,yV=Od*Od,gV=yV/2,bV=Zl(WBe),qs=Zl(0);rr.ZERO=qs;var ef=Zl(0,!0);rr.UZERO=ef;var qd=Zl(1);rr.ONE=qd;var mV=Zl(1,!0);rr.UONE=mV;var sI=Zl(-1);rr.NEG_ONE=sI;var vV=ir(4294967295|0,2147483647|0,!1);rr.MAX_VALUE=vV;var wV=ir(4294967295|0,4294967295|0,!0);rr.MAX_UNSIGNED_VALUE=wV;var Vn=ir(0,2147483648|0,!1);rr.MIN_VALUE=Vn;var Re=rr.prototype;Re.toInt=function(){return this.unsigned?this.low>>>0:this.low};Re.toNumber=function(){return this.unsigned?(this.high>>>0)*Od+(this.low>>>0):this.high*Od+(this.low>>>0)};Re.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Vn)){var t=Os(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Os(Jv(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),f=o.sub(c.mul(s)).toInt()>>>0,l=f.toString(e);if(o=c,o.isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}};Re.getHighBits=function(){return this.high};Re.getHighBitsUnsigned=function(){return this.high>>>0};Re.getLowBits=function(){return this.low};Re.getLowBitsUnsigned=function(){return this.low>>>0};Re.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Vn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};Re.isZero=function(){return this.high===0&&this.low===0};Re.eqz=Re.isZero;Re.isNegative=function(){return!this.unsigned&&this.high<0};Re.isPositive=function(){return this.unsigned||this.high>=0};Re.isOdd=function(){return(this.low&1)==1};Re.isEven=function(){return(this.low&1)==0};Re.equals=function(e){return jn(e)||(e=vo(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};Re.eq=Re.equals;Re.notEquals=function(e){return!this.eq(e)};Re.neq=Re.notEquals;Re.ne=Re.notEquals;Re.lessThan=function(e){return this.comp(e)<0};Re.lt=Re.lessThan;Re.lessThanOrEqual=function(e){return this.comp(e)<=0};Re.lte=Re.lessThanOrEqual;Re.le=Re.lessThanOrEqual;Re.greaterThan=function(e){return this.comp(e)>0};Re.gt=Re.greaterThan;Re.greaterThanOrEqual=function(e){return this.comp(e)>=0};Re.gte=Re.greaterThanOrEqual;Re.ge=Re.greaterThanOrEqual;Re.compare=function(e){if(jn(e)||(e=vo(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Re.comp=Re.compare;Re.negate=function(){return!this.unsigned&&this.eq(Vn)?Vn:this.not().add(qd)};Re.neg=Re.negate;Re.add=function(e){jn(e)||(e=vo(e));var t=this.high>>>16,i=this.high&65535,n=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,f=e.low&65535,l=0,h=0,d=0,y=0;return y+=s+f,d+=y>>>16,y&=65535,d+=n+c,h+=d>>>16,d&=65535,h+=i+a,l+=h>>>16,h&=65535,l+=t+o,l&=65535,ir(d<<16|y,l<<16|h,this.unsigned)};Re.subtract=function(e){return jn(e)||(e=vo(e)),this.add(e.neg())};Re.sub=Re.subtract;Re.multiply=function(e){if(this.isZero())return qs;if(jn(e)||(e=vo(e)),Cs){var t=Cs.mul(this.low,this.high,e.low,e.high);return ir(t,Cs.get_high(),this.unsigned)}if(e.isZero())return qs;if(this.eq(Vn))return e.isOdd()?Vn:qs;if(e.eq(Vn))return this.isOdd()?Vn:qs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(bV)&&e.lt(bV))return Os(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,f=e.low>>>16,l=e.low&65535,h=0,d=0,y=0,g=0;return g+=o*l,y+=g>>>16,g&=65535,y+=s*l,d+=y>>>16,y&=65535,y+=o*f,d+=y>>>16,y&=65535,d+=n*l,h+=d>>>16,d&=65535,d+=s*f,h+=d>>>16,d&=65535,d+=o*c,h+=d>>>16,d&=65535,h+=i*l+n*f+s*c+o*a,h&=65535,ir(y<<16|g,h<<16|d,this.unsigned)};Re.mul=Re.multiply;Re.divide=function(e){if(jn(e)||(e=vo(e)),e.isZero())throw Error("division by zero");if(Cs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Cs.div_u:Cs.div_s)(this.low,this.high,e.low,e.high);return ir(t,Cs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?ef:qs;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ef;if(e.gt(this.shru(1)))return mV;s=ef}else{if(this.eq(Vn)){if(e.eq(qd)||e.eq(sI))return Vn;if(e.eq(Vn))return qd;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(qs)?e.isNegative()?qd:sI:(n=this.sub(e.mul(i)),s=i.add(n.div(e)),s)}else if(e.eq(Vn))return this.unsigned?ef:qs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=qs}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),c=a<=48?1:Jv(2,a-48),f=Os(i),l=f.mul(e);l.isNegative()||l.gt(n);)i-=c,f=Os(i,this.unsigned),l=f.mul(e);f.isZero()&&(f=qd),s=s.add(f),n=n.sub(l)}return s};Re.div=Re.divide;Re.modulo=function(e){if(jn(e)||(e=vo(e)),Cs){var t=(this.unsigned?Cs.rem_u:Cs.rem_s)(this.low,this.high,e.low,e.high);return ir(t,Cs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Re.mod=Re.modulo;Re.rem=Re.modulo;Re.not=function(){return ir(~this.low,~this.high,this.unsigned)};Re.and=function(e){return jn(e)||(e=vo(e)),ir(this.low&e.low,this.high&e.high,this.unsigned)};Re.or=function(e){return jn(e)||(e=vo(e)),ir(this.low|e.low,this.high|e.high,this.unsigned)};Re.xor=function(e){return jn(e)||(e=vo(e)),ir(this.low^e.low,this.high^e.high,this.unsigned)};Re.shiftLeft=function(e){return jn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ir(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ir(0,this.low<<e-32,this.unsigned)};Re.shl=Re.shiftLeft;Re.shiftRight=function(e){return jn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ir(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ir(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Re.shr=Re.shiftRight;Re.shiftRightUnsigned=function(e){if(jn(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return ir(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?ir(t,0,this.unsigned):ir(t>>>e-32,0,this.unsigned)};Re.shru=Re.shiftRightUnsigned;Re.shr_u=Re.shiftRightUnsigned;Re.toSigned=function(){return this.unsigned?ir(this.low,this.high,!1):this};Re.toUnsigned=function(){return this.unsigned?this:ir(this.low,this.high,!0)};Re.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Re.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Re.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};rr.fromBytes=function(e,t,i){return i?rr.fromBytesLE(e,t):rr.fromBytesBE(e,t)};rr.fromBytesLE=function(e,t){return new rr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};rr.fromBytesBE=function(e,t){return new rr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}});var xV=p((EAt,AV)=>{u();"use strict";var kd=Pi(),SV=kd.Reader,YBe=kd.Writer,We=kd.util,Bd=kd.roots["ipfs-ipns"]||(kd.roots["ipfs-ipns"]={});Bd.IpnsEntry=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.value=We.newBuffer([]),r.prototype.signature=We.newBuffer([]),r.prototype.validityType=0,r.prototype.validity=We.newBuffer([]),r.prototype.sequence=We.Long?We.Long.fromBits(0,0,!0):0,r.prototype.ttl=We.Long?We.Long.fromBits(0,0,!0):0,r.prototype.pubKey=We.newBuffer([]),r.prototype.signatureV2=We.newBuffer([]),r.prototype.data=We.newBuffer([]),r.encode=function(t,i){return i||(i=YBe.create()),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(10).bytes(t.value),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(18).bytes(t.signature),t.validityType!=null&&Object.hasOwnProperty.call(t,"validityType")&&i.uint32(24).int32(t.validityType),t.validity!=null&&Object.hasOwnProperty.call(t,"validity")&&i.uint32(34).bytes(t.validity),t.sequence!=null&&Object.hasOwnProperty.call(t,"sequence")&&i.uint32(40).uint64(t.sequence),t.ttl!=null&&Object.hasOwnProperty.call(t,"ttl")&&i.uint32(48).uint64(t.ttl),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(58).bytes(t.pubKey),t.signatureV2!=null&&Object.hasOwnProperty.call(t,"signatureV2")&&i.uint32(66).bytes(t.signatureV2),t.data!=null&&Object.hasOwnProperty.call(t,"data")&&i.uint32(74).bytes(t.data),i},r.decode=function(t,i){t instanceof SV||(t=SV.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Bd.IpnsEntry;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.value=t.bytes();break;case 2:s.signature=t.bytes();break;case 3:s.validityType=t.int32();break;case 4:s.validity=t.bytes();break;case 5:s.sequence=t.uint64();break;case 6:s.ttl=t.uint64();break;case 7:s.pubKey=t.bytes();break;case 8:s.signatureV2=t.bytes();break;case 9:s.data=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Bd.IpnsEntry)return t;var i=new Bd.IpnsEntry;switch(t.value!=null&&(typeof t.value=="string"?We.base64.decode(t.value,i.value=We.newBuffer(We.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.signature!=null&&(typeof t.signature=="string"?We.base64.decode(t.signature,i.signature=We.newBuffer(We.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),t.validityType){case"EOL":case 0:i.validityType=0;break}return t.validity!=null&&(typeof t.validity=="string"?We.base64.decode(t.validity,i.validity=We.newBuffer(We.base64.length(t.validity)),0):t.validity.length&&(i.validity=t.validity)),t.sequence!=null&&(We.Long?(i.sequence=We.Long.fromValue(t.sequence)).unsigned=!0:typeof t.sequence=="string"?i.sequence=parseInt(t.sequence,10):typeof t.sequence=="number"?i.sequence=t.sequence:typeof t.sequence=="object"&&(i.sequence=new We.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0))),t.ttl!=null&&(We.Long?(i.ttl=We.Long.fromValue(t.ttl)).unsigned=!0:typeof t.ttl=="string"?i.ttl=parseInt(t.ttl,10):typeof t.ttl=="number"?i.ttl=t.ttl:typeof t.ttl=="object"&&(i.ttl=new We.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0))),t.pubKey!=null&&(typeof t.pubKey=="string"?We.base64.decode(t.pubKey,i.pubKey=We.newBuffer(We.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.signatureV2!=null&&(typeof t.signatureV2=="string"?We.base64.decode(t.signatureV2,i.signatureV2=We.newBuffer(We.base64.length(t.signatureV2)),0):t.signatureV2.length&&(i.signatureV2=t.signatureV2)),t.data!=null&&(typeof t.data=="string"?We.base64.decode(t.data,i.data=We.newBuffer(We.base64.length(t.data)),0):t.data.length&&(i.data=t.data)),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=We.newBuffer(n.value))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=We.newBuffer(n.signature))),n.validityType=i.enums===String?"EOL":0,i.bytes===String?n.validity="":(n.validity=[],i.bytes!==Array&&(n.validity=We.newBuffer(n.validity))),We.Long){var s=new We.Long(0,0,!0);n.sequence=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.sequence=i.longs===String?"0":0;if(We.Long){var s=new We.Long(0,0,!0);n.ttl=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.ttl=i.longs===String?"0":0;i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=We.newBuffer(n.pubKey))),i.bytes===String?n.signatureV2="":(n.signatureV2=[],i.bytes!==Array&&(n.signatureV2=We.newBuffer(n.signatureV2))),i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=We.newBuffer(n.data)))}return t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?We.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?We.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),t.validityType!=null&&t.hasOwnProperty("validityType")&&(n.validityType=i.enums===String?Bd.IpnsEntry.ValidityType[t.validityType]:t.validityType),t.validity!=null&&t.hasOwnProperty("validity")&&(n.validity=i.bytes===String?We.base64.encode(t.validity,0,t.validity.length):i.bytes===Array?Array.prototype.slice.call(t.validity):t.validity),t.sequence!=null&&t.hasOwnProperty("sequence")&&(typeof t.sequence=="number"?n.sequence=i.longs===String?String(t.sequence):t.sequence:n.sequence=i.longs===String?We.Long.prototype.toString.call(t.sequence):i.longs===Number?new We.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0):t.sequence),t.ttl!=null&&t.hasOwnProperty("ttl")&&(typeof t.ttl=="number"?n.ttl=i.longs===String?String(t.ttl):t.ttl:n.ttl=i.longs===String?We.Long.prototype.toString.call(t.ttl):i.longs===Number?new We.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0):t.ttl),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?We.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.signatureV2!=null&&t.hasOwnProperty("signatureV2")&&(n.signatureV2=i.bytes===String?We.base64.encode(t.signatureV2,0,t.signatureV2.length):i.bytes===Array?Array.prototype.slice.call(t.signatureV2):t.signatureV2),t.data!=null&&t.hasOwnProperty("data")&&(n.data=i.bytes===String?We.base64.encode(t.data,0,t.data.length):i.bytes===Array?Array.prototype.slice.call(t.data):t.data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,kd.util.toJSONOptions)},r.ValidityType=function(){var e={},t=Object.create(e);return t[e[0]="EOL"]=0,t}(),r}();AV.exports=Bd});var IV=p((SAt,oI)=>{u();"use strict";oI.exports.toRFC3339=r=>{let e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),i=String(r.getUTCDate()).padStart(2,"0"),n=String(r.getUTCHours()).padStart(2,"0"),s=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),c=r.getUTCMilliseconds()*1e3*1e3;return`${e}-${t}-${i}T${n}:${s}:${o}.${c}Z`};oI.exports.parseRFC3339=r=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),f=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,f))}});var TV=p(Pa=>{u();"use strict";Pa.ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD";Pa.ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY";Pa.ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION";Pa.ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION";Pa.ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT";Pa.ERR_PEER_ID_FROM_PUBLIC_KEY="ERR_PEER_ID_FROM_PUBLIC_KEY";Pa.ERR_PUBLIC_KEY_FROM_ID="ERR_PUBLIC_KEY_FROM_ID";Pa.ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER";Pa.ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA"});var Ld=p((xAt,FV)=>{u();"use strict";var RV=fV(),{Key:mg}=Lt(),aI=Ea(),PV=rt(),XBe=(mn(),bn),{identity:QBe}=(cc(),aa),cn=ue(),{base32upper:JBe}=(en(),Zi),Nd=ct(),ZBe=Ze(),Dd=_n(),CV=fi(),OV=($y(),Iv),qV=EV(),kV=me(),os=Object.assign(kV("jsipns"),{error:kV("jsipns:error")}),{IpnsEntry:Md}=xV(),{parseRFC3339:eNe}=IV(),Wi=TV(),tNe=QBe.code,BV="/ipns/",rNe=Nd("/ipns/"),iNe=(r,e,t,i)=>{let n=new RV(Date.now()+Number(i)),s=Md.ValidityType.EOL,[o,a]=i.toString().split("."),c=BigInt(o)*100000n+BigInt(a||0);return NV(r,e,t,s,n,c)},nNe=(r,e,t,i)=>{let n=RV.fromString(i),s=Md.ValidityType.EOL,o=n.toDate().getTime()-Date.now(),a=BigInt(o)*100000n+BigInt(n.getNano());return NV(r,e,t,s,n,a)},NV=async(r,e,t,i,n,s)=>{t=BigInt(t);let o=Nd(n.toString()),a=await lNe(r,e,i,o),c=sNe(e,o,i,t,s),f=UV(c),l=await r.sign(f),h={value:e,signature:a,validityType:i,validity:o,sequence:t,ttl:s,signatureV2:l,data:c};return os(`ipns entry for ${e} created`),h},sNe=(r,e,t,i,n)=>{let s={value:r,validity:e,validityType:t,sequence:i,ttl:n};return OV.encode(s)},DV=async(r,e)=>{let{value:t,validityType:i,validity:n}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=UV(e.data),oNe(e)):(o=e.signature,s=LV(t,i,n));let a;try{a=await r.verify(s,o)}catch(c){a=!1}if(!a)throw os.error("record signature verification failed"),cn(new Error("record signature verification failed"),Wi.ERR_SIGNATURE_VERIFICATION);if(i===Md.ValidityType.EOL){let c;try{c=eNe(ZBe(n))}catch(f){throw os.error("unrecognized validity format (not an rfc3339 format)"),cn(new Error("unrecognized validity format (not an rfc3339 format)"),Wi.ERR_UNRECOGNIZED_FORMAT)}if(c.getTime()<Date.now())throw os.error("record has expired"),cn(new Error("record has expired"),Wi.ERR_IPNS_EXPIRED_RECORD)}else if(i)throw os.error("unrecognized validity type"),cn(new Error("unrecognized validity type"),Wi.ERR_UNRECOGNIZED_VALIDITY);os(`ipns entry for ${t} is valid`)},oNe=r=>{if(!r.data)throw cn(new Error("Record data is missing"),Wi.ERR_INVALID_RECORD_DATA);let e=OV.decode(r.data);if(Number.isInteger(e.sequence)&&(e.sequence=BigInt(e.sequence)),Number.isInteger(e.ttl)&&(e.ttl=BigInt(e.ttl)),!CV(e.value,r.value))throw cn(new Error('Field "value" did not match between protobuf and CBOR'),Wi.ERR_SIGNATURE_VERIFICATION);if(!CV(e.validity,r.validity))throw cn(new Error('Field "validity" did not match between protobuf and CBOR'),Wi.ERR_SIGNATURE_VERIFICATION);if(e.validityType!==r.validityType)throw cn(new Error('Field "validityType" did not match between protobuf and CBOR'),Wi.ERR_SIGNATURE_VERIFICATION);if(e.sequence!==r.sequence)throw cn(new Error('Field "sequence" did not match between protobuf and CBOR'),Wi.ERR_SIGNATURE_VERIFICATION);if(e.ttl!==r.ttl)throw cn(new Error('Field "ttl" did not match between protobuf and CBOR'),Wi.ERR_SIGNATURE_VERIFICATION)},aNe=async(r,e)=>{if(!r||!r.bytes||!e){let n=new Error("one or more of the provided parameters are not defined");throw os.error(n),cn(n,Wi.ERR_UNDEFINED_PARAMETER)}let t;try{t=await PV.createFromPubKey(r.bytes)}catch(n){throw cn(n,Wi.ERR_PEER_ID_FROM_PUBLIC_KEY)}let i;try{i=hNe(t)}catch(n){throw os.error(n),cn(n,Wi.ERR_PUBLIC_KEY_FROM_ID)}if(i)return null;try{e.pubKey=aI.keys.marshalPublicKey(r)}catch(n){throw os.error(n),n}return e},MV=(r,e)=>{if(!e||!r){let t=new Error("one or more of the provided parameters are not defined");throw os.error(t),cn(t,Wi.ERR_UNDEFINED_PARAMETER)}if(e.pubKey){let t;try{t=aI.keys.unmarshalPublicKey(e.pubKey)}catch(i){throw os.error(i),i}return t}if(r.pubKey)return r.pubKey;throw Object.assign(new Error("no public key is available"),{code:Wi.ERR_UNDEFINED_PARAMETER})},cI=r=>JBe.encode(r).slice(1),cNe=r=>new mg(`/ipns/${cI(r)}`),uNe=r=>{let e=Nd("/pk/"),t=Nd("/ipns/");return{routingPubKey:new mg(Dd([e,r]),!1),pkKey:new mg(cI(Dd([e,r]))),routingKey:new mg(Dd([t,r]),!1),ipnsKey:new mg(cI(Dd([t,r])))}},lNe=(r,e,t,i)=>{try{let n=LV(e,t,i);return r.sign(n)}catch(n){throw os.error("record signature creation failed"),cn(new Error("record signature creation failed: "+n.message),Wi.ERR_SIGNATURE_CREATION)}},fNe=r=>{if(r.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${r.toString()}`);throw os.error(e),cn(e,Wi.ERR_UNRECOGNIZED_VALIDITY)},LV=(r,e,t)=>{let i=Nd(fNe(e));return Dd([r,t,i])},UV=r=>{let e=Nd("ipns-signature:");return Dd([e,r])},hNe=r=>{let e=XBe.decode(r.id);return e.code!==tNe?null:aI.keys.unmarshalPublicKey(e.digest)},dNe=r=>Md.encode({...r,sequence:qV.fromString(r.sequence.toString()),ttl:r.ttl==null?void 0:qV.fromString(r.ttl.toString())}).finish(),Zv=r=>{let e=Md.decode(r),t=Md.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:t.value,signature:t.signature,validityType:t.validityType,validity:t.validity,sequence:Object.hasOwnProperty.call(t,"sequence")?BigInt(`${t.sequence}`):0n,pubKey:t.pubKey,ttl:Object.hasOwnProperty.call(t,"ttl")?BigInt(`${t.ttl}`):void 0}},pNe={validate:async(r,e)=>{let t=Zv(r),i=e.slice(rNe.length),n=PV.createFromBytes(i),s=MV(n,t);await DV(s,t)},select:(r,e)=>{let t=Zv(r),i=Zv(e);return t.sequence>i.sequence?0:1}};FV.exports={create:iNe,createWithExpiration:nNe,validate:DV,embedPublicKey:aNe,extractPublicKey:MV,getLocalKey:cNe,getIdKeys:uNe,marshal:dNe,unmarshal:Zv,validator:pNe,namespace:BV,namespaceLength:BV.length}});var GV=p((HV,$V)=>{u();"use strict";var ew=rt(),{Key:KV,Errors:yNe}=Lt(),An=ue(),jV=me(),vi=Object.assign(jV("ipfs:ipns:publisher"),{error:jV("ipfs:ipns:publisher:error")}),vg=Ze(),gNe=fi(),Sc=Ld(),VV=yNe.notFoundError().code,zV=60*60*1e3,uI=class{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,i){if(!e||!e.bytes)throw An(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let n=await ew.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,t,i,n);return this._putRecordToRouting(s,n)}publish(e,t){return this.publishWithEOL(e,t,zV)}async _putRecordToRouting(e,t){if(!ew.isPeerId(t)){let o="peerId received is not valid";throw vi.error(o),An(new Error(o),"ERR_INVALID_PEER_ID")}let i=t._pubKey,n=await Sc.embedPublicKey(i,e),s=Sc.getIdKeys(t.toBytes());return await this._publishEntry(s.routingKey,n||e),await this._publishPublicKey(s.routingPubKey,i),n||e}async _publishEntry(e,t){if(!(e instanceof KV)){let n="datastore key does not have a valid format";throw vi.error(n),An(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let i;try{i=Sc.marshal(t)}catch(n){throw vi.error(n),n}try{let n=await this._routing.put(e.uint8Array(),i);return vi(`ipns record for ${vg(e.uint8Array(),"base64")} was stored in the routing`),n}catch(n){let s=`ipns record for ${vg(e.uint8Array(),"base64")} could not be stored in the routing`;throw vi.error(s),vi.error(n),An(new Error(s),"ERR_PUTTING_TO_ROUTING")}}async _publishPublicKey(e,t){if(!(e instanceof KV)){let i="datastore key does not have a valid format";throw vi.error(i),An(new Error(i),"ERR_INVALID_DATASTORE_KEY")}if(!t||!t.bytes){let i="one or more of the provided parameters are not defined";throw vi.error(i),An(new Error(i),"ERR_UNDEFINED_PARAMETER")}try{let i=await this._routing.put(e.uint8Array(),t.bytes);return vi(`public key for ${vg(e.uint8Array(),"base64")} was stored in the routing`),i}catch(i){let n=`public key for ${vg(e.uint8Array(),"base64")} could not be stored in the routing`;throw vi.error(n),vi.error(i),An(new Error(n),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!ew.isPeerId(e)){let n="peerId received is not valid";throw vi.error(n),An(new Error(n),"ERR_INVALID_PEER_ID")}let i=t.checkRouting!==!1;try{let n=await this._datastore.get(Sc.getLocalKey(e.id));return this._unmarshalData(n)}catch(n){if(n.code!==VV){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw vi.error(s),An(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw An(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=Sc.getIdKeys(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw vi.error(s),s}}}_unmarshalData(e){try{return Sc.unmarshal(e)}catch(t){throw An(t,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,i,n){if(!ew.isPeerId(n)){let f="peerId received is not valid";throw vi.error(f),An(new Error(f),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(n,s)}catch(f){if(f.code!==VV){let l=`unexpected error when determining the last published IPNS record for ${n.id} ${f.stack}`;throw vi.error(l),An(new Error(l),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0n;o&&o.sequence!==void 0&&(a=gNe(o.value,t)?BigInt(o.sequence):BigInt(o.sequence)+1n);let c;try{c=await Sc.create(e,t,a,i)}catch(f){let l=`ipns record for ${t} could not be created`;throw vi.error(f),An(new Error(l),"ERR_CREATING_IPNS_RECORD")}try{let f=Sc.marshal(c);return await this._datastore.put(Sc.getLocalKey(n.id),f),vi(`ipns record for ${vg(t,"base32")} was stored in the datastore`),c}catch(f){let l=`ipns record for ${t} could not be stored in the datastore`;throw vi.error(l),An(new Error(l),"ERR_STORING_IN_DATASTORE")}}};uI.defaultRecordLifetime=zV;HV=$V.exports=uI});var rz=p((ez,tz)=>{u();"use strict";var WV=Ld(),bNe=Ea(),YV=rt(),tf=ue(),XV=me(),tw=Object.assign(XV("ipfs:ipns:republisher"),{error:XV("ipfs:ipns:republisher:error")}),QV=60*1e3,JV=60*QV,mNe=4*JV,vNe=24*JV,ZV=class{constructor(e,t,i,n,s={pass:""}){this._publisher=e,this._datastore=t,this._peerId=i,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw tf(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){tw.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:t}=this._peerId,{pass:i}=this._options,n=!0;e._task=()=>this._republishEntries(t,i),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||QV):this._options.broadcastInterval||mNe),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw tf(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t){try{await this._republishEntry(e)}catch(i){let n="cannot republish entry for the node's private key";tw.error(n);return}if(t)try{let i=await this._keychain.listKeys();for(let n of i){if(n.name==="self")continue;let s=await this._keychain.exportKey(n.name,t),o=await bNe.keys.import(s,t);await this._republishEntry(o)}}catch(i){tw.error(i)}}async _republishEntry(e){if(!e||!e.bytes)throw tf(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let t=await YV.createFromPrivKey(e.bytes),i=await this._getPreviousValue(t);await this._publisher.publishWithEOL(e,i,vNe)}catch(t){if(t.code==="ERR_NO_ENTRY_FOUND")return;throw t}}async _getPreviousValue(e){if(!YV.isPeerId(e))throw tf(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let t=await this._datastore.get(WV.getLocalKey(e.id));if(!(t instanceof Uint8Array))throw tf(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return WV.unmarshal(t).value}catch(i){throw tw.error(i),tf(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(t){throw t&&t.notFound?tf(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):t}}};ez=tz.exports=ZV});var cz=p((oz,az)=>{u();"use strict";var rw=Ld(),wNe=rt(),Ud=ue(),iz=me(),iw=Object.assign(iz("ipfs:ipns:resolver"),{error:iz("ipfs:ipns:resolver:error")}),_Ne=Ze(),{Errors:ENe}=Lt(),SNe=ENe.notFoundError().code,nz=32,sz=class{constructor(e){this._routing=e}async resolve(e,t={}){if(typeof e!="string")throw Ud(new Error("invalid name"),"ERR_INVALID_NAME");let i=t.recursive&&t.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw Ud(new Error("invalid name"),"ERR_INVALID_NAME");let s=n[2],o=1/0;i&&(o=nz);let a=await this.resolver(s,o);return iw(`${e} was locally resolved correctly`),a}async resolver(e,t){if(t===0){let s=`could not resolve name (recursion limit of ${nz} exceeded)`;throw iw.error(s),Ud(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let i=await this._resolveName(e),n=i.split("/");return n[1]==="ipfs"||!t?i:this.resolver(n[2],t-1)}async _resolveName(e){let t=wNe.parse(e),{routingKey:i}=rw.getIdKeys(t.toBytes()),n;try{n=await this._routing.get(i.uint8Array())}catch(o){throw iw.error("could not get record from routing",o),o.code===SNe?Ud(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):Ud(new Error(`unexpected error getting the ipns record ${t.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=rw.unmarshal(n)}catch(o){throw iw.error("could not unmarshal record",o),Ud(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(t,s)}async _validateRecord(e,t){let i=await rw.extractPublicKey(e,t);return await rw.validate(i,t),_Ne(t.value)}};oz=az.exports=sz});var pz=p((IAt,dz)=>{u();"use strict";var{createFromPrivKey:ANe}=rt(),xNe=ue(),uz=me(),wg=Object.assign(uz("ipfs:ipns"),{error:uz("ipfs:ipns:error")}),lI=GV(),INe=rz(),TNe=cz(),RNe=sx(),lz=60*1e3,fz=Ze(),hz=class{constructor(e,t,i,n,s){this.publisher=new lI(e,t),this.republisher=new INe(this.publisher,t,i,n,s),this.resolver=new TNe(e),this.cache=new RNe(1e3),this.routing=e}async publish(e,t,i=lI.defaultRecordLifetime){try{let n=await ANe(e.bytes);await this.publisher.publishWithEOL(e,t,i),wg(`IPNS value ${fz(t,"base32")} was published correctly`);let s=n.toB58String(),o=parseFloat(i),a=o<lz?o:lz;return this.cache.set(s,t,a),wg(`IPNS value ${fz(t,"base32")} was cached correctly`),{name:s,value:t}}catch(n){throw wg.error(n),n}}async resolve(e,t={}){if(typeof e!="string")throw xNe(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){let i=e.split("/")[2],n=this.cache.get(i);if(n)return n}try{let i=await this.resolver.resolve(e,t);return wg(`IPNS record from ${e} was resolved correctly`),i}catch(i){throw wg.error(i),i}}async initializeKeyspace(e,t){return this.publish(e,t,lI.defaultRecordLifetime)}};dz.exports=hz});var _g=p((TAt,gz)=>{u();"use strict";var{Adapter:PNe}=Lt(),rf=mo(),{pipe:fI}=Gr(),yz=class extends PNe{constructor(e,t){super();this.child=e,this.transform=t}open(){return this.child.open()}put(e,t,i){return this.child.put(this.transform.convert(e),t,i)}get(e,t){return this.child.get(this.transform.convert(e),t)}has(e,t){return this.child.has(this.transform.convert(e),t)}delete(e,t){return this.child.delete(this.transform.convert(e),t)}async*putMany(e,t={}){let i=this.transform,n=this.child;yield*fI(e,async function*(s){yield*rf(s,({key:o,value:a})=>({key:i.convert(o),value:a}))},async function*(s){yield*n.putMany(s,t)},async function*(s){yield*rf(s,({key:o,value:a})=>({key:i.invert(o),value:a}))})}async*getMany(e,t={}){let i=this.transform,n=this.child;yield*fI(e,async function*(s){yield*rf(s,o=>i.convert(o))},async function*(s){yield*n.getMany(s,t)})}async*deleteMany(e,t={}){let i=this.transform,n=this.child;yield*fI(e,async function*(s){yield*rf(s,o=>i.convert(o))},async function*(s){yield*n.deleteMany(s,t)},async function*(s){yield*rf(s,o=>i.invert(o))})}batch(){let e=this.child.batch();return{put:(t,i)=>{e.put(this.transform.convert(t),i)},delete:t=>{e.delete(this.transform.convert(t))},commit:t=>e.commit(t)}}query(e,t){return rf(this.child.query(e,t),({key:i,value:n})=>({key:this.transform.invert(i),value:n}))}queryKeys(e,t){return rf(this.child.queryKeys(e,t),i=>this.transform.invert(i))}close(){return this.child.close()}};gz.exports=yz});var mz=p((RAt,bz)=>{u();"use strict";bz.exports=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var yI=p((PAt,Ez)=>{u();"use strict";var{Key:vz}=Lt(),CNe=mz(),nw="/repo/flatfs/shard/",wz="SHARDING",ONe="_README",sw=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${nw}v1/${this.name}/${this.param}`}},hI=class extends sw{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},dI=class extends sw{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let t=this._padding+e;return t.slice(t.length-this.param)}},pI=class extends sw{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let t=this._padding+e,i=t.length-this.param-1;return t.slice(i,i+this.param)}};function _z(r){if(r=r.trim(),r.length===0)throw new Error("empty shard string");if(!r.startsWith(nw))throw new Error(`invalid or no path prefix: ${r}`);let e=r.slice(nw.length).split("/"),t=e[0];if(t!=="v1")throw new Error(`expect 'v1' version, got '${t}'`);let i=e[1];if(!e[2])throw new Error("missing param");let n=parseInt(e[2],10);switch(i){case"prefix":return new hI(n);case"suffix":return new dI(n);case"next-to-last":return new pI(n);default:throw new Error(`unkown sharding function: ${i}`)}}var qNe=async(r,e)=>{let t=new vz(r).child(new vz(wz)),n=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(t);return _z(new TextDecoder().decode(n||"").trim())};Ez.exports={readme:CNe,parseShardFun:_z,readShardFun:qNe,Prefix:hI,Suffix:dI,NextToLast:pI,README_FN:ONe,SHARDING_FN:wz,PREFIX:nw}});var Az=p((CAt,Sz)=>{u();"use strict";var{Adapter:kNe,Key:ow,Errors:BNe}=Lt(),Eg=yI(),NNe=_g(),Fd=new ow(Eg.SHARDING_FN),Sg=new ow(Eg.README_FN),nf=class extends kNe{constructor(e,t){super();this.child=new NNe(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){await this.child.open(),this.shard=await nf.create(this.child,this.shard)}_convertKey(e){let t=e.toString();return t===Fd.toString()||t===Sg.toString()?e:new ow(this.shard.fun(t)).child(e)}_invertKey(e){let t=e.toString();return t===Fd.toString()||t===Sg.toString()?e:ow.withNamespaces(e.list().slice(1))}static async createOrOpen(e,t){try{await nf.create(e,t)}catch(i){if(i&&i.message!=="datastore exists")throw i}return nf.open(e)}static async open(e){let t=await Eg.readShardFun("/",e);return new nf(e,t)}static async create(e,t){let i=await e.has(Fd);if(!i&&!t)throw BNe.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));if(!i){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(Fd,new TextEncoder().encode(t.toString()+`
`)),a(Sg,new TextEncoder().encode(Eg.readme))]),t}let n=await Eg.readShardFun("/",e),s=(n||"").toString(),o=t.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return n}put(e,t,i){return this.child.put(e,t,i)}get(e,t){return this.child.get(e,t)}has(e,t){return this.child.has(e,t)}delete(e,t){return this.child.delete(e,t)}async*putMany(e,t={}){yield*this.child.putMany(e,t)}async*getMany(e,t={}){yield*this.child.getMany(e,t)}async*deleteMany(e,t={}){yield*this.child.deleteMany(e,t)}batch(){return this.child.batch()}query(e,t){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.key.toString()!==Fd.toString(),s=>s.key.toString()!==Sg.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s.key).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>({key:c,value:f})=>o({key:this._invertKey(c),value:f}));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s({key:this._invertKey(a.key),value:a.value},{key:this._invertKey(c.key),value:c.value}))),this.child.query(i,t)}queryKeys(e,t){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.toString()!==Fd.toString(),s=>s.toString()!==Sg.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>c=>o(this._invertKey(c)));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s(this._invertKey(a),this._invertKey(c)))),this.child.queryKeys(i,t)}close(){return this.child.close()}};Sz.exports=nf});var Oz=p((OAt,Cz)=>{u();"use strict";var{Adapter:DNe,Key:MNe,Errors:gI,utils:{sortAll:xz,replaceStartWith:bI}}=Lt(),aw=wc(),Iz=md(),Tz=Pd(),Rz=_g(),Pz=class extends DNe{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e)){let i=bI(e.toString(),t.prefix.toString());return{datastore:t.datastore,mountpoint:t.prefix,rest:new MNe(i)}}}put(e,t,i){let n=this._lookup(e);if(n==null)throw gI.dbWriteFailedError(new Error("No datastore mounted for this key"));return n.datastore.put(n.rest,t,i)}get(e,t){let i=this._lookup(e);if(i==null)throw gI.notFoundError(new Error("No datastore mounted for this key"));return i.datastore.get(i.rest,t)}has(e,t){let i=this._lookup(e);return i==null?Promise.resolve(!1):i.datastore.has(i.rest,t)}delete(e,t){let i=this._lookup(e);if(i==null)throw gI.dbDeleteFailedError(new Error("No datastore mounted for this key"));return i.datastore.delete(i.rest,t)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},t=i=>{let n=this._lookup(i);if(n==null)throw new Error("No datastore mounted for this key");let s=n.mountpoint.toString();return e[s]==null&&(e[s]=n.datastore.batch()),{batch:e[s],rest:n.rest}};return{put:(i,n)=>{let s=t(i);s.batch.put(s.rest,n)},delete:i=>{let n=t(i);n.batch.delete(n.rest)},commit:async i=>{await Promise.all(Object.keys(e).map(n=>e[n].commit(i)))}}}query(e,t){let i=this.mounts.map(s=>{let o=new Rz(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=bI(e.prefix,s.prefix.toString())),o.query({prefix:a,filters:e.filters},t)}),n=Tz(...i);if(e.filters&&e.filters.forEach(s=>{n=aw(n,s)}),e.orders&&e.orders.forEach(s=>{n=xz(n,s)}),e.offset!=null){let s=0;n=aw(n,()=>s++>=e.offset)}return e.limit!=null&&(n=Iz(n,e.limit)),n}queryKeys(e,t){let i=this.mounts.map(s=>{let o=new Rz(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=bI(e.prefix,s.prefix.toString())),o.queryKeys({prefix:a,filters:e.filters},t)}),n=Tz(...i);if(e.filters&&e.filters.forEach(s=>{n=aw(n,s)}),e.orders&&e.orders.forEach(s=>{n=xz(n,s)}),e.offset!=null){let s=0;n=aw(n,()=>s++>=e.offset)}return e.limit!=null&&(n=Iz(n,e.limit)),n}};Cz.exports=Pz});var Dz=p((qAt,Nz)=>{u();"use strict";var{Adapter:LNe,Errors:cw}=Lt(),UNe=me()("datastore:core:tiered"),qz=Ra(),kz=Ia(),Bz=class extends LNe{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw cw.dbOpenFailedError()}}async put(e,t){try{await Promise.all(this.stores.map(i=>i.put(e,t)))}catch(i){throw cw.dbWriteFailedError()}}async get(e,t){for(let i of this.stores)try{let n=await i.get(e,t);if(n)return n}catch(n){UNe(n)}throw cw.notFoundError()}async has(e,t){for(let i of this.stores)if(await i.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map(i=>i.delete(e,t)))}catch(i){throw cw.dbDeleteFailedError()}}async*putMany(e,t={}){let i,n=this.stores.map(s=>{let o=qz();return kz(s.putMany(o,t)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async*deleteMany(e,t={}){let i,n=this.stores.map(s=>{let o=qz();return kz(s.deleteMany(o,t)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(t=>t.batch());return{put:(t,i)=>{e.forEach(n=>n.put(t,i))},delete:t=>{e.forEach(i=>i.delete(t))},commit:async t=>{for(let i of e)await i.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}};Nz.exports=Bz});var Uz=p((kAt,Lz)=>{u();"use strict";var mI=Lt().Key,FNe=_g(),Mz=class extends FNe{constructor(e,t){super(e,{convert(i){return t.child(i)},invert(i){if(t.toString()==="/")return i;if(!t.isAncestorOf(i))throw new Error(`Expected prefix: (${t.toString()}) in key: ${i.toString()}`);return new mI(i.toString().slice(t.toString().length),!1)}});this.prefix=t}query(e,t){return e.prefix&&this.prefix.toString()!=="/"?super.query(Object.assign({},e,{prefix:this.prefix.child(new mI(e.prefix)).toString()})):super.query(e,t)}queryKeys(e,t){return e.prefix&&this.prefix.toString()!=="/"?super.queryKeys(Object.assign({},e,{prefix:this.prefix.child(new mI(e.prefix)).toString()})):super.queryKeys(e,t)}};Lz.exports=Mz});var Kz=p((BAt,Fz)=>{u();"use strict";var KNe=_g(),jNe=Az(),VNe=Oz(),zNe=Dz(),HNe=Uz(),$Ne=yI();Fz.exports={KeytransformDatastore:KNe,ShardingDatastore:jNe,MountDatastore:VNe,TieredDatastore:zNe,NamespaceDatastore:HNe,shard:$Ne}});var Ag=p((vI,wI)=>{u();(function(r,e){typeof vI=="object"&&typeof wI!="undefined"?wI.exports=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}:typeof define=="function"&&define.amd?define(function(){return function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}}):r.dlv=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}})(vI)});var Hz=p((NAt,zz)=>{u();"use strict";var GNe=ue(),jz=Ze(),Vz=ct(),uw="/record/";function WNe(r){return jz(r,"base32")}function YNe(r){(typeof r=="string"||r instanceof String)&&(r=Vz(r.toString()));let e=jz(r,"base64url");return`${uw}${e}`}function XNe(r){if(r.substring(0,uw.length)!==uw)throw GNe(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=r.substring(uw.length);return Vz(e,"base64url")}zz.exports={encodeBase32:WNe,keyToTopic:YNe,topicToKey:XNe}});var Qz=p((Yz,Xz)=>{u();"use strict";var{Key:_I,Adapter:QNe}=Lt(),{encodeBase32:$z,keyToTopic:lw,topicToKey:JNe}=Hz(),ZNe=fi(),ks=ue(),Gz=me(),un=Object.assign(Gz("datastore-pubsub:publisher"),{error:Gz("datastore-pubsub:publisher:error")}),Wz=class extends QNe{constructor(e,t,i,n,s){super();if(!n)throw ks(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n.validate!="function")throw ks(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof n.select!="function")throw ks(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw ks(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=i,this._validator=n,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,t){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw un.error(n),ks(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){let n="received value is not a Uint8Array";throw un.error(n),ks(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let i=lw(e);un(`publish value for topic ${i}`),await this._pubsub.publish(i,t)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw un.error(n),ks(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let t=lw(e),i=await this._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(t)>-1)return this._getLocal(e);try{this._pubsub.on(t,this._onMessage),await this._pubsub.subscribe(t)}catch(n){let s=`cannot subscribe topic ${t}`;throw un.error(s),ks(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return un(`subscribed values for key ${t}`),this._getLocal(e)}unsubscribe(e){let t=lw(e);return this._pubsub.removeListener(t,this._onMessage),this._pubsub.unsubscribe(t)}async _getLocal(e){let t=new _I("/"+$z(e),!1),i;try{i=await this._datastore.get(t)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${t.toString()}`;throw un.error(o),ks(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${t.toString()}`;throw un.error(s),ks(new Error(s),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw un.error(n),ks(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){let{data:t,from:i,topicIDs:n}=e,s;try{s=JNe(n[0])}catch(o){un.error(o);return}if(un(`message received for topic ${n[0]}`),i===this._peerId.toB58String()){un("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch(a){un.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,t)}catch(o){un.error(o)}}async _storeIfSubscriptionIsBetter(e,t){let i=!1;try{i=await this._isBetter(e,t)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}i&&await this._storeRecord(e,t)}async _validateRecord(e,t){return this._validator.validate(e,t)}async _selectRecord(e,t){return await this._validator.select(e,t)===0}async _isBetter(e,t){try{await this._validateRecord(t,e)}catch(s){let o="record received through pubsub is not valid";throw un.error(o),ks(new Error(o),"ERR_NOT_VALID_RECORD")}let i=new _I(e),n;try{n=await this._getLocal(i.uint8Array())}catch(s){return!0}return ZNe(n,t)?!1:this._selectRecord(e,[n,t])}async _storeRecord(e,t){let i=new _I("/"+$z(e),!1);await this._datastore.put(i,t),un(`record for ${lw(e)} was stored in the datastore`)}};Yz=Xz.exports=Wz});var SI=p((DAt,nH)=>{u();"use strict";var qu=Ld(),{base58btc:Jz}=(zr(),Vr),eDe=Qz(),Zz=Ze(),eH=ct(),tH=ue(),rH=me(),EI=Object.assign(rH("ipfs:ipns:pubsub"),{error:rH("ipfs:ipns:pubsub:error")}),iH=class{constructor(e,t,i){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new eDe(e,t,i,qu.validator,this._handleSubscriptionKey)}put(e,t){return this._pubsubDs.put(e,t)}async get(e){let t,i;try{t=await this._pubsubDs.get(e)}catch(s){i=s}let n=e.slice(0,qu.namespaceLength);if(Zz(n)===qu.namespace){let s=Jz.encode(e).substring(1),o=Jz.encode(e.slice(qu.namespaceLength)).substring(1);this._subscriptions[s]=o,EI(`subscribed to pubsub topic ${s}, id ${o}`)}if(i)throw i;return t}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=Zz(e,"base58btc"));let t=this._subscriptions[e];if(!t)throw tH(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let i;try{i=qu.getIdKeys(eH(t,"base58btc"))}catch(n){throw EI.error(n),n}return i.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(t=>`${qu.namespace}${t}`)}async cancel(e){if(typeof e!="string")throw tH(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(qu.namespace)&&(e=e.substring(qu.namespaceLength));let t=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!t)return{canceled:!1};let i=eH(t);return this._pubsubDs.unsubscribe(i),delete this._subscriptions[t],EI(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}};nH.exports=iH});var aH=p((MAt,oH)=>{u();"use strict";var Kd=Pi(),sH=Kd.Reader,tDe=Kd.Writer,Bs=Kd.util,xg=Kd.roots["libp2p-record"]||(Kd.roots["libp2p-record"]={});xg.Record=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key=Bs.newBuffer([]),r.prototype.value=Bs.newBuffer([]),r.prototype.timeReceived="",r.encode=function(t,i){return i||(i=tDe.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).bytes(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),t.timeReceived!=null&&Object.hasOwnProperty.call(t,"timeReceived")&&i.uint32(42).string(t.timeReceived),i},r.decode=function(t,i){t instanceof sH||(t=sH.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new xg.Record;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.bytes();break;case 2:s.value=t.bytes();break;case 5:s.timeReceived=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof xg.Record)return t;var i=new xg.Record;return t.key!=null&&(typeof t.key=="string"?Bs.base64.decode(t.key,i.key=Bs.newBuffer(Bs.base64.length(t.key)),0):t.key.length&&(i.key=t.key)),t.value!=null&&(typeof t.value=="string"?Bs.base64.decode(t.value,i.value=Bs.newBuffer(Bs.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.timeReceived!=null&&(i.timeReceived=String(t.timeReceived)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=Bs.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=Bs.newBuffer(n.value))),n.timeReceived=""),t.key!=null&&t.hasOwnProperty("key")&&(n.key=i.bytes===String?Bs.base64.encode(t.key,0,t.key.length):i.bytes===Array?Array.prototype.slice.call(t.key):t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?Bs.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.timeReceived!=null&&t.hasOwnProperty("timeReceived")&&(n.timeReceived=t.timeReceived),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Kd.util.toJSONOptions)},r}();oH.exports=xg});var cH=p((LAt,AI)=>{u();"use strict";AI.exports.toRFC3339=r=>{let e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),i=String(r.getUTCDate()).padStart(2,"0"),n=String(r.getUTCHours()).padStart(2,"0"),s=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),c=r.getUTCMilliseconds()*1e3*1e3;return`${e}-${t}-${i}T${n}:${s}:${o}.${c}Z`};AI.exports.parseRFC3339=r=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),f=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,f))}});var fH=p((UAt,lH)=>{u();"use strict";var{Record:xI}=aH(),uH=cH(),Ig=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=i}serialize(){return xI.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&uH.toRFC3339(this.timeReceived)}}static deserialize(e){let t=xI.decode(e);return Ig.fromDeserialized(xI.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let t;return e.timeReceived&&(t=uH.parseRFC3339(e.timeReceived)),new Ig(e.key,e.value,t)}};lH.exports=Ig});var dH=p((FAt,hH)=>{u();"use strict";var{sha256:rDe}=(Hr(),Ir),fw=ue(),iDe=Ze(),nDe=fi(),sDe=async(r,e)=>{if(!(r instanceof Uint8Array))throw fw(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(r.byteLength<5)throw fw(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(iDe(r.subarray(0,4))!=="/pk/")throw fw(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let i=r.slice(4),n=await rDe.digest(e);if(!nDe(i,n.bytes))throw fw(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};hH.exports={func:sDe,sign:!1}});var yH=p((KAt,pH)=>{u();"use strict";pH.exports={pk:dH()}});var bH=p((jAt,gH)=>{u();"use strict";var oDe=ue(),aDe=Ze(),cDe=(r,e)=>{let t=e.key,n=aDe(t).split("/");if(n.length<3)return;let s=r[n[1].toString()];if(!s){let o="Invalid record keytype";throw oDe(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(t,e.value)};gH.exports={verifyRecord:cDe,validators:yH()}});var vH=p((VAt,mH)=>{u();"use strict";var uDe=(r,e)=>0;mH.exports=uDe});var _H=p((zAt,wH)=>{u();"use strict";wH.exports={pk:vH()}});var SH=p((HAt,EH)=>{u();"use strict";var II=ue(),lDe=Ze(),fDe=(r,e,t)=>{if(t.length===0){let o="No records given";throw II(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let n=lDe(e).split("/");if(n.length<3){let o="Record key does not have a selector function";throw II(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=r[n[1].toString()];if(!s){let o=`Unrecognized key prefix: ${n[1]}`;throw II(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return s(e,t)};EH.exports={bestRecord:fDe,selectors:_H()}});var sf=p(($At,AH)=>{u();"use strict";AH.exports={Record:fH(),validator:bH(),selection:SH()}});var TI=p((GAt,IH)=>{u();"use strict";var xH=Ld(),hDe=Ze();IH.exports={encodeBase32:r=>hDe(r,"base32upper"),validator:{func:(r,e)=>xH.validator.validate(e,r)},selector:(r,e)=>xH.validator.select(e[0],e[1])}});var PI=p((CH,OH)=>{u();"use strict";var{Key:dDe}=Lt(),{Record:TH}=sf(),{encodeBase32:pDe}=TI(),Tg=ue(),RH=me(),RI=Object.assign(RH("ipfs:ipns:offline-datastore"),{error:RH("ipfs:ipns:offline-datastore:error")}),PH=class{constructor(e){this._repo=e,this.stores=[]}async put(e,t){if(!(e instanceof Uint8Array))throw Tg(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw Tg(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=this._routingKey(e)}catch(s){throw RI.error(s),Tg(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new TH(e,t);return this._repo.datastore.put(i,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw Tg(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let t;try{t=this._routingKey(e)}catch(s){throw RI.error(s),Tg(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=await this._repo.datastore.get(t),n;try{n=TH.deserialize(i)}catch(s){throw RI.error(s),s}return n.value}_routingKey(e){return new dDe("/"+pDe(e),!1)}};CH=OH.exports=PH});var kH=p((WAt,qH)=>{u();"use strict";var{TieredDatastore:yDe}=Kz(),CI=Ag(),gDe=SI(),bDe=PI();qH.exports=({libp2p:r,repo:e,peerId:t,options:i})=>{let n=[],s;if(CI(i,"EXPERIMENTAL.ipnsPubsub",!1)){let o=r.pubsub,a=e.datastore;s=new gDe(o,a,t),n.push(s)}if(CI(i,"offline")||!CI(i,"libp2p.config.dht.enabled",!1)){let o=new bDe(e);n.push(o)}else n.push(r._dht);return new yDe(n)}});var LH=p((YAt,MH)=>{u();"use strict";var BH=pz(),mDe=kH(),vDe=PI(),{NotInitializedError:wDe,AlreadyInitializedError:NH}=Iu(),_De=me()("ipfs:components:ipns"),DH=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new wDe}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:i}){if(this.offline!=null)throw new NH;_De("initializing IPNS keyspace");let n=new vDe(e),s=new BH(n,e.datastore,t,i,this.options);this.offline=s}async startOnline({libp2p:e,repo:t,peerId:i,keychain:n}){if(this.online!=null)throw new NH;let s=mDe({libp2p:e,repo:t,peerId:i,options:this.options}),o=new BH(s,t.datastore,i,n,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,i){return this.getIPNS().publish(e,t,i)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t){return this.getIPNS().initializeKeyspace(e,t)}};MH.exports=DH});var FH=p(UH=>{u();"use strict";var EDe=sd(),SDe=ng(),ADe=Ia(),{resolve:xDe}=Ui();UH.resolvePath=async({ipns:r,repo:e,codecs:t},i,n)=>{if(EDe.ipnsPath(i))return r.resolve(i);let{cid:s,path:o}=SDe(i);await ADe(xDe(s,o||"",t,e,n))}});var zH=p((QAt,VH)=>{u();"use strict";var KH=me(),{default:IDe}=rg(),TDe=Ea(),jH=ue(),RDe=ct(),PDe=Ze(),OI=Object.assign(KH("ipfs:name:publish"),{error:KH("ipfs:name:publish:error")}),{OFFLINE_ERROR:CDe,normalizePath:ODe}=Ui(),qDe=Oe(),{resolvePath:kDe}=FH();VH.exports=({ipns:r,repo:e,codecs:t,peerId:i,isOnline:n,keychain:s})=>{let o=async c=>{if(c==="self")return i.privKey;try{let f=await s.exportKey(c,"temp");return await TDe.keys.import(f,"temp")}catch(f){throw OI.error(f),jH(f,"ERR_CANNOT_GET_KEY")}};async function a(c,f={}){let l=f.resolve!==!1,h=f.lifetime||"24h",d=f.key||"self";if(!n())throw jH(new Error(CDe),"OFFLINE_ERROR");try{c=ODe(c)}catch(_){throw OI.error(_),_}let y=0;try{y=IDe(h)||0,y=parseFloat(y.toFixed(6))}catch(_){throw OI.error(_),_}let g=await Promise.all([o(d),l?kDe({ipns:r,repo:e,codecs:t},c):Promise.resolve()]),m=RDe(c),E=await r.publish(g[0],m,y);return{name:E.name,value:PDe(E.value)}}return qDe(a)}});var $H=p((JAt,HH)=>{u();"use strict";var BDe=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;HH.exports=function(e,t){if(t==null&&(t=!1),e.length<2||e.length>255)return!1;var i=e[e.length-1];if(t){if(i!==".")return!1}else if(i===".")return!1;return BDe.test(e)}});var XH=p((ZAt,YH)=>{u();"use strict";var GH=me(),qI=ue(),NDe=mr().bind({ignoreUndefined:!0}),{CID:DDe}=(xe(),Ce),MDe=rt(),LDe=$H(),UDe=Ze(),FDe=Object.assign(GH("ipfs:name:resolve"),{error:GH("ipfs:name:resolve:error")}),{OFFLINE_ERROR:KDe}=Ui(),jDe=Oe(),WH=(r,e)=>e.length>0?r+"/"+e.join("/"):r;YH.exports=({dns:r,ipns:e,peerId:t,isOnline:i,options:{offline:n}})=>{async function*s(o,a={}){if(a=NDe({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw qI(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");o||(o=t.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,f,...l]=o.slice(1).split("/");try{f.substring(0,1)==="1"?MDe.parse(f):DDe.parse(f)}catch(d){if(LDe(f)){yield WH(await r(f,a),l);return}throw FDe.error(d),qI(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}if(!i()&&!n)throw qI(new Error(KDe),"OFFLINE_ERROR");let h=await e.resolve(`/${c}/${f}`,a);yield WH(h instanceof Uint8Array?UDe(h):h,l)}return jDe(s)}});var hw=p(ZH=>{u();"use strict";var QH=SI(),JH=ue();ZH.getPubsubRouting=(r,e)=>{if(!r||!(e&&e.ipnsPubsub))throw JH(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(r.routing instanceof QH)return r.routing;let t=(r.routing.stores||[]).find(i=>i instanceof QH);if(!t)throw JH(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return t}});var t$=p((txt,e$)=>{u();"use strict";var{getPubsubRouting:VDe}=hw(),zDe=Oe();e$.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n,s={}){return VDe(r,t).cancel(n,s)}return zDe(i)}});var i$=p((rxt,r$)=>{u();"use strict";var{getPubsubRouting:HDe}=hw(),$De=Oe();r$.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n={}){try{return{enabled:Boolean(HDe(r,t))}}catch(s){return{enabled:!1}}}return $De(i)}});var s$=p((ixt,n$)=>{u();"use strict";var{getPubsubRouting:GDe}=hw(),WDe=Oe();n$.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n={}){return GDe(r,t).getSubscriptions(n)}return WDe(i)}});var c$=p((nxt,a$)=>{u();"use strict";var YDe=t$(),XDe=i$(),QDe=s$(),o$=class{constructor({ipns:e,options:t}){this.cancel=YDe({ipns:e,options:t}),this.state=XDe({ipns:e,options:t}),this.subs=QDe({ipns:e,options:t})}};a$.exports=o$});var f$=p((sxt,l$)=>{u();"use strict";var JDe=zH(),ZDe=XH(),eMe=c$(),u$=class{constructor({dns:e,ipns:t,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a,options:c}){this.publish=JDe({ipns:t,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a}),this.resolve=ZDe({dns:e,ipns:t,peerId:s,isOnline:o,options:c}),this.pubsub=new eMe({ipns:t,options:c})}};l$.exports=u$});var p$=p((oxt,BI)=>{u();"use strict";var tMe=(xt(),At),{Errors:rMe}=Lt(),iMe=rMe.notFoundError().code,nMe=Oe(),h$=ng(),{CID:d$}=(xe(),Ce),dw={default:"<dst>",edges:"<src> -> <dst>"};BI.exports=function({repo:r,codecs:e,resolve:t,preload:i}){async function*n(s,o={}){if(o.maxDepth===0)return;if(o.edges&&o.format&&o.format!==dw.default)throw new Error("Cannot set edges to true and also specify format");o.format=o.edges?dw.edges:o.format,typeof o.maxDepth!="number"&&(o.maxDepth=o.recursive?1/0:1);let c=(Array.isArray(s)?s:[s]).map(f=>sMe(i,f,o));for(let f of c)yield*oMe(t,r,e,f,o)}return nMe(n)};BI.exports.Format=dw;function sMe(r,e,t){let{cid:i,path:n}=h$(e);return t.preload!==!1&&r(i),`/ipfs/${i}${n||""}`}async function*oMe(r,e,t,i,n){let s=await r(i),{cid:o}=h$(s),a=n.maxDepth!=null?n.maxDepth:1/0,c=n.unique||!1;for await(let f of cMe(e,t,o,a,c))!f.parent||f.isDuplicate||(yield{ref:aMe(f.parent.cid,f.node.cid,f.node.name,n.format)})}function aMe(r,e,t="",i=dw.default){let n=i.replace(/<src>/g,r.toString());return n=n.replace(/<dst>/g,e.toString()),n=n.replace(/<linkname>/g,t),n}async function*cMe(r,e,t,i,n){let s=new Set;async function*o(a,c){let f=c+1;if(!(f>i))try{for await(let l of uMe(r,e,a.cid))yield{parent:a,node:l,isDuplicate:n&&s.has(l.cid.toString())},n&&s.add(l.cid.toString()),yield*o(l,f)}catch(l){throw l.code===iMe&&(l.message=`Could not find object with CID: ${a.cid}`),l}}yield*o({cid:t},0)}async function*uMe(r,e,t,i=[]){let n=await r.blocks.get(t),o=(await e.getCodec(t.code)).decode(n),a=t.code===tMe.code;for(let[c,f]of kI(o,i)){if(a){let l=c.match(/^Links\/(\d+)\/Hash$/);if(l){let h=Number(l[1]);if(h<o.Links.length){yield{name:o.Links[h].Name,cid:f};continue}}}yield{name:c,cid:f}}}var kI=function*(r,e){if(r!=null&&!(r instanceof Uint8Array)){for(let[t,i]of Object.entries(r)){let n=[...e,t];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=d$.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*kI(o,a))}else{let s=d$.asCID(i);s?yield[n.join("/"),s]:yield*kI(i,n)}}return[]}}});var g$=p((axt,y$)=>{u();"use strict";var lMe=Oe();y$.exports=function({repo:r}){async function*e(t={}){for await(let i of r.blocks.queryKeys({},{signal:t.signal}))yield{ref:i.toString()}}return lMe(e)}});var m$=p((cxt,b$)=>{u();"use strict";var fMe=Oe();b$.exports=({network:r})=>{async function e(t={}){let{bitswap:i}=await r.use(t),n=i.getWantlist();return Array.from(n).map(s=>s[1].cid)}return fMe(e)}});var w$=p((uxt,v$)=>{u();"use strict";var hMe=rt(),dMe=Oe();v$.exports=({network:r})=>{async function e(t,i={}){let{bitswap:n}=await r.use(i),s=n.wantlistForPeer(hMe.createFromB58String(t));return Array.from(s).map(o=>o[1].cid)}return dMe(e)}});var E$=p((lxt,_$)=>{u();"use strict";var pMe=Oe();_$.exports=({network:r})=>{async function e(t,i={}){let{bitswap:n}=await r.use(i);return Array.isArray(t)||(t=[t]),n.unwant(t)}return pMe(e)}});var NI=p((fxt,S$)=>{u();"use strict";var yMe=Oe();S$.exports=({network:r})=>{async function e(t={}){let i=(await r.use(t)).bitswap,n=i.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(i.getWantlist()).map(s=>s[1].cid),peers:i.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return yMe(e)}});var I$=p((hxt,x$)=>{u();"use strict";var gMe=m$(),bMe=w$(),mMe=E$(),vMe=NI(),A$=class{constructor({network:e}){this.wantlist=gMe({network:e}),this.wantlistForPeer=bMe({network:e}),this.unwant=mMe({network:e}),this.stat=vMe({network:e})}};x$.exports=A$});var DI=p(T$=>{u();"use strict";var wMe=zl().IPFS.matches;T$.isValidMultiaddr=r=>{try{return wMe(r)}catch(e){return!1}}});var P$=p((pxt,R$)=>{u();"use strict";var{isValidMultiaddr:_Me}=DI(),EMe=Oe();R$.exports=({repo:r})=>{async function e(t,i={}){if(!_Me(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i),s=n.Bootstrap||[];return s.push(t.toString()),n.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await r.config.replace(n),{Peers:[t]}}return EMe(e)}});var O$=p((yxt,C$)=>{u();"use strict";var SMe=Oe(),{Multiaddr:AMe}=et();C$.exports=({repo:r})=>{async function e(t={}){let i=await r.config.getAll(t),n=i.Bootstrap||[];return i.Bootstrap=[],await r.config.replace(i),{Peers:n.map(s=>new AMe(s))}}return SMe(e)}});var k$=p((gxt,q$)=>{u();"use strict";var xMe=Oe(),{Multiaddr:IMe}=et();q$.exports=({repo:r})=>{async function e(t={}){return{Peers:(await r.config.get("Bootstrap",t)||[]).map(n=>new IMe(n))}}return xMe(e)}});var pw=p((bxt,B$)=>{u();"use strict";B$.exports=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:200,HighWater:500},DisableNatPortMap:!0},Routing:{Type:"none"}})});var M$=p((mxt,D$)=>{u();"use strict";var N$=pw(),TMe=Oe(),{Multiaddr:RMe}=et();D$.exports=({repo:r})=>{async function e(t={}){let i=await r.config.getAll(t);return i.Bootstrap=N$().Bootstrap,await r.config.replace(i),{Peers:N$().Bootstrap.map(n=>new RMe(n))}}return TMe(e)}});var U$=p((vxt,L$)=>{u();"use strict";var{isValidMultiaddr:PMe}=DI(),CMe=Oe();L$.exports=({repo:r})=>{async function e(t,i={}){if(!PMe(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i);return n.Bootstrap=(n.Bootstrap||[]).filter(s=>s.toString()!==t.toString()),await r.config.replace(n),{Peers:[t]}}return CMe(e)}});var j$=p((wxt,K$)=>{u();"use strict";var OMe=P$(),qMe=O$(),kMe=k$(),BMe=M$(),NMe=U$(),F$=class{constructor({repo:e}){this.add=OMe({repo:e}),this.list=kMe({repo:e}),this.rm=NMe({repo:e}),this.clear=qMe({repo:e}),this.reset=BMe({repo:e})}};K$.exports=F$});var z$=p((_xt,V$)=>{u();"use strict";var DMe=Oe();V$.exports=({preload:r,repo:e})=>{async function t(i,n={}){return n.preload!==!1&&r(i),e.blocks.get(i,n)}return DMe(t)}});var $$=p((Ext,H$)=>{u();"use strict";var{CID:MMe}=(xe(),Ce),LMe=Oe();H$.exports=({codecs:r,hashers:e,repo:t,preload:i})=>{async function n(s,o={}){let a=o.pin?await t.gcLock.readLock():null;try{let c=o.version!=null?o.version:0,f=o.format||(c===0?"dag-pb":"raw"),h=await(await e.getHasher(o.mhtype||"sha2-256")).digest(s),d=await r.getCodec(f),y=MMe.create(c,d.code,h);return await t.blocks.put(y,s,{signal:o.signal}),o.preload!==!1&&i(y),o.pin===!0&&await t.pins.pinRecursively(y,{signal:o.signal}),y}finally{a&&a()}}return LMe(n)}});var jd=p((yw,G$)=>{u();(function(r,e){typeof yw=="object"&&typeof G$!="undefined"?e(yw):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.streamingIterables={}))})(yw,function(r){"use strict";async function*e(x,L){let K=[];for await(let k of L)K.push(k),K.length===x&&(yield K,K=[]);K.length>0&&(yield K)}function*t(x,L){let K=[];for(let k of L)K.push(k),K.length===x&&(yield K,K=[]);K.length>0&&(yield K)}function i(x,L){return L===void 0?K=>i(x,K):L[Symbol.asyncIterator]?e(x,L):t(x,L)}function n(x){if(typeof x.next=="function")return x;if(typeof x[Symbol.iterator]=="function")return x[Symbol.iterator]();if(typeof x[Symbol.asyncIterator]=="function")return x[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function s(){let x,L;return{promise:new Promise((k,Y)=>{L=k,x=Y}),reject:x,resolve:L}}function o(x,L){let K=n(L),k=[],Y=[],ee=!1,Z=!1;function ce(){for(;Y.length>0&&k.length>0;){let Te=Y.shift(),{error:je,value:Je}=k.shift();je?Te.reject(je):Te.resolve({done:!1,value:Je})}for(;Y.length>0&&Z;){let{resolve:Te}=Y.shift();Te({done:!0,value:void 0})}}async function ge(){if(!Z&&!ee&&!(k.length>=x)){ee=!0;try{let{done:Te,value:je}=await K.next();Te?Z=!0:k.push({value:je})}catch(Te){Z=!0,k.push({error:Te})}ce(),ee=!1,ge()}}async function be(){if(k.length>0){let{error:je,value:Je}=k.shift();if(je)throw je;return ge(),{done:!1,value:Je}}if(Z)return{done:!0,value:void 0};let Te=s();return Y.push(Te),ge(),Te.promise}let Ke={next:be,[Symbol.asyncIterator]:()=>Ke};return Ke}function*a(x,L){let K=[],k;try{for(let Y of L)K.push(Y),!(K.length<=x)&&(yield K.shift())}catch(Y){k=Y}for(let Y of K)yield Y;if(k)throw k}function c(x,L){return L===void 0?K=>c(x,K):x===0?L:L[Symbol.asyncIterator]?o(x,L):a(x,L)}async function f(x){let L=[];for await(let K of x)L.push(K);return L}function l(x){return x[Symbol.asyncIterator]?f(x):Array.from(x)}async function*h(x){for await(let L of x)yield*L}function*d(x){for(let L of x)yield*L}function y(...x){return x.find(K=>K[Symbol.asyncIterator]!==void 0)?h(x):d(x)}async function g(x){for await(let L of x);}function m(x){if(x[Symbol.asyncIterator])return g(x);for(let L of x);}async function*E(x,L){for await(let K of L)await x(K)&&(yield K)}function _(x,L){return L===void 0?K=>E(x,K):E(x,L)}async function*T(x){for await(let L of x)L&&typeof L!="string"&&(L[Symbol.iterator]||L[Symbol.asyncIterator])?yield*T(L):yield L}async function*q(x,L){for await(let K of L)yield await x(K)}function z(x,L){return L===void 0?K=>q(x,K):q(x,L)}function V(x,L){return L===void 0?K=>V(x,K):_(K=>K!=null,T(z(x,L)))}function M(x,L,K){let k=n(K),Y=[],ee=[],Z=!1,ce=!1,ge=0,be=null;function Ke(){for(;ee.length>0&&Y.length>0;){let{resolve:Ve}=ee.shift(),dt=Y.shift();Ve({done:!1,value:dt})}for(;ee.length>0&&ge===0&&Z;){let{resolve:Ve,reject:dt}=ee.shift();be?(dt(be),be=null):Ve({done:!0,value:void 0})}}async function Te(){if(Z){Ke();return}if(!ce&&!(ge+Y.length>=x)){ce=!0,ge++;try{let{done:Ve,value:dt}=await k.next();Ve?(Z=!0,ge--,Ke()):je(dt)}catch(Ve){Z=!0,ge--,be=Ve,Ke()}ce=!1,Te()}}async function je(Ve){try{let dt=await L(Ve);if(dt&&dt[Symbol.asyncIterator])for await(let Vt of dt)Y.push(Vt);else Y.push(dt)}catch(dt){Z=!0,be=dt}ge--,Ke(),Te()}async function Je(){if(Y.length===0){let dt=s();return ee.push(dt),Te(),dt.promise}let Ve=Y.shift();return Te(),{done:!1,value:Ve}}let ze={next:Je,[Symbol.asyncIterator]:()=>ze};return ze}function $(x,L,K){return L===void 0?(k,Y)=>Y?$(x,k,Y):$(x,k):K===void 0?k=>$(x,L,k):_(k=>k!=null,T(M(x,L,K)))}async function X(x){return new Promise(L=>{x.once("readable",()=>{L()})})}async function*Q(x){for(;;){let L=x.read();if(L!==null){yield L;continue}if(x._readableState.ended)break;await X(x)}}function O(x){return typeof x[Symbol.asyncIterator]=="function"?x:Q(x)}async function*b(...x){let L=new Set(x.map(n));for(;L.size>0;)for(let K of L){let k=await K.next();k.done?L.delete(K):yield k.value}}function w(x,...L){let K=x();for(let k of L)K=k(K);return K}async function*S(x,L,K){let k=null,Y=ge=>({value:L(ge)}),ee=async function*(ge){for await(let be of ge){if(k)return;yield be}},Z=w(()=>K,c(1),ee,z(Y),c(x-1)),ce=n(Z);for(;;){let{value:ge,done:be}=await ce.next();if(be)break;try{let Ke=await ge.value;k||(yield Ke)}catch(Ke){k=Ke}}if(k)throw k}function C(x,L,K){return L===void 0?(k,Y)=>C(x,k,Y):K===void 0?k=>C(x,L,k):x===1?z(L,K):S(x,L,K)}function B(x,L,K){return L===void 0?(k,Y)=>Y?B(x,k,Y):B(x,k):K===void 0?k=>B(x,L,k):_(k=>k!=null,T(C(x,L,K)))}async function*G(...x){let L=x.map(n),K=new Set,k=new Map,Y=null,ee=null,Z=null,ce=Te=>{Y=Te,ee&&ee(Te)},ge=Te=>{Z&&Z(Te)},be=()=>new Promise((Te,je)=>{if(Y&&je(Y),k.size>0)return Te();Z=Te,ee=je}),Ke=Te=>{let je=Promise.resolve(Te.next()).then(async({done:Je,value:ze})=>{Je||k.set(Te,ze),K.delete(je)});K.add(je),je.then(ge,ce)};for(let Te of L)Ke(Te);for(;;){if(K.size===0&&k.size===0)return;await be();for(let[Te,je]of k)k.delete(Te),yield je,Ke(Te)}}async function F(x,L,K){let k=L;for await(let Y of K)k=await x(k,Y);return k}function N(x,L,K){return L===void 0?(k,Y)=>Y?F(x,k,Y):N(x,k):K===void 0?k=>N(x,L,k):F(x,L,K)}async function*v(x,L){let K=0;for await(let k of L)if(yield await k,K++,K>=x)break}function*D(x,L){let K=0;for(let k of L)if(yield k,K++,K>=x)break}function ae(x,L){return L===void 0?K=>ae(x,K):L[Symbol.asyncIterator]?v(x,L):D(x,L)}async function*W(x,L){for await(let K of L)await x(K),yield K}function ne(x,L){return L===void 0?K=>W(x,K):W(x,L)}function oe(x,L){let K=x[0]+L[0],k=x[1]+L[1];if(k>=1e9){let Y=k%1e9;K+=(k-Y)/1e9,k=Y}return[K,k]}async function*de(x,L){let K=L[Symbol.asyncIterator](),k=[0,0];for(;;){let Y=process.hrtime(),{value:ee,done:Z}=await K.next(),ce=process.hrtime(Y);if(k=oe(k,ce),x.progress&&x.progress(ce,k),Z)return x.total&&x.total(k),ee;yield ee}}function*pe(x,L){let K=L[Symbol.iterator](),k=[0,0];for(;;){let Y=process.hrtime(),{value:ee,done:Z}=K.next(),ce=process.hrtime(Y);if(k=oe(k,ce),x.progress&&x.progress(ce,k),Z)return x.total&&x.total(k),ee;yield ee}}function _e(x={},L){return L===void 0?K=>_e(x,K):L[Symbol.asyncIterator]!==void 0?de(x,L):pe(x,L)}function P(x,L,K){let k=n(K),Y=[],ee=[],Z=!1,ce=!1,ge=0,be=null;function Ke(){for(;ee.length>0&&Y.length>0;){let{resolve:Ve}=ee.shift(),dt=Y.shift();Ve({done:!1,value:dt})}for(;ee.length>0&&ge===0&&Z;){let{resolve:Ve,reject:dt}=ee.shift();be?(dt(be),be=null):Ve({done:!0,value:void 0})}}async function Te(){if(Z){Ke();return}if(!ce&&!(ge+Y.length>=x)){ce=!0,ge++;try{let{done:Ve,value:dt}=await k.next();Ve?(Z=!0,ge--,Ke()):je(dt)}catch(Ve){Z=!0,ge--,be=Ve,Ke()}ce=!1,Te()}}async function je(Ve){try{let dt=await L(Ve);Y.push(dt)}catch(dt){Z=!0,be=dt}ge--,Ke(),Te()}async function Je(){if(Y.length===0){let dt=s();return ee.push(dt),Te(),dt.promise}let Ve=Y.shift();return Te(),{done:!1,value:Ve}}let ze={next:Je,[Symbol.asyncIterator]:()=>ze};return ze}function U(x,L,K){return L===void 0?(k,Y)=>Y?U(x,k,Y):U(x,k):K===void 0?k=>U(x,L,k):P(x,L,K)}async function H(x,L){let K=null,k=null,Y=null,ee=be=>{K=be,k&&k(be)},Z=()=>{Y&&Y()},ce=()=>{x.removeListener("error",ee),x.removeListener("drain",Z)};x.once("error",ee);let ge=()=>new Promise((be,Ke)=>{if(K)return Ke(K);x.once("drain",Z),Y=be,k=Ke});for await(let be of L)if(x.write(be)===!1&&await ge(),K)break;if(ce(),K)throw K}function J(x,L){return L===void 0?K=>H(x,K):H(x,L)}r.batch=i,r.buffer=c,r.collect=l,r.concat=y,r.consume=m,r.filter=_,r.flatMap=V,r.flatTransform=$,r.flatten=T,r.fromStream=O,r.getIterator=n,r.map=z,r.merge=b,r.parallelFlatMap=B,r.parallelMap=C,r.parallelMerge=G,r.pipeline=w,r.reduce=N,r.take=ae,r.tap=ne,r.time=_e,r.transform=U,r.writeToStream=J,Object.defineProperty(r,"__esModule",{value:!0})})});var LI=p(W$=>{u();"use strict";var{CID:MI}=(xe(),Ce),UMe=ue();W$.cleanCid=r=>{if(r instanceof MI)return r;if(typeof r=="string")return MI.parse(r);if(r instanceof Uint8Array)return MI.decode(r);throw UMe(new Error("Invalid CID"),"ERR_INVALID_CID")}});var X$=p((Axt,Y$)=>{u();"use strict";var FMe=ue(),{parallelMap:KMe,filter:jMe}=jd(),{pipe:VMe}=Gr(),{cleanCid:zMe}=LI(),HMe=Oe(),$Me=8;Y$.exports=({repo:r})=>{async function*e(t,i={}){Array.isArray(t)||(t=[t]);let n=await r.gcLock.writeLock();try{yield*VMe(t,KMe($Me,async s=>{s=zMe(s);let o={cid:s};try{if(!await r.blocks.has(s))throw FMe(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await r.blocks.delete(s)}catch(a){i.force||(a.message=`cannot remove ${s}: ${a.message}`,o.error=a)}return o}),jMe(()=>!i.quiet))}finally{n()}}return HMe(e)}});var J$=p((xxt,Q$)=>{u();"use strict";var{cleanCid:GMe}=LI(),WMe=Oe();Q$.exports=({repo:r,preload:e})=>{async function t(i,n={}){i=GMe(i),n.preload!==!1&&e(i);let s=await r.blocks.get(i);return{cid:i,size:s.length}}return WMe(t)}});var tG=p((Ixt,eG)=>{u();"use strict";var YMe=z$(),XMe=$$(),QMe=X$(),JMe=J$(),Z$=class{constructor({codecs:e,hashers:t,preload:i,repo:n}){this.get=YMe({preload:i,repo:n}),this.put=XMe({codecs:e,hashers:t,preload:i,repo:n}),this.rm=QMe({repo:n}),this.stat=JMe({preload:i,repo:n})}};eG.exports=Z$});var iG=p((Txt,rG)=>{u();"use strict";var ZMe=Un();rG.exports=({addAll:r})=>{async function e(t,i={}){let n=await ZMe(r(t,i));if(n==null)throw Error("Failed to add a file, if you see this please report a bug");return n}return e}});var nG=p((Rg,gw)=>{u();(function(r,e){"use strict";var t={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(y){if(!Array.isArray(y)&&!ArrayBuffer.isView(y))return!1;for(var g=0;g<y.length;g++)if(!Number.isInteger(y[g])||y[g]<0||y[g]>255)return!1;return!0}function n(y,g){return(y&65535)*g+(((y>>>16)*g&65535)<<16)}function s(y,g){return y<<g|y>>>32-g}function o(y){return y^=y>>>16,y=n(y,2246822507),y^=y>>>13,y=n(y,3266489909),y^=y>>>16,y}function a(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=y[3]+g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=y[2]+g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=y[1]+g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=y[0]+g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function c(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=y[3]*g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=y[2]*g[3],m[1]+=m[2]>>>16,m[2]&=65535,m[2]+=y[3]*g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=y[1]*g[3],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=y[2]*g[2],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=y[3]*g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=y[0]*g[3]+y[1]*g[2]+y[2]*g[1]+y[3]*g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function f(y,g){return g%=64,g===32?[y[1],y[0]]:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g|y[0]>>>32-g]:(g-=32,[y[1]<<g|y[0]>>>32-g,y[0]<<g|y[1]>>>32-g])}function l(y,g){return g%=64,g===0?y:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g]:[y[1]<<g-32,0]}function h(y,g){return[y[0]^g[0],y[1]^g[1]]}function d(y){return y=h(y,[0,y[0]>>>1]),y=c(y,[4283543511,3981806797]),y=h(y,[0,y[0]>>>1]),y=c(y,[3301882366,444984403]),y=h(y,[0,y[0]>>>1]),y}t.x86.hash32=function(y,g){if(t.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%4,E=y.length-m,_=g,T=0,q=3432918353,z=461845907,V=0;V<E;V=V+4)T=y[V]|y[V+1]<<8|y[V+2]<<16|y[V+3]<<24,T=n(T,q),T=s(T,15),T=n(T,z),_^=T,_=s(_,13),_=n(_,5)+3864292196;switch(T=0,m){case 3:T^=y[V+2]<<16;case 2:T^=y[V+1]<<8;case 1:T^=y[V],T=n(T,q),T=s(T,15),T=n(T,z),_^=T}return _^=y.length,_=o(_),_>>>0},t.x86.hash128=function(y,g){if(t.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%16,E=y.length-m,_=g,T=g,q=g,z=g,V=0,M=0,$=0,X=0,Q=597399067,O=2869860233,b=951274213,w=2716044179,S=0;S<E;S=S+16)V=y[S]|y[S+1]<<8|y[S+2]<<16|y[S+3]<<24,M=y[S+4]|y[S+5]<<8|y[S+6]<<16|y[S+7]<<24,$=y[S+8]|y[S+9]<<8|y[S+10]<<16|y[S+11]<<24,X=y[S+12]|y[S+13]<<8|y[S+14]<<16|y[S+15]<<24,V=n(V,Q),V=s(V,15),V=n(V,O),_^=V,_=s(_,19),_+=T,_=n(_,5)+1444728091,M=n(M,O),M=s(M,16),M=n(M,b),T^=M,T=s(T,17),T+=q,T=n(T,5)+197830471,$=n($,b),$=s($,17),$=n($,w),q^=$,q=s(q,15),q+=z,q=n(q,5)+2530024501,X=n(X,w),X=s(X,18),X=n(X,Q),z^=X,z=s(z,13),z+=_,z=n(z,5)+850148119;switch(V=0,M=0,$=0,X=0,m){case 15:X^=y[S+14]<<16;case 14:X^=y[S+13]<<8;case 13:X^=y[S+12],X=n(X,w),X=s(X,18),X=n(X,Q),z^=X;case 12:$^=y[S+11]<<24;case 11:$^=y[S+10]<<16;case 10:$^=y[S+9]<<8;case 9:$^=y[S+8],$=n($,b),$=s($,17),$=n($,w),q^=$;case 8:M^=y[S+7]<<24;case 7:M^=y[S+6]<<16;case 6:M^=y[S+5]<<8;case 5:M^=y[S+4],M=n(M,O),M=s(M,16),M=n(M,b),T^=M;case 4:V^=y[S+3]<<24;case 3:V^=y[S+2]<<16;case 2:V^=y[S+1]<<8;case 1:V^=y[S],V=n(V,Q),V=s(V,15),V=n(V,O),_^=V}return _^=y.length,T^=y.length,q^=y.length,z^=y.length,_+=T,_+=q,_+=z,T+=_,q+=_,z+=_,_=o(_),T=o(T),q=o(q),z=o(z),_+=T,_+=q,_+=z,T+=_,q+=_,z+=_,("00000000"+(_>>>0).toString(16)).slice(-8)+("00000000"+(T>>>0).toString(16)).slice(-8)+("00000000"+(q>>>0).toString(16)).slice(-8)+("00000000"+(z>>>0).toString(16)).slice(-8)},t.x64.hash128=function(y,g){if(t.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%16,E=y.length-m,_=[0,g],T=[0,g],q=[0,0],z=[0,0],V=[2277735313,289559509],M=[1291169091,658871167],$=0;$<E;$=$+16)q=[y[$+4]|y[$+5]<<8|y[$+6]<<16|y[$+7]<<24,y[$]|y[$+1]<<8|y[$+2]<<16|y[$+3]<<24],z=[y[$+12]|y[$+13]<<8|y[$+14]<<16|y[$+15]<<24,y[$+8]|y[$+9]<<8|y[$+10]<<16|y[$+11]<<24],q=c(q,V),q=f(q,31),q=c(q,M),_=h(_,q),_=f(_,27),_=a(_,T),_=a(c(_,[0,5]),[0,1390208809]),z=c(z,M),z=f(z,33),z=c(z,V),T=h(T,z),T=f(T,31),T=a(T,_),T=a(c(T,[0,5]),[0,944331445]);switch(q=[0,0],z=[0,0],m){case 15:z=h(z,l([0,y[$+14]],48));case 14:z=h(z,l([0,y[$+13]],40));case 13:z=h(z,l([0,y[$+12]],32));case 12:z=h(z,l([0,y[$+11]],24));case 11:z=h(z,l([0,y[$+10]],16));case 10:z=h(z,l([0,y[$+9]],8));case 9:z=h(z,[0,y[$+8]]),z=c(z,M),z=f(z,33),z=c(z,V),T=h(T,z);case 8:q=h(q,l([0,y[$+7]],56));case 7:q=h(q,l([0,y[$+6]],48));case 6:q=h(q,l([0,y[$+5]],40));case 5:q=h(q,l([0,y[$+4]],32));case 4:q=h(q,l([0,y[$+3]],24));case 3:q=h(q,l([0,y[$+2]],16));case 2:q=h(q,l([0,y[$+1]],8));case 1:q=h(q,[0,y[$]]),q=c(q,V),q=f(q,31),q=c(q,M),_=h(_,q)}return _=h(_,[0,y.length]),T=h(T,[0,y.length]),_=a(_,T),T=a(T,_),_=d(_),T=d(T),_=a(_,T),T=a(T,_),("00000000"+(_[0]>>>0).toString(16)).slice(-8)+("00000000"+(_[1]>>>0).toString(16)).slice(-8)+("00000000"+(T[0]>>>0).toString(16)).slice(-8)+("00000000"+(T[1]>>>0).toString(16)).slice(-8)},typeof Rg!="undefined"?(typeof gw!="undefined"&&gw.exports&&(Rg=gw.exports=t),Rg.murmurHash3=t):typeof define=="function"&&define.amd?define([],function(){return t}):(t._murmurHash3=r.murmurHash3,t.noConflict=function(){return r.murmurHash3=t._murmurHash3,t._murmurHash3=e,t.noConflict=e,t},r.murmurHash3=t)})(Rg)});var UI=p((Rxt,sG)=>{u();sG.exports=nG()});var bw=p((Pxt,oG)=>{u();"use strict";var e7e=mr().bind({ignoreUndefined:!0}),{sha256:t7e}=(Hr(),Ir),r7e=UI(),i7e=ct();async function n7e(r){return i7e(r7e.x64.hash128(r),"base16").slice(0,8).reverse()}var s7e={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:t7e,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:n7e,hamtHashCode:34,hamtBucketBits:8};oG.exports=function(r={}){return e7e(s7e,r)}});var of=p((Cxt,uG)=>{u();"use strict";var{CID:o7e}=(xe(),Ce),aG=(xt(),At),{sha256:cG}=(Hr(),Ir),a7e=async(r,e,t)=>{t.codec||(t.codec=aG),t.hasher||(t.hasher=cG),t.cidVersion===void 0&&(t.cidVersion=1),t.codec===aG&&t.hasher!==cG&&(t.cidVersion=1);let i=await t.hasher.digest(r),n=o7e.create(t.cidVersion,t.codec.code,i);return t.onlyHash||await e.put(n,r,{signal:t.signal}),n};uG.exports=a7e});var fG=p((Oxt,lG)=>{u();"use strict";var{UnixFS:c7e}=mi(),u7e=of(),{encode:l7e,prepare:f7e}=(xt(),At),h7e=async(r,e,t)=>{let i=new c7e({type:"directory",mtime:r.mtime,mode:r.mode}),n=l7e(f7e({Data:i.marshal()})),s=await u7e(n,e,t),o=r.path;return{cid:s,path:o,unixfs:i,size:n.length}};lG.exports=h7e});var dG=p((qxt,hG)=>{u();"use strict";var d7e=bd();hG.exports=async function(r,e){return e(await d7e(r))}});var gG=p((kxt,yG)=>{u();"use strict";var p7e=Wv();function y7e(r,e,t){return pG(r,e,t)}async function pG(r,e,t){let i=[];for await(let n of p7e(r,t.maxChildrenPerNode))i.push(await e(n));return i.length>1?pG(i,e,t):i[0]}yG.exports=y7e});var vG=p((Bxt,mG)=>{u();"use strict";var g7e=Wv();mG.exports=async function(e,t,i){let n=new bG(i.layerRepeat),s=0,o=1,a=n;for await(let c of g7e(e,i.maxChildrenPerNode))a.isFull()&&(a!==n&&n.addChild(await a.reduce(t)),s&&s%i.layerRepeat==0&&o++,a=new FI(o,i.layerRepeat,s),s++),a.append(c);return a&&a!==n&&n.addChild(await a.reduce(t)),n.reduce(t)};var FI=class{constructor(e,t,i=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=i,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let i=[];return e.children.length&&(i=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,t)))),t((e.data||[]).concat(i))}_findParent(e,t){let i=e.parent;if(!(!i||i.depth===0))return i.children.length===i.maxChildren||!i.maxChildren?this._findParent(i,t):i}},bG=class extends FI{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}});var EG=p((Nxt,_G)=>{u();"use strict";var{UnixFS:b7e}=mi(),m7e=of(),wG=(xt(),At),v7e=(Xn(),kn);async function*w7e(r,e,t){for await(let i of r.content)yield async()=>{t.progress(i.length,r.path);let n,s={codec:wG,cidVersion:t.cidVersion,hasher:t.hasher,onlyHash:t.onlyHash};return t.rawLeaves?(s.codec=v7e,s.cidVersion=1):(n=new b7e({type:t.leafType,data:i,mtime:r.mtime,mode:r.mode}),i=wG.encode({Data:n.marshal(),Links:[]})),{cid:await m7e(i,e,s),unixfs:n,size:i.length}}}_G.exports=w7e});var RG=p((Dxt,TG)=>{u();"use strict";var _7e=ue(),{UnixFS:SG}=mi(),AG=of(),{encode:xG,prepare:IG}=(xt(),At),E7e=Yv(),KI=(Xn(),kn),S7e=(xt(),At),A7e={flat:dG(),balanced:gG(),trickle:vG()};async function*x7e(r,e,t){let i=-1,n,s;typeof t.bufferImporter=="function"?s=t.bufferImporter:s=EG();for await(let o of E7e(s(r,e,t),t.blockWriteConcurrency)){if(i++,i===0){n=o;continue}else i===1&&n&&(yield n,n=null);yield o}n&&(n.single=!0,yield n)}var I7e=(r,e,t)=>{async function i(n){if(n.length===1&&n[0].single&&t.reduceSingleLeafToSelf){let l=n[0];if(l.cid.code===KI.code&&(r.mtime!==void 0||r.mode!==void 0)){let h=await e.get(l.cid);l.unixfs=new SG({type:"file",mtime:r.mtime,mode:r.mode,data:h}),h=xG(IG({Data:l.unixfs.marshal()})),l.cid=await AG(h,e,{...t,codec:S7e,hasher:t.hasher,cidVersion:t.cidVersion}),l.size=h.length}return{cid:l.cid,path:r.path,unixfs:l.unixfs,size:l.size}}let s=new SG({type:"file",mtime:r.mtime,mode:r.mode}),o=n.filter(l=>l.cid.code===KI.code&&l.size||l.unixfs&&!l.unixfs.data&&l.unixfs.fileSize()?!0:Boolean(l.unixfs&&l.unixfs.data&&l.unixfs.data.length)).map(l=>l.cid.code===KI.code?(s.addBlockSize(l.size),{Name:"",Tsize:l.size,Hash:l.cid}):(!l.unixfs||!l.unixfs.data?s.addBlockSize(l.unixfs&&l.unixfs.fileSize()||0):s.addBlockSize(l.unixfs.data.length),{Name:"",Tsize:l.size,Hash:l.cid})),a={Data:s.marshal(),Links:o},c=xG(IG(a));return{cid:await AG(c,e,t),path:r.path,unixfs:s,size:c.length+a.Links.reduce((l,h)=>l+h.Tsize,0)}}return i};function T7e(r,e,t){let i=A7e[t.strategy];if(!i)throw _7e(new Error(`Unknown importer build strategy name: ${t.strategy}`),"ERR_BAD_STRATEGY");return i(x7e(r,e,t),I7e(r,e,t),t)}TG.exports=T7e});var jI=p((Mxt,CG)=>{u();"use strict";var{Buffer:wo}=pt(),PG=Symbol.for("BufferList");function nr(r){if(!(this instanceof nr))return new nr(r);nr._init.call(this,r)}nr._init=function(e){Object.defineProperty(this,PG,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};nr.prototype._new=function(e){return new nr(e)};nr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};nr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};nr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};nr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};nr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||wo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,f=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:wo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,f),f+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=wo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-l;if(c>d)this._bufs[h].copy(e,f,l),f+=d;else{this._bufs[h].copy(e,f,l,l+c),f+=d;break}c-=d,l&&(l=0)}return e.length>f?e.slice(0,f):e};nr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};nr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};nr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};nr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};nr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(wo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(wo.from(e));return this};nr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};nr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=wo.from([r]):typeof r=="string"?r=wo.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=wo.from(r.buffer,r.byteOffset,r.byteLength):wo.isBuffer(r)||(r=wo.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};nr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?nr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:nr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();nr.prototype._isBufferList=function(e){return e instanceof nr||nr.isBufferList(e)};nr.isBufferList=function(e){return e!=null&&e[PG]};CG.exports=nr});var kG=p((Lxt,qG)=>{u();var OG=class{constructor(e,t=12,i=8*1024,n=32*1024,s=64,o){this.bits=t,this.min=i,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,i,n,s,o),this.polynomial=o}fingerprint(e){let{__retain:t,__release:i,__allocArray:n,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),f=t(n(o,c)),l=t(n(a,e)),h=this.rabin.fingerprint(l,f),d=s(h);i(l),i(f);let y=d.indexOf(0);return y>=0?d.subarray(0,y):d}};qG.exports=OG});var $G=p(Og=>{u();"use strict";var VI=-8,mw=-4,R7e=0,BG=1,NG=1<<0,vw=1<<1,Uxt=1<<2,Fxt=1<<3,DG=5,Kxt=1<<DG,MG=1<<10,LG=1<<11,jxt=1<<12,P7e=1<<13,UG=14,Vxt=1<<UG,zxt=1<<19,Hxt=1<<20,$xt=1<<21,Gxt=1<<22,C7e=0,zI=4,O7e=8,q7e=12,FG=12,k7e=16,B7e=typeof BigUint64Array!="undefined",Pg=Symbol(),Cg=1024;function KG(r,e){let t=new Uint32Array(r),i=new Uint16Array(r);var n=t[e+mw>>>2]>>>1,s=e>>>1;if(n<=Cg)return String.fromCharCode.apply(String,i.subarray(s,s+n));let o=[];do{let a=i[s+Cg-1],c=a>=55296&&a<56320?Cg-1:Cg;o.push(String.fromCharCode.apply(String,i.subarray(s,s+=c))),n-=c}while(n>Cg);return o.join("")+String.fromCharCode.apply(String,i.subarray(s,s+n))}function HI(r){let e={};function t(n,s){return n?KG(n.buffer,s):"<yet unknown>"}let i=r.env=r.env||{};return i.abort=i.abort||function(s,o,a,c){let f=e.memory||i.memory;throw Error("abort: "+t(f,s)+" at "+t(f,o)+":"+a+":"+c)},i.trace=i.trace||function(s,o){let a=e.memory||i.memory;console.log("trace: "+t(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},r.Math=r.Math||Math,r.Date=r.Date||Date,e}function $I(r,e){let t=e.exports,i=t.memory,n=t.table,s=t.__alloc,o=t.__retain,a=t.__rtti_base||~0;function c(M){let $=new Uint32Array(i.buffer),X=$[a>>>2];if((M>>>=0)>=X)throw Error("invalid id: "+M);return $[(a+4>>>2)+M*2]}function f(M){let $=new Uint32Array(i.buffer),X=$[a>>>2];if((M>>>=0)>=X)throw Error("invalid id: "+M);return $[(a+4>>>2)+M*2+1]}function l(M){return 31-Math.clz32(M>>>DG&31)}function h(M){return 31-Math.clz32(M>>>UG&31)}function d(M){let $=M.length,X=s($<<1,BG),Q=new Uint16Array(i.buffer);for(var O=0,b=X>>>1;O<$;++O)Q[b+O]=M.charCodeAt(O);return X}r.__allocString=d;function y(M){let $=i.buffer;if(new Uint32Array($)[M+VI>>>2]!==BG)throw Error("not a string: "+M);return KG($,M)}r.__getString=y;function g(M,$,X){let Q=i.buffer;if(X)switch(M){case 2:return new Float32Array(Q);case 3:return new Float64Array(Q)}else switch(M){case 0:return new($?Int8Array:Uint8Array)(Q);case 1:return new($?Int16Array:Uint16Array)(Q);case 2:return new($?Int32Array:Uint32Array)(Q);case 3:return new($?BigInt64Array:BigUint64Array)(Q)}throw Error("unsupported align: "+M)}function m(M,$){let X=c(M);if(!(X&(NG|vw)))throw Error("not an array: "+M+" @ "+X);let Q=l(X),O=$.length,b=s(O<<Q,R7e),w=s(X&vw?k7e:q7e,M),S=new Uint32Array(i.buffer);S[w+C7e>>>2]=o(b),S[w+zI>>>2]=b,S[w+O7e>>>2]=O<<Q,X&vw&&(S[w+FG>>>2]=O);let C=g(Q,X&MG,X&LG);if(X&P7e)for(let B=0;B<O;++B)C[(b>>>Q)+B]=o($[B]);else C.set($,b>>>Q);return w}r.__allocArray=m;function E(M){let $=new Uint32Array(i.buffer),X=$[M+VI>>>2],Q=c(X);if(!(Q&NG))throw Error("not an array: "+X);let O=l(Q);var b=$[M+zI>>>2];let w=Q&vw?$[M+FG>>>2]:$[b+mw>>>2]>>>O;return g(O,Q&MG,Q&LG).subarray(b>>>=O,b+w)}r.__getArrayView=E;function _(M){let $=E(M),X=$.length,Q=new Array(X);for(let O=0;O<X;O++)Q[O]=$[O];return Q}r.__getArray=_;function T(M){let $=i.buffer,X=new Uint32Array($)[M+mw>>>2];return $.slice(M,M+X)}r.__getArrayBuffer=T;function q(M,$,X){return new M(z(M,$,X))}function z(M,$,X){let Q=i.buffer,O=new Uint32Array(Q),b=O[X+zI>>>2];return new M(Q,b,O[b+mw>>>2]>>>$)}r.__getInt8Array=q.bind(null,Int8Array,0),r.__getInt8ArrayView=z.bind(null,Int8Array,0),r.__getUint8Array=q.bind(null,Uint8Array,0),r.__getUint8ArrayView=z.bind(null,Uint8Array,0),r.__getUint8ClampedArray=q.bind(null,Uint8ClampedArray,0),r.__getUint8ClampedArrayView=z.bind(null,Uint8ClampedArray,0),r.__getInt16Array=q.bind(null,Int16Array,1),r.__getInt16ArrayView=z.bind(null,Int16Array,1),r.__getUint16Array=q.bind(null,Uint16Array,1),r.__getUint16ArrayView=z.bind(null,Uint16Array,1),r.__getInt32Array=q.bind(null,Int32Array,2),r.__getInt32ArrayView=z.bind(null,Int32Array,2),r.__getUint32Array=q.bind(null,Uint32Array,2),r.__getUint32ArrayView=z.bind(null,Uint32Array,2),B7e&&(r.__getInt64Array=q.bind(null,BigInt64Array,3),r.__getInt64ArrayView=z.bind(null,BigInt64Array,3),r.__getUint64Array=q.bind(null,BigUint64Array,3),r.__getUint64ArrayView=z.bind(null,BigUint64Array,3)),r.__getFloat32Array=q.bind(null,Float32Array,2),r.__getFloat32ArrayView=z.bind(null,Float32Array,2),r.__getFloat64Array=q.bind(null,Float64Array,3),r.__getFloat64ArrayView=z.bind(null,Float64Array,3);function V(M,$){let X=new Uint32Array(i.buffer);var Q=X[M+VI>>>2];if(Q<=X[a>>>2])do if(Q==$)return!0;while(Q=f(Q));return!1}return r.__instanceof=V,r.memory=r.memory||i,r.table=r.table||n,HG(t,r)}function jG(r){return typeof Response!="undefined"&&r instanceof Response}async function VG(r,e){return jG(r=await r)?zG(r,e):$I(HI(e||(e={})),await WebAssembly.instantiate(r instanceof WebAssembly.Module?r:await WebAssembly.compile(r),e))}Og.instantiate=VG;function N7e(r,e){return $I(HI(e||(e={})),new WebAssembly.Instance(r instanceof WebAssembly.Module?r:new WebAssembly.Module(r),e))}Og.instantiateSync=N7e;async function zG(r,e){return WebAssembly.instantiateStreaming?$I(HI(e||(e={})),(await WebAssembly.instantiateStreaming(r,e)).instance):VG(jG(r=await r)?r.arrayBuffer():r,e)}Og.instantiateStreaming=zG;function HG(r,e){var t=e?Object.create(e):{},i=r.__argumentsLength?function(n){r.__argumentsLength.value=n}:r.__setArgumentsLength||r.__setargc||function(){};for(let n in r){if(!Object.prototype.hasOwnProperty.call(r,n))continue;let s=r[n],o=n.split("."),a=t;for(;o.length>1;){let l=o.shift();Object.prototype.hasOwnProperty.call(a,l)||(a[l]={}),a=a[l]}let c=o[0],f=c.indexOf("#");if(f>=0){let l=c.substring(0,f),h=a[l];if(typeof h=="undefined"||!h.prototype){let d=function(...y){return d.wrap(d.prototype.constructor(0,...y))};d.prototype={valueOf:function(){return this[Pg]}},d.wrap=function(y){return Object.create(d.prototype,{[Pg]:{value:y,writable:!1}})},h&&Object.getOwnPropertyNames(h).forEach(y=>Object.defineProperty(d,y,Object.getOwnPropertyDescriptor(h,y))),a[l]=d}if(c=c.substring(f+1),a=a[l].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let d=r[n.replace("set:","get:")],y=r[n.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return d(this[Pg])},set:function(g){y(this[Pg],g)},enumerable:!0})}}else c==="constructor"?(a[c]=(...d)=>(i(d.length),s(...d))).original=s:(a[c]=function(...d){return i(d.length),s(this[Pg],...d)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:r[n.replace("set:","get:")],set:r[n.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==i?(a[c]=(...l)=>(i(l.length),s(...l))).original=s:a[c]=s}return t}Og.demangle=HG});var WG=p((Yxt,GG)=>{u();var{instantiate:D7e}=$G();GI.supported=typeof WebAssembly!="undefined";function GI(r={}){if(!GI.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return D7e(new Response(new Blob([e],{type:"application/wasm"})),r)}GG.exports=GI});var QG=p((Xxt,XG)=>{u();var YG=kG(),M7e=WG(),L7e=async(r,e,t,i,n)=>{let s=await M7e();return new YG(s,r,e,t,i,n)};XG.exports={Rabin:YG,create:L7e}});var eW=p((Qxt,ZG)=>{u();"use strict";var U7e=jI(),{create:F7e}=QG(),JG=ue();ZG.exports=async function*(e,t){let i,n,s;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)s=t.avgChunkSize,i=t.minChunkSize,n=t.maxChunkSize;else if(t.avgChunkSize)s=t.avgChunkSize,i=s/3,n=s+s/2;else throw JG(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(i<16)throw JG(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<i&&(n=i),s<i&&(s=i);let o=Math.floor(Math.log2(s));for await(let a of K7e(e,{min:i,max:n,bits:o,window:t.window,polynomial:t.polynomial}))yield a};async function*K7e(r,e){let t=await F7e(e.bits,e.min,e.max,e.window),i=new U7e;for await(let n of r){i.append(n);let s=t.fingerprint(n);for(let o=0;o<s.length;o++){let a=s[o],c=i.slice(0,a);i.consume(a),yield c}}i.length&&(yield i.slice(0))}});var rW=p((Jxt,tW)=>{u();"use strict";var WI=jI();tW.exports=async function*(e,t){let i=new WI,n=0,s=!1,o=t.maxChunkSize;for await(let a of e)for(i.append(a),n+=a.length;n>=o;)if(yield i.slice(0,o),s=!0,o===i.length)i=new WI,n=0;else{let c=new WI;c.append(i.shallowSlice(o)),i=c,n-=o}(!s||n)&&(yield i.slice(0,n))}});var sW=p((Zxt,nW)=>{u();"use strict";var iW=ue(),j7e=ct();async function*V7e(r){for await(let e of r){if(e.length===void 0)throw iW(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield j7e(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw iW(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}nW.exports=V7e});var cW=p((eIt,aW)=>{u();"use strict";var z7e=fG(),H7e=RG(),oW=ue();function $7e(r){return Symbol.iterator in r}function G7e(r){return Symbol.asyncIterator in r}function W7e(r){try{if(r instanceof Uint8Array)return async function*(){yield r}();if($7e(r))return async function*(){yield*r}();if(G7e(r))return r}catch{throw oW(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw oW(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*Y7e(r,e,t){for await(let i of r)if(i.path&&(i.path.substring(0,2)==="./"&&(t.wrapWithDirectory=!0),i.path=i.path.split("/").filter(n=>n&&n!==".").join("/")),i.content){let n;typeof t.chunker=="function"?n=t.chunker:t.chunker==="rabin"?n=eW():n=rW();let s;typeof t.chunkValidator=="function"?s=t.chunkValidator:s=sW();let o={path:i.path,mtime:i.mtime,mode:i.mode,content:n(s(W7e(i.content),t),t)};yield()=>H7e(o,e,t)}else if(i.path){let n={path:i.path,mtime:i.mtime,mode:i.mode};yield()=>z7e(n,e,t)}else throw new Error("Import candidate must have content or path or both")}aW.exports=Y7e});var ww=p((tIt,lW)=>{u();"use strict";var uW=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}};lW.exports=uW});var YI=p((rIt,dW)=>{u();"use strict";var{encode:X7e,prepare:Q7e}=(xt(),At),{UnixFS:J7e}=mi(),fW=ww(),Z7e=of(),hW=class extends fW{constructor(e,t){super(e,t);this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let t=0;t<e.length;t++){let i=e[t];yield{key:i,child:this._children[i]}}}async*flush(e){let t=Object.keys(this._children),i=[];for(let f=0;f<t.length;f++){let l=this._children[t[f]];if(l instanceof fW)for await(let h of l.flush(e))l=h,yield l;l.size!=null&&l.cid&&i.push({Name:t[f],Tsize:l.size,Hash:l.cid})}let n=new J7e({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:i},o=X7e(Q7e(s)),a=await Z7e(o,e,this.options),c=o.length+s.Links.reduce((f,l)=>f+(l.Tsize==null?0:l.Tsize),0);this.cid=a,this.size=c,yield{cid:a,unixfs:n,path:this.path,size:c}}};dW.exports=hW});var gW=p((nIt,yW)=>{u();"use strict";var _w=7;yW.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let i=this._internalPositionFor(e,!1);if(t===void 0)i!==-1&&(this._unsetInternalPos(i),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;i===-1?(i=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(i,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let t=this._internalPositionFor(e,!0);if(t!==-1)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,i=new Array(this.length);for(;t<this.length;)i[t]=e(this.get(t),t,this),t++;return i}reduce(e,t){let i=0,n=t;for(;i<this.length;){let s=this.get(i);n=e(n,s,i),i++}return n}find(e){let t=0,i,n;for(;t<this.length&&!i;)n=this.get(t),i=e(n),t++;return i?n:void 0}_internalPositionFor(e,t){let i=this._bytePosFor(e,t);if(i>=this._bitArrays.length)return-1;let n=this._bitArrays[i],s=e-i*_w;if(!((n&1<<s)>0))return-1;let a=this._bitArrays.slice(0,i).reduce(eLe,0),c=~(4294967295<<s+1),f=pW(n&c);return a+f-1}_bytePosFor(e,t){let i=Math.floor(e/_w),n=i+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return i}_setBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-t*_w}_unsetBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-t*_w)}_setInternalPos(e,t,i,n){let s=this._data,o=[t,i];if(n)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=t)s.push(o);else if(s[0][0]<=t)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(tLe),this._changedData=!1}bitField(){let e=[],t=8,i=0,n=0,s,o=this._bitArrays.slice();for(;o.length||i;){i===0&&(s=o.shift(),i=7);let c=Math.min(i,t),f=~(255<<c);n|=(s&f)<<8-t,s=s>>>c,i-=c,t-=c,(!t||!i&&!o.length)&&(e.push(n),n=0,t=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(rLe)}};function eLe(r,e){return r+pW(e)}function pW(r){let e=r;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function tLe(r,e){return r[0]-e[0]}function rLe(r){return r[1]}});var vW=p((sIt,mW)=>{u();"use strict";var iLe=gW(),nLe=ct(),_o=class{constructor(e,t,i=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=i,this._children=new iLe,this.key=null}async put(e,t){let i=await this._findNewBucketAndPos(e);await i.bucket._putAt(i,e,t)}async get(e){let t=await this._findChild(e);if(t)return t.value}async del(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);i&&i.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce((t,i)=>i instanceof _o?t+i.leafCount():t+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let t of e)t instanceof _o?yield*t.eachLeafSeries():yield t;return[]}serialize(e,t){let i=[];return t(this._children.reduce((n,s,o)=>(s&&(s instanceof _o?n.push(s.serialize(e,t)):n.push(e(s,o))),n),i))}asyncTransform(e,t){return bW(this,e,t)}toJSON(){return this.serialize(oLe,aLe)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);if(!(i instanceof _o)&&i&&i.key===e)return i}async _findPlace(e){let t=this._options.hash(typeof e=="string"?nLe(e):e),i=await t.take(this._options.bits),n=this._children.get(i);return n instanceof _o?n._findPlace(t):{bucket:this,pos:i,hash:t,existingChild:n}}async _findNewBucketAndPos(e){let t=await this._findPlace(e);if(t.existingChild&&t.existingChild.key!==e){let i=new _o(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,i);let n=await i._findPlace(t.existingChild.hash);return n.bucket._putAt(n,t.existingChild.key,t.existingChild.value),i._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,i){this._putObjectAt(e.pos,{key:t,value:i,hash:e.hash})}_putObjectAt(e,t){this._children.get(e)||this._popCount++,this._children.set(e,t)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(sLe);if(e&&!(e instanceof _o)){let t=e.hash;t.untake(this._options.bits);let i={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(i,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function sLe(r){return Boolean(r)}function oLe(r,e){return r.key}function aLe(r){return r}async function bW(r,e,t){let i=[];for(let n of r._children.compactArray())if(n instanceof _o)await bW(n,e,t);else{let s=await e(n);i.push({bitField:r._children.bitField(),children:s})}return t(i)}mW.exports=_o});var _W=p((aIt,wW)=>{u();"use strict";var cLe=[255,254,252,248,240,224,192,128],uLe=[1,3,7,15,31,63,127,255];wW.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let t=e,i=0;for(;t&&this._haveBits();){let n=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,t),a=lLe(n,s-o,o);i=(i<<o)+a,t-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return i}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function lLe(r,e,t){let i=fLe(e,t);return(r&i)>>>e}function fLe(r,e){return cLe[r]&uLe[Math.min(e+r-1,7)]}});var EW=p((cIt,XI)=>{u();"use strict";var hLe=_W(),dLe=_n();function pLe(r){function e(t){return t instanceof Ew?t:new Ew(t,r)}return e}var Ew=class{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let i=0;for(;t>0;){let n=this._buffers[this._currentBufferIndex],s=Math.min(n.availableBits(),t),o=n.take(s);i=(i<<s)+o,t-=s,this._availableBits-=s,n.availableBits()===0&&this._currentBufferIndex++}return i}untake(e){let t=e;for(;t>0;){let i=this._buffers[this._currentBufferIndex],n=Math.min(i.totalBits()-i.availableBits(),t);i.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&i.totalBits()===i.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?dLe([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),i=new hLe(t);this._buffers.push(i),this._availableBits+=i.availableBits()}};XI.exports=pLe;XI.exports.InfiniteHash=Ew});var Sw=p((uIt,AW)=>{u();"use strict";var SW=vW(),yLe=EW();function gLe(r){if(!r||!r.hashFn)throw new Error("please define an options.hashFn");let e={bits:r.bits||8,hash:yLe(r.hashFn)};return new SW(e)}AW.exports={createHAMT:gLe,Bucket:SW}});var Aw=p((lIt,TW)=>{u();"use strict";var{encode:bLe,prepare:mLe}=(xt(),At),{UnixFS:vLe}=mi(),wLe=ww(),_Le=of(),{createHAMT:ELe,Bucket:SLe}=Sw(),xW=class extends wLe{constructor(e,t){super(e,t);this._bucket=ELe({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(let t of IW(this._bucket,e,this,this.options))yield{...t,path:this.path}}};TW.exports=xW;async function*IW(r,e,t,i){let n=r._children,s=[],o=0;for(let y=0;y<n.length;y++){let g=n.get(y);if(!g)continue;let m=y.toString(16).toUpperCase().padStart(2,"0");if(g instanceof SLe){let E;for await(let _ of await IW(g,e,null,i))E=_;if(!E)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:m,Tsize:E.size,Hash:E.cid}),o+=E.size}else if(typeof g.value.flush=="function"){let E=g.value,_;for await(let q of E.flush(e))_=q,yield _;let T=m+g.key;s.push({Name:T,Tsize:_.size,Hash:_.cid}),o+=_.size}else{let E=g.value;if(!E.cid)continue;let _=m+g.key,T=E.size;s.push({Name:_,Tsize:T,Hash:E.cid}),o+=T}}let a=Uint8Array.from(n.bitField().reverse()),c=new vLe({type:"hamt-sharded-directory",data:a,fanout:r.tableSize(),hashType:i.hamtHashCode,mtime:t&&t.mtime,mode:t&&t.mode}),f={Data:c.marshal(),Links:s},l=bLe(mLe(f)),h=await _Le(l,e,i),d=l.length+o;yield{cid:h,unixfs:c,size:d}}});var PW=p((fIt,RW)=>{u();"use strict";var ALe=Aw(),xLe=YI();RW.exports=async function r(e,t,i,n){let s=t;t instanceof xLe&&t.directChildrenCount()>=i&&(s=await ILe(t,n));let o=s.parent;if(o){if(s!==t){if(e&&(e.parent=s),!s.parentKey)throw new Error("No parent key found");await o.put(s.parentKey,s)}return r(s,o,i,n)}return s};async function ILe(r,e){let t=new ALe({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},e);for await(let{key:i,child:n}of r.eachChildSeries())await t.put(i,n);return t}});var OW=p((hIt,CW)=>{u();"use strict";var TLe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);CW.exports=TLe});var DW=p((dIt,NW)=>{u();"use strict";var qW=YI(),RLe=PW(),kW=ww(),PLe=OW();async function CLe(r,e,t){let i=PLe(r.path||""),n=i.length-1,s=e,o="";for(let a=0;a<i.length;a++){let c=i[a];o+=`${o?"/":""}${c}`;let f=a===n;if(s.dirty=!0,s.cid=void 0,s.size=void 0,f)await s.put(c,r),e=await RLe(null,s,t.shardSplitThreshold,t);else{let l=await s.get(c);(!l||!(l instanceof kW))&&(l=new qW({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:l&&l.unixfs&&l.unixfs.mtime,mode:l&&l.unixfs&&l.unixfs.mode},t)),await s.put(c,l),s=l}}return e}async function*BW(r,e){if(!(r instanceof kW)){r&&r.unixfs&&r.unixfs.isDirectory()&&(yield r);return}yield*r.flush(e)}async function*OLe(r,e,t){let i=new qW({root:!0,dir:!0,path:"",dirty:!0,flat:!0},t);for await(let n of r)!n||(i=await CLe(n,i,t),(!n.unixfs||!n.unixfs.isDirectory())&&(yield n));if(t.wrapWithDirectory)yield*BW(i,e);else for await(let n of i.eachChildSeries())!n||(yield*BW(n.child,e))}NW.exports=OLe});var xw=p((pIt,MW)=>{u();"use strict";var qLe=Yv(),kLe=bw();async function*BLe(r,e,t={}){let i=kLe(t),n;typeof t.dagBuilder=="function"?n=t.dagBuilder:n=cW();let s;typeof t.treeBuilder=="function"?s=t.treeBuilder:s=DW();let o;Symbol.asyncIterator in r||Symbol.iterator in r?o=r:o=[r];for await(let a of s(qLe(n(o,e,i),i.fileImportConcurrency),e,i))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}MW.exports={importer:BLe}});var qg=p((yIt,LW)=>{u();"use strict";async function*NLe(r,e={}){let t=r.getReader();try{for(;;){let i=await t.read();if(i.done)return;yield i.value}}finally{e.preventCancel!==!0&&t.cancel(),t.releaseLock()}}LW.exports=NLe});var KW=p((gIt,FW)=>{u();"use strict";var UW=qg();function DLe(r){return typeof r.stream=="function"?UW(r.stream()):UW(new Response(r).body)}FW.exports=DLe});var kg=p((bIt,jW)=>{u();"use strict";function MLe(r){let[e,t]=r[Symbol.asyncIterator]?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],i=[];return{peek:()=>e.next(),push:n=>{i.push(n)},next:()=>i.length?{done:!1,value:i.shift()}:e.next(),[t](){return this}}}jW.exports=MLe});var Iw=p((mIt,VW)=>{u();"use strict";function LLe(r){return ArrayBuffer.isView(r)||r instanceof ArrayBuffer}function ULe(r){return r.constructor&&(r.constructor.name==="Blob"||r.constructor.name==="File")&&typeof r.stream=="function"}function FLe(r){return typeof r=="object"&&(r.path||r.content)}var KLe=r=>r&&typeof r.getReader=="function";VW.exports={isBytes:LLe,isBlob:ULe,isFileObject:FLe,isReadableStream:KLe}});var $W=p((vIt,HW)=>{u();"use strict";var jLe=ue(),VLe=ct(),zLe=qg(),HLe=KW(),$Le=kg(),GLe=bd(),WLe=mo(),{isBytes:zW,isReadableStream:YLe,isBlob:XLe}=Iw();async function*QLe(r){if(zW(r)){yield QI(r);return}if(typeof r=="string"||r instanceof String){yield QI(r.toString());return}if(XLe(r)){yield*HLe(r);return}if(YLe(r)&&(r=zLe(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=$Le(r),{value:t,done:i}=await e.peek();if(i){yield*[];return}if(e.push(t),Number.isInteger(t)){yield Uint8Array.from(await GLe(e));return}if(zW(t)||typeof t=="string"||t instanceof String){yield*WLe(e,QI);return}}throw jLe(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}function QI(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Array.isArray(r)?Uint8Array.from(r):VLe(r.toString())}HW.exports=QLe});var JI=p((wIt,JW)=>{u();"use strict";var JLe=ue(),ZLe=qg(),e9e=kg(),GW=mo(),{isBytes:WW,isBlob:YW,isReadableStream:XW,isFileObject:QW}=Iw(),{parseMtime:t9e,parseMode:r9e}=mi();JW.exports=async function*(e,t){if(e!=null){if(typeof e=="string"||e instanceof String){yield Vd(e.toString(),t);return}if(WW(e)||YW(e)){yield Vd(e,t);return}if(XW(e)&&(e=ZLe(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let i=e9e(e),{value:n,done:s}=await i.peek();if(s){yield*[];return}if(i.push(n),Number.isInteger(n)||WW(n)){yield Vd(i,t);return}if(QW(n)||YW(n)||typeof n=="string"||n instanceof String){yield*GW(i,o=>Vd(o,t));return}if(n[Symbol.iterator]||n[Symbol.asyncIterator]||XW(n)){yield*GW(i,o=>Vd(o,t));return}}if(QW(e)){yield Vd(e,t);return}throw JLe(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}};async function Vd(r,e){let{path:t,mode:i,mtime:n,content:s}=r,o={path:t||"",mode:r9e(i),mtime:t9e(n)};return s?o.content=await e(s):t||(o.content=await e(r)),o}});var eY=p((_It,ZW)=>{u();"use strict";var i9e=$W(),n9e=JI();ZW.exports=r=>n9e(r,i9e)});var iY=p((EIt,rY)=>{u();"use strict";var s9e=r=>{if(r)if(r.startsWith("size-")){let e=r.split("-")[1],t=parseInt(e);if(isNaN(t))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:t}}else{if(r.startsWith("rabin"))return{chunker:"rabin",...tY(r)};throw new Error(`Unrecognized chunker option: ${r}`)}else return{chunker:"fixed"}},tY=r=>{let e={},t=r.split("-");switch(t.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=Bg(t[1],"avg");break;case 4:e.minChunkSize=Bg(t[1],"min"),e.avgChunkSize=Bg(t[2],"avg"),e.maxChunkSize=Bg(t[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},Bg=(r,e)=>{let t=parseInt(r);if(isNaN(t))throw new Error(`Chunker parameter ${e} must be an integer`);return t};rY.exports={parseChunkSize:Bg,parseRabinString:tY,parseChunkerString:s9e}});var sY=p((SIt,nY)=>{u();"use strict";var{importer:o9e}=xw(),a9e=eY(),{parseChunkerString:c9e}=iY(),{pipe:u9e}=Gr(),l9e=Oe(),f9e=mr().bind({ignoreUndefined:!0});nY.exports=({repo:r,preload:e,options:t})=>{let i=t&&t.sharding;async function*n(s,o={}){let a=f9e({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},o,{...c9e(o.chunker)});a.hashAlg&&a.hashAlg!=="sha2-256"&&a.cidVersion!==1&&(a.cidVersion=1),a.trickle&&(a.strategy="trickle"),a.strategy==="trickle"&&(a.leafType="raw",a.reduceSingleLeafToSelf=!1),a.cidVersion>0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),a.hashAlg!==void 0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),delete a.trickle;let c={};if(a.progress){let h=a.progress;a.progress=(d,y)=>{c[y]||(c[y]=0),c[y]+=d,h(c[y],y)}}let f=u9e(a9e(s),h=>o9e(h,r.blocks,{...a,pin:!1}),h9e(a),d9e(e,a),p9e(r,a)),l=await r.gcLock.readLock();try{for await(let h of f)delete c[h.path],yield h}finally{l()}}return l9e(n)};function h9e(r){async function*e(t){for await(let i of t){let n=i.cid;r.cidVersion===1&&(n=n.toV1());let s=i.path?i.path:n.toString();r.wrapWithDirectory&&!i.path&&(s=""),yield{path:s,cid:n,size:i.size,mode:i.unixfs&&i.unixfs.mode,mtime:i.unixfs&&i.unixfs.mtime}}}return e}function d9e(r,e){async function*t(i){for await(let n of i)(!n.path||e.wrapWithDirectory?n.path==="":!n.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&r(n.cid),yield n}return t}function p9e(r,e){async function*t(i){for await(let n of i){let s=!(n.path&&n.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await r.pins.pinRecursively(n.cid),yield n}}return t}});var uY=p((AIt,cY)=>{u();"use strict";var{Bucket:y9e,createHAMT:g9e}=Sw(),{decode:b9e}=(xt(),At),m9e=UI(),v9e=ct(),w9e=async function(r){return v9e(m9e.x64.hash128(r),"base16").slice(0,8).reverse()},_9e=(r,e,t)=>Promise.all(r.map(i=>{if(i.Name==null)throw new Error("Unexpected Link without a Name");if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new y9e({hash:t._options.hash,bits:t._options.bits},e,n))}return t.put(i.Name.substring(2),!0)})),oY=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),E9e=r=>{let e=r.bucket,t=[];for(;e._parent;)t.push(e),e=e._parent;return t.push(e),t.reverse()},aY=async(r,e,t,i,n)=>{if(!i){let l=g9e({hashFn:w9e});i={rootBucket:l,hamtDepth:1,lastBucket:l}}await _9e(r.Links,i.lastBucket,i.rootBucket);let s=await i.rootBucket._findNewBucketAndPos(e),o=oY(s.pos),a=E9e(s);a.length>i.hamtDepth&&(i.lastBucket=a[i.hamtDepth],o=oY(i.lastBucket._posAtParent));let c=r.Links.find(l=>{if(l.Name==null)return!1;let h=l.Name.substring(0,2),d=l.Name.substring(2);return!(h!==o||d&&d!==e)});if(!c)return null;if(c.Name!=null&&c.Name.substring(2)===e)return c.Hash;i.hamtDepth++;let f=await t.get(c.Hash,n);return r=b9e(f),aY(r,e,t,i,n)};cY.exports=aY});var Tw=p((xIt,lY)=>{u();"use strict";lY.exports=function(e,t,i,n){let s=e.length,o=t+s;return i>=o||n<t?new Uint8Array(0):(n>=t&&n<o&&(e=e.slice(0,n-t)),i>=t&&i<o&&(e=e.slice(i-t)),e)}});var Rw=p((IIt,fY)=>{u();"use strict";var ZI=ue(),S9e=(r,e,t)=>{if(e||(e=0),e<0)throw ZI(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>r)throw ZI(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!t&&t!==0&&(t=r-e),t<0)throw ZI(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+t>r&&(t=r-e),{offset:e,length:t}};fY.exports=S9e});var e4=p((TIt,bY)=>{u();"use strict";var hY=Tw(),A9e=Rw(),{UnixFS:x9e}=mi(),dY=ue(),pY=(xt(),At),yY=(mc(),$l),I9e=(Xn(),kn);async function*gY(r,e,t,i,n=0,s){if(e instanceof Uint8Array){let c=hY(e,n,t,i);return c.length&&(yield c),n+=c.length,n}if(e.Data==null)throw dY(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let o;try{o=x9e.unmarshal(e.Data)}catch(c){throw dY(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=hY(o.data,n,t,i);c.length&&(yield c),n+=o.data.length}let a=n;for(let c=0;c<e.Links.length;c++){let f=e.Links[c],l=n+o.blockSizes[c];if(t>=a&&t<l||i>a&&i<=l||t<a&&i>l){let h=await r.get(f.Hash,{signal:s.signal}),d;switch(f.Hash.code){case pY.code:d=await pY.decode(h);break;case I9e.code:d=h;break;case yY.code:d=await yY.decode(h);break;default:throw Error(`Unsupported codec: ${f.Hash.code}`)}for await(let y of gY(r,d,t,i,n,s))n+=y.length,yield y}n=l,a=l+1}}var T9e=(r,e,t,i,n,s,o)=>{function a(c={}){let f=t.fileSize();if(f===void 0)throw new Error("File was a directory");let{offset:l,length:h}=A9e(f,c.offset,c.length),d=l,y=l+h;return gY(o,e,d,y,0,c)}return a};bY.exports=T9e});var vY=p((RIt,mY)=>{u();"use strict";var R9e=(r,e,t,i,n,s,o)=>{async function*a(c={}){let f=c.offset||0,l=c.length||e.Links.length,h=e.Links.slice(f,l);for(let d of h){let y=await n(d.Hash,d.Name||"",`${i}/${d.Name||""}`,[],s+1,o,c);y.entry&&(yield y.entry)}}return a};mY.exports=R9e});var EY=p((PIt,_Y)=>{u();"use strict";var{decode:P9e}=(xt(),At),C9e=(r,e,t,i,n,s,o)=>{function a(c={}){return wY(e,i,n,s,o,c)}return a};async function*wY(r,e,t,i,n,s){let o=r.Links;for(let a of o){let c=a.Name!=null?a.Name.substring(2):null;if(c)yield(await t(a.Hash,c,`${e}/${c}`,[],i+1,n,s)).entry;else{let f=await n.get(a.Hash);r=P9e(f);for await(let l of wY(r,e,t,i,n,s))yield l}}}_Y.exports=C9e});var AY=p((CIt,SY)=>{u();"use strict";var t4=ue(),{UnixFS:O9e}=mi(),q9e=uY(),{decode:k9e}=(xt(),At),B9e=(r,e)=>{let t=r.Links.find(i=>i.Name===e);return t&&t.Hash},N9e={raw:e4(),file:e4(),directory:vY(),"hamt-sharded-directory":EY(),metadata:(r,e,t,i,n,s,o)=>()=>[],symlink:(r,e,t,i,n,s,o)=>()=>[]},D9e=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r,a),f=k9e(c),l,h;if(e||(e=r.toString()),f.Data==null)throw t4(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{l=O9e.unmarshal(f.Data)}catch(d){throw t4(d,"ERR_NOT_UNIXFS")}if(t||(t=e),i.length){let d;if(l&&l.type==="hamt-sharded-directory"?d=await q9e(f,i[0],o):d=B9e(f,i[0]),!d)throw t4(new Error("file does not exist"),"ERR_NOT_FOUND");let y=i.shift(),g=`${t}/${y}`;h={cid:d,toResolve:i,name:y||"",path:g}}return{entry:{type:l.isDirectory()?"directory":"file",name:e,path:t,cid:r,content:N9e[l.type](r,f,l,t,n,s,o),unixfs:l,depth:s,node:f,size:l.fileSize()},next:h}};SY.exports=D9e});var IY=p((OIt,xY)=>{u();"use strict";var M9e=ue(),L9e=Tw(),U9e=Rw(),F9e=r=>{async function*e(t={}){let{offset:i,length:n}=U9e(r.length,t.offset,t.length);yield L9e(r,0,i,i+n)}return e},K9e=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw M9e(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await o.get(r,a);return{entry:{type:"raw",name:e,path:t,cid:r,content:F9e(c),depth:s,size:c.length,node:c}}};xY.exports=K9e});var RY=p((qIt,TY)=>{u();"use strict";var{CID:j9e}=(xe(),Ce),V9e=ue(),z9e=(mc(),$l),H9e=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r),f=z9e.decode(c),l=f,h=t;for(;i.length;){let d=i[0];if(d in l){i.shift(),h=`${h}/${d}`;let y=j9e.asCID(l[d]);if(y)return{entry:{type:"object",name:e,path:t,cid:r,node:c,depth:s,size:c.length,content:async function*(){yield f}},next:{cid:y,name:d,path:h,toResolve:i}};l=l[d]}else throw V9e(new Error(`No property named ${d} found in cbor node ${r}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:t,cid:r,node:c,depth:s,size:c.length,content:async function*(){yield f}}}};TY.exports=H9e});var CY=p((kIt,PY)=>{u();"use strict";var $9e=ue(),G9e=Tw(),W9e=Rw(),Y9e=(mn(),bn),X9e=r=>{async function*e(t={}){let{offset:i,length:n}=W9e(r.length,t.offset,t.length);yield G9e(r,0,i,i+n)}return e},Q9e=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw $9e(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await Y9e.decode(r.multihash.bytes);return{entry:{type:"identity",name:e,path:t,cid:r,content:X9e(c.digest),depth:s,size:c.digest.length,node:c.digest}}};PY.exports=Q9e});var kY=p((BIt,qY)=>{u();"use strict";var J9e=ue(),Z9e=(xt(),At),eUe=(mc(),$l),tUe=(Xn(),kn),{identity:rUe}=(cc(),aa),iUe={[Z9e.code]:AY(),[tUe.code]:IY(),[eUe.code]:RY(),[rUe.code]:CY()};function OY(r,e,t,i,n,s,o){let a=iUe[r.code];if(!a)throw J9e(new Error(`No resolver for code ${r.code}`),"ERR_NO_RESOLVER");return a(r,e,t,i,OY,n,s,o)}qY.exports=OY});var Eo=p((NIt,DY)=>{u();"use strict";var r4=ue(),{CID:i4}=(xe(),Ce),nUe=kY(),sUe=Un(),oUe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),aUe=r=>{if(r instanceof Uint8Array)return{cid:i4.decode(r),toResolve:[]};let e=i4.asCID(r);if(e)return{cid:e,toResolve:[]};if(typeof r=="string"){r.indexOf("/ipfs/")===0&&(r=r.substring(6));let t=oUe(r);return{cid:i4.parse(t[0]),toResolve:t.slice(1)}}throw r4(new Error(`Unknown path type ${r}`),"ERR_BAD_PATH")};async function*BY(r,e,t={}){let{cid:i,toResolve:n}=aUe(r),s=i.toString(),o=s,a=n.length;for(;;){let c=await nUe(i,s,o,n,a,e,t);if(!c.entry&&!c.next)throw r4(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;n=c.next.toResolve,i=c.next.cid,s=c.next.name,o=c.next.path}}async function NY(r,e,t={}){let i=await sUe(BY(r,e,t));if(!i)throw r4(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");return i}async function*cUe(r,e,t={}){let i=await NY(r,e,t);if(!i)return;if(yield i,i.type==="directory")for await(let s of n(i,t))yield s;async function*n(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*n(a,o))}}DY.exports={exporter:NY,walkPath:BY,recursive:cUe}});var LY=p((DIt,MY)=>{u();"use strict";var{exporter:uUe}=Eo(),{normalizeCidPath:lUe}=Ui(),fUe=Oe(),{CID:hUe}=(xe(),Ce);MY.exports=function({repo:r,preload:e}){async function*t(i,n={}){if(i=lUe(i),n.preload!==!1){let o=i.split("/");e(hUe.parse(o[0]))}let s=await uUe(i,r.blocks,n);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}return fUe(t)}});var KY=p((MIt,FY)=>{u();"use strict";var dUe=Eo(),pUe=ue(),{normalizeCidPath:yUe,mapFile:gUe}=Ui(),bUe=Oe(),{CID:UY}=(xe(),Ce);FY.exports=function({repo:r,preload:e}){async function*t(i,n={}){if(n.preload!==!1){let o;try{o=yUe(i).split("/")}catch(a){throw pUe(a,"ERR_INVALID_PATH")}e(UY.parse(o[0]))}let s=UY.asCID(i)||i;for await(let o of dUe.recursive(s,r.blocks,n))yield gUe(o,{...n,includeContent:!0})}return bUe(t)}});var zY=p((LIt,VY)=>{u();"use strict";var{exporter:mUe,recursive:vUe}=Eo(),wUe=ue(),{normalizeCidPath:_Ue,mapFile:n4}=Ui(),EUe=Oe(),{CID:jY}=(xe(),Ce);VY.exports=function({repo:r,preload:e}){async function*t(i,n={}){let s=_Ue(i),o=s.split("/");n.preload!==!1&&e(jY.parse(o[0]));let a=jY.asCID(s)||s,c=await mUe(a,r.blocks,n);if(c.type==="file"){yield n4(c,n);return}if(c.type==="directory"){if(n.recursive){for await(let f of vUe(c.cid,r.blocks,n))c.cid.toString()!==f.cid.toString()&&(yield n4(f,n));return}for await(let f of c.content()){let l=n4(f,n);l.depth--,yield l}return}throw wUe(new Error(`Unknown UnixFS type ${c.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return EUe(t)}});var GY=p((UIt,$Y)=>{u();"use strict";var SUe=iG(),AUe=sY(),xUe=LY(),IUe=KY(),TUe=zY(),HY=class{constructor({preload:e,repo:t,options:i}){let n=AUe({preload:e,repo:t,options:i});this.addAll=n,this.add=SUe({addAll:n}),this.cat=xUe({repo:t,preload:e}),this.get=IUe({repo:t,preload:e}),this.ls=TUe({repo:t,preload:e})}};$Y.exports=HY});var Pw=p((FIt,RUe)=>{RUe.exports={name:"ipfs-core",version:"0.8.0",description:"JavaScript implementation of the IPFS specification",keywords:["IPFS"],homepage:"https://github.com/ipfs/js-ipfs/tree/master/packages/ipfs-core#readme",bugs:"https://github.com/ipfs/js-ipfs/issues",license:"(Apache-2.0 OR MIT)",leadMaintainer:"Alex Potsides <alex@achingbrain.net>",main:"src/index.js",types:"dist/src/index.d.ts",files:["src","dist","!dist/*.tsbuildinfo"],browser:{"./src/runtime/init-assets-nodejs.js":"./src/runtime/init-assets-browser.js","./src/runtime/config-nodejs.js":"./src/runtime/config-browser.js","./src/runtime/dns-nodejs.js":"./src/runtime/dns-browser.js","./src/runtime/libp2p-nodejs.js":"./src/runtime/libp2p-browser.js","./src/runtime/libp2p-pubsub-routers-nodejs.js":"./src/runtime/libp2p-pubsub-routers-browser.js","./src/runtime/preload-nodejs.js":"./src/runtime/preload-browser.js","./src/runtime/repo-nodejs.js":"./src/runtime/repo-browser.js","ipfs-utils/src/files/glob-source":!1},typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"],"src/":["dist/src/index"]}},repository:{type:"git",url:"git+https://github.com/ipfs/js-ipfs.git"},scripts:{build:"aegir build",lint:"aegir lint",test:"aegir test","test:node":"aegir test -t node","test:browser":"aegir test -t browser","test:webworker":"aegir test -t webworker","test:electron-main":"aegir test -t electron-main","test:electron-renderer":"aegir test -t electron-renderer","test:bootstrapers":"IPFS_TEST=bootstrapers aegir test -t browser -f test/bootstrapers.js",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",clean:"rimraf ./dist","dep-check":"aegir dep-check -i interface-ipfs-core -i ipfs-core-types -i abort-controller"},dependencies:{"@ipld/car":"^3.1.0","@ipld/dag-cbor":"^6.0.5","@ipld/dag-pb":"^2.1.3","abort-controller":"^3.0.0","array-shuffle":"^2.0.0","blockstore-datastore-adapter":"1.0.0","datastore-core":"^5.0.1","datastore-fs":"^5.0.2","datastore-level":"^6.0.1","datastore-pubsub":"^0.7.0",debug:"^4.1.1",dlv:"^1.1.3","err-code":"^3.0.1","hamt-sharding":"^2.0.0",hashlru:"^2.3.0","interface-blockstore":"^1.0.0","interface-datastore":"^5.0.0","ipfs-bitswap":"^6.0.0","ipfs-core-types":"^0.5.2","ipfs-core-utils":"^0.8.3","ipfs-http-client":"^50.1.2","ipfs-repo":"^11.0.1","ipfs-unixfs":"^5.0.0","ipfs-unixfs-exporter":"^6.0.0","ipfs-unixfs-importer":"^8.0.0","ipfs-utils":"^8.1.4",ipns:"^0.13.2","is-domain-name":"^1.0.1","is-ipfs":"^6.0.1","it-all":"^1.0.4","it-drain":"^1.0.3","it-first":"^1.0.4","it-last":"^1.0.4","it-map":"^1.0.4","it-merge":"^1.0.2","it-peekable":"^1.0.2","it-pipe":"^1.1.0","it-pushable":"^1.4.2","just-safe-set":"^2.2.1",libp2p:"^0.32.0","libp2p-bootstrap":"^0.13.0","libp2p-crypto":"^0.19.6","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.11.0","libp2p-kad-dht":"^0.23.1","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.2","libp2p-noise":"^4.0.0","libp2p-record":"^0.10.3","libp2p-tcp":"^0.17.1","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.1",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.0",multiaddr:"^10.0.0","multiaddr-to-uri":"^8.0.0",multiformats:"^9.4.1","native-abort-controller":"^1.0.3","p-queue":"^6.6.1","parse-duration":"^1.0.0","peer-id":"^0.15.1","streaming-iterables":"^6.0.0",uint8arrays:"^2.1.6"},devDependencies:{"@types/dlv":"^1.1.2",aegir:"^34.0.2",delay:"^5.0.0","go-ipfs":"0.8.0","interface-blockstore-tests":"^1.0.0","interface-ipfs-core":"^0.147.0","ipfsd-ctl":"^9.0.0","iso-url":"^1.0.0",nanoid:"^3.1.12","p-defer":"^3.0.0",rimraf:"^3.0.2",sinon:"^11.1.1"}}});var YY=p((KIt,WY)=>{u();"use strict";var s4=Pw(),PUe=Oe();WY.exports=({repo:r})=>{async function e(t={}){let i=await r.version.get();return{version:s4.version,repo:`${i}`,commit:s4.gitHead||"","interface-ipfs-core":s4.devDependencies["interface-ipfs-core"]}}return PUe(e)}});var QY=p((jIt,XY)=>{u();"use strict";var CUe=Pw().version,{Multiaddr:OUe}=et(),qUe=Oe(),Cw=Ze(),kUe=rt(),{NotStartedError:BUe}=Iu();XY.exports=({peerId:r,network:e})=>{async function t(i={}){i.peerId===r.toB58String()&&delete i.peerId;let n=e.try();if(!n){if(i.peerId)throw new BUe;return{id:r.toB58String(),publicKey:Cw(r.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${CUe}`,protocolVersion:"9000",protocols:[]}}let s=i.peerId?kUe.createFromB58String(i.peerId.toString()):r,{libp2p:o}=n,a=i.peerId?o.peerStore.keyBook.get(s):s.pubKey,c=i.peerId?o.peerStore.addressBook.getMultiaddrsForPeer(s):o.multiaddrs,f=i.peerId?o.peerStore.protoBook.get(s):Array.from(o.upgrader.protocols.keys()),l=Cw(o.peerStore.metadataBook.getValue(s,"AgentVersion")||new Uint8Array),h=Cw(o.peerStore.metadataBook.getValue(s,"ProtocolVersion")||new Uint8Array),d=s.toB58String();return{id:d,publicKey:Cw(a.bytes,"base64pad"),addresses:(c||[]).map(y=>{let g=y.toString();return g.endsWith(`/p2p/${d}`)?g:`${g}/p2p/${d}`}).sort().map(y=>new OUe(y)),agentVersion:l,protocolVersion:h,protocols:(f||[]).sort()}}return qUe(t)}});var c4=p((VIt,a4)=>{u();"use strict";var si=kx(),o4=pw(),zd=Oe(),NUe=me()("ipfs:core:config");a4.exports=({repo:r})=>{return{getAll:zd(e),get:zd(t),set:zd(i),replace:zd(n),profiles:{apply:zd(s),list:zd(DUe)}};async function e(o={}){return r.config.getAll(o)}async function t(o,a){return o?r.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function i(o,a,c){return r.config.set(o,a,c)}async function n(o,a){return r.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,f=Ow[o];if(!f)throw new Error(`No profile with name '${o}' exists`);try{let l=await r.config.getAll(a),h=JSON.parse(JSON.stringify(l));return h=f.transform(h),c||await r.config.replace(h,a),delete l.Identity.PrivKey,delete h.Identity.PrivKey,{original:l,updated:h}}catch(l){throw NUe(l),new Error(`Could not apply profile '${o}' to config: ${l.message}`)}}};async function DUe(r){return Object.keys(Ow).map(e=>({name:e,description:Ow[e].description}))}var Ow={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:r=>(si(r,"Discovery.MDNS.Enabled",!1),si(r,"Discovery.webRTCStar.Enabled",!1),r.Swarm={...r.Swarm||{},DisableNatPortMap:!0},r)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:r=>(si(r,"Discovery.MDNS.Enabled",!0),si(r,"Discovery.webRTCStar.Enabled",!0),si(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:r=>{let e=o4();return si(r,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),si(r,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),si(r,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),si(r,"Addresses.Delegates",[]),si(r,"Bootstrap",[]),si(r,"Discovery.MDNS.Enabled",!1),si(r,"Discovery.webRTCStar.Enabled",!1),si(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!0}),r}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:r=>{let e=o4();return si(r,"Addresses.API",e.Addresses.API),si(r,"Addresses.Gateway",e.Addresses.Gateway),si(r,"Addresses.Swarm",e.Addresses.Swarm),si(r,"Addresses.Delegates",e.Addresses.Delegates),si(r,"Bootstrap",e.Bootstrap),si(r,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),si(r,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),si(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:r=>{let e=r.Swarm||{},t=e.ConnMgr||{};return t.LowWater=20,t.HighWater=40,e.ConnMgr=t,r.Swarm=e,r}},"default-power":{description:'Inverse of "lowpower" profile.',transform:r=>{let e=o4();return r.Swarm=e.Swarm,r}}};a4.exports.profiles=Ow});function l4(r){let e=zA({version:1,roots:r}),t=u4.default.encode(e.length),i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i}function JY(r){return{async setRoots(e){let t=l4(e);await r.write(t)},async writeBlock(e){let{cid:t,bytes:i}=e;await r.write(new Uint8Array(u4.default.encode(t.bytes.length+i.length))),await r.write(t.bytes),await r.write(i)},async close(){return r.end()}}}var u4,ZY=Ge(()=>{u();u4=qC(Jn());mc()});function qw(){}function eX(){let r=[],e=null,t=qw,i=!1,n=null,s=qw,o=()=>(e||(e=new Promise(f=>{t=()=>{e=null,t=qw,f()}})),e),a={write(f){r.push(f);let l=o();return s(),l},async end(){i=!0;let f=o();return s(),f}},c={async next(){let f=r.shift();return f?(r.length===0&&t(),{done:!1,value:f}):i?(t(),{done:!0,value:void 0}):(n||(n=new Promise(l=>{s=()=>(n=null,s=qw,l(c.next()))})),n)}};return{writer:a,iterator:c}}var tX=Ge(()=>{u()});async function kw(r){let e=await r.upTo(8),t=ku.default.decode(e);return r.seek(ku.default.decode.bytes),t}async function h4(r){let e=await kw(r),t=await r.exactly(e);r.seek(e);let i=HA(t);if(i==null||Array.isArray(i)||typeof i!="object")throw new Error("Invalid CAR header format");if(i.version!==1)throw typeof i.version=="string"?new Error(`Invalid CAR version: "${i.version}"`):new Error(`Invalid CAR version: ${i.version}`);if(!Array.isArray(i.roots))throw new Error("Invalid CAR header format");if(Object.keys(i).filter(n=>n!=="roots"&&n!=="version").length)throw new Error("Invalid CAR header format");return i}async function MUe(r){let e=await r.upTo(8);ku.default.decode(e);let t=ku.default.decode.bytes,i=ku.default.decode(e.subarray(ku.default.decode.bytes)),n=ku.default.decode.bytes,s=t+n+i,o=await r.exactly(s);return r.seek(s),o}async function LUe(r){let e=await r.exactly(2);if(e[0]===f4.SHA2_256&&e[1]===f4.LENGTH){let o=await r.exactly(34);r.seek(34);let a=yh(o);return tt.create(0,f4.DAG_PB,a)}let t=await kw(r);if(t!==1)throw new Error(`Unexpected CID version (${t})`);let i=await kw(r),n=await MUe(r),s=yh(n);return tt.create(t,i,s)}async function rX(r){let e=r.pos,t=await kw(r)+(r.pos-e),i=await LUe(r),n=t-(r.pos-e);return{cid:i,length:t,blockLength:n}}async function UUe(r){let{cid:e,blockLength:t}=await rX(r),i=await r.exactly(t);return r.seek(t),{bytes:i,cid:e}}async function FUe(r){let e=r.pos,{cid:t,length:i,blockLength:n}=await rX(r),s={cid:t,length:i,blockLength:n,offset:e,blockOffset:r.pos};return r.seek(s.blockLength),s}function iX(r){let e=h4(r);return{header:()=>e,async*blocks(){for(await e;(await r.upTo(8)).length>0;)yield await UUe(r)},async*blocksIndex(){for(await e;(await r.upTo(8)).length>0;)yield await FUe(r)}}}function Bw(r){let e=0;return{async upTo(t){return r.subarray(e,e+Math.min(t,r.length-e))},async exactly(t){if(t>r.length-e)throw new Error("Unexpected end of data");return r.subarray(e,e+t)},seek(t){e+=t},get pos(){return e}}}function KUe(r){let e=0,t=0,i=0,n=new Uint8Array(0),s=async o=>{t=n.length-i;let a=[n.subarray(i)];for(;t<o;){let f=await r();if(f.length===0)break;t<0?f.length>t&&a.push(f.subarray(-t)):a.push(f),t+=f.length}n=new Uint8Array(a.reduce((f,l)=>f+l.length,0));let c=0;for(let f of a)n.set(f,c),c+=f.length;i=0};return{async upTo(o){return n.length-i<o&&await s(o),n.subarray(i,i+Math.min(n.length-i,o))},async exactly(o){if(n.length-i<o&&await s(o),n.length-i<o)throw new Error("Unexpected end of data");return n.subarray(i,i+o)},seek(o){e+=o,i+=o},get pos(){return e}}}function nX(r){let e=r[Symbol.asyncIterator]();async function t(){let i=await e.next();return i.done?new Uint8Array(0):i.value}return KUe(t)}var ku,f4,d4=Ge(()=>{u();ku=qC(Jn());xe();mn();mc();f4={SHA2_256:18,LENGTH:32,DAG_PB:112}});var oX={};Ht(oX,{CarWriter:()=>Ng,CarWriterOut:()=>Nw,__browser:()=>VUe});function sX(){let r=eX(),{writer:e,iterator:t}=r;return{encoder:JY(e),iterator:t}}function jUe(r){if(r===void 0)return[];if(!Array.isArray(r)){let t=tt.asCID(r);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}let e=[];for(let t of r){let i=tt.asCID(t);if(!i)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(i)}return e}var Ng,Nw,VUe,aX=Ge(()=>{u();xe();ZY();tX();d4();Ng=class{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let t=tt.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:t,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=jUe(e);let{encoder:t,iterator:i}=sX(),n=new Ng(e,t),s=new Nw(i);return{writer:n,out:s}}static createAppender(){let{encoder:e,iterator:t}=sX();e.setRoots=()=>Promise.resolve();let i=new Ng([],e),n=new Nw(t);return{writer:i,out:n}}static async updateRootsInBytes(e,t){let i=Bw(e);await h4(i);let n=l4(t);if(i.pos!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${i.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},Nw=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};VUe=!0});var fX=p((t4t,lX)=>{u();"use strict";var{CID:zUe}=(xe(),Ce),HUe=(jv(),Kv),{base58btc:$Ue}=(zr(),Vr),{CarWriter:GUe}=(aX(),oX),WUe=Oe(),cX=me()("ipfs:components:dag:import"),YUe=(Xn(),kn),XUe=(_1(),hy),QUe=[YUe.code,XUe.code];lX.exports=({repo:r,preload:e,codecs:t})=>{async function*i(n,s={}){s.preload!==!1&&e(n);let o=zUe.asCID(n);if(!o)throw new Error(`Unexpected error converting CID type: ${n}`);cX(`Exporting ${o} as car`);let{writer:a,out:c}=await GUe.create([o]),f=null;(async()=>{try{await uX(r,{signal:s.signal,timeout:s.timeout},o,a,t),a.close()}catch(l){f=l}})();for await(let l of c){if(f)break;yield l}if(f)throw f}return WUe(i)};async function uX(r,e,t,i,n,s=new Set){let o=t.toString($Ue);if(s.has(o))return;let a=await JUe(r,e,t,n);cX(`Adding block ${t} to car`),await i.put(a),s.add(o);for(let c of a.links)await uX(r,e,c,i,n,s)}async function JUe(r,e,t,i){let n=await r.blocks.get(t,e),s=[],o=await i.getCodec(t.code);if(o)s=[...HUe.createUnsafe({bytes:n,cid:t,codec:o}).links()].map(c=>c[1]);else if(!QUe.includes(t.code))throw new Error(`Can't decode links in block with codec 0x${t.code.toString(16)} to form complete DAG`);return{cid:t,bytes:n,links:s}}});var pX=p((r4t,dX)=>{u();"use strict";var ZUe=Oe(),eFe=xd(),tFe=Un(),{resolve:hX}=Ui(),rFe=ue();dX.exports=({codecs:r,repo:e,preload:t})=>ZUe(async function(s,o={}){if(o.preload!==!1&&t(s),o.path){let h=o.localResolve?await eFe(hX(s,o.path,r,e,o)):await tFe(hX(s,o.path,r,e,o));if(!h)throw rFe(new Error("Not found"),"ERR_NOT_FOUND");return h}let a=await r.getCodec(s.code),c=await e.blocks.get(s,o);return{value:a.decode(c),remainderPath:""}})});var mX={};Ht(mX,{CarBlockIterator:()=>Dg,CarCIDIterator:()=>Mg,CarIteratorBase:()=>Dw});async function yX(r){if(!(r instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return bX(Bw(r))}async function gX(r){if(!r||typeof r[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return bX(nX(r))}async function bX(r){let e=iX(r),{version:t,roots:i}=await e.header();return{version:t,roots:i,iterator:e.blocks()}}var Dw,Dg,Mg,vX=Ge(()=>{u();d4();Dw=class{constructor(e,t,i){this._version=e,this._roots=t,this._iterable=i,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},Dg=class extends Dw{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:t,roots:i,iterator:n}=await yX(e);return new Dg(t,i,n)}static async fromIterable(e){let{version:t,roots:i,iterator:n}=await gX(e);return new Dg(t,i,n)}},Mg=class extends Dw{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){let{version:t,roots:i,iterator:n}=await yX(e);return new Mg(t,i,n)}static async fromIterable(e){let{version:t,roots:i,iterator:n}=await gX(e);return new Mg(t,i,n)}}});var EX=p((n4t,_X)=>{u();"use strict";var{CarBlockIterator:iFe}=(vX(),mX),nFe=Oe(),sFe=kg(),oFe=Ia(),aFe=mo(),wX=me()("ipfs:components:dag:import");_X.exports=({repo:r})=>{async function*e(t,i={}){let n=await r.gcLock.readLock();try{let s={signal:i.signal,timeout:i.timeout},o=sFe(t),{value:a,done:c}=await o.peek();if(c)return;a&&o.push(a);let f;a instanceof Uint8Array?f=[o]:f=o;for await(let l of f){let h=await cFe(r,s,l);if(i.pinRoots!==!1)for(let d of h){let y="";try{await r.blocks.has(d)?(wX(`Pinning root ${d}`),await r.pins.pinRecursively(d)):y="blockstore: block not found"}catch(g){y=g.message}yield{root:{cid:d,pinErrorMsg:y}}}}}finally{n()}}return nFe(e)};async function cFe(r,e,t){let i=await iFe.fromIterable(t),n=await i.getRoots();return await oFe(r.blocks.putMany(aFe(i,({cid:s,bytes:o})=>(wX(`Import block ${s}`),{key:s,value:o})),{signal:e.signal})),n}});var AX=p((s4t,SX)=>{u();"use strict";var{CID:uFe}=(xe(),Ce),lFe=Oe();SX.exports=({repo:r,codecs:e,hashers:t,preload:i})=>{async function n(s,o={}){let a=o.pin?await r.gcLock.readLock():null;try{let c=o.format||"dag-cbor",f=o.version!=null?o.version:c==="dag-pb"?0:1,l=await e.getCodec(c);if(!l)throw new Error(`Unknown codec ${o.format}, please configure additional BlockCodecs for this IPFS instance`);let h=await t.getHasher(o.hashAlg||"sha2-256");if(!h)throw new Error(`Unknown hash algorithm ${o.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let d=l.encode(s),y=await h.digest(d),g=uFe.create(f,l.code,y);return await r.blocks.put(g,d,{signal:o.signal}),o.pin&&await r.pins.pinRecursively(g),o.preload!==!1&&i(g),g}finally{a&&a()}}return lFe(n)}});var IX=p((o4t,xX)=>{u();"use strict";var fFe=Oe(),hFe=ng(),{resolvePath:dFe}=Ui();xX.exports=({repo:r,codecs:e,preload:t})=>{async function i(n,s={}){let{cid:o}=hFe(n);return s.preload!==!1&&t(o),dFe(r,e,n,s)}return fFe(i)}});var PX=p((a4t,RX)=>{u();"use strict";var pFe=fX(),yFe=pX(),gFe=EX(),bFe=AX(),mFe=IX(),TX=class{constructor({repo:e,codecs:t,hashers:i,preload:n}){this.export=pFe({repo:e,preload:n,codecs:t}),this.get=yFe({codecs:t,repo:e,preload:n}),this.import=gFe({repo:e}),this.resolve=mFe({repo:e,codecs:t,preload:n}),this.put=bFe({repo:e,codecs:t,hashers:i,preload:n})}};RX.exports=TX});var Lw=p((c4t,CX)=>{u();var{Multiaddr:vFe}=et(),Mw=(r,e)=>e,wFe=(r,e,t,i)=>{if(i&&i.assumeHttp===!1)return`tcp://${r}:${e}`;let n="tcp",s=`:${e}`;return t[t.length-1].protocol==="tcp"&&(n=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${n}://${r}${s}`},_Fe={ip4:Mw,ip6:(r,e,t,i)=>i.length===1&&i[0].protocol==="ip6"?e:`[${e}]`,tcp:(r,e,t,i,n)=>i.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${r}:${e}`:wFe(r,e,i,n),udp:(r,e)=>`udp://${r}:${e}`,dnsaddr:Mw,dns4:Mw,dns6:Mw,ipfs:(r,e)=>`${r}/ipfs/${e}`,p2p:(r,e)=>`${r}/p2p/${e}`,http:r=>`http://${r}`,https:r=>`https://${r}`,ws:r=>`ws://${r}`,wss:r=>`wss://${r}`,"p2p-websocket-star":r=>`${r}/p2p-websocket-star`,"p2p-webrtc-star":r=>`${r}/p2p-webrtc-star`,"p2p-webrtc-direct":r=>`${r}/p2p-webrtc-direct`};CX.exports=(r,e)=>{let t=new vFe(r),i=r.toString().split("/").slice(1);return t.tuples().map(n=>({protocol:i.shift(),content:n[1]?i.shift():null})).reduce((n,s,o,a)=>{let c=_Fe[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(n,s.content,o,a,e)},"")}});var qX=p((u4t,OX)=>{u();"use strict";OX.exports=r=>{if(!Array.isArray(r))throw new TypeError(`Expected an array, got ${typeof r}`);r=[...r];for(let e=r.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return r}});var NX=p((l4t,BX)=>{u();"use strict";var{default:EFe}=_c(),SFe=X0(),kX=me(),AFe=Object.assign(kX("ipfs:preload"),{error:kX("ipfs:preload:error")}),xFe=new EFe({concurrency:4});BX.exports=function(e,t={}){return AFe(e),xFe.add(async()=>{let n=(await SFe.post(e,{signal:t.signal})).body.getReader();try{for(;;){let{done:s}=await n.read();if(s)return}}finally{n.releaseLock()}})}});var LX=p((f4t,MX)=>{u();"use strict";var IFe=Lw(),DX=me(),TFe=qX(),{AbortController:RFe}=Ji(),PFe=NX(),CFe=sg(),Lg=Object.assign(DX("ipfs:preload"),{error:DX("ipfs:preload:error")}),OFe=(r={})=>{if(r.enabled=Boolean(r.enabled),r.addresses=r.addresses||[],r.cache=r.cache||1e3,!r.enabled||!r.addresses.length)return Lg("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,t=[],i=r.addresses.map(IFe),n=CFe(r.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(n.has(a))return;n.set(a,!0);let c=TFe(i),f=!1,l=Date.now();for(let h of c){if(e)throw new Error(`preload aborted for ${a}`);let d;try{d=new RFe,t=t.concat(d),await PFe(`${h}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:d.signal}),f=!0}catch(y){y.type!=="aborted"&&Lg.error(y)}finally{t=t.filter(y=>y!==d)}if(f)break}Lg(`${f?"":"un"}successfully preloaded ${a} in ${Date.now()-l}ms`)}catch(a){Lg.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,Lg(`aborting ${t.length} pending preload request(s)`),t.forEach(o=>o.abort()),t=[]},s};MX.exports=OFe});var KX=p((h4t,FX)=>{u();"use strict";var UX=me(),Uw=Object.assign(UX("ipfs:mfs-preload"),{error:UX("ipfs:mfs-preload:error")});FX.exports=({preload:r,files:e,options:t={}})=>{if(t.interval=t.interval||30*1e3,!t.enabled){Uw("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let i="",n,s=async()=>{try{let o=await e.stat("/"),a=o.cid.toString();i!==a&&(Uw(`preloading updated MFS root ${i} -> ${o.cid}`),await r(o.cid),i=a)}catch(o){Uw.error("failed to preload MFS root",o)}finally{n=setTimeout(s,t.interval)}};return{async start(){let o=await e.stat("/");i=o.cid.toString(),Uw(`monitoring MFS root ${o.cid}`),n=setTimeout(s,t.interval)},stop(){clearTimeout(n)}}}});var p4=p((d4t,jX)=>{u();"use strict";var qFe=Zx(),Fw;jX.exports=(r=!1)=>{if(Fw)return Fw;let e=qFe({singleProcess:r});return Fw={readLock:t=>async(...i)=>{let n=await e.readLock();try{return await t.apply(null,i)}finally{n()}},writeLock:t=>async(...i)=>{let n=await e.writeLock();try{return await t.apply(null,i)}finally{n()}}},Fw}});var Kw=p((p4t,GX)=>{u();"use strict";var{CID:VX}=(xe(),Ce),{UnixFS:kFe}=mi(),BFe=(xt(),At),{sha256:NFe}=(Hr(),Ir),zX=me()("ipfs:mfs:utils:with-mfs-root"),HX=ue(),{MFS_ROOT_KEY:$X}=Ui(),DFe=async(r,e)=>{if(e&&e.signal&&e.signal.aborted)throw HX(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.open();let t;try{let i=await r.repo.datastore.get($X);t=VX.decode(i)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i;zX("Creating new MFS root");let n=BFe.encode({Data:new kFe({type:"directory"}).marshal(),Links:[]}),s=await NFe.digest(n);if(t=VX.createV0(s),await r.repo.blocks.put(t,n),e&&e.signal&&e.signal.aborted)throw HX(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.put($X,t.bytes)}return zX(`Loaded MFS root /ipfs/${t}`),t};GX.exports=DFe});var jw=p((y4t,WX)=>{u();"use strict";var MFe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);WX.exports=MFe});var Ac=p((g4t,XX)=>{u();"use strict";var LFe=Kw(),UFe=jw(),{exporter:FFe}=Eo(),YX=ue(),{CID:KFe}=(xe(),Ce),y4="ipfs",jFe=async(r,e,t)=>{let i=await LFe(r,t),n={entryType:"file"},s="";if(e instanceof KFe?s=`/ipfs/${e}`:s=e,s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw YX(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw YX(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let o=UFe(s);if(o[0]===y4){let c;o.length===2?c=`/${o.join("/")}`:c=`/${o.slice(0,o.length-1).join("/")}`,n={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{let c=`/${y4}/${i}${o.length?"/"+o.join("/"):""}`,f=`/${y4}/${i}/${o.slice(0,o.length-1).join("/")}`;n={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:f,mfsPath:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}let a=n.type==="mfs"?n.mfsPath:n.path;try{let c=await FFe(a,r.repo.blocks,t);n.cid=c.cid,n.mfsPath=`/ipfs/${c.path}`,n.entryType=c.type,n.content=c.content,(n.entryType==="file"||n.entryType==="directory")&&(c.type==="file"||c.type==="directory")&&(n.unixfs=c.unixfs)}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}return n.exists=Boolean(n.cid),n};XX.exports=jFe});var Ug=p((b4t,ZX)=>{u();"use strict";var VFe=mr().bind({ignoreUndefined:!0}),zFe=Ac(),{exporter:HFe}=Eo(),$Fe=me()("ipfs:mfs:stat"),GFe=ue(),WFe=Oe(),QX=(xt(),At),YFe={withLocal:!1};ZX.exports=r=>{async function e(t,i={}){i=VFe(YFe,i),$Fe(`Fetching stats for ${t}`);let{type:n,cid:s,mfsPath:o}=await zFe(r,t,i),a=n==="ipfs"&&s?s:o,c;try{c=await HFe(a,r.repo.blocks)}catch(f){throw f.code==="ERR_NOT_FOUND"?GFe(new Error(`${t} does not exist`),"ERR_NOT_FOUND"):f}if(!JX[c.type])throw new Error(`Cannot stat codec ${c.cid.code}`);return JX[c.type](c)}return WFe(e)};var JX={raw:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:r=>{let e={cid:r.cid,type:"file",size:r.unixfs.fileSize(),cumulativeSize:QX.encode(r.node).length+(r.node.Links||[]).reduce((t,i)=>t+(i.Tsize||0),0),blocks:r.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},directory:r=>{let e={cid:r.cid,type:"directory",size:0,cumulativeSize:QX.encode(r.node).length+(r.node.Links||[]).reduce((t,i)=>t+(i.Tsize||0),0),blocks:r.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},object:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})}});var Hd=p((m4t,eQ)=>{u();"use strict";var{walkPath:XFe}=Eo(),QFe=me()("ipfs:mfs:utils:to-trail"),JFe=async(r,e)=>{QFe(`Creating trail for path ${e}`);let t=[];for await(let i of XFe(e,r.repo.blocks))t.push({name:i.name,cid:i.cid,size:i.size,type:i.type});return t};eQ.exports=JFe});var b4=p((v4t,sQ)=>{u();"use strict";var Vw=(xt(),At),{Bucket:tQ,createHAMT:ZFe}=Sw(),eKe=Aw(),g4=bw(),zw=me()("ipfs:mfs:core:utils:hamt-utils"),{UnixFS:rQ}=mi(),tKe=Un(),{CID:rKe}=(xe(),Ce),iKe=async(r,e,t,i)=>{let n=g4();if(!i.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let s=Uint8Array.from(t._children.bitField().reverse()),o=rQ.unmarshal(i.parent.Data),a=new rQ({type:"hamt-sharded-directory",data:s,fanout:t.tableSize(),hashType:n.hamtHashCode,mode:o.mode,mtime:o.mtime}),c=await r.hashers.getHasher(i.hashAlg),f={Data:a.marshal(),Links:e.sort((y,g)=>(y.Name||"").localeCompare(g.Name||""))},l=Vw.encode(f),h=await c.digest(l),d=rKe.create(i.cidVersion,Vw.code,h);return i.flush&&await r.repo.blocks.put(d,l),{node:f,cid:d,size:e.reduce((y,g)=>y+(g.Tsize||0),l.length)}},iQ=async(r,e,t,i)=>{let n=new tQ({hash:e._options.hash,bits:e._options.bits},t,i);return t._putObjectAt(i,n),await Hw(r,n,e),n},nQ=async r=>{let e=g4(),t=ZFe({hashFn:e.hamtHashFn,bits:e.hamtBucketBits});return await Hw(r,t,t),t},Hw=async(r,e,t)=>{await Promise.all(r.map(i=>{let n=i.Name||"";if(n.length===2){let s=parseInt(n,16);return e._putObjectAt(s,new tQ({hash:t._options.hash,bits:t._options.bits},e,s)),Promise.resolve()}return t.put(n.substring(2),{size:i.Tsize,cid:i.Hash})}))},$w=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),nKe=async(r,e,t)=>{let i=await nQ(t.Links),n=await i._findNewBucketAndPos(e),s=[{bucket:n.bucket,prefix:$w(n.pos)}],o=n.bucket;for(;o!==i;)s.push({bucket:o,prefix:$w(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=t;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let f=c.node.Links.filter(y=>(y.Name||"").substring(0,2)===c.prefix).pop();if(!f){zw(`Link ${c.prefix}${e} will be added`);continue}if(f.Name===`${c.prefix}${e}`){zw(`Link ${c.prefix}${e} will be replaced`);continue}zw(`Found subshard ${c.prefix}`);let l=await r.repo.blocks.get(f.Hash),h=Vw.decode(l);if(!s[a+1]){zw(`Loaded new subshard ${c.prefix}`),await iQ(h.Links,i,c.bucket,parseInt(c.prefix,16));let y=await i._findNewBucketAndPos(e);s.push({bucket:y.bucket,prefix:$w(y.pos),node:h});continue}let d=s[a+1];await Hw(h.Links,d.bucket,i),d.node=h}return await i.put(e,!0),s.reverse(),{rootBucket:i,path:s}},sKe=async(r,e,t={})=>{let i=g4(),n=new eKe({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mtime:t.mtime,mode:t.mode},{hamtHashFn:i.hamtHashFn,hamtHashCode:i.hamtHashCode,hamtBucketBits:i.hamtBucketBits,hasher:i.hasher,...t,codec:Vw});for(let s=0;s<e.length;s++)await n._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});return tKe(n.flush(r.repo.blocks))};sQ.exports={generatePath:nKe,updateHamtDirectory:iKe,recreateHamtLevel:iQ,recreateInitialHamtLevel:nQ,addLinksToHamtBucket:Hw,toPrefix:$w,createShard:sKe}});var cf=p((w4t,aQ)=>{u();"use strict";var af=(xt(),At),{sha256:oKe,sha512:aKe}=(Hr(),Ir),{CID:oQ}=(xe(),Ce),Ca=me()("ipfs:mfs:core:utils:add-link"),{UnixFS:m4}=mi(),cKe=Aw(),uKe=bw(),{updateHamtDirectory:lKe,recreateHamtLevel:fKe,recreateInitialHamtLevel:hKe,createShard:dKe,toPrefix:v4,addLinksToHamtBucket:pKe}=b4(),xc=ue(),yKe=Un(),gKe=async(r,e)=>{let t=e.parent;if(e.parentCid){let n=oQ.asCID(e.parentCid);if(n===null)throw xc(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==af.code)throw xc(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");Ca(`Loading parent node ${n}`);let s=await r.repo.blocks.get(n);t=af.decode(s)}if(!t)throw xc(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw xc(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw xc(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw xc(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!t.Data)throw xc(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let i=m4.unmarshal(t.Data);return i.type==="hamt-sharded-directory"?(Ca("Adding link to sharded directory"),vKe(r,{...e,parent:t})):t.Links.length>=e.shardSplitThreshold?(Ca("Converting directory to sharded directory"),bKe(r,{...e,parent:t,mtime:i.mtime,mode:i.mode})):(Ca(`Adding ${e.name} (${e.cid}) to regular directory`),mKe(r,{...e,parent:t}))},bKe=async(r,e)=>{let t=await dKe(r,e.parent.Links.map(i=>({name:i.Name||"",size:i.Tsize||0,cid:i.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return Ca(`Converted directory to sharded directory ${t.cid}`),t},mKe=async(r,e)=>{let t=e.parent.Links.filter(f=>f.Name!==e.name);if(t.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw xc(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let i=m4.unmarshal(e.parent.Data),n;if(i.mtime){let f=Date.now(),l=Math.floor(f/1e3);i.mtime={secs:l,nsecs:(f-l*1e3)*1e3},n=i.marshal()}else n=e.parent.Data;e.parent=af.prepare({Data:n,Links:t});let s=await r.hashers.getHasher(e.hashAlg),o=af.encode(e.parent),a=await s.digest(o),c=oQ.create(e.cidVersion,af.code,a);return e.flush&&await r.repo.blocks.put(c,o),{node:e.parent,cid:c,size:o.length}},vKe=async(r,e)=>{let{shard:t,path:i}=await wKe(r,e),n=await yKe(t.flush(r.repo.blocks)),s=await r.repo.blocks.get(n.cid),o=af.decode(s),a=e.parent.Links.filter(f=>(f.Name||"").substring(0,2)!==i[0].prefix),c=o.Links.find(f=>(f.Name||"").substring(0,2)===i[0].prefix);if(!c)throw new Error(`No link found with prefix ${i[0].prefix}`);return a.push(c),lKe(r,a,i[0].bucket,e)},wKe=async(r,e)=>{let t={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw xc(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let i=await hKe(e.parent.Links),n=m4.unmarshal(e.parent.Data),s=uKe(),o;switch(e.hashAlg){case"sha2-256":o=oKe;break;case"sha2-512":o=aKe;break;default:throw new Error(`TODO vmx 2021-03-31: Proper error message for unsupported hash algorithms like ${e.hashAlg}`)}let a=new cKe({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mode:n.mode},{hamtHashFn:s.hamtHashFn,hamtHashCode:s.hamtHashCode,hamtBucketBits:s.hamtBucketBits,hasher:o,...e});a._bucket=i,n.mtime&&(a.mtime=new Date);let c=await i._findNewBucketAndPos(t.name),f=_Ke(c);f[0].node=e.parent;let l=0;for(;l<f.length;){let h=f[l];l++;let d=h.node;if(!d)throw new Error("Segment had no node");let y=d.Links.find(_=>(_.Name||"").substring(0,2)===h.prefix);if(!y){Ca(`Link ${h.prefix}${t.name} will be added`),l=f.length;break}if(y.Name===`${h.prefix}${t.name}`){Ca(`Link ${h.prefix}${t.name} will be replaced`),l=f.length;break}if((y.Name||"").length>2){Ca(`Link ${y.Name} ${y.Hash} will be replaced with a subshard`),l=f.length;break}Ca(`Found subshard ${h.prefix}`);let g=await r.repo.blocks.get(y.Hash),m=af.decode(g);if(!f[l]){Ca(`Loaded new subshard ${h.prefix}`),await fKe(m.Links,i,h.bucket,parseInt(h.prefix,16));let _=await i._findNewBucketAndPos(t.name);f.push({bucket:_.bucket,prefix:v4(_.pos),node:m});break}let E=f[l];await pKe(m.Links,E.bucket,i),E.node=m}return await a._bucket.put(t.name,{size:t.size,cid:t.cid}),{shard:a,path:f}},_Ke=r=>{let e=[{bucket:r.bucket,prefix:v4(r.pos)}],t=r.bucket._parent,i=r.bucket._posAtParent;for(;t;)e.push({bucket:t,prefix:v4(i)}),i=t._posAtParent,t=t._parent;return e.reverse(),e};aQ.exports=gKe});var uf=p((_4t,uQ)=>{u();"use strict";var cQ=me()("ipfs:mfs:utils:update-tree"),EKe=cf(),{decode:SKe}=(xt(),At),AKe={shardSplitThreshold:1e3},xKe=async(r,e,t)=>{t=Object.assign({},AKe,t),cQ("Trail",e),e=e.slice().reverse();let i=0,n;for await(let o of r.repo.blocks.getMany(e.map(a=>a.cid))){let a=SKe(o),c=e[i].cid,f=e[i].name;if(i++,!n){n={cid:c,name:f,size:o.length};continue}let l=await EKe(r,{parent:a,name:n.name,cid:n.cid,size:n.size,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold,hashAlg:t.hashAlg,cidVersion:t.cidVersion});n={cid:l.cid,name:f,size:l.size}}let{cid:s}=n;return cQ(`Final CID ${s}`),s};uQ.exports=xKe});var lf=p((E4t,lQ)=>{u();"use strict";var IKe=me()("ipfs:mfs:utils:update-mfs-root"),{MFS_ROOT_KEY:TKe}=Ui(),RKe=ue(),PKe=async(r,e,t)=>{if(t&&t.signal&&t.signal.aborted)throw RKe(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return IKe(`New MFS root will be ${e}`),await r.repo.datastore.put(TKe,e.bytes),e};lQ.exports=PKe});var dQ=p((S4t,hQ)=>{u();"use strict";var{UnixFS:CKe}=mi(),fQ=(xt(),At),{CID:OKe}=(xe(),Ce),qKe=async(r,e,t)=>{let i=new CKe({type:e,mode:t.mode,mtime:t.mtime}),n=await r.hashers.getHasher(t.hashAlg),s={Data:i.marshal(),Links:[]},o=fQ.encode(s),a=await n.digest(o),c=OKe.create(t.cidVersion,fQ.code,a);return t.flush&&await r.repo.blocks.put(c,o),{cid:c,node:s}};hQ.exports=qKe});var Gw=p((A4t,yQ)=>{u();"use strict";var $d=ue(),pQ=me()("ipfs:mfs:mkdir"),{exporter:kKe}=Eo(),BKe=dQ(),NKe=jw(),DKe=lf(),MKe=uf(),LKe=cf(),UKe=Kw(),FKe=mr().bind({ignoreUndefined:!0}),KKe=Oe(),jKe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};yQ.exports=r=>{async function e(t,i={}){let n=FKe(jKe,i);if(!t)throw new Error("no path given to Mkdir");if(t=t.trim(),t==="/"){if(n.parents)return;throw $d(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(t.substring(0,1)!=="/")throw $d(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");pQ(`Creating ${t}`);let s=NKe(t);if(s[0]==="ipfs")throw $d(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await UKe(r,n),a,c=[],f=await BKe(r,"directory",n);for(let h=0;h<=s.length;h++){let d=s.slice(0,h),y=`/ipfs/${o}/${d.join("/")}`;try{if(a=await kKe(y,r.repo.blocks),a.type!=="file"&&a.type!=="directory")throw $d(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(h===s.length){if(n.parents)return;throw $d(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(g){if(g.code==="ERR_NOT_FOUND"){if(h<s.length&&!n.parents)throw $d(new Error(`Intermediate directory path ${y} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await VKe(r,d[d.length-1],f,c[c.length-1],c,n)}else throw g}}let l=await MKe(r,c,n);await DKe(r,l,n)}return KKe(e)};var VKe=async(r,e,t,i,n,s)=>{pQ(`Adding empty dir called ${e} to ${i.cid}`);let o=await LKe(r,{parent:i.node,parentCid:i.cid,size:0,cid:t.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});n[n.length-1].cid=o.cid,n.push({name:e,cid:t.cid})}});var Xw=p((x4t,_Q)=>{u();"use strict";var gQ=Gw(),zKe=Ug(),Ww=me()("ipfs:mfs:cp"),ff=ue(),bQ=uf(),mQ=lf(),HKe=cf(),Yw=Ac(),$Ke=mr().bind({ignoreUndefined:!0}),GKe=Hd(),WKe=Oe(),YKe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};_Q.exports=r=>{async function e(t,i,n={}){let s=$Ke(YKe,n);Array.isArray(t)||(t=[t]);let o=await Promise.all(t.map(d=>Yw(r,d,s))),a=await Yw(r,i,s);if(!o.length||!a)throw ff(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(d=>!d.exists);if(c)throw ff(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let f=vQ(a);if(a.exists){if(Ww("Destination exists"),o.length===1&&!f)throw ff(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(Ww("Destination does not exist"),o.length>1){if(!s.parents)throw ff(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await gQ(r)(a.path,s),a=await Yw(r,a.path,s)}else if(a.parts.length>1){let d=`/${a.parts.slice(0,-1).join("/")}`;try{await zKe(r)(d,s)}catch(y){if(y.code!=="ERR_NOT_FOUND")throw y;if(!s.parents)throw ff(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await gQ(r)(d,s),a=await Yw(r,a.path,s)}}let l=vQ(a)?a.mfsPath:a.mfsDirectory,h=await GKe(r,l);if(o.length===1){let d=o.pop();if(!d)throw ff(new Error("could not find source"),"ERR_INVALID_PARAMS");let y=f?d.name:a.name;return Ww(`Only one source, copying to destination ${f?"directory":"file"} ${y}`),XKe(r,d,y,h,s)}return Ww("Multiple sources, wrapping in a directory"),QKe(r,o,a,h,s)}return WKe(e)};var vQ=r=>r.unixfs&&r.unixfs.type&&r.unixfs.type.includes("directory"),XKe=async(r,e,t,i,n)=>{let s=i.pop();if(!s)throw ff(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await wQ(r,e,t,s,n),i.push(s);let o=await bQ(r,i,n);await mQ(r,o,n)},QKe=async(r,e,t,i,n)=>{for(let o=0;o<e.length;o++){let a=e[o];t=await wQ(r,a,a.name,t,n)}i[i.length-1]=t;let s=await bQ(r,i,n);await mQ(r,s,n)},wQ=async(r,e,t,i,n)=>{let s=await r.repo.blocks.get(e.cid),{node:o,cid:a}=await HKe(r,{parentCid:i.cid,size:s.length,cid:e.cid,name:t,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return i.node=o,i.cid=a,i.size=o.size,i}});var xQ=p((I4t,AQ)=>{u();"use strict";var w4=(xt(),At),{CID:EQ}=(xe(),Ce),Bu=me()("ipfs:mfs:core:utils:remove-link"),{UnixFS:JKe}=mi(),{generatePath:ZKe,updateHamtDirectory:_4}=b4(),hf=ue(),eje=async(r,e)=>{let t=e.parent;if(e.parentCid){let n=EQ.asCID(e.parentCid);if(n===null)throw hf(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Bu(`Loading parent node ${n}`);let s=await r.repo.blocks.get(n);t=w4.decode(s)}if(!t)throw hf(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw hf(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!t.Data)throw hf(new Error("Parent node had no data"),"ERR_INVALID_NODE");return JKe.unmarshal(t.Data).type==="hamt-sharded-directory"?(Bu(`Removing ${e.name} from sharded directory`),rje(r,{...e,parent:t})):(Bu(`Removing link ${e.name} regular directory`),tje(r,{...e,parent:t}))},tje=async(r,e)=>{e.parent.Links=e.parent.Links.filter(o=>o.Name!==e.name);let t=await w4.encode(e.parent),n=await(await r.hashers.getHasher(e.hashAlg)).digest(t),s=EQ.create(e.cidVersion,w4.code,n);return await r.repo.blocks.put(s,t),Bu(`Updated regular directory ${s}`),{node:e.parent,cid:s}},rje=async(r,e)=>{let{rootBucket:t,path:i}=await ZKe(r,e.name,e.parent);await t.del(e.name);let{node:n}=await SQ(r,i,e.name,e);return _4(r,n.Links,t,e)},SQ=async(r,e,t,i)=>{let n=e.pop();if(!n)throw hf(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=n;if(!a)throw hf(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(y=>(y.Name||"").substring(0,2)===o);if(!c)throw hf(new Error(`No link found with prefix ${o} for file ${t}`),"ERR_NOT_FOUND");if(c.Name===`${o}${t}`){Bu(`Removing existing link ${c.Name}`);let y=a.Links.filter(g=>g.Name!==c.Name);return await s.del(t),_4(r,y,s,i)}Bu(`Descending into sub-shard ${c.Name} for ${o}${t}`);let f=await SQ(r,e,t,i),l=f.cid,h=f.size,d=o;if(f.node.Links.length===1){Bu(`Removing subshard for ${o}`);let y=f.node.Links[0];d=`${o}${(y.Name||"").substring(2)}`,l=y.Hash,h=y.Tsize||0}return Bu(`Updating shard ${o} with name ${d}`),ije(r,s,a,o,d,h,l,i)},ije=(r,e,t,i,n,s,o,a)=>{let c=t.Links.filter(f=>f.Name!==i);return c.push({Name:n,Tsize:s,Hash:o}),_4(r,c,e,a)};AQ.exports=eje});var Jw=p((T4t,TQ)=>{u();"use strict";var Qw=ue(),nje=uf(),sje=lf(),oje=xQ(),IQ=Ac(),aje=Hd(),cje=Oe(),uje=mr().bind({ignoreUndefined:!0}),lje={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};TQ.exports=r=>{async function e(t,i={}){let n=uje(lje,i);Array.isArray(t)||(t=[t]);let s=await Promise.all(t.map(o=>IQ(r,o,n)));if(!s.length)throw Qw(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw Qw(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await fje(r,o.path,n)}return cje(e)};var fje=async(r,e,t)=>{let i=await IQ(r,e,t),n=await aje(r,i.mfsPath),s=n[n.length-1];n.pop();let o=n[n.length-1];if(!o)throw Qw(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!t.recursive)throw Qw(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await oje(r,{parentCid:o.cid,name:s.name,hashAlg:t.hashAlg,cidVersion:t.cidVersion,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold});o.cid=a;let c=await nje(r,n,t);await sje(r,c,t)}});var kQ=p((R4t,qQ)=>{u();"use strict";var hje=mr().bind({ignoreUndefined:!0}),dje=Ac(),pje=me()("ipfs:mfs:touch"),Fg=ue(),{UnixFS:RQ}=mi(),yje=Hd(),gje=cf(),bje=uf(),mje=lf(),df=(xt(),At),{CID:PQ}=(xe(),Ce),{pipe:vje}=Gr(),{importer:wje}=xw(),{recursive:_je}=Eo(),Eje=Un(),Sje=Xw(),Aje=Jw(),xje=of(),Ije=Oe(),CQ={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function Tje(r,e,t){let i=0;return(r.includes("x")||r.includes("X")&&(t||e&1||e&8||e&64))&&(i+=1),r.includes("w")&&(i+=2),r.includes("r")&&(i+=4),i}function Rje(r,e){let t=0;return r.includes("u")&&(t+=e<<6),r.includes("g")&&(t+=e<<3),r.includes("o")&&(t+=e),t}function Pje(r,e,t){return e.includes("t")&&(t+=parseInt("1000",8)),e.includes("s")&&(r.includes("u")&&(t+=parseInt("4000",8)),r.includes("g")&&(t+=parseInt("2000",8))),t}function Cje(r,e,t){e||(e=0);let i=r.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!i)throw new Error(`Invalid file mode: ${r}`);let[,n,s,o]=i;(n==="a"||!n)&&(n="ugo");let a=Tje(o,e,t);return a=Rje(n,a),a=Pje(n,o,a),s==="="?(n.includes("u")&&(e=e&parseInt("7077",8),e=e|a),n.includes("g")&&(e=e&parseInt("7707",8),e=e|a),n.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function OQ(r,e){if(r instanceof String||typeof r=="string"){let t=`${r}`;t.match(/^\d+$/g)?r=parseInt(t,8):r=0+t.split(",").reduce((i,n)=>Cje(n,i,e.isDirectory()),e.mode||0)}return r}qQ.exports=r=>{async function e(t,i,n={}){let s=hje(CQ,n);pje(`Fetching stats for ${t}`);let{cid:o,mfsDirectory:a,name:c}=await dje(r,t,s);if(o.code!==df.code)throw Fg(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let X=await vje(async function*(){for await(let Q of _je(o,r.repo.blocks)){if(Q.type!=="file"&&Q.type!=="directory")throw Fg(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");Q.unixfs.mode=OQ(i,Q.unixfs);let O=df.prepare({Data:Q.unixfs.marshal(),Links:Q.node.Links});yield{path:Q.path,content:O}}},Q=>wje(Q,r.repo.blocks,{...s,pin:!1,dagBuilder:async function*(O,b,w){for await(let S of O)yield async function(){let C=S.content,B=df.encode(C),G=await xje(B,b,w);if(!C.Data)throw Fg(new Error(`${G} had no data`),"ERR_INVALID_NODE");let F=RQ.unmarshal(C.Data);return{cid:G,size:B.length,path:S.path,unixfs:F}}}}),Q=>Eje(Q));if(!X)throw Fg(new Error(`Could not chmod ${t}`),"ERR_COULD_NOT_CHMOD");await Aje(r)(t,s),await Sje(r)(`/ipfs/${X.cid}`,t,s);return}let f=await r.repo.blocks.get(o),l=df.decode(f);if(!l.Data)throw Fg(new Error(`${o} had no data`),"ERR_INVALID_NODE");let h=RQ.unmarshal(l.Data);h.mode=OQ(i,h);let d=df.encode({Data:h.marshal(),Links:l.Links}),y=s.hashAlg||CQ.hashAlg,m=await(await r.hashers.getHasher(y)).digest(d),E=PQ.create(s.cidVersion,df.code,m);s.flush&&await r.repo.blocks.put(E,d);let _=await yje(r,a),T=_[_.length-1],q=PQ.decode(T.cid.bytes),z=await r.repo.blocks.get(q),V=df.decode(z),M=await gje(r,{parent:V,name:c,cid:E,size:d.length,flush:s.flush,hashAlg:y,cidVersion:o.version,shardSplitThreshold:1/0});T.cid=M.cid;let $=await bje(r,_,s);await mje(r,$,s)}return Ije(e)}});var NQ=p((P4t,BQ)=>{u();"use strict";var Oje=Ug(),qje=Oe(),kje=mr().bind({ignoreUndefined:!0}),Bje={};BQ.exports=r=>{async function e(t,i={}){i=kje(Bje,i);let{cid:n}=await Oje(r)(t,i);return n}return qje(e)}});var MQ=p((C4t,DQ)=>{u();"use strict";var Nje=Xw(),Dje=Jw(),Mje=mr().bind({ignoreUndefined:!0}),Lje=Oe(),Uje={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};DQ.exports=r=>{async function e(t,i,n={}){let s=Mje(Uje,n);await Nje(r)(t,i,s),await Dje(r)(t,{...s,recursive:!0})}return Lje(e)}});var VQ=p((O4t,jQ)=>{u();"use strict";var Fje=mr().bind({ignoreUndefined:!0}),Kje=Ac(),jje=me()("ipfs:mfs:touch"),LQ=ue(),{UnixFS:UQ}=mi(),Vje=Hd(),zje=cf(),Hje=uf(),$je=lf(),pf=(xt(),At),{CID:FQ}=(xe(),Ce),Gje=Oe(),KQ={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};jQ.exports=r=>{async function e(t,i={}){let n=Fje(KQ,i);n.mtime=n.mtime||new Date,jje(`Touching ${t} mtime: ${n.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await Kje(r,t,n),f=i.hashAlg||KQ.hashAlg,l=await r.hashers.getHasher(f),h,d,y=n.cidVersion;if(c){if(s.code!==pf.code)throw LQ(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");y=s.version;let V=await r.repo.blocks.get(s),M=pf.decode(V);if(!M.Data)throw LQ(new Error(`${t} had no data`),"ERR_INVALID_NODE");let $=UQ.unmarshal(M.Data);$.mtime=n.mtime,h=pf.encode({Data:$.marshal(),Links:M.Links});let X=await l.digest(h);d=FQ.create(n.cidVersion,pf.code,X),n.flush&&await r.repo.blocks.put(d,h)}else{let V=new UQ({type:"file",mtime:n.mtime});h=pf.encode({Data:V.marshal(),Links:[]});let M=await l.digest(h);d=FQ.create(n.cidVersion,pf.code,M),n.flush&&await r.repo.blocks.put(d,h)}let g=await Vje(r,o),m=g[g.length-1],E=m.cid,_=await r.repo.blocks.get(E),T=pf.decode(_),q=await zje(r,{parent:T,name:a,cid:d,size:h.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:y});m.cid=q.cid;let z=await Hje(r,g,n);await $je(r,z,n)}return Gje(e)}});var GQ=p((q4t,$Q)=>{u();"use strict";var zQ=ue(),Kg=me()("ipfs:mfs:utils:to-async-iterator"),{MFS_MAX_CHUNK_SIZE:HQ}=Ui(),Wje=ct(),Yje=r=>{if(!r)throw zQ(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof r=="string"||r instanceof String)&&(Kg("Content was a string"),r=Wje(r.toString())),r.length)return Kg("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield r}};if(r[Symbol.asyncIterator])return Kg("Content was an async iterator"),r;if(r[Symbol.iterator])return Kg("Content was an iterator"),r;if(globalThis.Blob&&r instanceof globalThis.Blob){Kg("Content was an HTML5 Blob");let e=0,t={next:()=>e>r.size?{done:!0}:new Promise((i,n)=>{let s=r.slice(e,HQ);e+=HQ;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return n(c.error);i({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>t}}throw zQ(new Error(`Don't know how to convert ${r} into an async iterator`),"ERR_INVALID_PARAMS")};$Q.exports=Yje});var JQ=p((k4t,QQ)=>{u();"use strict";var Oa=me()("ipfs:mfs:write"),{importer:Xje}=xw(),{decode:Qje}=(xt(),At),{sha256:Jje,sha512:Zje}=(Hr(),Ir),eVe=Ug(),tVe=Gw(),rVe=cf(),iVe=mr().bind({ignoreUndefined:!0}),WQ=p4(),nVe=GQ(),E4=Ac(),sVe=jw(),oVe=Hd(),aVe=uf(),cVe=lf(),Ic=ue(),{MFS_MAX_CHUNK_SIZE:uVe}=Ui(),lVe=Un(),fVe=Oe(),{parseMode:hVe,parseMtime:dVe}=mi(),pVe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(r,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};QQ.exports=r=>{async function e(t,i,n={}){let s=iVe(pVe,n),o,a,c;if(Oa("Reading source, destination and parent"),await WQ().readLock(async()=>{o=await nVe(i),a=await E4(r,t,s),c=await E4(r,a.mfsDirectory,s)})(),Oa("Read source, destination and parent"),!s.parents&&!c.exists)throw Ic(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw Ic(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw Ic(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw Ic(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw Ic(new Error("not a file"),"ERR_NOT_A_FILE");return yVe(r,t,o,a,s)}return fVe(e)};var yVe=async(r,e,t,i,n)=>{let s=await gVe(r,t,i,n);await WQ().writeLock(async()=>{let o=sVe(e),a=o.pop();if(a==null)throw Ic(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await eVe(r)(`/${o.join("/")}`,n),c=!0}catch(E){if(E.code!=="ERR_NOT_FOUND")throw E}c||await tVe(r)(`/${o.join("/")}`,n);let f=await E4(r,e,n),l=await oVe(r,f.mfsDirectory),h=l[l.length-1];if(!h)throw Ic(new Error("directory does not exist"),"ERR_NO_EXIST");if(!h.type||!h.type.includes("directory"))throw Ic(new Error(`cannot write to ${h.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let d=await r.repo.blocks.get(h.cid),y=Qje(d),g=await rVe(r,{parent:y,name:a,cid:s.cid,size:s.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});h.cid=g.cid;let m=await aVe(r,l,n);await cVe(r,m,n)})()},gVe=async(r,e,t,i)=>{t.exists?Oa(`Overwriting file ${t.cid} offset ${i.offset} length ${i.length}`):Oa(`Writing file offset ${i.offset} length ${i.length}`);let n=[];if(i.offset>0)if(t.unixfs){if(Oa(`Writing first ${i.offset} bytes of original file`),n.push(()=>t.content({offset:0,length:i.offset})),t.unixfs.fileSize()<i.offset){let l=i.offset-t.unixfs.fileSize();Oa(`Writing zeros for extra ${l} bytes`),n.push(XQ(l))}}else Oa(`Writing zeros for first ${i.offset} bytes`),n.push(XQ(i.offset));n.push(YQ(e,i.length));let s=mVe(bVe(n),l=>{if(t.unixfs&&!i.truncate){let h=t.unixfs.fileSize();if(h>l)return Oa(`Writing last ${h-l} of ${h} bytes from original file starting at offset ${l}`),t.content({offset:l});Oa("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;i.mode!==void 0&&i.mode!==null?o=hVe(i.mode):t&&t.unixfs&&(o=t.unixfs.mode);let a;i.mtime!=null?a=dVe(i.mtime):t&&t.unixfs&&(a=t.unixfs.mtime);let c;switch(i.hashAlg){case"sha2-256":c=Jje;break;case"sha2-512":c=Zje;break;default:throw new Error(`TODO vmx 2021-03-31: Proper error message for unsupported hash algorithms like ${i.hashAlg}`)}let f=await lVe(Xje([{content:s,mode:o,mtime:a}],r.repo.blocks,{progress:i.progress,hasher:c,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType}));if(!f)throw Ic(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return Oa(`Wrote ${f.cid}`),{cid:f.cid,size:f.size}},YQ=(r,e)=>async function*(){let i=0;for await(let n of r){if(i+=n.length,i>e){yield n.slice(0,e-i);return}yield n}},XQ=(r,e=uVe)=>{let t=new Uint8Array(e);async function*i(){for(;;)yield t.slice()}return YQ(i(),r)},bVe=async function*(r){for(let e=0;e<r.length;e++)yield*r[e]()},mVe=async function*(r,e){let t=0;for await(let i of r)t+=i.length,yield i;for await(let i of e(t))t+=i.length,yield i}});var tJ=p((B4t,eJ)=>{u();"use strict";var{exporter:vVe}=Eo(),wVe=mr().bind({ignoreUndefined:!0}),_Ve=Ac(),ZQ=ue(),EVe=Oe(),SVe={offset:0,length:1/0};eJ.exports=r=>{function e(t,i={}){return i=wVe(SVe,i),{[Symbol.asyncIterator]:async function*(){let s=await _Ve(r,t,i),o=await vVe(s.mfsPath,r.repo.blocks);if(o.type!=="file")throw ZQ(new Error(`${t} was not a file`),"ERR_NOT_FILE");if(!o.content)throw ZQ(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:i.offset,length:i.length}))yield a}}}return EVe(e)}});var nJ=p((N4t,iJ)=>{u();"use strict";var{exporter:AVe}=Eo(),xVe=Ac(),IVe=Oe(),TVe=mo(),rJ=r=>{let e={cid:r.cid,name:r.name,type:r.type==="directory"?"directory":"file",size:r.size};return(r.type==="file"||r.type==="directory")&&(e.mode=r.unixfs.mode,e.mtime=r.unixfs.mtime),e};iJ.exports=r=>{async function*e(t,i={}){let n=await xVe(r,t,i),s=await AVe(n.mfsPath,r.repo.blocks);if(s.type==="directory"){yield*TVe(s.content(i),rJ);return}yield rJ(s)}return IVe(e)}});var uJ=p((D4t,cJ)=>{u();"use strict";var RVe=p4(),sJ=sd(),PVe={stat:Ug()},CVe={chmod:kQ(),cp:Xw(),flush:NQ(),mkdir:Gw(),mv:MQ(),rm:Jw(),touch:VQ()},oJ={write:JQ(),read:tJ(),ls:nJ()},aJ=({options:r,mfs:e,operations:t,lock:i})=>{Object.keys(t).forEach(n=>{e[n]=i(t[n](r))})},OVe={repoOwner:!0,repo:null};function qVe(r){let{repoOwner:e}=Object.assign({},OVe||{},r),t=RVe(e),i=o=>t.readLock(o),n=o=>t.writeLock(o),s={};return aJ({options:r,mfs:s,operations:PVe,lock:i}),aJ({options:r,mfs:s,operations:CVe,lock:n}),Object.keys(oJ).forEach(o=>{s[o]=oJ[o](r)}),s}cJ.exports=({repo:r,preload:e,hashers:t,options:i})=>{let n=qVe({repo:r,repoOwner:Boolean(i.repoOwner),hashers:t}),s=o=>(...c)=>{let f=c.filter(l=>sJ.ipfsPath(l)||sJ.cid(l));if(f.length){let l=c[c.length-1];l&&l.preload!==!1&&f.forEach(h=>e(h))}return o(...c)};return{...n,chmod:n.chmod,cp:s(n.cp),mkdir:n.mkdir,stat:s(n.stat),rm:n.rm,read:s(n.read),touch:n.touch,write:n.write,mv:s(n.mv),flush:n.flush,ls:s(async function*(...o){for await(let a of n.ls(...o))yield{...a,size:a.size||0}})}}});var fJ=p((M4t,lJ)=>{u();"use strict";var kVe=Oe();lJ.exports=({keychain:r})=>kVe((t,i)=>r.exportKey(t,i))});var yJ=p((L4t,pJ)=>{u();"use strict";var BVe=Oe(),hJ="rsa",dJ=2048;pJ.exports=({keychain:r})=>BVe((t,i={type:hJ,size:dJ})=>r.createKey(t,i.type||hJ,i.size||dJ))});var bJ=p((U4t,gJ)=>{u();"use strict";var NVe=Oe();gJ.exports=({keychain:r})=>NVe((t,i,n)=>r.importKey(t,i,n))});var vJ=p((F4t,mJ)=>{u();"use strict";var DVe=Oe();mJ.exports=({keychain:r})=>DVe(t=>r.findKeyByName(t))});var _J=p((K4t,wJ)=>{u();"use strict";var MVe=Oe();wJ.exports=({keychain:r})=>MVe(()=>r.listKeys())});var SJ=p((j4t,EJ)=>{u();"use strict";var LVe=Oe();EJ.exports=({keychain:r})=>LVe(async(t,i)=>{let n=await r.renameKey(t,i);return{was:t,now:n.name,id:n.id,overwrite:!1}})});var xJ=p((V4t,AJ)=>{u();"use strict";var UVe=Oe();AJ.exports=({keychain:r})=>UVe(t=>r.removeKey(t))});var RJ=p((z4t,TJ)=>{u();"use strict";var FVe=fJ(),KVe=yJ(),jVe=bJ(),VVe=vJ(),zVe=_J(),HVe=SJ(),$Ve=xJ(),IJ=class{constructor({keychain:e}){this.gen=KVe({keychain:e}),this.list=zVe({keychain:e}),this.rm=$Ve({keychain:e}),this.rename=HVe({keychain:e}),this.export=FVe({keychain:e}),this.import=jVe({keychain:e}),this.info=VVe({keychain:e})}};TJ.exports=IJ});var Nu=p((H4t,PJ)=>{u();"use strict";var GVe=(xt(),At),WVe=Oe();PJ.exports=({repo:r,preload:e})=>{async function t(i,n={}){n.preload!==!1&&e(i);let s=await r.blocks.get(i,n);return GVe.decode(s)}return WVe(t)}});var OJ=p(($4t,CJ)=>{u();"use strict";var YVe=Oe();CJ.exports=({repo:r,preload:e})=>{let t=Nu()({repo:r,preload:e});async function i(n,s={}){return(await t(n,s)).Data||new Uint8Array(0)}return YVe(i)}});var BJ=p((G4t,kJ)=>{u();"use strict";var XVe=(xt(),At),QVe=(mc(),$l),JVe=(Xn(),kn),{CID:qJ}=(xe(),Ce),ZVe=Oe();function S4(r,e=[]){for(let t in r){let i=r[t];if(t==="/"&&Object.keys(r).length===1)try{e.push({Name:"",Tsize:0,Hash:qJ.parse(i)});continue}catch(n){}if(i instanceof qJ){e.push({Name:"",Tsize:0,Hash:i});continue}Array.isArray(i)&&S4(i,e),i&&typeof i=="object"&&S4(i,e)}return e}kJ.exports=({repo:r,codecs:e})=>{async function t(i,n={}){let s=await e.getCodec(i.code),o=await r.blocks.get(i,n),a=s.decode(o);if(i.code===JVe.code)return[];if(i.code===XVe.code)return a.Links;if(i.code===QVe.code)return S4(a);throw new Error(`Cannot resolve links from codec ${i.code}`)}return ZVe(t)}});var DJ=p((W4t,NJ)=>{u();"use strict";var eze=(xt(),At),{sha256:tze}=(Hr(),Ir),{UnixFS:rze}=mi(),ize=Oe(),{CID:nze}=(xe(),Ce);NJ.exports=({repo:r,preload:e})=>{async function t(i={}){let n;if(i.template)if(i.template==="unixfs-dir")n=new rze({type:"directory"}).marshal();else throw new Error("unknown template");let s=eze.encode({Data:n,Links:[]}),o=await tze.digest(s),a=nze.createV0(o);return await r.blocks.put(a,s,{signal:i.signal}),i.preload!==!1&&e(a),a}return ize(t)}});var Gd=p((Y4t,MJ)=>{u();"use strict";var sze=(xt(),At),{CID:oze}=(xe(),Ce),{sha256:aze}=(Hr(),Ir),cze=Oe();MJ.exports=({repo:r,preload:e})=>{async function t(i,n={}){let s=await r.gcLock.readLock();try{let o=sze.encode(i),a=await aze.digest(o),c=oze.createV0(a);return await r.blocks.put(c,o,{signal:n.signal}),n.preload!==!1&&e(c),n.pin&&await r.pins.pinRecursively(c,{signal:n.signal}),c}finally{s()}}return cze(t)}});var UJ=p((X4t,LJ)=>{u();"use strict";var uze=(xt(),At),lze=Oe();LJ.exports=({repo:r,preload:e})=>{let t=Nu()({repo:r,preload:e});async function i(n,s={}){let o=await t(n,s),c=uze.encode(o).length,f=o.Links.reduce((l,h)=>l+(h.Tsize||0),0);return{Hash:n,NumLinks:o.Links.length,BlockSize:c,LinksSize:c-(o.Data||[]).length,DataSize:(o.Data||[]).length,CumulativeSize:c+f}}return lze(i)}});var KJ=p((Q4t,FJ)=>{u();"use strict";var fze=Oe();FJ.exports=({repo:r,preload:e})=>{let t=Nu()({repo:r,preload:e}),i=Gd()({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a);return i({...c,Links:c.Links.concat([o])},a)}return fze(n)}});var VJ=p((J4t,jJ)=>{u();"use strict";var hze=Oe(),dze=_n();jJ.exports=({repo:r,preload:e})=>{let t=Nu()({repo:r,preload:e}),i=Gd()({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a),f=dze([c.Data||[],o]);return i({...c,Data:f},a)}return hze(n)}});var HJ=p((Z4t,zJ)=>{u();"use strict";var pze=Oe();zJ.exports=({repo:r,preload:e})=>{let t=Nu()({repo:r,preload:e}),i=Gd()({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a),f=(typeof o=="string"?o:o.Name)||"";return c.Links=c.Links.filter(l=>l.Name!==f),i(c,a)}return pze(n)}});var GJ=p((e5t,$J)=>{u();"use strict";var yze=Oe();$J.exports=({repo:r,preload:e})=>{let t=Nu()({repo:r,preload:e}),i=Gd()({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a);return i({...c,Data:o},a)}return yze(n)}});var XJ=p((t5t,YJ)=>{u();"use strict";var gze=KJ(),bze=VJ(),mze=HJ(),vze=GJ(),WJ=class{constructor({repo:e,preload:t}){this.addLink=gze({repo:e,preload:t}),this.appendData=bze({repo:e,preload:t}),this.rmLink=mze({repo:e,preload:t}),this.setData=vze({repo:e,preload:t})}};YJ.exports=WJ});var ZJ=p((r5t,JJ)=>{u();"use strict";var wze=OJ(),_ze=Nu(),Eze=BJ(),Sze=DJ(),Aze=Gd(),xze=UJ(),Ize=XJ(),QJ=class{constructor({repo:e,codecs:t,preload:i}){this.data=wze({repo:e,preload:i}),this.get=_ze({repo:e,preload:i}),this.links=Eze({repo:e,codecs:t}),this.new=Sze({repo:e,preload:i}),this.put=Aze({repo:e,preload:i}),this.stat=xze({repo:e,preload:i}),this.patch=new Ize({repo:e,preload:i})}};JJ.exports=QJ});var tZ=p((i5t,eZ)=>{u();"use strict";var Tze=me()("ipfs:repo:gc"),Rze=Oe(),Pze=Kw();eZ.exports=({repo:r,hashers:e})=>{async function*t(i={}){let n=Date.now(),s;try{s=await Pze({repo:r,hashers:e},i),await r.pins.pinRecursively(s),yield*r.gc()}finally{s&&await r.pins.unpin(s)}Tze(`Complete (${Date.now()-n}ms)`)}return Rze(t)}});var A4=p((n5t,rZ)=>{u();"use strict";var Cze=Oe();rZ.exports=({repo:r})=>{async function e(t={}){let i=await r.stat();return{numObjects:BigInt(i.numObjects.toString()),repoSize:BigInt(i.repoSize.toString()),repoPath:i.repoPath,version:`${i.version}`,storageMax:BigInt(i.storageMax.toString())}}return Cze(e)}});var nZ=p((s5t,iZ)=>{u();"use strict";var{repoVersion:Oze}=Jl(),qze=Oe();iZ.exports=({repo:r})=>{async function e(t={}){try{await r._checkInitialized(t)}catch(i){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(i.message)))return Oze;throw i}return r.version.get()}return qze(e)}});var aZ=p((o5t,oZ)=>{u();"use strict";var kze=tZ(),Bze=A4(),Nze=nZ(),sZ=class{constructor({repo:e,hashers:t}){this.gc=kze({repo:e,hashers:t}),this.stat=Bze({repo:e}),this.version=Nze({repo:e}),this.setApiAddr=i=>e.apiAddr.set(i)}};oZ.exports=sZ});var lZ=p((a5t,uZ)=>{u();"use strict";var{default:Dze}=rg(),Mze=ue(),Lze=Oe();function cZ(r,e){let t;if(r.metrics?e.peer?t=r.metrics.forPeer(e.peer):e.proto?t=r.metrics.forProtocol(e.proto):t=r.metrics.global:t=void 0,!t)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:BigInt(0),rateOut:BigInt(0)};let{movingAverages:i,snapshot:n}=t;return{totalIn:BigInt(n.dataReceived.integerValue().toString()),totalOut:BigInt(n.dataSent.integerValue().toString()),rateIn:BigInt(Math.round(i.dataReceived[6e4].movingAverage()/60)),rateOut:BigInt(Math.round(i.dataSent[6e4].movingAverage()/60))}}uZ.exports=({network:r})=>Lze(async function*(t={}){let{libp2p:i}=await r.use(t);if(!t.poll){yield cZ(i,t);return}let n=t.interval||1e3,s=-1;try{if(s=typeof n=="string"?Dze(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(a){throw Mze(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield cZ(i,t),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})});var dZ=p((c5t,hZ)=>{u();"use strict";var Uze=lZ(),Fze=A4(),Kze=NI(),fZ=class{constructor({repo:e,network:t}){this.repo=Fze({repo:e}),this.bw=Uze({network:t}),this.bitswap=Kze({network:t})}};hZ.exports=fZ});var yZ=p((u5t,pZ)=>{u();"use strict";pZ.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==n||o.enumerable!==!0)return!1}return!0}});var Zw=p((l5t,bZ)=>{u();"use strict";var gZ=typeof Symbol!="undefined"&&Symbol,jze=yZ();bZ.exports=function(){return typeof gZ!="function"||typeof Symbol!="function"||typeof gZ("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:jze()}});var vZ=p((f5t,mZ)=>{u();"use strict";var Vze="Function.prototype.bind called on incompatible ",x4=Array.prototype.slice,zze=Object.prototype.toString,Hze="[object Function]";mZ.exports=function(e){var t=this;if(typeof t!="function"||zze.call(t)!==Hze)throw new TypeError(Vze+t);for(var i=x4.call(arguments,1),n,s=function(){if(this instanceof n){var l=t.apply(this,i.concat(x4.call(arguments)));return Object(l)===l?l:this}else return t.apply(e,i.concat(x4.call(arguments)))},o=Math.max(0,t.length-i.length),a=[],c=0;c<o;c++)a.push("$"+c);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var f=function(){};f.prototype=t.prototype,n.prototype=new f,f.prototype=null}return n}});var e_=p((h5t,wZ)=>{u();"use strict";var $ze=vZ();wZ.exports=Function.prototype.bind||$ze});var EZ=p((d5t,_Z)=>{u();"use strict";var Gze=e_();_Z.exports=Gze.call(Function.call,Object.prototype.hasOwnProperty)});var n_=p((p5t,IZ)=>{u();"use strict";var Pt,jg=SyntaxError,SZ=Function,Wd=TypeError,I4=function(r){try{return SZ('"use strict"; return ('+r+").constructor;")()}catch(e){}},yf=Object.getOwnPropertyDescriptor;if(yf)try{yf({},"")}catch(r){yf=null}var T4=function(){throw new Wd},Wze=yf?function(){try{return arguments.callee,T4}catch(r){try{return yf(arguments,"callee").get}catch(e){return T4}}}():T4,Yd=Zw()(),Du=Object.getPrototypeOf||function(r){return r.__proto__},Xd={},Yze=typeof Uint8Array=="undefined"?Pt:Du(Uint8Array),Qd={"%AggregateError%":typeof AggregateError=="undefined"?Pt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?Pt:ArrayBuffer,"%ArrayIteratorPrototype%":Yd?Du([][Symbol.iterator]()):Pt,"%AsyncFromSyncIteratorPrototype%":Pt,"%AsyncFunction%":Xd,"%AsyncGenerator%":Xd,"%AsyncGeneratorFunction%":Xd,"%AsyncIteratorPrototype%":Xd,"%Atomics%":typeof Atomics=="undefined"?Pt:Atomics,"%BigInt%":typeof BigInt=="undefined"?Pt:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?Pt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?Pt:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?Pt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?Pt:FinalizationRegistry,"%Function%":SZ,"%GeneratorFunction%":Xd,"%Int8Array%":typeof Int8Array=="undefined"?Pt:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?Pt:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?Pt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Yd?Du(Du([][Symbol.iterator]())):Pt,"%JSON%":typeof JSON=="object"?JSON:Pt,"%Map%":typeof Map=="undefined"?Pt:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!Yd?Pt:Du(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?Pt:Promise,"%Proxy%":typeof Proxy=="undefined"?Pt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?Pt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?Pt:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!Yd?Pt:Du(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?Pt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Yd?Du(""[Symbol.iterator]()):Pt,"%Symbol%":Yd?Symbol:Pt,"%SyntaxError%":jg,"%ThrowTypeError%":Wze,"%TypedArray%":Yze,"%TypeError%":Wd,"%Uint8Array%":typeof Uint8Array=="undefined"?Pt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?Pt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?Pt:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?Pt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?Pt:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?Pt:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?Pt:WeakSet},Xze=function r(e){var t;if(e==="%AsyncFunction%")t=I4("async function () {}");else if(e==="%GeneratorFunction%")t=I4("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=I4("async function* () {}");else if(e==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=r("%AsyncGenerator%");n&&(t=Du(n.prototype))}return Qd[e]=t,t},AZ={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},t_=e_(),r_=EZ(),Qze=t_.call(Function.call,Array.prototype.concat),Jze=t_.call(Function.apply,Array.prototype.splice),xZ=t_.call(Function.call,String.prototype.replace),i_=t_.call(Function.call,String.prototype.slice),Zze=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,eHe=/\\(\\)?/g,tHe=function(e){var t=i_(e,0,1),i=i_(e,-1);if(t==="%"&&i!=="%")throw new jg("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new jg("invalid intrinsic syntax, expected opening `%`");var n=[];return xZ(e,Zze,function(s,o,a,c){n[n.length]=a?xZ(c,eHe,"$1"):o||s}),n},rHe=function(e,t){var i=e,n;if(r_(AZ,i)&&(n=AZ[i],i="%"+n[0]+"%"),r_(Qd,i)){var s=Qd[i];if(s===Xd&&(s=Xze(i)),typeof s=="undefined"&&!t)throw new Wd("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new jg("intrinsic "+e+" does not exist!")};IZ.exports=function(e,t){if(typeof e!="string"||e.length===0)throw new Wd("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Wd('"allowMissing" argument must be a boolean');var i=tHe(e),n=i.length>0?i[0]:"",s=rHe("%"+n+"%",t),o=s.name,a=s.value,c=!1,f=s.alias;f&&(n=f[0],Jze(i,Qze([0,1],f)));for(var l=1,h=!0;l<i.length;l+=1){var d=i[l],y=i_(d,0,1),g=i_(d,-1);if((y==='"'||y==="'"||y==="`"||g==='"'||g==="'"||g==="`")&&y!==g)throw new jg("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(c=!0),n+="."+d,o="%"+n+"%",r_(Qd,o))a=Qd[o];else if(a!=null){if(!(d in a)){if(!t)throw new Wd("base intrinsic for "+e+" exists, but the property is not available.");return}if(yf&&l+1>=i.length){var m=yf(a,d);h=!!m,h&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else h=r_(a,d),a=a[d];h&&!c&&(Qd[o]=a)}}return a}});var qZ=p((y5t,s_)=>{u();"use strict";var R4=e_(),Jd=n_(),TZ=Jd("%Function.prototype.apply%"),RZ=Jd("%Function.prototype.call%"),PZ=Jd("%Reflect.apply%",!0)||R4.call(RZ,TZ),CZ=Jd("%Object.getOwnPropertyDescriptor%",!0),gf=Jd("%Object.defineProperty%",!0),iHe=Jd("%Math.max%");if(gf)try{gf({},"a",{value:1})}catch(r){gf=null}s_.exports=function(e){var t=PZ(R4,RZ,arguments);if(CZ&&gf){var i=CZ(t,"length");i.configurable&&gf(t,"length",{value:1+iHe(0,e.length-(arguments.length-1))})}return t};var OZ=function(){return PZ(R4,TZ,arguments)};gf?gf(s_.exports,"apply",{value:OZ}):s_.exports.apply=OZ});var o_=p((g5t,NZ)=>{u();"use strict";var kZ=n_(),BZ=qZ(),nHe=BZ(kZ("String.prototype.indexOf"));NZ.exports=function(e,t){var i=kZ(e,!!t);return typeof i=="function"&&nHe(e,".prototype.")>-1?BZ(i):i}});var LZ=p((b5t,MZ)=>{u();"use strict";var sHe=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",oHe=o_(),P4=oHe("Object.prototype.toString"),a_=function(e){return sHe&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:P4(e)==="[object Arguments]"},DZ=function(e){return a_(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&P4(e)!=="[object Array]"&&P4(e.callee)==="[object Function]"},aHe=function(){return a_(arguments)}();a_.isLegacyArguments=DZ;MZ.exports=aHe?a_:DZ});var KZ=p((m5t,FZ)=>{u();"use strict";var cHe=Object.prototype.toString,uHe=Function.prototype.toString,lHe=/^\s*(?:function)?\*/,UZ=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",C4=Object.getPrototypeOf,fHe=function(){if(!UZ)return!1;try{return Function("return function*() {}")()}catch(r){}},O4;FZ.exports=function(e){if(typeof e!="function")return!1;if(lHe.test(uHe.call(e)))return!0;if(!UZ){var t=cHe.call(e);return t==="[object GeneratorFunction]"}if(!C4)return!1;if(typeof O4=="undefined"){var i=fHe();O4=i?C4(i):!1}return C4(e)===O4}});var q4=p((v5t,jZ)=>{u();var hHe=Object.prototype.hasOwnProperty,dHe=Object.prototype.toString;jZ.exports=function(e,t,i){if(dHe.call(t)!=="[object Function]")throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var s=0;s<n;s++)t.call(i,e[s],s,e);else for(var o in e)hHe.call(e,o)&&t.call(i,e[o],o,e)}});var B4=p((w5t,VZ)=>{u();"use strict";var k4=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];VZ.exports=function(){for(var e=[],t=0;t<k4.length;t++)typeof globalThis[k4[t]]=="function"&&(e[e.length]=k4[t]);return e}});var N4=p((_5t,zZ)=>{u();"use strict";var pHe=n_(),c_=pHe("%Object.getOwnPropertyDescriptor%");if(c_)try{c_([],"length")}catch(r){c_=null}zZ.exports=c_});var L4=p((E5t,YZ)=>{u();"use strict";var HZ=q4(),yHe=B4(),D4=o_(),gHe=D4("Object.prototype.toString"),bHe=Zw()(),$Z=bHe&&typeof Symbol.toStringTag=="symbol",GZ=yHe(),mHe=D4("Array.prototype.indexOf",!0)||function(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return i;return-1},vHe=D4("String.prototype.slice"),WZ={},u_=N4(),M4=Object.getPrototypeOf;$Z&&u_&&M4&&HZ(GZ,function(r){var e=new globalThis[r];if(!(Symbol.toStringTag in e))throw new EvalError("this engine has support for Symbol.toStringTag, but "+r+" does not have the property! Please report this.");var t=M4(e),i=u_(t,Symbol.toStringTag);if(!i){var n=M4(t);i=u_(n,Symbol.toStringTag)}WZ[r]=i.get});var wHe=function(e){var t=!1;return HZ(WZ,function(i,n){if(!t)try{t=i.call(e)===n}catch(s){}}),t};YZ.exports=function(e){if(!e||typeof e!="object")return!1;if(!$Z){var t=vHe(gHe(e),8,-1);return mHe(GZ,t)>-1}return u_?wHe(e):!1}});var tee=p((S5t,eee)=>{u();"use strict";var XZ=q4(),_He=B4(),QZ=o_(),EHe=QZ("Object.prototype.toString"),SHe=Zw()(),JZ=SHe&&typeof Symbol.toStringTag=="symbol",AHe=_He(),xHe=QZ("String.prototype.slice"),ZZ={},U4=N4(),F4=Object.getPrototypeOf;JZ&&U4&&F4&&XZ(AHe,function(r){if(typeof globalThis[r]=="function"){var e=new globalThis[r];if(!(Symbol.toStringTag in e))throw new EvalError("this engine has support for Symbol.toStringTag, but "+r+" does not have the property! Please report this.");var t=F4(e),i=U4(t,Symbol.toStringTag);if(!i){var n=F4(t);i=U4(n,Symbol.toStringTag)}ZZ[r]=i.get}});var IHe=function(e){var t=!1;return XZ(ZZ,function(i,n){if(!t)try{var s=i.call(e);s===n&&(t=s)}catch(o){}}),t},THe=L4();eee.exports=function(e){return THe(e)?JZ?IHe(e):xHe(EHe(e),8,-1):!1}});var yee=p(vt=>{u();"use strict";var RHe=LZ(),PHe=KZ(),So=tee(),ree=L4();function Zd(r){return r.call.bind(r)}var iee=typeof BigInt!="undefined",nee=typeof Symbol!="undefined",Ns=Zd(Object.prototype.toString),CHe=Zd(Number.prototype.valueOf),OHe=Zd(String.prototype.valueOf),qHe=Zd(Boolean.prototype.valueOf);iee&&(see=Zd(BigInt.prototype.valueOf));var see;nee&&(oee=Zd(Symbol.prototype.valueOf));var oee;function Vg(r,e){if(typeof r!="object")return!1;try{return e(r),!0}catch(t){return!1}}vt.isArgumentsObject=RHe;vt.isGeneratorFunction=PHe;vt.isTypedArray=ree;function kHe(r){return typeof Promise!="undefined"&&r instanceof Promise||r!==null&&typeof r=="object"&&typeof r.then=="function"&&typeof r.catch=="function"}vt.isPromise=kHe;function BHe(r){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(r):ree(r)||cee(r)}vt.isArrayBufferView=BHe;function NHe(r){return So(r)==="Uint8Array"}vt.isUint8Array=NHe;function DHe(r){return So(r)==="Uint8ClampedArray"}vt.isUint8ClampedArray=DHe;function MHe(r){return So(r)==="Uint16Array"}vt.isUint16Array=MHe;function LHe(r){return So(r)==="Uint32Array"}vt.isUint32Array=LHe;function UHe(r){return So(r)==="Int8Array"}vt.isInt8Array=UHe;function FHe(r){return So(r)==="Int16Array"}vt.isInt16Array=FHe;function KHe(r){return So(r)==="Int32Array"}vt.isInt32Array=KHe;function jHe(r){return So(r)==="Float32Array"}vt.isFloat32Array=jHe;function VHe(r){return So(r)==="Float64Array"}vt.isFloat64Array=VHe;function zHe(r){return So(r)==="BigInt64Array"}vt.isBigInt64Array=zHe;function HHe(r){return So(r)==="BigUint64Array"}vt.isBigUint64Array=HHe;function l_(r){return Ns(r)==="[object Map]"}l_.working=typeof Map!="undefined"&&l_(new Map);function $He(r){return typeof Map=="undefined"?!1:l_.working?l_(r):r instanceof Map}vt.isMap=$He;function f_(r){return Ns(r)==="[object Set]"}f_.working=typeof Set!="undefined"&&f_(new Set);function GHe(r){return typeof Set=="undefined"?!1:f_.working?f_(r):r instanceof Set}vt.isSet=GHe;function h_(r){return Ns(r)==="[object WeakMap]"}h_.working=typeof WeakMap!="undefined"&&h_(new WeakMap);function WHe(r){return typeof WeakMap=="undefined"?!1:h_.working?h_(r):r instanceof WeakMap}vt.isWeakMap=WHe;function K4(r){return Ns(r)==="[object WeakSet]"}K4.working=typeof WeakSet!="undefined"&&K4(new WeakSet);function YHe(r){return K4(r)}vt.isWeakSet=YHe;function d_(r){return Ns(r)==="[object ArrayBuffer]"}d_.working=typeof ArrayBuffer!="undefined"&&d_(new ArrayBuffer);function aee(r){return typeof ArrayBuffer=="undefined"?!1:d_.working?d_(r):r instanceof ArrayBuffer}vt.isArrayBuffer=aee;function p_(r){return Ns(r)==="[object DataView]"}p_.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&p_(new DataView(new ArrayBuffer(1),0,1));function cee(r){return typeof DataView=="undefined"?!1:p_.working?p_(r):r instanceof DataView}vt.isDataView=cee;var j4=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function zg(r){return Ns(r)==="[object SharedArrayBuffer]"}function uee(r){return typeof j4=="undefined"?!1:(typeof zg.working=="undefined"&&(zg.working=zg(new j4)),zg.working?zg(r):r instanceof j4)}vt.isSharedArrayBuffer=uee;function XHe(r){return Ns(r)==="[object AsyncFunction]"}vt.isAsyncFunction=XHe;function QHe(r){return Ns(r)==="[object Map Iterator]"}vt.isMapIterator=QHe;function JHe(r){return Ns(r)==="[object Set Iterator]"}vt.isSetIterator=JHe;function ZHe(r){return Ns(r)==="[object Generator]"}vt.isGeneratorObject=ZHe;function e$e(r){return Ns(r)==="[object WebAssembly.Module]"}vt.isWebAssemblyCompiledModule=e$e;function lee(r){return Vg(r,CHe)}vt.isNumberObject=lee;function fee(r){return Vg(r,OHe)}vt.isStringObject=fee;function hee(r){return Vg(r,qHe)}vt.isBooleanObject=hee;function dee(r){return iee&&Vg(r,see)}vt.isBigIntObject=dee;function pee(r){return nee&&Vg(r,oee)}vt.isSymbolObject=pee;function t$e(r){return lee(r)||fee(r)||hee(r)||dee(r)||pee(r)}vt.isBoxedPrimitive=t$e;function r$e(r){return typeof Uint8Array!="undefined"&&(aee(r)||uee(r))}vt.isAnyArrayBuffer=r$e;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(r){Object.defineProperty(vt,r,{enumerable:!1,value:function(){throw new Error(r+" is not supported in userland")}})})});var bee=p((x5t,gee)=>{u();gee.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var See=p(wt=>{u();var mee=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++)i[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return i},i$e=/%[sdj%]/g;wt.format=function(r){if(!v_(r)){for(var e=[],t=0;t<arguments.length;t++)e.push(Mu(arguments[t]));return e.join(" ")}for(var t=1,i=arguments,n=i.length,s=String(r).replace(i$e,function(a){if(a==="%%")return"%";if(t>=n)return a;switch(a){case"%s":return String(i[t++]);case"%d":return Number(i[t++]);case"%j":try{return JSON.stringify(i[t++])}catch(c){return"[Circular]"}default:return a}}),o=i[t];t<n;o=i[++t])m_(o)||!ep(o)?s+=" "+o:s+=" "+Mu(o);return s};wt.deprecate=function(r,e){if(typeof process!="undefined"&&process.noDeprecation===!0)return r;if(typeof process=="undefined")return function(){return wt.deprecate(r,e).apply(this,arguments)};var t=!1;function i(){if(!t){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),t=!0}return r.apply(this,arguments)}return i};var y_={},vee=/^$/;process.env.NODE_DEBUG&&(g_=process.env.NODE_DEBUG,g_=g_.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),vee=new RegExp("^"+g_+"$","i"));var g_;wt.debuglog=function(r){if(r=r.toUpperCase(),!y_[r])if(vee.test(r)){var e=process.pid;y_[r]=function(){var t=wt.format.apply(wt,arguments);console.error("%s %d: %s",r,e,t)}}else y_[r]=function(){};return y_[r]};function Mu(r,e){var t={seen:[],stylize:s$e};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),H4(e)?t.showHidden=e:e&&wt._extend(t,e),bf(t.showHidden)&&(t.showHidden=!1),bf(t.depth)&&(t.depth=2),bf(t.colors)&&(t.colors=!1),bf(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=n$e),b_(t,r,t.depth)}wt.inspect=Mu;Mu.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Mu.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n$e(r,e){var t=Mu.styles[e];return t?"["+Mu.colors[t][0]+"m"+r+"["+Mu.colors[t][1]+"m":r}function s$e(r,e){return r}function o$e(r){var e={};return r.forEach(function(t,i){e[t]=!0}),e}function b_(r,e,t){if(r.customInspect&&e&&__(e.inspect)&&e.inspect!==wt.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(t,r);return v_(i)||(i=b_(r,i,t)),i}var n=a$e(r,e);if(n)return n;var s=Object.keys(e),o=o$e(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),$g(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return V4(e);if(s.length===0){if(__(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(Hg(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(w_(e))return r.stylize(Date.prototype.toString.call(e),"date");if($g(e))return V4(e)}var c="",f=!1,l=["{","}"];if(wee(e)&&(f=!0,l=["[","]"]),__(e)){var h=e.name?": "+e.name:"";c=" [Function"+h+"]"}if(Hg(e)&&(c=" "+RegExp.prototype.toString.call(e)),w_(e)&&(c=" "+Date.prototype.toUTCString.call(e)),$g(e)&&(c=" "+V4(e)),s.length===0&&(!f||e.length==0))return l[0]+c+l[1];if(t<0)return Hg(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var d;return f?d=c$e(r,e,t,o,s):d=s.map(function(y){return z4(r,e,t,o,y,f)}),r.seen.pop(),u$e(d,c,l)}function a$e(r,e){if(bf(e))return r.stylize("undefined","undefined");if(v_(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(_ee(e))return r.stylize(""+e,"number");if(H4(e))return r.stylize(""+e,"boolean");if(m_(e))return r.stylize("null","null")}function V4(r){return"["+Error.prototype.toString.call(r)+"]"}function c$e(r,e,t,i,n){for(var s=[],o=0,a=e.length;o<a;++o)Eee(e,String(o))?s.push(z4(r,e,t,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(z4(r,e,t,i,c,!0))}),s}function z4(r,e,t,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),Eee(i,n)||(o="["+n+"]"),a||(r.seen.indexOf(c.value)<0?(m_(t)?a=b_(r,c.value,null):a=b_(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(f){return"  "+f}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(f){return"   "+f}).join(`
`))):a=r.stylize("[Circular]","special")),bf(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function u$e(r,e,t){var i=0,n=r.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}wt.types=yee();function wee(r){return Array.isArray(r)}wt.isArray=wee;function H4(r){return typeof r=="boolean"}wt.isBoolean=H4;function m_(r){return r===null}wt.isNull=m_;function l$e(r){return r==null}wt.isNullOrUndefined=l$e;function _ee(r){return typeof r=="number"}wt.isNumber=_ee;function v_(r){return typeof r=="string"}wt.isString=v_;function f$e(r){return typeof r=="symbol"}wt.isSymbol=f$e;function bf(r){return r===void 0}wt.isUndefined=bf;function Hg(r){return ep(r)&&$4(r)==="[object RegExp]"}wt.isRegExp=Hg;wt.types.isRegExp=Hg;function ep(r){return typeof r=="object"&&r!==null}wt.isObject=ep;function w_(r){return ep(r)&&$4(r)==="[object Date]"}wt.isDate=w_;wt.types.isDate=w_;function $g(r){return ep(r)&&($4(r)==="[object Error]"||r instanceof Error)}wt.isError=$g;wt.types.isNativeError=$g;function __(r){return typeof r=="function"}wt.isFunction=__;function h$e(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r=="undefined"}wt.isPrimitive=h$e;wt.isBuffer=bee();function $4(r){return Object.prototype.toString.call(r)}function G4(r){return r<10?"0"+r.toString(10):r.toString(10)}var d$e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function p$e(){var r=new Date,e=[G4(r.getHours()),G4(r.getMinutes()),G4(r.getSeconds())].join(":");return[r.getDate(),d$e[r.getMonth()],e].join(" ")}wt.log=function(){console.log("%s - %s",p$e(),wt.format.apply(wt,arguments))};wt.inherits=Hi();wt._extend=function(r,e){if(!e||!ep(e))return r;for(var t=Object.keys(e),i=t.length;i--;)r[t[i]]=e[t[i]];return r};function Eee(r,e){return Object.prototype.hasOwnProperty.call(r,e)}var mf=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;wt.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(mf&&e[mf]){var t=e[mf];if(typeof t!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,mf,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var i,n,s=new Promise(function(c,f){i=c,n=f}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,f){c?n(c):i(f)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),mf&&Object.defineProperty(t,mf,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,mee(e))};wt.promisify.custom=mf;function y$e(r,e){if(!r){var t=new Error("Promise was rejected with a falsy value");t.reason=r,r=t}return e(r)}function g$e(r){if(typeof r!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};r.apply(this,t).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(y$e.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),Object.defineProperties(e,mee(r)),e}wt.callbackify=g$e});var W4=p((T5t,Aee)=>{u();"use strict";Aee.exports=function(...e){let t=e.reduce((i,n)=>Object.assign(i,n),{});return Object.assign(t,{bufferKeys:t.bufferKeys||!1,snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,openCallback:t.openCallback||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:t.encodings||!1,additionalMethods:Object.assign({},t.additionalMethods)})}});var Iee=p((R5t,xee)=>{u();xee.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var E_=p((P5t,Ree)=>{u();var Tee;Ree.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:globalThis):r=>(Tee||(Tee=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var S_=p((C5t,Cee)=>{u();"use strict";var Pee=E_();Cee.exports=function(r,...e){e.length===0?Pee(r):Pee(()=>r(...e))}});var Y4=p((O5t,Oee)=>{u();"use strict";function Lu(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._ended=!1,this._nexting=!1}Lu.prototype.next=function(r){if(typeof r!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(r,new Error("cannot call next() after end()")),this):this._nexting?(this._nextTick(r,new Error("cannot call next() before previous next() has completed")),this):(this._nexting=!0,this._next((e,...t)=>{this._nexting=!1,r(e,...t)}),this)};Lu.prototype._next=function(r){this._nextTick(r)};Lu.prototype.seek=function(r){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");r=this.db._serializeKey(r),this._seek(r)};Lu.prototype._seek=function(r){};Lu.prototype.end=function(r){if(typeof r!="function")throw new Error("end() requires a callback argument");if(this._ended)return this._nextTick(r,new Error("end() already called on iterator"));this._ended=!0,this._end(r)};Lu.prototype._end=function(r){this._nextTick(r)};Lu.prototype._nextTick=S_();Oee.exports=Lu});var X4=p((q5t,kee)=>{u();"use strict";var qee=Object.freeze({});function Ao(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._operations=[],this._written=!1}Ao.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};Ao.prototype.put=function(r,e,t){this._checkWritten();let i=this.db._checkKey(r)||this.db._checkValue(e);if(i)throw i;return r=this.db._serializeKey(r),e=this.db._serializeValue(e),this._put(r,e,t??qee),this};Ao.prototype._put=function(r,e,t){this._operations.push({...t,type:"put",key:r,value:e})};Ao.prototype.del=function(r,e){this._checkWritten();let t=this.db._checkKey(r);if(t)throw t;return r=this.db._serializeKey(r),this._del(r,e??qee),this};Ao.prototype._del=function(r,e){this._operations.push({...e,type:"del",key:r})};Ao.prototype.clear=function(){return this._checkWritten(),this._clear(),this};Ao.prototype._clear=function(){this._operations=[]};Ao.prototype.write=function(r,e){if(this._checkWritten(),typeof r=="function"&&(e=r),typeof e!="function")throw new Error("write() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),this._written=!0,this._write(r,e)};Ao.prototype._write=function(r,e){this.db._batch(this._operations,r,e)};Ao.prototype._nextTick=S_();kee.exports=Ao});var Dee=p((k5t,Nee)=>{u();"use strict";var b$e=W4(),m$e=Iee(),v$e=Y4(),w$e=X4(),_$e=Object.prototype.hasOwnProperty,E$e=["lt","lte","gt","gte"];function _r(r){this.status="new",this.supports=b$e(r,{status:!0})}_r.prototype.open=function(r,e){let t=this.status;if(typeof r=="function"&&(e=r),typeof e!="function")throw new Error("open() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),r.createIfMissing=r.createIfMissing!==!1,r.errorIfExists=!!r.errorIfExists,this.status="opening",this._open(r,i=>{if(i)return this.status=t,e(i);this.status="open",e()})};_r.prototype._open=function(r,e){this._nextTick(e)};_r.prototype.close=function(r){let e=this.status;if(typeof r!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(t=>{if(t)return this.status=e,r(t);this.status="closed",r()})};_r.prototype._close=function(r){this._nextTick(r)};_r.prototype.get=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("get() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(r,e,t)};_r.prototype._get=function(r,e,t){this._nextTick(function(){t(new Error("NotFound"))})};_r.prototype.put=function(r,e,t,i){if(typeof t=="function"&&(i=t),typeof i!="function")throw new Error("put() requires a callback argument");let n=this._checkKey(r)||this._checkValue(e);if(n)return this._nextTick(i,n);r=this._serializeKey(r),e=this._serializeValue(e),(typeof t!="object"||t===null)&&(t={}),this._put(r,e,t,i)};_r.prototype._put=function(r,e,t,i){this._nextTick(i)};_r.prototype.del=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("del() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),this._del(r,e,t)};_r.prototype._del=function(r,e,t){this._nextTick(t)};_r.prototype.batch=function(r,e,t){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(t=e),typeof r=="function"&&(t=r),typeof t!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(r))return this._nextTick(t,new Error("batch(array) requires an array argument"));if(r.length===0)return this._nextTick(t);(typeof e!="object"||e===null)&&(e={});let i=new Array(r.length);for(let n=0;n<r.length;n++){if(typeof r[n]!="object"||r[n]===null)return this._nextTick(t,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},r[n]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(t,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(t,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(t,a);s.value=this._serializeValue(s.value)}i[n]=s}this._batch(i,e,t)};_r.prototype._batch=function(r,e,t){this._nextTick(t)};_r.prototype.clear=function(r,e){if(typeof r=="function")e=r;else if(typeof e!="function")throw new Error("clear() requires a callback argument");r=Bee(this,r),r.reverse=!!r.reverse,r.limit="limit"in r?r.limit:-1,this._clear(r,e)};_r.prototype._clear=function(r,e){r.keys=!0,r.values=!1,r.keyAsBuffer=!0,r.valueAsBuffer=!0;let t=this._iterator(r),i={},n=s=>{if(s)return t.end(function(){e(s)});t.next((o,a)=>{if(o)return n(o);if(a===void 0)return t.end(e);this._del(a,i,n)})};n()};_r.prototype._setupIteratorOptions=function(r){return r=Bee(this,r),r.reverse=!!r.reverse,r.keys=r.keys!==!1,r.values=r.values!==!1,r.limit="limit"in r?r.limit:-1,r.keyAsBuffer=r.keyAsBuffer!==!1,r.valueAsBuffer=r.valueAsBuffer!==!1,r};function Bee(r,e){let t={};for(let i in e){if(!_$e.call(e,i))continue;if(i==="start"||i==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let n=e[i];S$e(i)&&(n=r._serializeKey(n)),t[i]=n}return t}function S$e(r){return E$e.indexOf(r)!==-1}_r.prototype.iterator=function(r){return(typeof r!="object"||r===null)&&(r={}),r=this._setupIteratorOptions(r),this._iterator(r)};_r.prototype._iterator=function(r){return new v$e(this)};_r.prototype._chainedBatch=function(){return new w$e(this)};_r.prototype._serializeKey=function(r){return r};_r.prototype._serializeValue=function(r){return r};_r.prototype._checkKey=function(r){if(r==null)return new Error("key cannot be `null` or `undefined`");if(m$e(r)&&r.length===0)return new Error("key cannot be an empty Buffer");if(r==="")return new Error("key cannot be an empty String");if(Array.isArray(r)&&r.length===0)return new Error("key cannot be an empty Array")};_r.prototype._checkValue=function(r){if(r==null)return new Error("value cannot be `null` or `undefined`")};_r.prototype._nextTick=S_();Nee.exports=_r});var Uu=p(A_=>{u();"use strict";A_.AbstractLevelDOWN=Dee();A_.AbstractIterator=Y4();A_.AbstractChainedBatch=X4()});var Uee=p((N5t,Lee)=>{u();"use strict";var Mee=Uu().AbstractIterator,A$e=Hi();function tp(r,e){Mee.call(this,r),this._options=e,this._iterator=null,this._operations=[]}A$e(tp,Mee);tp.prototype.setDb=function(r){let e=this._iterator=r.iterator(this._options);for(let t of this._operations)e[t.method](...t.args)};tp.prototype._operation=function(r,e){if(this._iterator)return this._iterator[r](...e);this._operations.push({method:r,args:e})};for(let r of["next","end"])tp.prototype["_"+r]=function(...e){this._operation(r,e)};tp.prototype.seek=function(...r){this._operation("seek",r)};Lee.exports=tp});var zee=p((D5t,Q4)=>{u();"use strict";var Fee=Uu().AbstractLevelDOWN,x$e=Hi(),Kee=Uee(),jee="put get del batch clear".split(" "),I$e="approximateSize compactRange".split(" ");function vf(r){Fee.call(this,r.supports||{});for(let e of I$e)typeof r[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this._db=r,this._operations=[],Vee(this)}x$e(vf,Fee);vf.prototype.type="deferred-leveldown";vf.prototype._open=function(r,e){this._db.open(r,t=>{if(t)return e(t);for(let i of this._operations)i.iterator?i.iterator.setDb(this._db):this._db[i.method](...i.args);this._operations=[],T$e(this),e()})};vf.prototype._close=function(r){this._db.close(e=>{if(e)return r(e);Vee(this),r()})};function T$e(r){for(let e of jee.concat("iterator"))r["_"+e]=function(...t){return this._db[e](...t)};for(let e of Object.keys(r.supports.additionalMethods))r[e]=function(...t){return this._db[e](...t)}}function Vee(r){for(let e of jee)r["_"+e]=function(...t){this._operations.push({method:e,args:t})};for(let e of Object.keys(r.supports.additionalMethods))r[e]=function(...t){this._operations.push({method:e,args:t})};r._iterator=function(e){let t=new Kee(r,e);return this._operations.push({iterator:t}),t}}vf.prototype._serializeKey=function(r){return r};vf.prototype._serializeValue=function(r){return r};Q4.exports=vf;Q4.exports.DeferredIterator=Kee});var J4=p((M5t,Hee)=>{u();Hee.exports=br().EventEmitter});var Z4=p(()=>{u()});var Yee=p((F5t,Wee)=>{u();"use strict";function $ee(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function R$e(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$ee(Object(t),!0).forEach(function(i){P$e(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):$ee(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function P$e(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function C$e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Gee(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function O$e(r,e,t){return e&&Gee(r.prototype,e),t&&Gee(r,t),r}var q$e=pt(),x_=q$e.Buffer,k$e=Z4(),e5=k$e.inspect,B$e=e5&&e5.custom||"inspect";function N$e(r,e,t){x_.prototype.copy.call(r,e,t)}Wee.exports=function(){function r(){C$e(this,r),this.head=null,this.tail=null,this.length=0}return O$e(r,[{key:"push",value:function(t){var i={data:t,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(t){var i={data:t,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=t+i.data;return n}},{key:"concat",value:function(t){if(this.length===0)return x_.alloc(0);for(var i=x_.allocUnsafe(t>>>0),n=this.head,s=0;n;)N$e(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(t,i){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):t===this.head.data.length?n=this.shift():n=i?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var i=this.head,n=1,s=i.data;for(t-=s.length;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(a===o.length?s+=o:s+=o.slice(0,t),t-=a,t===0){a===o.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(t){var i=x_.allocUnsafe(t),n=this.head,s=1;for(n.data.copy(i),t-=n.data.length;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,a),t-=a,t===0){a===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++s}return this.length-=s,i}},{key:B$e,value:function(t,i){return e5(this,R$e({},i,{depth:0,customInspect:!1}))}}]),r}()});var r5=p((K5t,Qee)=>{u();"use strict";function D$e(r,e){var t=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(t5,this,r)):process.nextTick(t5,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(s){!e&&s?t._writableState?t._writableState.errorEmitted?process.nextTick(I_,t):(t._writableState.errorEmitted=!0,process.nextTick(Xee,t,s)):process.nextTick(Xee,t,s):e?(process.nextTick(I_,t),e(s)):process.nextTick(I_,t)}),this)}function Xee(r,e){t5(r,e),I_(r)}function I_(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function M$e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function t5(r,e){r.emit("error",e)}function L$e(r,e){var t=r._readableState,i=r._writableState;t&&t.autoDestroy||i&&i.autoDestroy?r.destroy(e):r.emit("error",e)}Qee.exports={destroy:D$e,undestroy:M$e,errorOrDestroy:L$e}});var wf=p((j5t,ete)=>{u();"use strict";function U$e(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var Jee={};function Ds(r,e,t){t||(t=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){U$e(o,s);function o(a,c,f){return s.call(this,i(a,c,f))||this}return o}(t);n.prototype.name=t.name,n.prototype.code=r,Jee[r]=n}function Zee(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(i){return String(i)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:t===2?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}else return"of ".concat(e," ").concat(String(r))}function F$e(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function K$e(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function j$e(r,e,t){return typeof t!="number"&&(t=0),t+e.length>r.length?!1:r.indexOf(e,t)!==-1}Ds("ERR_INVALID_OPT_VALUE",function(r,e){return'The value "'+e+'" is invalid for option "'+r+'"'},TypeError);Ds("ERR_INVALID_ARG_TYPE",function(r,e,t){var i;typeof e=="string"&&F$e(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(K$e(r," argument"))n="The ".concat(r," ").concat(i," ").concat(Zee(e,"type"));else{var s=j$e(r,".")?"property":"argument";n='The "'.concat(r,'" ').concat(s," ").concat(i," ").concat(Zee(e,"type"))}return n+=". Received type ".concat(typeof t),n},TypeError);Ds("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Ds("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"});Ds("ERR_STREAM_PREMATURE_CLOSE","Premature close");Ds("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"});Ds("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Ds("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Ds("ERR_STREAM_WRITE_AFTER_END","write after end");Ds("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Ds("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError);Ds("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");ete.exports.codes=Jee});var i5=p((V5t,tte)=>{u();"use strict";var V$e=wf().codes.ERR_INVALID_OPT_VALUE;function z$e(r,e,t){return r.highWaterMark!=null?r.highWaterMark:e?r[t]:null}function H$e(r,e,t,i){var n=z$e(e,i,t);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?t:"highWaterMark";throw new V$e(s,n)}return Math.floor(n)}return r.objectMode?16:16*1024}tte.exports={getHighWaterMark:H$e}});var ite=p((z5t,rte)=>{u();rte.exports=$$e;function $$e(r,e){if(n5("noDeprecation"))return r;var t=!1;function i(){if(!t){if(n5("throwDeprecation"))throw new Error(e);n5("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}return i}function n5(r){try{if(!globalThis.localStorage)return!1}catch(t){return!1}var e=globalThis.localStorage[r];return e==null?!1:String(e).toLowerCase()==="true"}});var a5=p((H5t,ute)=>{u();"use strict";ute.exports=Wr;function nte(r){var e=this;this.next=null,this.entry=null,this.finish=function(){vGe(e,r)}}var rp;Wr.WritableState=Gg;var G$e={deprecate:ite()},ste=J4(),T_=pt().Buffer,W$e=globalThis.Uint8Array||function(){};function Y$e(r){return T_.from(r)}function X$e(r){return T_.isBuffer(r)||r instanceof W$e}var s5=r5(),Q$e=i5(),J$e=Q$e.getHighWaterMark,Fu=wf().codes,Z$e=Fu.ERR_INVALID_ARG_TYPE,eGe=Fu.ERR_METHOD_NOT_IMPLEMENTED,tGe=Fu.ERR_MULTIPLE_CALLBACK,rGe=Fu.ERR_STREAM_CANNOT_PIPE,iGe=Fu.ERR_STREAM_DESTROYED,nGe=Fu.ERR_STREAM_NULL_VALUES,sGe=Fu.ERR_STREAM_WRITE_AFTER_END,oGe=Fu.ERR_UNKNOWN_ENCODING,ip=s5.errorOrDestroy;Hi()(Wr,ste);function aGe(){}function Gg(r,e,t){rp=rp||_f(),r=r||{},typeof t!="boolean"&&(t=e instanceof rp),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.writableObjectMode),this.highWaterMark=J$e(this,r,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=r.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){pGe(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new nte(this)}Gg.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};(function(){try{Object.defineProperty(Gg.prototype,"buffer",{get:G$e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(r){}})();var R_;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(R_=Function.prototype[Symbol.hasInstance],Object.defineProperty(Wr,Symbol.hasInstance,{value:function(e){return R_.call(this,e)?!0:this!==Wr?!1:e&&e._writableState instanceof Gg}})):R_=function(e){return e instanceof this};function Wr(r){rp=rp||_f();var e=this instanceof rp;if(!e&&!R_.call(Wr,this))return new Wr(r);this._writableState=new Gg(r,this,e),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),ste.call(this)}Wr.prototype.pipe=function(){ip(this,new rGe)};function cGe(r,e){var t=new sGe;ip(r,t),process.nextTick(e,t)}function uGe(r,e,t,i){var n;return t===null?n=new nGe:typeof t!="string"&&!e.objectMode&&(n=new Z$e("chunk",["string","Buffer"],t)),n?(ip(r,n),process.nextTick(i,n),!1):!0}Wr.prototype.write=function(r,e,t){var i=this._writableState,n=!1,s=!i.objectMode&&X$e(r);return s&&!T_.isBuffer(r)&&(r=Y$e(r)),typeof e=="function"&&(t=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof t!="function"&&(t=aGe),i.ending?cGe(this,t):(s||uGe(this,i,r,t))&&(i.pendingcb++,n=fGe(this,i,s,r,e,t)),n};Wr.prototype.cork=function(){this._writableState.corked++};Wr.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&ate(this,r))};Wr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new oGe(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Wr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function lGe(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=T_.from(e,t)),e}Object.defineProperty(Wr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function fGe(r,e,t,i,n,s){if(!t){var o=lGe(e,i,n);i!==o&&(t=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var f=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:t,callback:s,next:null},f?f.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else o5(r,e,!1,a,i,n,s);return c}function o5(r,e,t,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new iGe("write")):t?r._writev(n,e.onwrite):r._write(n,s,e.onwrite),e.sync=!1}function hGe(r,e,t,i,n){--e.pendingcb,t?(process.nextTick(n,i),process.nextTick(Wg,r,e),r._writableState.errorEmitted=!0,ip(r,i)):(n(i),r._writableState.errorEmitted=!0,ip(r,i),Wg(r,e))}function dGe(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function pGe(r,e){var t=r._writableState,i=t.sync,n=t.writecb;if(typeof n!="function")throw new tGe;if(dGe(t),e)hGe(r,t,i,e,n);else{var s=cte(t)||r.destroyed;!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&ate(r,t),i?process.nextTick(ote,r,t,s,n):ote(r,t,s,n)}}function ote(r,e,t,i){t||yGe(r,e),e.pendingcb--,i(),Wg(r,e)}function yGe(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function ate(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=t;for(var o=0,a=!0;t;)n[o]=t,t.isBuf||(a=!1),t=t.next,o+=1;n.allBuffers=a,o5(r,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new nte(e),e.bufferedRequestCount=0}else{for(;t;){var c=t.chunk,f=t.encoding,l=t.callback,h=e.objectMode?1:c.length;if(o5(r,e,!1,h,c,f,l),t=t.next,e.bufferedRequestCount--,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}Wr.prototype._write=function(r,e,t){t(new eGe("_write()"))};Wr.prototype._writev=null;Wr.prototype.end=function(r,e,t){var i=this._writableState;return typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),i.corked&&(i.corked=1,this.uncork()),i.ending||mGe(this,i,t),this};Object.defineProperty(Wr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function cte(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function gGe(r,e){r._final(function(t){e.pendingcb--,t&&ip(r,t),e.prefinished=!0,r.emit("prefinish"),Wg(r,e)})}function bGe(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(gGe,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function Wg(r,e){var t=cte(e);if(t&&(bGe(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"),e.autoDestroy))){var i=r._readableState;(!i||i.autoDestroy&&i.endEmitted)&&r.destroy()}return t}function mGe(r,e,t){e.ending=!0,Wg(r,e),t&&(e.finished?process.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function vGe(r,e,t){var i=r.entry;for(r.entry=null;i;){var n=i.callback;e.pendingcb--,n(t),i=i.next}e.corkedRequestsFree.next=r}Object.defineProperty(Wr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Wr.prototype.destroy=s5.destroy;Wr.prototype._undestroy=s5.undestroy;Wr.prototype._destroy=function(r,e){e(r)}});var _f=p(($5t,fte)=>{u();"use strict";var wGe=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};fte.exports=qa;var lte=l5(),c5=a5();Hi()(qa,lte);for(u5=wGe(c5.prototype),P_=0;P_<u5.length;P_++)C_=u5[P_],qa.prototype[C_]||(qa.prototype[C_]=c5.prototype[C_]);var u5,C_,P_;function qa(r){if(!(this instanceof qa))return new qa(r);lte.call(this,r),c5.call(this,r),this.allowHalfOpen=!0,r&&(r.readable===!1&&(this.readable=!1),r.writable===!1&&(this.writable=!1),r.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",_Ge)))}Object.defineProperty(qa.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(qa.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(qa.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function _Ge(){this._writableState.ended||process.nextTick(EGe,this)}function EGe(r){r.end()}Object.defineProperty(qa.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var h5=p((f5,dte)=>{u();var O_=pt(),ka=O_.Buffer;function hte(r,e){for(var t in r)e[t]=r[t]}ka.from&&ka.alloc&&ka.allocUnsafe&&ka.allocUnsafeSlow?dte.exports=O_:(hte(O_,f5),f5.Buffer=Ef);function Ef(r,e,t){return ka(r,e,t)}Ef.prototype=Object.create(ka.prototype);hte(ka,Ef);Ef.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return ka(r,e,t)};Ef.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var i=ka(r);return e!==void 0?typeof t=="string"?i.fill(e,t):i.fill(e):i.fill(0),i};Ef.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return ka(r)};Ef.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return O_.SlowBuffer(r)}});var y5=p(yte=>{u();"use strict";var d5=h5().Buffer,pte=d5.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function SGe(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function AGe(r){var e=SGe(r);if(typeof e!="string"&&(d5.isEncoding===pte||!pte(r)))throw new Error("Unknown encoding: "+r);return e||r}yte.StringDecoder=Yg;function Yg(r){this.encoding=AGe(r);var e;switch(this.encoding){case"utf16le":this.text=CGe,this.end=OGe,e=4;break;case"utf8":this.fillLast=TGe,e=4;break;case"base64":this.text=qGe,this.end=kGe,e=3;break;default:this.write=BGe,this.end=NGe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=d5.allocUnsafe(e)}Yg.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};Yg.prototype.end=PGe;Yg.prototype.text=RGe;Yg.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function p5(r){return r<=127?0:r>>5==6?2:r>>4==14?3:r>>3==30?4:r>>6==2?-1:-2}function xGe(r,e,t){var i=e.length-1;if(i<t)return 0;var n=p5(e[i]);return n>=0?(n>0&&(r.lastNeed=n-1),n):--i<t||n===-2?0:(n=p5(e[i]),n>=0?(n>0&&(r.lastNeed=n-2),n):--i<t||n===-2?0:(n=p5(e[i]),n>=0?(n>0&&(n===2?n=0:r.lastNeed=n-3),n):0))}function IGe(r,e,t){if((e[0]&192)!=128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return r.lastNeed=2,"\uFFFD"}}function TGe(r){var e=this.lastTotal-this.lastNeed,t=IGe(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function RGe(r,e){var t=xGe(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var i=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,i),r.toString("utf8",e,i)}function PGe(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD":e}function CGe(r,e){if((r.length-e)%2==0){var t=r.toString("utf16le",e);if(t){var i=t.charCodeAt(t.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function OGe(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function qGe(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function kGe(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function BGe(r){return r.toString(this.encoding)}function NGe(r){return r&&r.length?this.write(r):""}});var q_=p((W5t,mte)=>{u();"use strict";var gte=wf().codes.ERR_STREAM_PREMATURE_CLOSE;function DGe(r){var e=!1;return function(){if(!e){e=!0;for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];r.apply(this,i)}}}function MGe(){}function LGe(r){return r.setHeader&&typeof r.abort=="function"}function bte(r,e,t){if(typeof e=="function")return bte(r,null,e);e||(e={}),t=DGe(t||MGe);var i=e.readable||e.readable!==!1&&r.readable,n=e.writable||e.writable!==!1&&r.writable,s=function(){r.writable||a()},o=r._writableState&&r._writableState.finished,a=function(){n=!1,o=!0,i||t.call(r)},c=r._readableState&&r._readableState.endEmitted,f=function(){i=!1,c=!0,n||t.call(r)},l=function(g){t.call(r,g)},h=function(){var g;if(i&&!c)return(!r._readableState||!r._readableState.ended)&&(g=new gte),t.call(r,g);if(n&&!o)return(!r._writableState||!r._writableState.ended)&&(g=new gte),t.call(r,g)},d=function(){r.req.on("finish",a)};return LGe(r)?(r.on("complete",a),r.on("abort",h),r.req?d():r.on("request",d)):n&&!r._writableState&&(r.on("end",s),r.on("close",s)),r.on("end",f),r.on("finish",a),e.error!==!1&&r.on("error",l),r.on("close",h),function(){r.removeListener("complete",a),r.removeListener("abort",h),r.removeListener("request",d),r.req&&r.req.removeListener("finish",a),r.removeListener("end",s),r.removeListener("close",s),r.removeListener("finish",a),r.removeListener("end",f),r.removeListener("error",l),r.removeListener("close",h)}}mte.exports=bte});var wte=p((Y5t,vte)=>{u();"use strict";var k_;function Ku(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var UGe=q_(),ju=Symbol("lastResolve"),Sf=Symbol("lastReject"),Xg=Symbol("error"),B_=Symbol("ended"),Af=Symbol("lastPromise"),g5=Symbol("handlePromise"),xf=Symbol("stream");function Vu(r,e){return{value:r,done:e}}function FGe(r){var e=r[ju];if(e!==null){var t=r[xf].read();t!==null&&(r[Af]=null,r[ju]=null,r[Sf]=null,e(Vu(t,!1)))}}function KGe(r){process.nextTick(FGe,r)}function jGe(r,e){return function(t,i){r.then(function(){if(e[B_]){t(Vu(void 0,!0));return}e[g5](t,i)},i)}}var VGe=Object.getPrototypeOf(function(){}),zGe=Object.setPrototypeOf((k_={get stream(){return this[xf]},next:function(){var e=this,t=this[Xg];if(t!==null)return Promise.reject(t);if(this[B_])return Promise.resolve(Vu(void 0,!0));if(this[xf].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[Xg]?a(e[Xg]):o(Vu(void 0,!0))})});var i=this[Af],n;if(i)n=new Promise(jGe(i,this));else{var s=this[xf].read();if(s!==null)return Promise.resolve(Vu(s,!1));n=new Promise(this[g5])}return this[Af]=n,n}},Ku(k_,Symbol.asyncIterator,function(){return this}),Ku(k_,"return",function(){var e=this;return new Promise(function(t,i){e[xf].destroy(null,function(n){if(n){i(n);return}t(Vu(void 0,!0))})})}),k_),VGe),HGe=function(e){var t,i=Object.create(zGe,(t={},Ku(t,xf,{value:e,writable:!0}),Ku(t,ju,{value:null,writable:!0}),Ku(t,Sf,{value:null,writable:!0}),Ku(t,Xg,{value:null,writable:!0}),Ku(t,B_,{value:e._readableState.endEmitted,writable:!0}),Ku(t,g5,{value:function(s,o){var a=i[xf].read();a?(i[Af]=null,i[ju]=null,i[Sf]=null,s(Vu(a,!1))):(i[ju]=s,i[Sf]=o)},writable:!0}),t));return i[Af]=null,UGe(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[Sf];s!==null&&(i[Af]=null,i[ju]=null,i[Sf]=null,s(n)),i[Xg]=n;return}var o=i[ju];o!==null&&(i[Af]=null,i[ju]=null,i[Sf]=null,o(Vu(void 0,!0))),i[B_]=!0}),e.on("readable",KGe.bind(null,i)),i};vte.exports=HGe});var Ete=p((X5t,_te)=>{u();_te.exports=function(){throw new Error("Readable.from is not available in the browser")}});var l5=p((J5t,qte)=>{u();"use strict";qte.exports=qt;var np;qt.ReadableState=Ate;var Q5t=br().EventEmitter,Ste=function(e,t){return e.listeners(t).length},Qg=J4(),N_=pt().Buffer,$Ge=globalThis.Uint8Array||function(){};function GGe(r){return N_.from(r)}function WGe(r){return N_.isBuffer(r)||r instanceof $Ge}var b5=Z4(),yt;b5&&b5.debuglog?yt=b5.debuglog("stream"):yt=function(){};var YGe=Yee(),m5=r5(),XGe=i5(),QGe=XGe.getHighWaterMark,D_=wf().codes,JGe=D_.ERR_INVALID_ARG_TYPE,ZGe=D_.ERR_STREAM_PUSH_AFTER_EOF,eWe=D_.ERR_METHOD_NOT_IMPLEMENTED,tWe=D_.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,sp,v5,w5;Hi()(qt,Qg);var Jg=m5.errorOrDestroy,_5=["error","close","destroy","pause","resume"];function rWe(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Array.isArray(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function Ate(r,e,t){np=np||_f(),r=r||{},typeof t!="boolean"&&(t=e instanceof np),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode),this.highWaterMark=QGe(this,r,"readableHighWaterMark",t),this.buffer=new YGe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(sp||(sp=y5().StringDecoder),this.decoder=new sp(r.encoding),this.encoding=r.encoding)}function qt(r){if(np=np||_f(),!(this instanceof qt))return new qt(r);var e=this instanceof np;this._readableState=new Ate(r,this,e),this.readable=!0,r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy)),Qg.call(this)}Object.defineProperty(qt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});qt.prototype.destroy=m5.destroy;qt.prototype._undestroy=m5.undestroy;qt.prototype._destroy=function(r,e){e(r)};qt.prototype.push=function(r,e){var t=this._readableState,i;return t.objectMode?i=!0:typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=N_.from(r,e),e=""),i=!0),xte(this,r,e,!1,i)};qt.prototype.unshift=function(r){return xte(this,r,null,!0,!1)};function xte(r,e,t,i,n){yt("readableAddChunk",e);var s=r._readableState;if(e===null)s.reading=!1,sWe(r,s);else{var o;if(n||(o=iWe(s,e)),o)Jg(r,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==N_.prototype&&(e=GGe(e)),i)s.endEmitted?Jg(r,new tWe):E5(r,s,e,!0);else if(s.ended)Jg(r,new ZGe);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!t?(e=s.decoder.write(e),s.objectMode||e.length!==0?E5(r,s,e,!1):S5(r,s)):E5(r,s,e,!1)}else i||(s.reading=!1,S5(r,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function E5(r,e,t,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,r.emit("data",t)):(e.length+=e.objectMode?1:t.length,i?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&M_(r)),S5(r,e)}function iWe(r,e){var t;return!WGe(e)&&typeof e!="string"&&e!==void 0&&!r.objectMode&&(t=new JGe("chunk",["string","Buffer","Uint8Array"],e)),t}qt.prototype.isPaused=function(){return this._readableState.flowing===!1};qt.prototype.setEncoding=function(r){sp||(sp=y5().StringDecoder);var e=new sp(r);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var t=this._readableState.buffer.head,i="";t!==null;)i+=e.write(t.data),t=t.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var Ite=1073741824;function nWe(r){return r>=Ite?r=Ite:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function Tte(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=nWe(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}qt.prototype.read=function(r){yt("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return yt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?x5(this):M_(this),null;if(r=Tte(r,e),r===0&&e.ended)return e.length===0&&x5(this),null;var i=e.needReadable;yt("need readable",i),(e.length===0||e.length-r<e.highWaterMark)&&(i=!0,yt("length less than watermark",i)),e.ended||e.reading?(i=!1,yt("reading or ended",i)):i&&(yt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=Tte(t,e)));var n;return r>0?n=Cte(r,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,r=0):(e.length-=r,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&x5(this)),n!==null&&this.emit("data",n),n};function sWe(r,e){if(yt("onEofChunk"),!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?M_(r):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Rte(r)))}}function M_(r){var e=r._readableState;yt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(yt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Rte,r))}function Rte(r){var e=r._readableState;yt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(r.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,A5(r)}function S5(r,e){e.readingMore||(e.readingMore=!0,process.nextTick(oWe,r,e))}function oWe(r,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var t=e.length;if(yt("maybeReadMore read 0"),r.read(0),t===e.length)break}e.readingMore=!1}qt.prototype._read=function(r){Jg(this,new eWe("_read()"))};qt.prototype.pipe=function(r,e){var t=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r);break}i.pipesCount+=1,yt("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&r!==process.stdout&&r!==process.stderr,s=n?a:m;i.endEmitted?process.nextTick(s):t.once("end",s),r.on("unpipe",o);function o(E,_){yt("onunpipe"),E===t&&_&&_.hasUnpiped===!1&&(_.hasUnpiped=!0,l())}function a(){yt("onend"),r.end()}var c=aWe(t);r.on("drain",c);var f=!1;function l(){yt("cleanup"),r.removeListener("close",y),r.removeListener("finish",g),r.removeListener("drain",c),r.removeListener("error",d),r.removeListener("unpipe",o),t.removeListener("end",a),t.removeListener("end",m),t.removeListener("data",h),f=!0,i.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}t.on("data",h);function h(E){yt("ondata");var _=r.write(E);yt("dest.write",_),_===!1&&((i.pipesCount===1&&i.pipes===r||i.pipesCount>1&&Ote(i.pipes,r)!==-1)&&!f&&(yt("false write response, pause",i.awaitDrain),i.awaitDrain++),t.pause())}function d(E){yt("onerror",E),m(),r.removeListener("error",d),Ste(r,"error")===0&&Jg(r,E)}rWe(r,"error",d);function y(){r.removeListener("finish",g),m()}r.once("close",y);function g(){yt("onfinish"),r.removeListener("close",y),m()}r.once("finish",g);function m(){yt("unpipe"),t.unpipe(r)}return r.emit("pipe",t),i.flowing||(yt("pipe resume"),t.resume()),r};function aWe(r){return function(){var t=r._readableState;yt("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&Ste(r,"data")&&(t.flowing=!0,A5(r))}}qt.prototype.unpipe=function(r){var e=this._readableState,t={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this,t),this);if(!r){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=Ote(e.pipes,r);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this,t),this)};qt.prototype.on=function(r,e){var t=Qg.prototype.on.call(this,r,e),i=this._readableState;return r==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):r==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,yt("on readable",i.length,i.reading),i.length?M_(this):i.reading||process.nextTick(cWe,this)),t};qt.prototype.addListener=qt.prototype.on;qt.prototype.removeListener=function(r,e){var t=Qg.prototype.removeListener.call(this,r,e);return r==="readable"&&process.nextTick(Pte,this),t};qt.prototype.removeAllListeners=function(r){var e=Qg.prototype.removeAllListeners.apply(this,arguments);return(r==="readable"||r===void 0)&&process.nextTick(Pte,this),e};function Pte(r){var e=r._readableState;e.readableListening=r.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:r.listenerCount("data")>0&&r.resume()}function cWe(r){yt("readable nexttick read 0"),r.read(0)}qt.prototype.resume=function(){var r=this._readableState;return r.flowing||(yt("resume"),r.flowing=!r.readableListening,uWe(this,r)),r.paused=!1,this};function uWe(r,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(lWe,r,e))}function lWe(r,e){yt("resume",e.reading),e.reading||r.read(0),e.resumeScheduled=!1,r.emit("resume"),A5(r),e.flowing&&!e.reading&&r.read(0)}qt.prototype.pause=function(){return yt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(yt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function A5(r){var e=r._readableState;for(yt("flow",e.flowing);e.flowing&&r.read()!==null;);}qt.prototype.wrap=function(r){var e=this,t=this._readableState,i=!1;r.on("end",function(){if(yt("wrapped end"),t.decoder&&!t.ended){var o=t.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),r.on("data",function(o){if(yt("wrapped data"),t.decoder&&(o=t.decoder.write(o)),!(t.objectMode&&o==null)&&!(!t.objectMode&&(!o||!o.length))){var a=e.push(o);a||(i=!0,r.pause())}});for(var n in r)this[n]===void 0&&typeof r[n]=="function"&&(this[n]=function(a){return function(){return r[a].apply(r,arguments)}}(n));for(var s=0;s<_5.length;s++)r.on(_5[s],this.emit.bind(this,_5[s]));return this._read=function(o){yt("wrapped _read",o),i&&(i=!1,r.resume())},this};typeof Symbol=="function"&&(qt.prototype[Symbol.asyncIterator]=function(){return v5===void 0&&(v5=wte()),v5(this)});Object.defineProperty(qt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(qt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(qt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});qt._fromList=Cte;Object.defineProperty(qt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Cte(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.first():t=e.buffer.concat(e.length),e.buffer.clear()):t=e.buffer.consume(r,e.decoder),t}function x5(r){var e=r._readableState;yt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(fWe,e,r))}function fWe(r,e){if(yt("endReadableNT",r.endEmitted,r.length),!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"),r.autoDestroy)){var t=e._writableState;(!t||t.autoDestroy&&t.finished)&&e.destroy()}}typeof Symbol=="function"&&(qt.from=function(r,e){return w5===void 0&&(w5=Ete()),w5(qt,r,e)});function Ote(r,e){for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}});var I5=p((Z5t,Bte)=>{u();"use strict";Bte.exports=Tc;var L_=wf().codes,hWe=L_.ERR_METHOD_NOT_IMPLEMENTED,dWe=L_.ERR_MULTIPLE_CALLBACK,pWe=L_.ERR_TRANSFORM_ALREADY_TRANSFORMING,yWe=L_.ERR_TRANSFORM_WITH_LENGTH_0,U_=_f();Hi()(Tc,U_);function gWe(r,e){var t=this._transformState;t.transforming=!1;var i=t.writecb;if(i===null)return this.emit("error",new dWe);t.writechunk=null,t.writecb=null,e!=null&&this.push(e),i(r);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function Tc(r){if(!(this instanceof Tc))return new Tc(r);U_.call(this,r),this._transformState={afterTransform:gWe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",bWe)}function bWe(){var r=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,t){kte(r,e,t)}):kte(this,null,null)}Tc.prototype.push=function(r,e){return this._transformState.needTransform=!1,U_.prototype.push.call(this,r,e)};Tc.prototype._transform=function(r,e,t){t(new hWe("_transform()"))};Tc.prototype._write=function(r,e,t){var i=this._transformState;if(i.writecb=t,i.writechunk=r,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};Tc.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Tc.prototype._destroy=function(r,e){U_.prototype._destroy.call(this,r,function(t){e(t)})};function kte(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new yWe;if(r._transformState.transforming)throw new pWe;return r.push(null)}});var Mte=p((eTt,Dte)=>{u();"use strict";Dte.exports=Zg;var Nte=I5();Hi()(Zg,Nte);function Zg(r){if(!(this instanceof Zg))return new Zg(r);Nte.call(this,r)}Zg.prototype._transform=function(r,e,t){t(null,r)}});var jte=p((tTt,Kte)=>{u();"use strict";var T5;function mWe(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var Lte=wf().codes,vWe=Lte.ERR_MISSING_ARGS,wWe=Lte.ERR_STREAM_DESTROYED;function Ute(r){if(r)throw r}function _We(r){return r.setHeader&&typeof r.abort=="function"}function EWe(r,e,t,i){i=mWe(i);var n=!1;r.on("close",function(){n=!0}),T5===void 0&&(T5=q_()),T5(r,{readable:e,writable:t},function(o){if(o)return i(o);n=!0,i()});var s=!1;return function(o){if(!n&&!s){if(s=!0,_We(r))return r.abort();if(typeof r.destroy=="function")return r.destroy();i(o||new wWe("pipe"))}}}function Fte(r){r()}function SWe(r,e){return r.pipe(e)}function AWe(r){return!r.length||typeof r[r.length-1]!="function"?Ute:r.pop()}function xWe(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var i=AWe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new vWe("streams");var n,s=e.map(function(o,a){var c=a<e.length-1,f=a>0;return EWe(o,c,f,function(l){n||(n=l),l&&s.forEach(Fte),!c&&(s.forEach(Fte),i(n))})});return e.reduce(SWe)}Kte.exports=xWe});var R5=p((Ms,Vte)=>{u();Ms=Vte.exports=l5();Ms.Stream=Ms;Ms.Readable=Ms;Ms.Writable=a5();Ms.Duplex=_f();Ms.Transform=I5();Ms.PassThrough=Mte();Ms.finished=q_();Ms.pipeline=jte()});var $te=p((rTt,Hte)=>{u();"use strict";var IWe=Hi(),{Readable:zte}=R5();Hte.exports=op;IWe(op,zte);function op(r,e){if(!(this instanceof op))return new op(r,e);e=e||{},zte.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=r,this._options=e,this.on("end",this.destroy.bind(this,null,null))}op.prototype._read=function(){this.destroyed||this._iterator.next((r,e,t)=>{if(!this.destroyed){if(r)return this.destroy(r);e===void 0&&t===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(t):this.push({key:e,value:t})}})};op.prototype._destroy=function(r,e){this._iterator.end(function(t){e(r||t)})}});var Wte=p((Gte,F_)=>{u();(function(r,e,t){typeof F_!="undefined"&&F_.exports?F_.exports=t():e[r]=t()})("prr",Gte,function(){var r=typeof Object.defineProperty=="function"?function(i,n,s){return Object.defineProperty(i,n,s),i}:function(i,n,s){return i[n]=s.value,i},e=function(i,n){var s=typeof n=="object",o=!s&&typeof n=="string",a=function(c){return s?!!n[c]:o?n.indexOf(c[0])>-1:!1};return{enumerable:a("enumerable"),configurable:a("configurable"),writable:a("writable"),value:i}},t=function(i,n,s,o){var a;if(o=e(s,o),typeof n=="object"){for(a in n)Object.hasOwnProperty.call(n,a)&&(o.value=n[a],r(i,a,o));return i}return r(i,n,o)};return t})});var Qte=p((iTt,Xte)=>{u();var TWe=Wte();function Yte(r,e,t){!!e&&typeof e!="string"&&(e=e.message||e.name),TWe(this,{type:r,name:r,cause:typeof e!="string"?e:t,message:e},"ewr")}function P5(r,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),Yte.call(this,"CustomError",r,e)}P5.prototype=new Error;function RWe(r,e,t){var i=function(n,s){Yte.call(this,e,n,s),e=="FilesystemError"&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(r.errno[this.cause.errno]?r.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,i)};return i.prototype=t?new t:new P5,i}Xte.exports=function(r){var e=function(t,i){return RWe(r,t,i)};return{CustomError:P5,FilesystemError:e("FilesystemError"),createError:e}}});var Jte=p((nTt,Ba)=>{u();var PWe=Ba.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];Ba.exports.errno={};Ba.exports.code={};PWe.forEach(function(r){Ba.exports.errno[r.errno]=r,Ba.exports.code[r.code]=r});Ba.exports.custom=Qte()(Ba.exports);Ba.exports.create=Ba.exports.custom.createError});var K_=p((sTt,Zte)=>{u();"use strict";var If=Jte().create,Tf=If("LevelUPError"),C5=If("NotFoundError",Tf);C5.prototype.notFound=!0;C5.prototype.status=404;Zte.exports={LevelUPError:Tf,InitializationError:If("InitializationError",Tf),OpenError:If("OpenError",Tf),ReadError:If("ReadError",Tf),WriteError:If("WriteError",Tf),NotFoundError:C5,EncodingError:If("EncodingError",Tf)}});var q5=p(O5=>{u();"use strict";O5.fromCallback=function(r){if(r===void 0){var e=new Promise(function(t,i){r=function(n,s){n?i(n):t(s)}});r.promise=e}return r};O5.fromPromise=function(r,e){if(e===void 0)return r;r.then(function(t){process.nextTick(e,null,t)}).catch(function(t){process.nextTick(e,t)})}});var eb=p(k5=>{u();"use strict";k5.getCallback=function(r,e){return typeof r=="function"?r:e};k5.getOptions=function(r){return typeof r=="object"&&r!==null?r:{}}});var tre=p((cTt,ere)=>{u();"use strict";var tb=K_().WriteError,CWe=q5(),OWe=eb().getCallback,qWe=eb().getOptions;function rb(r){this.db=r,this.batch=r.db.batch(),this.ops=[],this.length=0}rb.prototype.put=function(r,e,t){try{this.batch.put(r,e,t)}catch(i){throw new tb(i)}return this.ops.push({...t,type:"put",key:r,value:e}),this.length++,this};rb.prototype.del=function(r,e){try{this.batch.del(r,e)}catch(t){throw new tb(t)}return this.ops.push({...e,type:"del",key:r}),this.length++,this};rb.prototype.clear=function(){try{this.batch.clear()}catch(r){throw new tb(r)}return this.ops=[],this.length=0,this};rb.prototype.write=function(r,e){let t=this.db,i=this.ops;e=OWe(r,e),e=CWe.fromCallback(e),r=qWe(r);try{this.batch.write(r,function(n){if(n)return e(new tb(n));t.emit("batch",i),e()})}catch(n){throw new tb(n)}return e.promise};ere.exports=rb});var nre=p((uTt,ire)=>{u();"use strict";var rre=E_();ire.exports=function(r,...e){e.length===0?rre(r):rre(()=>r(...e))}});var cre=p((lTt,are)=>{u();"use strict";var j_=br().EventEmitter,kWe=See().inherits,sre=zee(),BWe=$te(),NWe=tre(),ap=K_(),DWe=W4(),Rf=q5(),ib=eb().getCallback,cp=eb().getOptions,V_=nre(),z_=ap.WriteError,ore=ap.ReadError,MWe=ap.NotFoundError,LWe=ap.OpenError,UWe=ap.InitializationError;function sr(r,e,t){if(!(this instanceof sr))return new sr(r,e,t);let i;if(j_.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(t=e,e={}),e=e||{},!r||typeof r!="object"){if(i=new UWe("First argument must be an abstract-leveldown compliant store"),typeof t=="function")return V_(t,i);throw i}if(typeof r.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=cp(e),this._db=r,this.db=new sre(r),this.open(t||(n=>{n&&this.emit("error",n)})),this.supports=DWe(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let n of Object.keys(this.supports.additionalMethods))this[n]==null&&(this[n]=function(...s){return this.db[n](...s)})}sr.prototype.emit=j_.prototype.emit;sr.prototype.once=j_.prototype.once;kWe(sr,j_);sr.prototype.open=function(r,e){return typeof r=="function"&&(e=r,r=null),e=Rf.fromCallback(e),r||(r=this.options),this.isOpen()?(V_(e,null,this),e.promise):this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.emit("opening"),this.db.open(r,t=>{if(t)return e(new LWe(t));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};sr.prototype.close=function(r){return r=Rf.fromCallback(r),this.isOpen()?(this.db.close((e,...t)=>{this.emit("closed"),r(e,...t)}),this.emit("closing"),this.db=new sre(this._db)):this.isClosed()?V_(r):this.db.status==="closing"?this.once("closed",r):this._isOpening()&&this.once("open",()=>{this.close(r)}),r.promise};sr.prototype.isOpen=function(){return this.db.status==="open"};sr.prototype._isOpening=function(){return this.db.status==="opening"};sr.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};sr.prototype.get=function(r,e,t){return t=ib(e,t),t=Rf.fromCallback(t),nb(this,t)||(e=cp(e),this.db.get(r,e,function(i,n){if(i)return/notfound/i.test(i)||i.notFound?i=new MWe("Key not found in database ["+r+"]",i):i=new ore(i),t(i);t(null,n)})),t.promise};sr.prototype.put=function(r,e,t,i){return i=ib(t,i),i=Rf.fromCallback(i),nb(this,i)||(t=cp(t),this.db.put(r,e,t,n=>{if(n)return i(new z_(n));this.emit("put",r,e),i()})),i.promise};sr.prototype.del=function(r,e,t){return t=ib(e,t),t=Rf.fromCallback(t),nb(this,t)||(e=cp(e),this.db.del(r,e,i=>{if(i)return t(new z_(i));this.emit("del",r),t()})),t.promise};sr.prototype.batch=function(r,e,t){return arguments.length?(typeof r=="function"?t=r:t=ib(e,t),t=Rf.fromCallback(t),nb(this,t)||(e=cp(e),this.db.batch(r,e,i=>{if(i)return t(new z_(i));this.emit("batch",r),t()})),t.promise):new NWe(this)};sr.prototype.iterator=function(r){return this.db.iterator(r)};sr.prototype.clear=function(r,e){return e=ib(r,e),r=cp(r),e=Rf.fromCallback(e),nb(this,e)||this.db.clear(r,t=>{if(t)return e(new z_(t));this.emit("clear",r),e()}),e.promise};sr.prototype.readStream=sr.prototype.createReadStream=function(r){return r=Object.assign({keys:!0,values:!0},r),typeof r.limit!="number"&&(r.limit=-1),new BWe(this.db.iterator(r),r)};sr.prototype.keyStream=sr.prototype.createKeyStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!0,values:!1}))};sr.prototype.valueStream=sr.prototype.createValueStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!1,values:!0}))};sr.prototype.toString=function(){return"LevelUP"};sr.prototype.type="levelup";function nb(r,e){if(!r._isOpening()&&!r.isOpen())return V_(e,new ore("Database is not open")),!0}sr.errors=ap;are.exports=sr});var ure=p(Rc=>{u();"use strict";var{Buffer:B5}=pt();Rc.utf8=Rc["utf-8"]={encode:function(r){return N5(r)?r:String(r)},decode:H_,buffer:!1,type:"utf8"};Rc.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};Rc.binary={encode:function(r){return N5(r)?r:B5.from(r)},decode:H_,buffer:!0,type:"binary"};Rc.none={encode:H_,decode:H_,buffer:!1,type:"id"};Rc.id=Rc.none;var FWe=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let r of FWe)Rc[r]={encode:function(e){return N5(e)?e:B5.from(e,r)},decode:function(e){return e.toString(r)},buffer:!0,type:r};function H_(r){return r}function N5(r){return r==null||B5.isBuffer(r)}});var fre=p((hTt,lre)=>{u();"use strict";var D5=ure(),KWe=new Set(["lt","gt","lte","gte"]);lre.exports=xn;function xn(r){if(!(this instanceof xn))return new xn(r);this.opts=r||{},this.encodings=D5}xn.prototype._encoding=function(r){return typeof r=="string"&&(r=D5[r]),r||(r=D5.id),r};xn.prototype._keyEncoding=function(r,e){return this._encoding(e&&e.keyEncoding||r&&r.keyEncoding||this.opts.keyEncoding)};xn.prototype._valueEncoding=function(r,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||r&&(r.valueEncoding||r.encoding)||this.opts.valueEncoding||this.opts.encoding)};xn.prototype.encodeKey=function(r,e,t){return this._keyEncoding(e,t).encode(r)};xn.prototype.encodeValue=function(r,e,t){return this._valueEncoding(e,t).encode(r)};xn.prototype.decodeKey=function(r,e){return this._keyEncoding(e).decode(r)};xn.prototype.decodeValue=function(r,e){return this._valueEncoding(e).decode(r)};xn.prototype.encodeBatch=function(r,e){return r.map(t=>{let i={type:t.type,key:this.encodeKey(t.key,e,t)};return this.keyAsBuffer(e,t)&&(i.keyEncoding="binary"),t.prefix&&(i.prefix=t.prefix),"value"in t&&(i.value=this.encodeValue(t.value,e,t),this.valueAsBuffer(e,t)&&(i.valueEncoding="binary")),i})};xn.prototype.encodeLtgt=function(r){let e={};for(let t of Object.keys(r)){if(t==="start"||t==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[t]=KWe.has(t)?this.encodeKey(r[t],r):r[t]}return e};xn.prototype.createStreamDecoder=function(r){return r.keys&&r.values?(e,t)=>({key:this.decodeKey(e,r),value:this.decodeValue(t,r)}):r.keys?e=>this.decodeKey(e,r):r.values?(e,t)=>this.decodeValue(t,r):function(){}};xn.prototype.keyAsBuffer=function(r){return this._keyEncoding(r).buffer};xn.prototype.valueAsBuffer=function(r){return this._valueEncoding(r).buffer}});var bre=p((dTt,gre)=>{u();"use strict";var hre=Uu().AbstractLevelDOWN,dre=Uu().AbstractChainedBatch,pre=Uu().AbstractIterator,M5=Hi(),jWe=fre(),yre=K_().EncodingError,VWe=["approximateSize","compactRange"];gre.exports=ln;function ln(r,e){if(!(this instanceof ln))return new ln(r,e);let t=r.supports||{},i=t.additionalMethods||{};hre.call(this,t),this.supports.encodings=!0,this.supports.additionalMethods={},VWe.forEach(function(n){let s=typeof r[n]=="function";(i[n]||s)&&(this.supports.additionalMethods[n]=!0,this[n]=function(o,a,c,f){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[n](o,a,c,f)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=r,this.codec=new jWe(e)}M5(ln,hre);ln.prototype.type="encoding-down";ln.prototype._serializeKey=ln.prototype._serializeValue=function(r){return r};ln.prototype._open=function(r,e){this.db.open(r,e)};ln.prototype._close=function(r){this.db.close(r)};ln.prototype._put=function(r,e,t,i){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.db.put(r,e,t,i)};ln.prototype._get=function(r,e,t){r=this.codec.encodeKey(r,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(r,e,(i,n)=>{if(i)return t(i);try{n=this.codec.decodeValue(n,e)}catch(s){return t(new yre(s))}t(null,n)})};ln.prototype._del=function(r,e,t){r=this.codec.encodeKey(r,e),this.db.del(r,e,t)};ln.prototype._chainedBatch=function(){return new up(this)};ln.prototype._batch=function(r,e,t){r=this.codec.encodeBatch(r,e),this.db.batch(r,e,t)};ln.prototype._iterator=function(r){return r.keyAsBuffer=this.codec.keyAsBuffer(r),r.valueAsBuffer=this.codec.valueAsBuffer(r),new sb(this,r)};ln.prototype._clear=function(r,e){r=this.codec.encodeLtgt(r),this.db.clear(r,e)};function sb(r,e){pre.call(this,r),this.codec=r.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=r.db.iterator(this.opts)}M5(sb,pre);sb.prototype._next=function(r){this.it.next((e,t,i)=>{if(e)return r(e);try{this.keys&&typeof t!="undefined"?t=this.codec.decodeKey(t,this.opts):t=void 0,this.values&&typeof i!="undefined"?i=this.codec.decodeValue(i,this.opts):i=void 0}catch(n){return r(new yre(n))}r(null,t,i)})};sb.prototype._seek=function(r){r=this.codec.encodeKey(r,this.opts),this.it.seek(r)};sb.prototype._end=function(r){this.it.end(r)};function up(r,e){dre.call(this,r),this.codec=r.codec,this.batch=r.db.batch()}M5(up,dre);up.prototype._put=function(r,e,t){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.batch.put(r,e)};up.prototype._del=function(r,e){r=this.codec.encodeKey(r,e),this.batch.del(r)};up.prototype._clear=function(){this.batch.clear()};up.prototype._write=function(r,e){this.batch.write(r,e)}});var wre=p((pTt,vre)=>{u();"use strict";var mre=cre(),zWe=bre();function HWe(r){function e(i,n,s){return typeof i=="function"?s=i:typeof n=="function"&&(s=n),t(n)||(n=t(i)?i:{}),mre(zWe(r(i,n),n),n,s)}function t(i){return typeof i=="object"&&i!==null}for(let i of["destroy","repair"])typeof r[i]=="function"&&(e[i]=function(...n){r[i](...n)});return e.errors=mre.errors,e}vre.exports=HWe});var Ere=p(oi=>{u();oi.compare=function(r,e){if(Buffer.isBuffer(r)){for(var t=Math.min(r.length,e.length),i=0;i<t;i++){var n=r[i]-e[i];if(n)return n}return r.length-e.length}return r<e?-1:r>e?1:0};function _re(r){return r!==void 0&&r!==""}function lp(r,e){return Object.hasOwnProperty.call(r,e)}function Na(r,e){return Object.hasOwnProperty.call(r,e)&&e}var $We=oi.lowerBoundKey=function(r){return Na(r,"gt")||Na(r,"gte")||Na(r,"min")||(r.reverse?Na(r,"end"):Na(r,"start"))||void 0},L5=oi.lowerBound=function(r,e){var t=$We(r);return t?r[t]:e},U5=oi.lowerBoundInclusive=function(r){return!lp(r,"gt")},F5=oi.upperBoundInclusive=function(r){return!lp(r,"lt")},GWe=oi.lowerBoundExclusive=function(r){return!U5(r)},WWe=oi.upperBoundExclusive=function(r){return!F5(r)},YWe=oi.upperBoundKey=function(r){return Na(r,"lt")||Na(r,"lte")||Na(r,"max")||(r.reverse?Na(r,"start"):Na(r,"end"))||void 0},K5=oi.upperBound=function(r,e){var t=YWe(r);return t?r[t]:e};oi.start=function(r,e){return r.reverse?K5(r,e):L5(r,e)};oi.end=function(r,e){return r.reverse?L5(r,e):K5(r,e)};oi.startInclusive=function(r){return r.reverse?F5(r):U5(r)};oi.endInclusive=function(r){return r.reverse?U5(r):F5(r)};function XWe(r){return r}oi.toLtgt=function(r,e,t,i,n){e=e||{},t=t||XWe;var s=arguments.length>3,o=oi.lowerBoundKey(r),a=oi.upperBoundKey(r);return o?o==="gt"?e.gt=t(r.gt,!1):e.gte=t(r[o],!1):s&&(e.gte=t(i,!1)),a?a==="lt"?e.lt=t(r.lt,!0):e.lte=t(r[a],!0):s&&(e.lte=t(n,!0)),r.reverse!=null&&(e.reverse=!!r.reverse),lp(e,"max")&&delete e.max,lp(e,"min")&&delete e.min,lp(e,"start")&&delete e.start,lp(e,"end")&&delete e.end,e};oi.contains=function(r,e,t){t=t||oi.compare;var i=L5(r);if(_re(i)){var n=t(e,i);if(n<0||n===0&&GWe(r))return!1}var s=K5(r);if(_re(s)){var n=t(e,s);if(n>0||n===0&&WWe(r))return!1}return!0};oi.filter=function(r,e){return function(t){return oi.contains(r,t,e)}}});var j5=p((gTt,Sre)=>{u();"use strict";var $_=Ere(),zu=Symbol("none");Sre.exports=function(e){let t=$_.lowerBound(e,zu),i=$_.upperBound(e,zu),n=$_.lowerBoundExclusive(e,zu),s=$_.upperBoundExclusive(e,zu);return t!==zu&&i!==zu?IDBKeyRange.bound(t,i,n,s):t!==zu?IDBKeyRange.lowerBound(t,n):i!==zu?IDBKeyRange.upperBound(i,s):null}});var V5=p((bTt,xre)=>{u();"use strict";var G_=pt().Buffer,QWe=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return Are(e).toString()}}(),JWe=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return G_.from(e).toString()}}();function Are(r){let e=G_.from(r.buffer);return r.byteLength===r.buffer.byteLength?e:e.slice(r.byteOffset,r.byteOffset+r.byteLength)}xre.exports=function(r,e){return r instanceof Uint8Array?e?Are(r):QWe(r):r instanceof ArrayBuffer?e?G_.from(r):JWe(r):e?G_.from(String(r)):String(r)}});var Pre=p((mTt,Rre)=>{u();"use strict";var ZWe=Hi(),Ire=Uu().AbstractIterator,eYe=j5(),Tre=V5(),tYe=function(){};Rre.exports=xo;function xo(r,e,t){if(Ire.call(this,r),this._limit=t.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=t.keys,this._values=t.values,this._keyAsBuffer=t.keyAsBuffer,this._valueAsBuffer=t.valueAsBuffer,this._limit===0){this._completed=!0;return}let i;try{i=eYe(t)}catch(n){this._completed=!0;return}this.createIterator(e,i,t.reverse)}ZWe(xo,Ire);xo.prototype.createIterator=function(r,e,t){let i=this.db.db.transaction([r],"readonly"),s=i.objectStore(r).openCursor(e,t?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=i,i.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},i.oncomplete=()=>{this.onComplete()}};xo.prototype.onItem=function(r){this._cache.push(r.key,r.value),(this._limit<=0||++this._count<this._limit)&&r.continue(),this.maybeNext()};xo.prototype.onAbort=function(r){this._aborted=!0,this._error=r,this.maybeNext()};xo.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};xo.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};xo.prototype._next=function(r){if(this._aborted){let e=this._error;this._error=null,this._nextTick(r,e)}else if(this._cache.length>0){let e=this._cache.shift(),t=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&t!==void 0?t=this._deserializeValue(t,this._valueAsBuffer):t=void 0,this._nextTick(r,null,e,t)}else this._completed?this._nextTick(r):this._callback=r};xo.prototype._deserializeKey=Tre;xo.prototype._deserializeValue=Tre;xo.prototype._end=function(r){if(this._aborted||this._completed)return this._nextTick(r,this._error);this.onItem=tYe,this.onAbort=r,this.onComplete=r}});var qre=p((vTt,Ore)=>{u();"use strict";var Cre=pt().Buffer,rYe=function(){if(globalThis.TextEncoder){let r=new TextEncoder("utf-8");return r.encode.bind(r)}else return Cre.from}();Ore.exports=function(r,e){return e?Cre.isBuffer(r)?r:rYe(String(r)):String(r)}});var kre=p(W_=>{u();"use strict";var iYe=pt().Buffer;W_.test=function(r){return function(t){try{return t.cmp(r,0),!0}catch(i){return!1}}};W_.bufferKeys=W_.test(iYe.alloc(0))});var Nre=p((_Tt,Bre)=>{u();"use strict";Bre.exports=function(e,t,i,n,s){if(n.limit===0)return e._nextTick(s);let o=e.db.transaction([t],"readwrite"),a=o.objectStore(t),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let f=a.openKeyCursor?"openKeyCursor":"openCursor",l=n.reverse?"prev":"next";a[f](i,l).onsuccess=function(h){let d=h.target.result;d&&(a.delete(d.key).onsuccess=function(){(n.limit<=0||++c<n.limit)&&d.continue()})}}});var Fre=p((ETt,Ure)=>{u();"use strict";Ure.exports=wi;var Dre=Uu().AbstractLevelDOWN,nYe=Hi(),sYe=Pre(),Mre=qre(),z5=V5(),oYe=kre(),aYe=Nre(),cYe=j5(),Lre="level-js-";function wi(r,e){if(!(this instanceof wi))return new wi(r,e);if(Dre.call(this,{bufferKeys:oYe.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0}),e=e||{},typeof r!="string")throw new Error("constructor requires a location string argument");this.location=r,this.prefix=e.prefix==null?Lre:e.prefix,this.version=parseInt(e.version||1,10)}nYe(wi,Dre);wi.prototype.type="level-js";wi.prototype._open=function(r,e){let t=indexedDB.open(this.prefix+this.location,this.version);t.onerror=function(){e(t.error||new Error("unknown error"))},t.onsuccess=()=>{this.db=t.result,e()},t.onupgradeneeded=i=>{let n=i.target.result;n.objectStoreNames.contains(this.location)||n.createObjectStore(this.location)}};wi.prototype.store=function(r){return this.db.transaction([this.location],r).objectStore(this.location)};wi.prototype.await=function(r,e){let t=r.transaction;t.onabort=function(){e(t.error||new Error("aborted by user"))},t.oncomplete=function(){e(null,r.result)}};wi.prototype._get=function(r,e,t){let i=this.store("readonly"),n;try{n=i.get(r)}catch(s){return this._nextTick(t,s)}this.await(n,function(s,o){if(s)return t(s);if(o===void 0)return t(new Error("NotFound"));t(null,z5(o,e.asBuffer))})};wi.prototype._del=function(r,e,t){let i=this.store("readwrite"),n;try{n=i.delete(r)}catch(s){return this._nextTick(t,s)}this.await(n,t)};wi.prototype._put=function(r,e,t,i){let n=this.store("readwrite"),s;try{s=n.put(e,r)}catch(o){return this._nextTick(i,o)}this.await(s,i)};wi.prototype._serializeKey=function(r){return Mre(r,this.supports.bufferKeys)};wi.prototype._serializeValue=function(r){return Mre(r,!0)};wi.prototype._iterator=function(r){return new sYe(this,this.location,r)};wi.prototype._batch=function(r,e,t){if(r.length===0)return this._nextTick(t);let i=this.store("readwrite"),n=i.transaction,s=0,o;n.onabort=function(){t(o||n.error||new Error("aborted by user"))},n.oncomplete=function(){t()};function a(){let c=r[s++],f=c.key,l;try{l=c.type==="del"?i.delete(f):i.put(c.value,f)}catch(h){o=h,n.abort();return}s<r.length&&(l.onsuccess=a)}a()};wi.prototype._clear=function(r,e){let t,i;try{t=cYe(r)}catch(n){return this._nextTick(e)}if(r.limit>=0)return aYe(this,this.location,t,r,e);try{let n=this.store("readwrite");i=t?n.delete(t):n.clear()}catch(n){return this._nextTick(e,n)}this.await(i,e)};wi.prototype._close=function(r){this.db.close(),this._nextTick(r)};wi.prototype.upgrade=function(r){if(this.status!=="open")return this._nextTick(r,new Error("cannot upgrade() before open()"));let e=this.iterator(),t={},i=this;e._deserializeKey=e._deserializeValue=a,n();function n(c){if(c)return o(c);e.next(s)}function s(c,f,l){if(c||f===void 0)return o(c);let h=i._serializeKey(z5(f,!0)),d=i._serializeValue(z5(l,!0));i._batch([{type:"del",key:f},{type:"put",key:h,value:d}],t,n)}function o(c){e.end(function(f){r(c||f)})}function a(c){return c}};wi.destroy=function(r,e,t){typeof e=="function"&&(t=e,e=Lre);let i=indexedDB.deleteDatabase(e+r);i.onsuccess=function(){t()},i.onerror=function(n){t(n)}}});var jre=p((STt,Kre)=>{u();Kre.exports=wre()(Fre())});var Gre=p((ATt,$re)=>{u();"use strict";var{Key:uYe,Errors:ob,Adapter:lYe,utils:{sortAll:Vre}}=Lt(),Y_=wc(),fYe=mo(),zre=md(),Hre=class extends lYe{constructor(e,t){super();this.path=e,this.opts=t,t&&t.db?(this.database=t.db,delete t.db):this.database=jre()}_initDb(){return new Promise((e,t)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},i=>{if(i)return t(i);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw ob.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(i){throw ob.dbWriteFailedError(i)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(i){throw i.notFound?ob.notFoundError(i):ob.dbWriteFailedError(i)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw ob.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(t,i)=>{e.push({type:"put",key:t.toString(),value:i})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>Y_(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>Vre(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=Y_(t,()=>s++>=i)}return n&&(t=zre(t,n)),t}queryKeys(e){let t=fYe(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>Y_(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>Vre(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=Y_(t,()=>s++>=i)}return n&&(t=zre(t,n)),t}_query(e){let t={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let i=e.prefix.toString();t.gte=i,t.lt=i+"\xFF"}return hYe(this.db.iterator(t))}};function hYe(r){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,t)=>{r.next((i,n,s)=>{if(i)return t(i);if(n==null)return r.end(o=>{if(o)return t(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new uYe(n,!1),value:s}})})}),return:()=>new Promise((e,t)=>{r.end(i=>{if(i)return t(i);e({done:!0,value:void 0})})})}}}}$re.exports=Hre});var H5=p((xTt,Jre)=>{u();"use strict";var Wre=Ia(),fp=wc(),Yre=md(),dYe=bd(),Xre=(r,e)=>async function*(){yield*(await dYe(r)).sort(e)}(),Qre=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await Wre(this.putMany(e,i)),e=[],await Wre(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=fp(i,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>fp(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Xre(n,s),i)),e.offset!=null){let n=0;i=fp(i,()=>n++>=(e.offset||0))}return e.limit!=null&&(i=Yre(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=fp(i,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>fp(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Xre(n,s),i)),e.offset!=null){let n=0;i=fp(i,()=>n++>=e.offset)}return e.limit!=null&&(i=Yre(i,e.limit)),i}};Jre.exports=Qre});var eie=p((ITt,Zre)=>{u();"use strict";var pYe=ue();function yYe(r){return r=r||new Error("Not Found"),pYe(r,"ERR_NOT_FOUND")}Zre.exports={notFoundError:yYe}});var oie=p((TTt,sie)=>{u();"use strict";var gYe=H5(),{base32:hp}=(en(),Zi),tie=(Xn(),kn),{CID:rie}=(xe(),Ce),iie=(mn(),bn),bYe=eie(),nie=class extends gYe{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[hp.encode(e.multihash.bytes)]=t}async get(e){if(!await this.has(e))throw bYe.notFoundError();return this.data[hp.encode(e.multihash.bytes)]}async has(e){return this.data[hp.encode(e.multihash.bytes)]!==void 0}async delete(e){delete this.data[hp.encode(e.multihash.bytes)]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:rie.createV1(tie.code,iie.decode(hp.decode(e))),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>rie.createV1(tie.code,iie.decode(hp.decode(e))))}};sie.exports=nie});var X_=p((RTt,aie)=>{u();"use strict";var mYe=H5(),vYe=oie();aie.exports={BlockstoreAdapter:mYe,MemoryBlockstore:vYe}});var pie=p((PTt,die)=>{u();"use strict";var cie=Ia(),uie=Ra(),{Key:wYe}=Lt(),{CID:lie}=(xe(),Ce),_Ye=(Xn(),kn),EYe=(mn(),bn),{base32:ab,base32pad:SYe}=(en(),Zi),{base58btc:fie}=(zr(),Vr),AYe=ue(),{BlockstoreAdapter:xYe}=X_();function dp(r){if(!(r instanceof lie))throw AYe(new Error("Not a valid cid"),"ERR_INVALID_CID");return new wYe("/"+ab.encode(r.multihash.bytes).slice(1).toUpperCase(),!1)}function Hu(r){return lie.createV1(_Ye.code,EYe.decode(ab.decode("b"+r.toString().slice(1).toLowerCase())))}function $5(r){let e,t=r.substring(0,1);return t==="/"?$5(r.substring(1)):(t.toLowerCase()==="b"?e=ab.decode(r.toLowerCase()).subarray(2):t.toLowerCase()==="c"?e=SYe.decode(r.toLowerCase()).subarray(2):t==="z"?e=fie.decode(r).subarray(2):t==="Q"?e=fie.decode("z"+r):e=ab.decode("b"+r.toLowerCase()).subarray(2),ab.encode(e).substring(1).toUpperCase()||"C")}function IYe(r){return{...r,prefix:r.prefix?`/${$5(r.prefix)}`:void 0,filters:r.filters?r.filters.map(e=>t=>e({key:Hu(t.key),value:t.value})):void 0,orders:r.orders?r.orders.map(e=>(t,i)=>e({key:Hu(t.key),value:t.value},{key:Hu(i.key),value:i.value})):void 0}}function TYe(r){return{...r,prefix:r.prefix?`/${$5(r.prefix)}`:void 0,filters:r.filters?r.filters.map(e=>t=>e(Hu(t))):void 0,orders:r.orders?r.orders.map(e=>(t,i)=>e(Hu(t),Hu(i))):void 0}}var hie=class extends xYe{constructor(e){super();this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(let{key:i,value:n}of this.child.query(IYe(e),t))yield{key:Hu(i),value:n}}async*queryKeys(e,t){for await(let i of this.child.queryKeys(TYe(e),t))yield Hu(i)}async get(e,t){return this.child.get(dp(e),t)}async*getMany(e,t){for await(let i of e)yield this.get(i,t)}async put(e,t,i){await this.child.put(dp(e),t,i)}async*putMany(e,t){let i=uie();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{let s=this.child;await cie(this.child.putMany(async function*(){for await(let o of e){let a=dp(o.key);await s.has(a,t)||(yield{key:a,value:o.value}),i.push(o)}}())),i.end()}catch(s){i.end(s)}}),yield*i}has(e,t){return this.child.has(dp(e),t)}delete(e,t){return this.child.delete(dp(e),t)}deleteMany(e,t){let i=uie();return cie(this.child.deleteMany(async function*(){for await(let n of e)yield dp(n),i.push(n);i.end()}(),t)).catch(n=>{i.end(n)}),i}};die.exports=hie});var gie=p((CTt,yie)=>{u();"use strict";var{createRepo:RYe}=Jl(),cb=Gre(),PYe=pie();yie.exports=(r,e,t)=>{let i=t.path||"ipfs";return RYe(i,n=>e.getCodec(n),{root:new cb(i),blocks:new PYe(new cb(`${i}/blocks`)),datastore:new cb(`${i}/datastore`),keys:new cb(`${i}/keys`),pins:new cb(`${i}/pins`)},{autoMigrate:t.autoMigrate,onMigrationProgress:t.onMigrationProgress||r})}});var G5=p((OTt,wie)=>{u();"use strict";var bie=()=>{},mie=Symbol.for("@libp2p/js-interfaces/topology"),vie=class{constructor({min:e=0,max:t=1/0,handlers:i={}}){this.min=e,this.max=t,this._onConnect=i.onConnect||bie,this._onDisconnect=i.onDisconnect||bie,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[mie](){return!0}static isTopology(e){return Boolean(e&&e[mie])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};wie.exports=vie});var Q_=p((qTt,Sie)=>{u();"use strict";var CYe=G5(),_ie=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),Eie=class extends CYe{constructor({min:e,max:t,multicodecs:i,handlers:n}){super({min:e,max:t,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[_ie](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[_ie])}set registrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(e){for(let{id:t,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(t.toB58String());let n=this._registrar.getConnection(t);n&&this._onConnect(t,n)}else this.peers.delete(t.toB58String())}_onProtocolChange({peerId:e,protocols:t}){let i=this.peers.has(e.toB58String()),n=t.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of t)if(this.multicodecs.includes(s)){let o=this._registrar.peerStore.get(e);this._updatePeers([o]);return}}_onPeerConnect(e){let t=e.remotePeer,i=this._registrar.peerStore.protoBook.get(t);!i||this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(t.toB58String()),this._onConnect(t,e))}};Sie.exports=Eie});var J_=p(Aie=>{u();"use strict";Aie.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var Y5=p((BTt,xie)=>{u();"use strict";var $u=Pi(),pp=$u.Reader,W5=$u.Writer,_t=$u.util,_i=$u.roots["libp2p-pubsub-rpc"]||($u.roots["libp2p-pubsub-rpc"]={});_i.RPC=function(){function r(e){if(this.subscriptions=[],this.msgs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.subscriptions=_t.emptyArray,r.prototype.msgs=_t.emptyArray,r.encode=function(t,i){if(i||(i=W5.create()),t.subscriptions!=null&&t.subscriptions.length)for(var n=0;n<t.subscriptions.length;++n)_i.RPC.SubOpts.encode(t.subscriptions[n],i.uint32(10).fork()).ldelim();if(t.msgs!=null&&t.msgs.length)for(var n=0;n<t.msgs.length;++n)_i.RPC.Message.encode(t.msgs[n],i.uint32(18).fork()).ldelim();return i},r.decode=function(t,i){t instanceof pp||(t=pp.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new _i.RPC;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(_i.RPC.SubOpts.decode(t,t.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(_i.RPC.Message.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof _i.RPC)return t;var i=new _i.RPC;if(t.subscriptions){if(!Array.isArray(t.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<t.subscriptions.length;++n){if(typeof t.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=_i.RPC.SubOpts.fromObject(t.subscriptions[n])}}if(t.msgs){if(!Array.isArray(t.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<t.msgs.length;++n){if(typeof t.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=_i.RPC.Message.fromObject(t.msgs[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),t.subscriptions&&t.subscriptions.length){n.subscriptions=[];for(var s=0;s<t.subscriptions.length;++s)n.subscriptions[s]=_i.RPC.SubOpts.toObject(t.subscriptions[s],i)}if(t.msgs&&t.msgs.length){n.msgs=[];for(var s=0;s<t.msgs.length;++s)n.msgs[s]=_i.RPC.Message.toObject(t.msgs[s],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,$u.util.toJSONOptions)},r.SubOpts=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var t;return Object.defineProperty(e.prototype,"_subscribe",{get:_t.oneOfGetter(t=["subscribe"]),set:_t.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_topicID",{get:_t.oneOfGetter(t=["topicID"]),set:_t.oneOfSetter(t)}),e.encode=function(n,s){return s||(s=W5.create()),n.subscribe!=null&&Object.hasOwnProperty.call(n,"subscribe")&&s.uint32(8).bool(n.subscribe),n.topicID!=null&&Object.hasOwnProperty.call(n,"topicID")&&s.uint32(18).string(n.topicID),s},e.decode=function(n,s){n instanceof pp||(n=pp.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new _i.RPC.SubOpts;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.subscribe=n.bool();break;case 2:a.topicID=n.string();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof _i.RPC.SubOpts)return n;var s=new _i.RPC.SubOpts;return n.subscribe!=null&&(s.subscribe=Boolean(n.subscribe)),n.topicID!=null&&(s.topicID=String(n.topicID)),s},e.toObject=function(n,s){s||(s={});var o={};return n.subscribe!=null&&n.hasOwnProperty("subscribe")&&(o.subscribe=n.subscribe,s.oneofs&&(o._subscribe="subscribe")),n.topicID!=null&&n.hasOwnProperty("topicID")&&(o.topicID=n.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,$u.util.toJSONOptions)},e}(),r.Message=function(){function e(i){if(this.topicIDs=[],i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=_t.emptyArray,e.prototype.signature=null,e.prototype.key=null;var t;return Object.defineProperty(e.prototype,"_from",{get:_t.oneOfGetter(t=["from"]),set:_t.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_data",{get:_t.oneOfGetter(t=["data"]),set:_t.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_seqno",{get:_t.oneOfGetter(t=["seqno"]),set:_t.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_signature",{get:_t.oneOfGetter(t=["signature"]),set:_t.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_key",{get:_t.oneOfGetter(t=["key"]),set:_t.oneOfSetter(t)}),e.encode=function(n,s){if(s||(s=W5.create()),n.from!=null&&Object.hasOwnProperty.call(n,"from")&&s.uint32(10).bytes(n.from),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),n.seqno!=null&&Object.hasOwnProperty.call(n,"seqno")&&s.uint32(26).bytes(n.seqno),n.topicIDs!=null&&n.topicIDs.length)for(var o=0;o<n.topicIDs.length;++o)s.uint32(34).string(n.topicIDs[o]);return n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&s.uint32(42).bytes(n.signature),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&s.uint32(50).bytes(n.key),s},e.decode=function(n,s){n instanceof pp||(n=pp.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new _i.RPC.Message;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.from=n.bytes();break;case 2:a.data=n.bytes();break;case 3:a.seqno=n.bytes();break;case 4:a.topicIDs&&a.topicIDs.length||(a.topicIDs=[]),a.topicIDs.push(n.string());break;case 5:a.signature=n.bytes();break;case 6:a.key=n.bytes();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof _i.RPC.Message)return n;var s=new _i.RPC.Message;if(n.from!=null&&(typeof n.from=="string"?_t.base64.decode(n.from,s.from=_t.newBuffer(_t.base64.length(n.from)),0):n.from.length&&(s.from=n.from)),n.data!=null&&(typeof n.data=="string"?_t.base64.decode(n.data,s.data=_t.newBuffer(_t.base64.length(n.data)),0):n.data.length&&(s.data=n.data)),n.seqno!=null&&(typeof n.seqno=="string"?_t.base64.decode(n.seqno,s.seqno=_t.newBuffer(_t.base64.length(n.seqno)),0):n.seqno.length&&(s.seqno=n.seqno)),n.topicIDs){if(!Array.isArray(n.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<n.topicIDs.length;++o)s.topicIDs[o]=String(n.topicIDs[o])}return n.signature!=null&&(typeof n.signature=="string"?_t.base64.decode(n.signature,s.signature=_t.newBuffer(_t.base64.length(n.signature)),0):n.signature.length&&(s.signature=n.signature)),n.key!=null&&(typeof n.key=="string"?_t.base64.decode(n.key,s.key=_t.newBuffer(_t.base64.length(n.key)),0):n.key.length&&(s.key=n.key)),s},e.toObject=function(n,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),n.from!=null&&n.hasOwnProperty("from")&&(o.from=s.bytes===String?_t.base64.encode(n.from,0,n.from.length):s.bytes===Array?Array.prototype.slice.call(n.from):n.from,s.oneofs&&(o._from="from")),n.data!=null&&n.hasOwnProperty("data")&&(o.data=s.bytes===String?_t.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data,s.oneofs&&(o._data="data")),n.seqno!=null&&n.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?_t.base64.encode(n.seqno,0,n.seqno.length):s.bytes===Array?Array.prototype.slice.call(n.seqno):n.seqno,s.oneofs&&(o._seqno="seqno")),n.topicIDs&&n.topicIDs.length){o.topicIDs=[];for(var a=0;a<n.topicIDs.length;++a)o.topicIDs[a]=n.topicIDs[a]}return n.signature!=null&&n.hasOwnProperty("signature")&&(o.signature=s.bytes===String?_t.base64.encode(n.signature,0,n.signature.length):s.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,s.oneofs&&(o._signature="signature")),n.key!=null&&n.hasOwnProperty("key")&&(o.key=s.bytes===String?_t.base64.encode(n.key,0,n.key.length):s.bytes===Array?Array.prototype.slice.call(n.key):n.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,$u.util.toJSONOptions)},e}(),r}();xie.exports=_i});var X5=p((NTt,Tie)=>{u();"use strict";var{Buffer:Io}=pt(),Iie=Symbol.for("BufferList");function or(r){if(!(this instanceof or))return new or(r);or._init.call(this,r)}or._init=function(e){Object.defineProperty(this,Iie,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};or.prototype._new=function(e){return new or(e)};or.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};or.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};or.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};or.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};or.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Io.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,f=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Io.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,f),f+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=Io.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-l;if(c>d)this._bufs[h].copy(e,f,l),f+=d;else{this._bufs[h].copy(e,f,l,l+c),f+=d;break}c-=d,l&&(l=0)}return e.length>f?e.slice(0,f):e};or.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};or.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};or.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};or.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};or.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Io.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Io.from(e));return this};or.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};or.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=Io.from([r]):typeof r=="string"?r=Io.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=Io.from(r.buffer,r.byteOffset,r.byteLength):Io.isBuffer(r)||(r=Io.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};or.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?or.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:or.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();or.prototype._isBufferList=function(e){return e instanceof or||or.isBufferList(e)};or.isBufferList=function(e){return e!=null&&e[Iie]};Tie.exports=or});var Q5=p((DTt,Cie)=>{u();"use strict";var Rie=Jn(),{Buffer:OYe}=pt(),Pie=(r,e,t)=>{let i=Rie.encode(r,e,t);return Pie.bytes=Rie.encode.bytes,e||OYe.from(i)};Cie.exports=Pie});var Die=p((MTt,Z_)=>{u();"use strict";var{Buffer:Oie}=pt(),qie=X5(),kie=Q5(),J5=8,Bie=10*1024;function Nie(r){r=r||{};let e=Math.max(r.poolSize||Bie,r.minPoolSize||J5),t=r.lengthEncoder||kie;return async function*(n){let s=Oie.alloc(e),o=0;for await(let a of n){t(a.length,s,o);let c=s.slice(o,o+t.bytes);o+=t.bytes,s.length-o<J5&&(s=Oie.alloc(e),o=0),yield new qie().append(c).append(a)}}}Nie.single=(r,e)=>{e=e||{};let t=e.lengthEncoder||kie;return new qie([t(r.length),r.slice()])};Z_.exports=Nie;Z_.exports.MIN_POOL_SIZE=J5;Z_.exports.DEFAULT_POOL_SIZE=Bie});var Z5=p((LTt,Uie)=>{u();"use strict";var Mie=Jn(),{Buffer:qYe}=pt(),kYe=r=>new Proxy({},{get:(e,t)=>t[0]==="l"?r[t]:r.get(parseInt(t))}),Lie=r=>{let e=Mie.decode(qYe.isBuffer(r)?r:kYe(r));return Lie.bytes=Mie.decode.bytes,e};Uie.exports=Lie});var Vie=p((UTt,e2)=>{u();"use strict";var{Buffer:BYe}=pt(),eT=X5(),NYe=Z5(),Fie=8,Kie=1024*1024*4,jie=BYe.alloc(0),Gu={LENGTH:"readLength",DATA:"readData"},DYe={[Gu.LENGTH]:(r,e,t,i)=>{e=e.append(r);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:Gu.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return r=e.shallowSlice(i.lengthDecoder.bytes),e=new eT,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(jie),{mode:Gu.LENGTH,chunk:r,buffer:e,data:jie}):{mode:Gu.DATA,chunk:r,buffer:e,state:{dataLength:n},data:void 0}},[Gu.DATA]:(r,e,t,i)=>{if(e=e.append(r),!t)throw new Error("state is required");if(e.length<t.dataLength)return{mode:Gu.DATA,buffer:e,state:t,chunk:void 0,data:void 0};let{dataLength:n}=t,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new eT,i.onData&&i.onData(s),{mode:Gu.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function tT(r){r=r||{};let e={lengthDecoder:r.lengthDecoder||NYe,maxLengthLength:r.maxLengthLength||Fie,maxDataLength:r.maxDataLength||Kie,onLength:r.onLength,onData:r.onData};return async function*(i){let n=new eT,s=Gu.LENGTH,o;for await(let a of i){let c=a;for(;c;){let f=DYe[s](c,n,o,e);s=f.mode,c=f.chunk,n=f.buffer,o=f.state,f.data&&(yield f.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}tT.fromReader=(r,e)=>{let t=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await r.next(t)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{t=1}}};return tT({...e||{},onLength:s=>{t=s}})(i)};e2.exports=tT;e2.exports.MAX_LENGTH_LENGTH=Fie;e2.exports.MAX_DATA_LENGTH=Kie});var $ie=p((FTt,Hie)=>{u();"use strict";var{Buffer:MYe}=pt(),zie=(r,e,t)=>(e=e||MYe.allocUnsafe(4),e.writeInt32BE(r,t),e);zie.bytes=4;Hie.exports=zie});var Yie=p((KTt,Wie)=>{u();"use strict";var Gie=r=>{if(r.length<4)throw RangeError("Could not decode int32BE");return r.readInt32BE(0)};Gie.bytes=4;Wie.exports=Gie});var To=p(Pf=>{u();"use strict";Pf.encode=Die();Pf.decode=Vie();Pf.varintEncode=Q5();Pf.varintDecode=Z5();Pf.int32BEEncode=$ie();Pf.int32BEDecode=Yie()});var t2=p((VTt,Xie)=>{u();Xie.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Jie=p((HTt,Qie)=>{u();Qie.exports=class extends Error{constructor(e,t){super(e||"The operation was aborted");this.type="aborted",this.code=t||"ABORT_ERR"}}});var Da=p(($Tt,Cf)=>{u();var LYe=t2(),rT=Jie(),Zie=(r,e,t)=>iT(r,Array.isArray(e)?e:[{signal:e,options:t}]),iT=(r,e)=>{r=LYe(r),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*t(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:f,abortCode:l}=c;throw new rT(f,l)}let o=new Promise((a,c)=>{i=()=>{let{options:f}=e.find(({signal:d})=>d.aborted),{abortMessage:l,abortCode:h}=f;c(new rT(l,h))}});s=await Promise.race([o,r.next()]),i=null}catch(o){for(let{signal:f}of e)f.removeEventListener("abort",n);let a=e.find(({signal:f})=>f.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(r),typeof r.return=="function"&&await r.return(),c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return t()},ene=(r,e,t)=>tne(r,Array.isArray(e)?e:[{signal:e,options:t}]),tne=(r,e)=>t=>r(iT(t,e)),UYe=(r,e,t)=>FYe(r,Array.isArray(e)?e:[{signal:e,options:t}]),FYe=(r,e)=>({sink:tne(r.sink,e),source:iT(r.source,e)});Cf.exports=Zie;Cf.exports.AbortError=rT;Cf.exports.source=Zie;Cf.exports.sink=ene;Cf.exports.transform=ene;Cf.exports.duplex=UYe});var ane=p((GTt,one)=>{u();"use strict";var rne=me(),KYe=Object.assign(rne("libp2p-pubsub:peer-streams"),{error:rne("libp2p-pubsub:peer-streams:err")}),{EventEmitter:jYe}=br(),ine=To(),VYe=Ra(),{pipe:nne}=Gr(),{source:zYe}=Da(),HYe=vl().default,sne=class extends jYe{constructor({id:e,protocol:t}){super();this.id=e,this.protocol=t,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new HYe,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let t=this.id.toB58String();throw new Error("No writable connection to "+t)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=zYe(nne(this._rawInboundStream,ine.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let t=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=VYe({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),nne(this.outboundStream,ine.encode(),this._rawOutboundStream).catch(i=>{KYe.error(i)}),t||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};one.exports=sne});var une=p(cne=>{u();"use strict";var $Ye={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};cne.SignaturePolicy=$Ye});var nT=p((YTt,hne)=>{u();"use strict";var GYe=gy(),WYe=Ze(),lne=ct(),fne=rt(),{sha256:YYe}=(Hr(),Ir),XYe=()=>GYe(8),QYe=(r,e)=>{let t;r instanceof Uint8Array?t=fne.createFromBytes(r).id:t=fne.parse(r).id;let i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i},JYe=r=>YYe.encode(r),ZYe=(r,e)=>{let t;Array.isArray(e)?t=i=>e.indexOf(i)>-1:t=i=>e.has(i);for(let i of r)if(t(i))return!0;return!1},eXe=r=>Array.isArray(r)?r:[r],tXe=(r,e)=>{let t=Object.assign({},r);return r.from instanceof Uint8Array&&(t.from=WYe(r.from,"base58btc")),e&&(t.receivedFrom=e),t},rXe=r=>{let e=Object.assign({},r);return typeof r.from=="string"&&(e.from=lne(r.from,"base58btc")),typeof r.data=="string"&&(e.data=lne(r.data)),e};hne.exports={randomSeqno:XYe,msgId:QYe,noSignMsgId:JYe,anyMatch:ZYe,ensureArray:eXe,normalizeInRpcMessage:tXe,normalizeOutRpcMessage:rXe}});var bne=p((XTt,gne)=>{u();"use strict";var sT=rt(),{RPC:dne}=Y5(),pne=_n(),iXe=ct(),oT=iXe("libp2p-pubsub:"),{normalizeOutRpcMessage:nXe}=nT();async function sXe(r,e){let t=pne([oT,dne.Message.encode(nXe(e)).finish()]),i=await r.privKey.sign(t);return{...e,signature:i,key:r.pubKey.bytes}}async function oXe(r){if(!r.signature)throw new Error("Message must contain a signature to be verified");if(!r.from)throw new Error("Message must contain a from property to be verified");let e=pne([oT,dne.Message.encode({...r,from:sT.createFromB58String(r.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await yne(r)).verify(e,r.signature)}async function yne(r){if(!r.from)throw new Error("Could not get the public key from the originator id");let e=sT.createFromB58String(r.from);if(r.key){let t=await sT.createFromPubKey(r.key);if(t.equals(e))return t.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}gne.exports={messagePublicKey:yne,signMessage:sXe,SignPrefix:oT,verifySignature:oXe}});var _ne=p((QTt,wne)=>{u();"use strict";var mne=me(),{EventEmitter:aXe}=br(),zn=ue(),{pipe:cXe}=Gr(),uXe=Q_(),{codes:Ro}=J_(),{RPC:vne}=Y5(),lXe=ane(),{SignaturePolicy:Pc}=une(),Wu=nT(),{signMessage:fXe,verifySignature:hXe}=bne(),r2=class extends aXe{constructor({debugName:e,multicodecs:t,libp2p:i,globalSignaturePolicy:n=Pc.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!t)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(mne(e),{err:mne(`${e}:error`)}),this.multicodecs=Wu.ensureArray(t),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!Pc[n])throw zn(new Error("Invalid global signature policy"),Ro.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new uXe({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(e),this.log("started"),this.started=!0}stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:t,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),a=o.attachInboundStream(t);this._processMessages(s,a,o)}async _onPeerConnected(e,t){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await t.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,t){let i=e.toB58String();this.log("connection ended",i,t?t.message:""),this._removePeer(e)}_addPeer(e,t){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new lXe({id:e,protocol:t});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let t=e.toB58String(),i=this.peers.get(t);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",t),this.peers.delete(t);for(let n of this.topics.values())n.delete(t);return i}}async _processMessages(e,t,i){try{await cXe(t,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);await this._processRpc(e,i,a)}})}catch(n){this._onPeerDisconnected(i.id,n)}}async _processRpc(e,t,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;if(n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",t.id,n)),!this._acceptFrom(e))return this.log("received message from unacceptable peer %s",e),!1;if(s.length)for(let o of s){if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(c=>this.subscriptions.has(c)))){this.log("received message we didn't subscribe to. Dropping.");continue}let a=Wu.normalizeInRpcMessage(o,e);await this._processRpcMessage(a)}return!0}_processRpcSubOpt(e,t){let i=t.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),t.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(t){this.log("Message is invalid, dropping it. %O",t);return}return this._emitMessage(e),this._publish(Wu.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(t=>{this.subscriptions.has(t)&&this.emit(t,e)})}getMsgId(e){let t=this.globalSignaturePolicy;switch(t){case Pc.StrictSign:return Wu.msgId(e.from,e.seqno);case Pc.StrictNoSign:return Wu.noSignMsgId(e.data);default:throw zn(new Error("Cannot get message id: unhandled signature policy: "+t),Ro.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return vne.decode(e)}_encodeRpc(e){return vne.encode(e).finish()}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(t))}_sendSubscriptions(e,t,i){return this._sendRpc(e,{subscriptions:t.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let t=this.globalSignaturePolicy;switch(t){case Pc.StrictNoSign:if(e.from)throw zn(new Error("StrictNoSigning: from should not be present"),Ro.ERR_UNEXPECTED_FROM);if(e.signature)throw zn(new Error("StrictNoSigning: signature should not be present"),Ro.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw zn(new Error("StrictNoSigning: key should not be present"),Ro.ERR_UNEXPECTED_KEY);if(e.seqno)throw zn(new Error("StrictNoSigning: seqno should not be present"),Ro.ERR_UNEXPECTED_SEQNO);break;case Pc.StrictSign:if(!e.signature)throw zn(new Error("StrictSigning: Signing required and no signature was present"),Ro.ERR_MISSING_SIGNATURE);if(!e.seqno)throw zn(new Error("StrictSigning: Signing required and no seqno was present"),Ro.ERR_MISSING_SEQNO);if(!await hXe(e))throw zn(new Error("StrictSigning: Invalid message signature"),Ro.ERR_INVALID_SIGNATURE);break;default:throw zn(new Error("Cannot validate message: unhandled signature policy: "+t),Ro.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let t=this.globalSignaturePolicy;switch(t){case Pc.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=Wu.randomSeqno(),fXe(this.peerId,e);case Pc.StrictNoSign:return Promise.resolve(e);default:throw zn(new Error("Cannot build message: unhandled signature policy: "+t),Ro.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw zn(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw zn(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let t=this.topics.get(e);return t?Array.from(t):[]}async publish(e,t){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,t);let n={receivedFrom:this.peerId.toB58String(),data:t,topicIDs:[e]},s=await this._buildMessage(n),o=Wu.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw zn(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};r2.utils=Wu;r2.SignaturePolicy=Pc;wne.exports=r2});var Ene=p(i2=>{u();"use strict";Object.defineProperty(i2,"__esModule",{value:!0});i2.createGossipRpc=void 0;function dXe(r=[],e={}){return{subscriptions:[],msgs:r,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}i2.createGossipRpc=dXe});var Sne=p(n2=>{u();"use strict";Object.defineProperty(n2,"__esModule",{value:!0});n2.shuffle=void 0;function pXe(r){if(r.length<=1)return r;let e=()=>Math.floor(Math.random()*Math.floor(r.length));for(let t=0;t<r.length;t++){let i=e(),n=r[t];r[t]=r[i],r[i]=n}return r}n2.shuffle=pXe});var Of=p(Pe=>{u();"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.ERR_TOPIC_VALIDATOR_IGNORE=Pe.ERR_TOPIC_VALIDATOR_REJECT=Pe.TimeCacheDuration=Pe.GossipsubIWantFollowupTime=Pe.GossipsubMaxIHaveMessages=Pe.GossipsubMaxIHaveLength=Pe.GossipsubGraftFloodThreshold=Pe.GossipsubOpportunisticGraftPeers=Pe.GossipsubOpportunisticGraftTicks=Pe.GossipsubDirectConnectInitialDelay=Pe.GossipsubDirectConnectTicks=Pe.GossipsubConnectionTimeout=Pe.GossipsubMaxPendingConnections=Pe.GossipsubConnectors=Pe.GossipsubPruneBackoffTicks=Pe.GossipsubPruneBackoff=Pe.GossipsubPrunePeers=Pe.GossipsubFanoutTTL=Pe.GossipsubHeartbeatInterval=Pe.GossipsubHeartbeatInitialDelay=Pe.GossipsubGossipRetransmission=Pe.GossipsubGossipFactor=Pe.GossipsubDlazy=Pe.GossipsubHistoryGossip=Pe.GossipsubHistoryLength=Pe.GossipsubDout=Pe.GossipsubDscore=Pe.GossipsubDhi=Pe.GossipsubDlo=Pe.GossipsubD=Pe.GossipsubIDv11=Pe.GossipsubIDv10=Pe.FloodsubID=Pe.minute=Pe.second=void 0;Pe.second=1e3;Pe.minute=60*Pe.second;Pe.FloodsubID="/floodsub/1.0.0";Pe.GossipsubIDv10="/meshsub/1.0.0";Pe.GossipsubIDv11="/meshsub/1.1.0";Pe.GossipsubD=6;Pe.GossipsubDlo=4;Pe.GossipsubDhi=12;Pe.GossipsubDscore=4;Pe.GossipsubDout=2;Pe.GossipsubHistoryLength=5;Pe.GossipsubHistoryGossip=3;Pe.GossipsubDlazy=6;Pe.GossipsubGossipFactor=.25;Pe.GossipsubGossipRetransmission=3;Pe.GossipsubHeartbeatInitialDelay=100;Pe.GossipsubHeartbeatInterval=Pe.second;Pe.GossipsubFanoutTTL=Pe.minute;Pe.GossipsubPrunePeers=16;Pe.GossipsubPruneBackoff=Pe.minute;Pe.GossipsubPruneBackoffTicks=15;Pe.GossipsubConnectors=8;Pe.GossipsubMaxPendingConnections=128;Pe.GossipsubConnectionTimeout=30*Pe.second;Pe.GossipsubDirectConnectTicks=300;Pe.GossipsubDirectConnectInitialDelay=Pe.second;Pe.GossipsubOpportunisticGraftTicks=60;Pe.GossipsubOpportunisticGraftPeers=2;Pe.GossipsubGraftFloodThreshold=10*Pe.second;Pe.GossipsubMaxIHaveLength=5e3;Pe.GossipsubMaxIHaveMessages=10;Pe.GossipsubIWantFollowupTime=3*Pe.second;Pe.TimeCacheDuration=120*1e3;Pe.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";Pe.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"});var xne=p(s2=>{u();"use strict";Object.defineProperty(s2,"__esModule",{value:!0});s2.hasGossipProtocol=void 0;var Ane=Of();function yXe(r){return r===Ane.GossipsubIDv10||r===Ane.GossipsubIDv11}s2.hasGossipProtocol=yXe});var Ine=p(o2=>{u();"use strict";Object.defineProperty(o2,"__esModule",{value:!0});o2.messageIdToString=void 0;var gXe=Ze();function bXe(r){return gXe(r,"base64")}o2.messageIdToString=bXe});var qf=p(Ma=>{u();"use strict";var mXe=Ma&&Ma.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),a2=Ma&&Ma.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&mXe(e,r,t)};Object.defineProperty(Ma,"__esModule",{value:!0});a2(Ene(),Ma);a2(Sne(),Ma);a2(xne(),Ma);a2(Ine(),Ma)});var Rne=p(u2=>{u();"use strict";Object.defineProperty(u2,"__esModule",{value:!0});u2.MessageCache=void 0;var c2=qf(),Tne=class{constructor(e,t,i){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let n=0;n<t;n++)this.history[n]=[];this.gossip=e,this.msgIdFn=i}put(e){let t=this.getMsgId(e),i=c2.messageIdToString(t);this.msgs.set(i,e),this.history[0].push({msgID:t,topics:e.topicIDs})}getMsgId(e){return this.msgIdFn(e)}get(e){return this.msgs.get(c2.messageIdToString(e))}getForPeer(e,t){let i=c2.messageIdToString(e),n=this.msgs.get(i);if(!n)return[void 0,0];let s=this.peertx.get(i);s||(s=new Map,this.peertx.set(i,s));let o=(s.get(t)||0)+1;return s.set(t,o),[n,o]}getGossipIDs(e){let t=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){t.push(n.msgID);break}});return t}shift(){this.history[this.history.length-1].forEach(t=>{let i=c2.messageIdToString(t.msgID);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};u2.MessageCache=Tne});var Cne=p((Pne,ub)=>{u();(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Ho=="function"&&typeof ub=="object"&&ub&&ub.exports&&(ub.exports=e(Pi()))})(Pne,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots.default||(r.roots.default={});return n.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),f=0;f<c.length;++f)a[c[f]]!=null&&(this[c[f]]=a[c[f]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(c,f){if(f||(f=t.create()),c.subscriptions!=null&&c.subscriptions.length)for(var l=0;l<c.subscriptions.length;++l)n.RPC.SubOpts.encode(c.subscriptions[l],f.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var l=0;l<c.msgs.length;++l)n.RPC.Message.encode(c.msgs[l],f.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,f.uint32(26).fork()).ldelim(),f},s.decode=function(c,f){c instanceof e||(c=e.create(c));for(var l=f===void 0?c.len:c.pos+f,h=new n.RPC;c.pos<l;){var d=c.uint32();switch(d>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:h.msgs&&h.msgs.length||(h.msgs=[]),h.msgs.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:h.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(d&7);break}}return h},s.fromObject=function(c){if(c instanceof n.RPC)return c;var f=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");f.subscriptions=[];for(var l=0;l<c.subscriptions.length;++l){if(typeof c.subscriptions[l]!="object")throw TypeError(".RPC.subscriptions: object expected");f.subscriptions[l]=n.RPC.SubOpts.fromObject(c.subscriptions[l])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");f.msgs=[];for(var l=0;l<c.msgs.length;++l){if(typeof c.msgs[l]!="object")throw TypeError(".RPC.msgs: object expected");f.msgs[l]=n.RPC.Message.fromObject(c.msgs[l])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");f.control=n.RPC.ControlMessage.fromObject(c.control)}return f},s.toObject=function(c,f){f||(f={});var l={};if((f.arrays||f.defaults)&&(l.subscriptions=[],l.msgs=[]),c.subscriptions&&c.subscriptions.length){l.subscriptions=[];for(var h=0;h<c.subscriptions.length;++h)l.subscriptions[h]=n.RPC.SubOpts.toObject(c.subscriptions[h],f)}if(c.msgs&&c.msgs.length){l.msgs=[];for(var h=0;h<c.msgs.length;++h)l.msgs[h]=n.RPC.Message.toObject(c.msgs[h],f)}return c.control!=null&&c.hasOwnProperty("control")&&(l.control=n.RPC.ControlMessage.toObject(c.control,f),f.oneofs&&(l._control="control")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},s.SubOpts=function(){function a(f){if(f)for(var l=Object.keys(f),h=0;h<l.length;++h)f[l[h]]!=null&&(this[l[h]]=f[l[h]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,h){return h||(h=t.create()),l.subscribe!=null&&Object.hasOwnProperty.call(l,"subscribe")&&h.uint32(8).bool(l.subscribe),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&h.uint32(18).string(l.topicID),h},a.decode=function(l,h){l instanceof e||(l=e.create(l));for(var d=h===void 0?l.len:l.pos+h,y=new n.RPC.SubOpts;l.pos<d;){var g=l.uint32();switch(g>>>3){case 1:y.subscribe=l.bool();break;case 2:y.topicID=l.string();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.SubOpts)return l;var h=new n.RPC.SubOpts;return l.subscribe!=null&&(h.subscribe=Boolean(l.subscribe)),l.topicID!=null&&(h.topicID=String(l.topicID)),h},a.toObject=function(l,h){h||(h={});var d={};return l.subscribe!=null&&l.hasOwnProperty("subscribe")&&(d.subscribe=l.subscribe,h.oneofs&&(d._subscribe="subscribe")),l.topicID!=null&&l.hasOwnProperty("topicID")&&(d.topicID=l.topicID,h.oneofs&&(d._topicID="topicID")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.Message=function(){function a(f){if(this.topicIDs=[],f)for(var l=Object.keys(f),h=0;h<l.length;++h)f[l[h]]!=null&&(this[l[h]]=f[l[h]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=i.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),a.encode=function(l,h){if(h||(h=t.create()),l.from!=null&&Object.hasOwnProperty.call(l,"from")&&h.uint32(10).bytes(l.from),l.data!=null&&Object.hasOwnProperty.call(l,"data")&&h.uint32(18).bytes(l.data),l.seqno!=null&&Object.hasOwnProperty.call(l,"seqno")&&h.uint32(26).bytes(l.seqno),l.topicIDs!=null&&l.topicIDs.length)for(var d=0;d<l.topicIDs.length;++d)h.uint32(34).string(l.topicIDs[d]);return l.signature!=null&&Object.hasOwnProperty.call(l,"signature")&&h.uint32(42).bytes(l.signature),l.key!=null&&Object.hasOwnProperty.call(l,"key")&&h.uint32(50).bytes(l.key),h},a.decode=function(l,h){l instanceof e||(l=e.create(l));for(var d=h===void 0?l.len:l.pos+h,y=new n.RPC.Message;l.pos<d;){var g=l.uint32();switch(g>>>3){case 1:y.from=l.bytes();break;case 2:y.data=l.bytes();break;case 3:y.seqno=l.bytes();break;case 4:y.topicIDs&&y.topicIDs.length||(y.topicIDs=[]),y.topicIDs.push(l.string());break;case 5:y.signature=l.bytes();break;case 6:y.key=l.bytes();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.Message)return l;var h=new n.RPC.Message;if(l.from!=null&&(typeof l.from=="string"?i.base64.decode(l.from,h.from=i.newBuffer(i.base64.length(l.from)),0):l.from.length&&(h.from=l.from)),l.data!=null&&(typeof l.data=="string"?i.base64.decode(l.data,h.data=i.newBuffer(i.base64.length(l.data)),0):l.data.length&&(h.data=l.data)),l.seqno!=null&&(typeof l.seqno=="string"?i.base64.decode(l.seqno,h.seqno=i.newBuffer(i.base64.length(l.seqno)),0):l.seqno.length&&(h.seqno=l.seqno)),l.topicIDs){if(!Array.isArray(l.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");h.topicIDs=[];for(var d=0;d<l.topicIDs.length;++d)h.topicIDs[d]=String(l.topicIDs[d])}return l.signature!=null&&(typeof l.signature=="string"?i.base64.decode(l.signature,h.signature=i.newBuffer(i.base64.length(l.signature)),0):l.signature.length&&(h.signature=l.signature)),l.key!=null&&(typeof l.key=="string"?i.base64.decode(l.key,h.key=i.newBuffer(i.base64.length(l.key)),0):l.key.length&&(h.key=l.key)),h},a.toObject=function(l,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.topicIDs=[]),l.from!=null&&l.hasOwnProperty("from")&&(d.from=h.bytes===String?i.base64.encode(l.from,0,l.from.length):h.bytes===Array?Array.prototype.slice.call(l.from):l.from,h.oneofs&&(d._from="from")),l.data!=null&&l.hasOwnProperty("data")&&(d.data=h.bytes===String?i.base64.encode(l.data,0,l.data.length):h.bytes===Array?Array.prototype.slice.call(l.data):l.data,h.oneofs&&(d._data="data")),l.seqno!=null&&l.hasOwnProperty("seqno")&&(d.seqno=h.bytes===String?i.base64.encode(l.seqno,0,l.seqno.length):h.bytes===Array?Array.prototype.slice.call(l.seqno):l.seqno,h.oneofs&&(d._seqno="seqno")),l.topicIDs&&l.topicIDs.length){d.topicIDs=[];for(var y=0;y<l.topicIDs.length;++y)d.topicIDs[y]=l.topicIDs[y]}return l.signature!=null&&l.hasOwnProperty("signature")&&(d.signature=h.bytes===String?i.base64.encode(l.signature,0,l.signature.length):h.bytes===Array?Array.prototype.slice.call(l.signature):l.signature,h.oneofs&&(d._signature="signature")),l.key!=null&&l.hasOwnProperty("key")&&(d.key=h.bytes===String?i.base64.encode(l.key,0,l.key.length):h.bytes===Array?Array.prototype.slice.call(l.key):l.key,h.oneofs&&(d._key="key")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var f=Object.keys(c),l=0;l<f.length;++l)c[f[l]]!=null&&(this[f[l]]=c[f[l]])}return a.prototype.ihave=i.emptyArray,a.prototype.iwant=i.emptyArray,a.prototype.graft=i.emptyArray,a.prototype.prune=i.emptyArray,a.encode=function(f,l){if(l||(l=t.create()),f.ihave!=null&&f.ihave.length)for(var h=0;h<f.ihave.length;++h)n.RPC.ControlIHave.encode(f.ihave[h],l.uint32(10).fork()).ldelim();if(f.iwant!=null&&f.iwant.length)for(var h=0;h<f.iwant.length;++h)n.RPC.ControlIWant.encode(f.iwant[h],l.uint32(18).fork()).ldelim();if(f.graft!=null&&f.graft.length)for(var h=0;h<f.graft.length;++h)n.RPC.ControlGraft.encode(f.graft[h],l.uint32(26).fork()).ldelim();if(f.prune!=null&&f.prune.length)for(var h=0;h<f.prune.length;++h)n.RPC.ControlPrune.encode(f.prune[h],l.uint32(34).fork()).ldelim();return l},a.decode=function(f,l){f instanceof e||(f=e.create(f));for(var h=l===void 0?f.len:f.pos+l,d=new n.RPC.ControlMessage;f.pos<h;){var y=f.uint32();switch(y>>>3){case 1:d.ihave&&d.ihave.length||(d.ihave=[]),d.ihave.push(n.RPC.ControlIHave.decode(f,f.uint32()));break;case 2:d.iwant&&d.iwant.length||(d.iwant=[]),d.iwant.push(n.RPC.ControlIWant.decode(f,f.uint32()));break;case 3:d.graft&&d.graft.length||(d.graft=[]),d.graft.push(n.RPC.ControlGraft.decode(f,f.uint32()));break;case 4:d.prune&&d.prune.length||(d.prune=[]),d.prune.push(n.RPC.ControlPrune.decode(f,f.uint32()));break;default:f.skipType(y&7);break}}return d},a.fromObject=function(f){if(f instanceof n.RPC.ControlMessage)return f;var l=new n.RPC.ControlMessage;if(f.ihave){if(!Array.isArray(f.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");l.ihave=[];for(var h=0;h<f.ihave.length;++h){if(typeof f.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");l.ihave[h]=n.RPC.ControlIHave.fromObject(f.ihave[h])}}if(f.iwant){if(!Array.isArray(f.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");l.iwant=[];for(var h=0;h<f.iwant.length;++h){if(typeof f.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");l.iwant[h]=n.RPC.ControlIWant.fromObject(f.iwant[h])}}if(f.graft){if(!Array.isArray(f.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");l.graft=[];for(var h=0;h<f.graft.length;++h){if(typeof f.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");l.graft[h]=n.RPC.ControlGraft.fromObject(f.graft[h])}}if(f.prune){if(!Array.isArray(f.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");l.prune=[];for(var h=0;h<f.prune.length;++h){if(typeof f.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");l.prune[h]=n.RPC.ControlPrune.fromObject(f.prune[h])}}return l},a.toObject=function(f,l){l||(l={});var h={};if((l.arrays||l.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),f.ihave&&f.ihave.length){h.ihave=[];for(var d=0;d<f.ihave.length;++d)h.ihave[d]=n.RPC.ControlIHave.toObject(f.ihave[d],l)}if(f.iwant&&f.iwant.length){h.iwant=[];for(var d=0;d<f.iwant.length;++d)h.iwant[d]=n.RPC.ControlIWant.toObject(f.iwant[d],l)}if(f.graft&&f.graft.length){h.graft=[];for(var d=0;d<f.graft.length;++d)h.graft[d]=n.RPC.ControlGraft.toObject(f.graft[d],l)}if(f.prune&&f.prune.length){h.prune=[];for(var d=0;d<f.prune.length;++d)h.prune[d]=n.RPC.ControlPrune.toObject(f.prune[d],l)}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(f){if(this.messageIDs=[],f)for(var l=Object.keys(f),h=0;h<l.length;++h)f[l[h]]!=null&&(this[l[h]]=f[l[h]])}a.prototype.topicID=null,a.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,h){if(h||(h=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&h.uint32(10).string(l.topicID),l.messageIDs!=null&&l.messageIDs.length)for(var d=0;d<l.messageIDs.length;++d)h.uint32(18).bytes(l.messageIDs[d]);return h},a.decode=function(l,h){l instanceof e||(l=e.create(l));for(var d=h===void 0?l.len:l.pos+h,y=new n.RPC.ControlIHave;l.pos<d;){var g=l.uint32();switch(g>>>3){case 1:y.topicID=l.string();break;case 2:y.messageIDs&&y.messageIDs.length||(y.messageIDs=[]),y.messageIDs.push(l.bytes());break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.ControlIHave)return l;var h=new n.RPC.ControlIHave;if(l.topicID!=null&&(h.topicID=String(l.topicID)),l.messageIDs){if(!Array.isArray(l.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var d=0;d<l.messageIDs.length;++d)typeof l.messageIDs[d]=="string"?i.base64.decode(l.messageIDs[d],h.messageIDs[d]=i.newBuffer(i.base64.length(l.messageIDs[d])),0):l.messageIDs[d].length&&(h.messageIDs[d]=l.messageIDs[d])}return h},a.toObject=function(l,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.messageIDs=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(d.topicID=l.topicID,h.oneofs&&(d._topicID="topicID")),l.messageIDs&&l.messageIDs.length){d.messageIDs=[];for(var y=0;y<l.messageIDs.length;++y)d.messageIDs[y]=h.bytes===String?i.base64.encode(l.messageIDs[y],0,l.messageIDs[y].length):h.bytes===Array?Array.prototype.slice.call(l.messageIDs[y]):l.messageIDs[y]}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var f=Object.keys(c),l=0;l<f.length;++l)c[f[l]]!=null&&(this[f[l]]=c[f[l]])}return a.prototype.messageIDs=i.emptyArray,a.encode=function(f,l){if(l||(l=t.create()),f.messageIDs!=null&&f.messageIDs.length)for(var h=0;h<f.messageIDs.length;++h)l.uint32(10).bytes(f.messageIDs[h]);return l},a.decode=function(f,l){f instanceof e||(f=e.create(f));for(var h=l===void 0?f.len:f.pos+l,d=new n.RPC.ControlIWant;f.pos<h;){var y=f.uint32();switch(y>>>3){case 1:d.messageIDs&&d.messageIDs.length||(d.messageIDs=[]),d.messageIDs.push(f.bytes());break;default:f.skipType(y&7);break}}return d},a.fromObject=function(f){if(f instanceof n.RPC.ControlIWant)return f;var l=new n.RPC.ControlIWant;if(f.messageIDs){if(!Array.isArray(f.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");l.messageIDs=[];for(var h=0;h<f.messageIDs.length;++h)typeof f.messageIDs[h]=="string"?i.base64.decode(f.messageIDs[h],l.messageIDs[h]=i.newBuffer(i.base64.length(f.messageIDs[h])),0):f.messageIDs[h].length&&(l.messageIDs[h]=f.messageIDs[h])}return l},a.toObject=function(f,l){l||(l={});var h={};if((l.arrays||l.defaults)&&(h.messageIDs=[]),f.messageIDs&&f.messageIDs.length){h.messageIDs=[];for(var d=0;d<f.messageIDs.length;++d)h.messageIDs[d]=l.bytes===String?i.base64.encode(f.messageIDs[d],0,f.messageIDs[d].length):l.bytes===Array?Array.prototype.slice.call(f.messageIDs[d]):f.messageIDs[d]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(f){if(f)for(var l=Object.keys(f),h=0;h<l.length;++h)f[l[h]]!=null&&(this[l[h]]=f[l[h]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,h){return h||(h=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&h.uint32(10).string(l.topicID),h},a.decode=function(l,h){l instanceof e||(l=e.create(l));for(var d=h===void 0?l.len:l.pos+h,y=new n.RPC.ControlGraft;l.pos<d;){var g=l.uint32();switch(g>>>3){case 1:y.topicID=l.string();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.ControlGraft)return l;var h=new n.RPC.ControlGraft;return l.topicID!=null&&(h.topicID=String(l.topicID)),h},a.toObject=function(l,h){h||(h={});var d={};return l.topicID!=null&&l.hasOwnProperty("topicID")&&(d.topicID=l.topicID,h.oneofs&&(d._topicID="topicID")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(f){if(this.peers=[],f)for(var l=Object.keys(f),h=0;h<l.length;++h)f[l[h]]!=null&&(this[l[h]]=f[l[h]])}a.prototype.topicID=null,a.prototype.peers=i.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),a.encode=function(l,h){if(h||(h=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&h.uint32(10).string(l.topicID),l.peers!=null&&l.peers.length)for(var d=0;d<l.peers.length;++d)n.RPC.PeerInfo.encode(l.peers[d],h.uint32(18).fork()).ldelim();return l.backoff!=null&&Object.hasOwnProperty.call(l,"backoff")&&h.uint32(24).uint64(l.backoff),h},a.decode=function(l,h){l instanceof e||(l=e.create(l));for(var d=h===void 0?l.len:l.pos+h,y=new n.RPC.ControlPrune;l.pos<d;){var g=l.uint32();switch(g>>>3){case 1:y.topicID=l.string();break;case 2:y.peers&&y.peers.length||(y.peers=[]),y.peers.push(n.RPC.PeerInfo.decode(l,l.uint32()));break;case 3:y.backoff=l.uint64();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.ControlPrune)return l;var h=new n.RPC.ControlPrune;if(l.topicID!=null&&(h.topicID=String(l.topicID)),l.peers){if(!Array.isArray(l.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var d=0;d<l.peers.length;++d){if(typeof l.peers[d]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[d]=n.RPC.PeerInfo.fromObject(l.peers[d])}}return l.backoff!=null&&(i.Long?(h.backoff=i.Long.fromValue(l.backoff)).unsigned=!0:typeof l.backoff=="string"?h.backoff=parseInt(l.backoff,10):typeof l.backoff=="number"?h.backoff=l.backoff:typeof l.backoff=="object"&&(h.backoff=new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0))),h},a.toObject=function(l,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.peers=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(d.topicID=l.topicID,h.oneofs&&(d._topicID="topicID")),l.peers&&l.peers.length){d.peers=[];for(var y=0;y<l.peers.length;++y)d.peers[y]=n.RPC.PeerInfo.toObject(l.peers[y],h)}return l.backoff!=null&&l.hasOwnProperty("backoff")&&(typeof l.backoff=="number"?d.backoff=h.longs===String?String(l.backoff):l.backoff:d.backoff=h.longs===String?i.Long.prototype.toString.call(l.backoff):h.longs===Number?new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0):l.backoff,h.oneofs&&(d._backoff="backoff")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(f){if(f)for(var l=Object.keys(f),h=0;h<l.length;++h)f[l[h]]!=null&&(this[l[h]]=f[l[h]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),a.encode=function(l,h){return h||(h=t.create()),l.peerID!=null&&Object.hasOwnProperty.call(l,"peerID")&&h.uint32(10).bytes(l.peerID),l.signedPeerRecord!=null&&Object.hasOwnProperty.call(l,"signedPeerRecord")&&h.uint32(18).bytes(l.signedPeerRecord),h},a.decode=function(l,h){l instanceof e||(l=e.create(l));for(var d=h===void 0?l.len:l.pos+h,y=new n.RPC.PeerInfo;l.pos<d;){var g=l.uint32();switch(g>>>3){case 1:y.peerID=l.bytes();break;case 2:y.signedPeerRecord=l.bytes();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.PeerInfo)return l;var h=new n.RPC.PeerInfo;return l.peerID!=null&&(typeof l.peerID=="string"?i.base64.decode(l.peerID,h.peerID=i.newBuffer(i.base64.length(l.peerID)),0):l.peerID.length&&(h.peerID=l.peerID)),l.signedPeerRecord!=null&&(typeof l.signedPeerRecord=="string"?i.base64.decode(l.signedPeerRecord,h.signedPeerRecord=i.newBuffer(i.base64.length(l.signedPeerRecord)),0):l.signedPeerRecord.length&&(h.signedPeerRecord=l.signedPeerRecord)),h},a.toObject=function(l,h){h||(h={});var d={};return l.peerID!=null&&l.hasOwnProperty("peerID")&&(d.peerID=h.bytes===String?i.base64.encode(l.peerID,0,l.peerID.length):h.bytes===Array?Array.prototype.slice.call(l.peerID):l.peerID,h.oneofs&&(d._peerID="peerID")),l.signedPeerRecord!=null&&l.hasOwnProperty("signedPeerRecord")&&(d.signedPeerRecord=h.bytes===String?i.base64.encode(l.signedPeerRecord,0,l.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(l.signedPeerRecord):l.signedPeerRecord,h.oneofs&&(d._signedPeerRecord="signedPeerRecord")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s}(),n})});var aT=p(l2=>{u();"use strict";Object.defineProperty(l2,"__esModule",{value:!0});l2.getGossipPeers=void 0;var One=qf();function vXe(r,e,t,i=()=>!0){let n=r.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let a=r.peers.get(o);!a||One.hasGossipProtocol(a.protocol)&&i(o)&&s.push(o)}),s=One.shuffle(s),t>0&&s.length>t&&(s=s.slice(0,t)),new Set(s)}l2.getGossipPeers=vXe});var kne=p(La=>{u();"use strict";var wXe=La&&La.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),_Xe=La&&La.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),EXe=La&&La.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&wXe(e,r,t);return _Xe(e,r),e};Object.defineProperty(La,"__esModule",{value:!0});La.Heartbeat=void 0;var lb=EXe(Of()),f2=aT(),SXe=qf(),qne=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),t=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,lb.GossipsubHeartbeatInterval)},lb.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(t),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:t,Dhi:i,Dscore:n,Dout:s}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let o=new Map,a=d=>{let y=o.get(d);return y===void 0&&(y=this.gossipsub.score.score(d),o.set(d,y)),y},c=new Map,f=new Map,l=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((d,y)=>{let g=E=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",E,y),this.gossipsub.score.prune(E,y),this.gossipsub._addBackoff(E,y),d.delete(E);let _=f.get(E);_?_.push(y):f.set(E,[y])},m=E=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",E,y),this.gossipsub.score.graft(E,y),d.add(E);let _=c.get(E);_?_.push(y):c.set(E,[y])};if(d.forEach(E=>{let _=a(E);_<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",E,_,y),g(E),l.set(E,!0))}),d.size<t){let E=this.gossipsub.backoff.get(y),_=e-d.size;f2.getGossipPeers(this.gossipsub,y,_,q=>!d.has(q)&&!this.gossipsub.direct.has(q)&&(!E||!E.has(q))&&a(q)>=0).forEach(m)}if(d.size>i){let E=Array.from(d);E.sort((T,q)=>a(q)-a(T)),E=E.slice(0,n).concat(SXe.shuffle(E.slice(n)));let _=0;if(E.slice(0,e).forEach(T=>{this.gossipsub.outbound.get(T)&&_++}),_<s){let T=z=>{let V=E[z];for(let M=z;M>0;M--)E[M]=E[M-1];E[0]=V};if(_>0){let z=_;for(let V=1;V<e&&z>0;V++)this.gossipsub.outbound.get(E[V])&&(T(V),z--)}let q=e-_;for(let z=e;z<E.length&&q>0;z++)this.gossipsub.outbound.get(E[z])&&(T(z),q--)}E.slice(e).forEach(g)}if(d.size>=t){let E=0;if(d.forEach(_=>{this.gossipsub.outbound.get(_)&&E++}),E<s){let _=s-E,T=this.gossipsub.backoff.get(y);f2.getGossipPeers(this.gossipsub,y,_,q=>!d.has(q)&&!this.gossipsub.direct.has(q)&&(!T||!T.has(q))&&a(q)>=0).forEach(m)}}if(this.gossipsub.heartbeatTicks%lb.GossipsubOpportunisticGraftTicks==0&&d.size>1){let E=Array.from(d).sort((q,z)=>a(q)-a(z)),_=d.size/2,T=a(E[_]);if(T<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let q=this.gossipsub.backoff.get(y);f2.getGossipPeers(this.gossipsub,y,lb.GossipsubOpportunisticGraftPeers,V=>d.has(V)&&!this.gossipsub.direct.has(V)&&(!q||!q.has(V))&&a(V)>T).forEach(V=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",V,y),m(V)})}}this.gossipsub._emitGossip(y,d)});let h=this.gossipsub._now();this.gossipsub.lastpub.forEach((d,y)=>{d+lb.GossipsubFanoutTTL<h&&(this.gossipsub.fanout.delete(y),this.gossipsub.lastpub.delete(y))}),this.gossipsub.fanout.forEach((d,y)=>{let g=this.gossipsub.topics.get(y);if(d.forEach(m=>{(!g.has(m)||a(m)<this.gossipsub._options.scoreThresholds.publishThreshold)&&d.delete(m)}),d.size<e){let m=e-d.size;f2.getGossipPeers(this.gossipsub,y,m,_=>!d.has(_)&&!this.gossipsub.direct.has(_)&&a(_)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(_=>{d.add(_)})}this.gossipsub._emitGossip(y,d)}),this.gossipsub._sendGraftPrune(c,f,l),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};La.Heartbeat=qne});var cT=p(yp=>{u();"use strict";Object.defineProperty(yp,"__esModule",{value:!0});yp.ERR_INVALID_PEER_SCORE_THRESHOLDS=yp.ERR_INVALID_PEER_SCORE_PARAMS=void 0;yp.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";yp.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var uT=p(fn=>{u();"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.validateTopicScoreParams=fn.validatePeerScoreParams=fn.createTopicScoreParams=fn.createPeerScoreParams=fn.defaultTopicScoreParams=fn.defaultPeerScoreParams=void 0;var Xt=cT(),Qt=ue();fn.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};fn.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function AXe(r={}){return Object.assign(Object.assign(Object.assign({},fn.defaultPeerScoreParams),r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=Bne(i),e),{}):{}})}fn.createPeerScoreParams=AXe;function Bne(r={}){return Object.assign(Object.assign({},fn.defaultTopicScoreParams),r)}fn.createTopicScoreParams=Bne;function xXe(r){for(let[e,t]of Object.entries(r.topics))try{Nne(t)}catch(i){throw Qt(new Error(`invalid score parameters for topic ${e}: ${i.message}`),Xt.ERR_INVALID_PEER_SCORE_PARAMS)}if(r.topicScoreCap<0)throw Qt(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.appSpecificScore===null||r.appSpecificScore===void 0)throw Qt(new Error("missing application specific score function"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight>0)throw Qt(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight!==0&&r.IPColocationFactorThreshold<1)throw Qt(new Error("invalid IPColocationFactorThreshold; must be at least 1"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight>0)throw Qt(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight!==0&&(r.behaviourPenaltyDecay<=0||r.behaviourPenaltyDecay>=1))throw Qt(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayInterval<1e3)throw Qt(new Error("invalid DecayInterval; must be at least 1s"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayToZero<=0||r.decayToZero>=1)throw Qt(new Error("invalid DecayToZero; must be between 0 and 1"),Xt.ERR_INVALID_PEER_SCORE_PARAMS)}fn.validatePeerScoreParams=xXe;function Nne(r){if(r.topicWeight<0)throw Qt(new Error("invalid topic weight; must be >= 0"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshQuantum===0)throw Qt(new Error("invalid TimeInMeshQuantum; must be non zero"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight<0)throw Qt(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshQuantum<=0)throw Qt(new Error("invalid TimeInMeshQuantum; must be positive"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshCap<=0)throw Qt(new Error("invalid TimeInMeshCap; must be positive"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight<0)throw Qt(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&(r.firstMessageDeliveriesDecay<=0||r.firstMessageDeliveriesDecay>=1))throw Qt(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&r.firstMessageDeliveriesCap<=0)throw Qt(new Error("invalid FirstMessageDeliveriesCap; must be positive"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight>0)throw Qt(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&(r.meshMessageDeliveriesDecay<=0||r.meshMessageDeliveriesDecay>=1))throw Qt(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesCap<=0)throw Qt(new Error("invalid MeshMessageDeliveriesCap; must be positive"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesThreshold<=0)throw Qt(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWindow<0)throw Qt(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesActivation<1e3)throw Qt(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight>0)throw Qt(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight!==0&&(r.meshFailurePenaltyDecay<=0||r.meshFailurePenaltyDecay>=1))throw Qt(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesWeight>0)throw Qt(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),Xt.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesDecay<=0||r.invalidMessageDeliveriesDecay>=1)throw Qt(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),Xt.ERR_INVALID_PEER_SCORE_PARAMS)}fn.validateTopicScoreParams=Nne});var Dne=p(Cc=>{u();"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.validatePeerScoreThresholds=Cc.createPeerScoreThresholds=Cc.defaultPeerScoreThresholds=void 0;var fb=cT(),hb=ue();Cc.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function IXe(r={}){return Object.assign(Object.assign({},Cc.defaultPeerScoreThresholds),r)}Cc.createPeerScoreThresholds=IXe;function TXe(r){if(r.gossipThreshold>0)throw hb(new Error("invalid gossip threshold; it must be <= 0"),fb.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.publishThreshold>0||r.publishThreshold>r.gossipThreshold)throw hb(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),fb.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.graylistThreshold>0||r.graylistThreshold>r.publishThreshold)throw hb(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),fb.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.acceptPXThreshold<0)throw hb(new Error("invalid accept PX threshold; it must be >= 0"),fb.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.opportunisticGraftThreshold<0)throw hb(new Error("invalid opportunistic grafting threshold; it must be >= 0"),fb.ERR_INVALID_PEER_SCORE_THRESHOLDS)}Cc.validatePeerScoreThresholds=TXe});var Mne=p(Yu=>{u();"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});Yu.ensureTopicStats=Yu.createTopicStats=Yu.createPeerStats=void 0;function RXe(r={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=lT(i),e),{}):{}})}Yu.createPeerStats=RXe;function lT(r={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},r)}Yu.createTopicStats=lT;function PXe(r,e,t){let i=e.topics[r];if(i)return i;if(!!t.topics[r])return e.topics[r]=i=lT(),i}Yu.ensureTopicStats=PXe});var Lne=p(h2=>{u();"use strict";Object.defineProperty(h2,"__esModule",{value:!0});h2.computeScore=void 0;function CXe(r,e,t,i){let n=0;return Object.entries(e.topics).forEach(([a,c])=>{let f=t.topics[a];if(!f)return;let l=0;if(c.inMesh){let g=c.meshTime/f.timeInMeshQuantum;g>f.timeInMeshCap&&(g=f.timeInMeshCap),l+=g*f.timeInMeshWeight}if(l+=c.firstMessageDeliveries*f.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<f.meshMessageDeliveriesThreshold){let g=f.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;l+=g*g*f.meshMessageDeliveriesWeight}l+=c.meshFailurePenalty*f.meshFailurePenaltyWeight,l+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*f.invalidMessageDeliveriesWeight,n+=l*f.topicWeight}),t.topicScoreCap>0&&n>t.topicScoreCap&&(n=t.topicScoreCap),n+=t.appSpecificScore(r)*t.appSpecificWeight,e.ips.forEach(a=>{if(t.IPColocationFactorWhitelist.has(a))return;let c=i.get(a),f=c?c.size:0;if(f>t.IPColocationFactorThreshold){let l=f-t.IPColocationFactorThreshold;n+=l*l*t.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*t.behaviourPenaltyWeight,n}h2.computeScore=CXe});var Fne=p((hRt,Une)=>{u();"use strict";function Yr(r,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(r)&&this._fromArray(r)}Yr.prototype.peekAt=function(e){var t=e;if(t===(t|0)){var i=this.size();if(!(t>=i||t<-i))return t<0&&(t+=i),t=this._head+t&this._capacityMask,this._list[t]}};Yr.prototype.get=function(e){return this.peekAt(e)};Yr.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Yr.prototype.peekFront=function(){return this.peek()};Yr.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Yr.prototype,"length",{get:function(){return this.size()}});Yr.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Yr.prototype.unshift=function(e){if(e===void 0)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Yr.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}};Yr.prototype.push=function(e){if(e===void 0)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Yr.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),i}};Yr.prototype.removeOne=function(e){var t=e;if(t===(t|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(t>=i||t<-i)){t<0&&(t+=i),t=this._head+t&this._capacityMask;var s=this._list[t],o;if(e<i/2){for(o=e;o>0;o--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};Yr.prototype.remove=function(e,t){var i=e,n,s=t;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||t<1)){if(i<0&&(i+=o),t===1||!t)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+t>=o)return n=this.toArray(),this.clear(),n;i+t>o&&(t=o-i);var c;for(n=new Array(t),c=0;c<t;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+t===o){for(this._tail=this._tail-t+a&this._capacityMask,c=t;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+t+a&this._capacityMask,c=t-1;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+t+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+t+a&this._capacityMask,c=o-(t+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};Yr.prototype.splice=function(e,t){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,c=arguments.length,f=this._list.length,l=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(t===0?(a=[],i>0&&(this._head=this._head+i+f&this._capacityMask)):(a=this.remove(i,t),this._head=this._head+i+f&this._capacityMask);c>l;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+t));var h=o.length;for(s=0;s<h;s++)o[s]=this._list[this._head+i+t+s&this._capacityMask];for(t===0?(a=[],i!=n&&(this._tail=this._head+i+f&this._capacityMask)):(a=this.remove(i,t),this._tail=this._tail-h+f&this._capacityMask);l<c;)this.push(arguments[l++]);for(s=0;s<h;s++)this.push(o[s])}return a}else return this.remove(i,t)}};Yr.prototype.clear=function(){this._head=0,this._tail=0};Yr.prototype.isEmpty=function(){return this._head===this._tail};Yr.prototype.toArray=function(){return this._copyArray(!1)};Yr.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])};Yr.prototype._copyArray=function(e){var t=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)t.push(i[s]);for(s=0;s<this._tail;s++)t.push(i[s])}else for(s=this._head;s<this._tail;s++)t.push(i[s]);return t};Yr.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length*=2,this._capacityMask=this._capacityMask<<1|1};Yr.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Une.exports=Yr});var Vne=p(Oc=>{u();"use strict";var OXe=Oc&&Oc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Oc,"__esModule",{value:!0});Oc.MessageDeliveries=Oc.DeliveryRecordStatus=void 0;var qXe=Of(),kXe=OXe(Fne()),BXe=qf(),Kne;(function(r){r[r.unknown=0]="unknown",r[r.valid=1]="valid",r[r.invalid=2]="invalid",r[r.ignored=3]="ignored"})(Kne=Oc.DeliveryRecordStatus||(Oc.DeliveryRecordStatus={}));var jne=class{constructor(){this.records=new Map,this.queue=new kXe.default}ensureRecord(e){let t=BXe.messageIdToString(e),i=this.records.get(t);if(i)return i;i={status:Kne.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(t,i);let n={msgId:t,expire:Date.now()+qXe.TimeCacheDuration};return this.queue.push(n),i}gc(){let e=Date.now(),t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};Oc.MessageDeliveries=jne});var Hne=p(mp=>{u();"use strict";var NXe=mp&&mp.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(mp,"__esModule",{value:!0});mp.PeerScore=void 0;var DXe=uT(),gp=Mne(),MXe=Lne(),Po=Vne(),LXe=Of(),UXe=NXe(rt()),FXe=me(),KXe=J_(),{ERR_INVALID_SIGNATURE:jXe,ERR_MISSING_SIGNATURE:VXe}=KXe.codes,bp=FXe("libp2p:gossipsub:score"),zne=class{constructor(e,t,i){DXe.validatePeerScoreParams(e),this.params=e,this._connectionManager=t,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new Po.MessageDeliveries,this.msgId=i}start(){if(this._backgroundInterval){bp("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),bp("started")}stop(){if(!this._backgroundInterval){bp("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),bp("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<t&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<t&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<t&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<t&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<t&&(i.behaviourPenalty=0)})}score(e){let t=this.peerStats.get(e);return t?MXe.computeScore(e,t,this.params,this.peerIPs):0}addPenalty(e,t){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=t)}addPeer(e){let t=gp.createPeerStats({connected:!0});this.peerStats.set(e,t);let i=this._getIPs(e);this._setIPs(e,i,t.ips),t.ips=i}removePeer(e){let t=this.peerStats.get(e);if(!!t){if(this.score(e)>0){this._removeIPs(e,t.ips),this.peerStats.delete(e);return}Object.entries(t.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){let i=this.peerStats.get(e);if(!i)return;let n=gp.ensureTopicStats(t,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}prune(e,t){let i=this.peerStats.get(e);if(!i)return;let n=gp.ensureTopicStats(t,i,this.params);if(!n)return;let s=this.params.topics[t].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}validateMessage(e){this.deliveryRecords.ensureRecord(this.msgId(e))}deliverMessage(e){let t=e.receivedFrom;this._markFirstMessageDelivery(t,e);let i=this.deliveryRecords.ensureRecord(this.msgId(e)),n=Date.now();if(i.status!==Po.DeliveryRecordStatus.unknown){bp("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",t,n-i.firstSeen,Po.DeliveryRecordStatus[i.status]);return}i.status=Po.DeliveryRecordStatus.valid,i.validated=n,i.peers.forEach(s=>{s!==t&&this._markDuplicateMessageDelivery(s,e)})}rejectMessage(e,t){let i=e.receivedFrom;switch(t){case VXe:case jXe:this._markInvalidMessageDelivery(i,e);return}let n=this.deliveryRecords.ensureRecord(this.msgId(e));if(n.status!==Po.DeliveryRecordStatus.unknown){bp("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",i,Date.now()-n.firstSeen,Po.DeliveryRecordStatus[n.status]);return}switch(t){case LXe.ERR_TOPIC_VALIDATOR_IGNORE:n.status=Po.DeliveryRecordStatus.ignored;return}n.status=Po.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(i,e),n.peers.forEach(s=>{this._markInvalidMessageDelivery(s,e)})}duplicateMessage(e){let t=e.receivedFrom,i=this.deliveryRecords.ensureRecord(this.msgId(e));if(!i.peers.has(t))switch(i.status){case Po.DeliveryRecordStatus.unknown:i.peers.add(t);break;case Po.DeliveryRecordStatus.valid:i.peers.add(t),this._markDuplicateMessageDelivery(t,e,i.validated);break;case Po.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(t,e);break}}_markInvalidMessageDelivery(e,t){let i=this.peerStats.get(e);!i||t.topicIDs.forEach(n=>{let s=gp.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(e,t){let i=this.peerStats.get(e);!i||t.topicIDs.forEach(n=>{let s=gp.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))})}_markDuplicateMessageDelivery(e,t,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;t.topicIDs.forEach(o=>{let a=gp.ensureTopicStats(o,n,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(i&&s>i+c.meshMessageDeliveriesWindow)return;let f=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>f&&(a.meshMessageDeliveries=f)})}_getIPs(e){return this._connectionManager.getAll(UXe.default.createFromB58String(e)).map(t=>t.remoteAddr.toOptions().host)}_setIPs(e,t,i){e:for(let n of t){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of t)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}}_removeIPs(e,t){t.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))})}_updateIPs(){this.peerStats.forEach((e,t)=>{let i=this._getIPs(t);this._setIPs(t,i,e.ips),e.ips=i})}};mp.PeerScore=zne});var $ne=p(qc=>{u();"use strict";var zXe=qc&&qc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),fT=qc&&qc.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&zXe(e,r,t)};Object.defineProperty(qc,"__esModule",{value:!0});fT(uT(),qc);fT(Dne(),qc);fT(Hne(),qc)});var Wne=p(d2=>{u();"use strict";Object.defineProperty(d2,"__esModule",{value:!0});d2.IWantTracer=void 0;var HXe=Of(),hT=qf(),$Xe=J_(),{ERR_INVALID_SIGNATURE:GXe,ERR_MISSING_SIGNATURE:WXe}=$Xe.codes,Gne=class{constructor(e){this.getMsgId=e,this.promises=new Map}addPromise(e,t){let i=Math.floor(Math.random()*t.length),n=t[i],s=hT.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+HXe.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),t=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(t.set(o,(t.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),t}deliverMessage(e){let t=this.getMsgId(e),i=hT.messageIdToString(t);this.promises.delete(i)}rejectMessage(e,t){switch(t){case GXe:case WXe:return}let i=this.getMsgId(e),n=hT.messageIdToString(i);this.promises.delete(n)}clear(){this.promises.clear()}};d2.IWantTracer=Gne});var Zne=p((bRt,Jne)=>{u();var Yne="Expected a function",Xne=0/0,YXe="[object Symbol]",XXe=/^\s+|\s+$/g,QXe=/^[-+]0x[0-9a-f]+$/i,JXe=/^0b[01]+$/i,ZXe=/^0o[0-7]+$/i,eQe=parseInt,tQe=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,rQe=typeof self=="object"&&self&&self.Object===Object&&self,iQe=tQe||rQe||Function("return this")(),nQe=Object.prototype,sQe=nQe.toString,oQe=Math.max,aQe=Math.min,dT=function(){return iQe.Date.now()};function cQe(r,e,t){var i,n,s,o,a,c,f=0,l=!1,h=!1,d=!0;if(typeof r!="function")throw new TypeError(Yne);e=Qne(e)||0,p2(t)&&(l=!!t.leading,h="maxWait"in t,s=h?oQe(Qne(t.maxWait)||0,e):s,d="trailing"in t?!!t.trailing:d);function y(M){var $=i,X=n;return i=n=void 0,f=M,o=r.apply(X,$),o}function g(M){return f=M,a=setTimeout(_,e),l?y(M):o}function m(M){var $=M-c,X=M-f,Q=e-$;return h?aQe(Q,s-X):Q}function E(M){var $=M-c,X=M-f;return c===void 0||$>=e||$<0||h&&X>=s}function _(){var M=dT();if(E(M))return T(M);a=setTimeout(_,m(M))}function T(M){return a=void 0,d&&i?y(M):(i=n=void 0,o)}function q(){a!==void 0&&clearTimeout(a),f=0,i=c=n=a=void 0}function z(){return a===void 0?o:T(dT())}function V(){var M=dT(),$=E(M);if(i=arguments,n=this,c=M,$){if(a===void 0)return g(c);if(h)return a=setTimeout(_,e),y(c)}return a===void 0&&(a=setTimeout(_,e)),o}return V.cancel=q,V.flush=z,V}function uQe(r,e,t){var i=!0,n=!0;if(typeof r!="function")throw new TypeError(Yne);return p2(t)&&(i="leading"in t?!!t.leading:i,n="trailing"in t?!!t.trailing:n),cQe(r,e,{leading:i,maxWait:e,trailing:n})}function p2(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function lQe(r){return!!r&&typeof r=="object"}function fQe(r){return typeof r=="symbol"||lQe(r)&&sQe.call(r)==YXe}function Qne(r){if(typeof r=="number")return r;if(fQe(r))return Xne;if(p2(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=p2(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(XXe,"");var t=JXe.test(r);return t||ZXe.test(r)?eQe(r.slice(2),t?2:8):QXe.test(r)?Xne:+r}Jne.exports=uQe});var rse=p((ese,tse)=>{u();"use strict";var hQe=Zne();ese=tse.exports=pT;function pT(r){if(!(this instanceof pT))return new pT(r);r=r||{};let e=r.validity||30,t=new Map,i=hQe(()=>{t.forEach((n,s)=>{let o=n.validity||e;dQe(n.timestamp)>o&&t.delete(s)})},200);this.put=(n,s,o)=>{this.has(n)||t.set(n,{value:s,timestamp:new Date,validity:o}),i()},this.get=n=>{if(t.has(n))return t.get(n).value;throw new Error("key does not exist")},this.has=n=>t.has(n)}function dQe(r){let t=new Date().getTime()-r.getTime();return Math.floor(t/1e3)}});var di=p(yT=>{u();"use strict";yT.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"};yT.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}});var sse=p((vRt,nse)=>{u();"use strict";var vp=Pi(),ise=vp.Reader,pQe=vp.Writer,Er=vp.util,db=vp.roots["libp2p-envelope"]||(vp.roots["libp2p-envelope"]={});db.Envelope=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.publicKey=Er.newBuffer([]),r.prototype.payloadType=Er.newBuffer([]),r.prototype.payload=Er.newBuffer([]),r.prototype.signature=Er.newBuffer([]),r.encode=function(t,i){return i||(i=pQe.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&i.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&i.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(42).bytes(t.signature),i},r.decode=function(t,i){t instanceof ise||(t=ise.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new db.Envelope;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.publicKey=t.bytes();break;case 2:s.payloadType=t.bytes();break;case 3:s.payload=t.bytes();break;case 5:s.signature=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof db.Envelope)return t;var i=new db.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?Er.base64.decode(t.publicKey,i.publicKey=Er.newBuffer(Er.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?Er.base64.decode(t.payloadType,i.payloadType=Er.newBuffer(Er.base64.length(t.payloadType)),0):t.payloadType.length&&(i.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?Er.base64.decode(t.payload,i.payload=Er.newBuffer(Er.base64.length(t.payload)),0):t.payload.length&&(i.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?Er.base64.decode(t.signature,i.signature=Er.newBuffer(Er.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Er.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=Er.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=Er.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Er.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Er.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?Er.base64.encode(t.payloadType,0,t.payloadType.length):i.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=i.bytes===String?Er.base64.encode(t.payload,0,t.payload.length):i.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Er.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,vp.util.toJSONOptions)},r}();nse.exports=db});var pb=p((wRt,cse)=>{u();"use strict";var yQe=ue(),gQe=_n(),bQe=ct(),mQe=X1(),vQe=rt(),gT=Jn(),y2=fi(),{codes:wQe}=di(),{Envelope:ose}=sse(),Xu=class{constructor({peerId:e,payloadType:t,payload:i,signature:n}){this.peerId=e,this.payloadType=t,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=mQe.marshalPublicKey(this.peerId.pubKey);return this._marshal=ose.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return y2(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&y2(this.payloadType,e.payloadType)&&y2(this.payload,e.payload)&&y2(this.signature,e.signature)}validate(e){let t=ase(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(t,this.signature)}},ase=(r,e,t)=>{let i=bQe(r),n=gT.encode(i.byteLength),s=gT.encode(e.length),o=gT.encode(t.length);return gQe([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),t])};Xu.createFromProtobuf=async r=>{let e=ose.decode(r),t=await vQe.createFromPubKey(e.publicKey);return new Xu({peerId:t,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};Xu.seal=async(r,e)=>{let t=r.domain,i=r.codec,n=r.marshal(),s=ase(t,i,n),o=await e.privKey.sign(s);return new Xu({peerId:e,payloadType:i,payload:n,signature:o})};Xu.openAndCertify=async(r,e)=>{let t=await Xu.createFromProtobuf(r);if(!await t.validate(e))throw yQe(new Error("envelope signature is not valid for the given domain"),wQe.ERR_SIGNATURE_NOT_VALID);return t};cse.exports=Xu});var ET=p((kc,lse)=>{u();"use strict";var _Qe=kc&&kc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),EQe=kc&&kc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),use=kc&&kc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&_Qe(e,r,t);return EQe(e,r),e},wp=kc&&kc.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{f(i.next(l))}catch(h){o(h)}}function c(l){try{f(i.throw(l))}catch(h){o(h)}}function f(l){l.done?s(l.value):n(l.value).then(a,c)}f((i=i.apply(r,e||[])).next())})},bT=use(_ne()),SQe=Rne(),mT=Cne(),kt=use(Of()),AQe=kne(),g2=aT(),Fi=qf(),vT=$ne(),xQe=Wne(),IQe=rse(),wT=rt(),TQe=pb(),_T=class extends bT.default{constructor(e,t={}){let i=[kt.GossipsubIDv11,kt.GossipsubIDv10],n=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:kt.GossipsubD,Dlo:kt.GossipsubDlo,Dhi:kt.GossipsubDhi,Dscore:kt.GossipsubDscore,Dout:kt.GossipsubDout,Dlazy:kt.GossipsubDlazy},t),{scoreParams:vT.createPeerScoreParams(t.scoreParams),scoreThresholds:vT.createPeerScoreThresholds(t.scoreThresholds)});n.fallbackToFloodsub&&i.push(kt.FloodsubID),super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:i,libp2p:e},n)),this._options=n,this.direct=new Set(n.directPeers.map(s=>s.id.toB58String())),n.directPeers.forEach(s=>{e.peerStore.addressBook.add(s.id,s.addrs)}),this.seenCache=new IQe,this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=t.messageCache||new SQe.MessageCache(kt.GossipsubHistoryGossip,kt.GossipsubHistoryLength,this.getMsgId.bind(this)),this.heartbeat=new AQe.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new xQe.IWantTracer(this.getMsgId.bind(this)),this._libp2p=e,this.score=new vT.PeerScore(this._options.scoreParams,e.connectionManager,this.getMsgId.bind(this))}_decodeRpc(e){return mT.RPC.decode(e)}_encodeRpc(e){return mT.RPC.encode(e).finish()}_addPeer(e,t){let i=super._addPeer(e,t);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>t===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let t=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),t}_processRpc(e,t,i){let n=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return wp(this,void 0,void 0,function*(){return(yield n._processRpc.call(this,e,t,i))?(i.control&&this._processRpcControlMessage(e,i.control),!0):!1})}_processRpcControlMessage(e,t){if(!t)return;let i=t.ihave?this._handleIHave(e,t.ihave):[],n=t.iwant?this._handleIWant(e,t.iwant):[],s=t.graft?this._handleGraft(e,t.graft):[];if(t.prune&&this._handlePrune(e,t.prune),!i.length&&!n.length&&!s.length)return;let o=Fi.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)}_processRpcMessage(e){let t=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return wp(this,void 0,void 0,function*(){let i=yield this.getMsgId(e),n=Fi.messageIdToString(i);if(this.seenCache.has(n)){this.score.duplicateMessage(e);return}this.seenCache.put(n),this.score.validateMessage(e),yield t._processRpcMessage.call(this,e)})}_acceptFrom(e){return this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.graylistThreshold}validate(e){let t=Object.create(null,{validate:{get:()=>super.validate}});return wp(this,void 0,void 0,function*(){try{yield t.validate.call(this,e)}catch(i){throw this.score.rejectMessage(e,i.code),this.gossipTracer.rejectMessage(e,i.code),i}})}_handleIHave(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>kt.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=kt.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(t.forEach(({topicID:f,messageIDs:l})=>{!f||!l||!this.mesh.has(f)||l.forEach(h=>{let d=Fi.messageIdToString(h);this.seenCache.has(d)||o.set(d,h)})}),!o.size)return[];let a=o.size;a+s>kt.GossipsubMaxIHaveLength&&(a=kt.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Fi.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return t.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let[a,c]=this.messageCache.getForPeer(o,e);if(!!a){if(c>kt.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(Fi.messageIdToString(o),a)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(bT.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,t){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return t.forEach(({topicID:a})=>{var c;if(!a)return;let f=this.mesh.get(a);if(!f){o=!1;return}if(f.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(a),o=!1;return}let l=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof l=="number"&&s<l){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let h=l+kt.GossipsubGraftFloodThreshold-kt.GossipsubPruneBackoff;s<h&&this.score.addPenalty(e,1),this._addBackoff(e,a),i.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),i.push(a),o=!1,this._addBackoff(e,a);return}if(f.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),f.add(e)}),i.length?i.map(a=>this._makePrune(e,a,o)):[]}_handlePrune(e,t){let i=this.score.score(e);t.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let a=this.mesh.get(n);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,t){this._doAddBackoff(e,t,kt.GossipsubPruneBackoff)}_doAddBackoff(e,t,i){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e)})}_clearBackoff(){if(this.heartbeatTicks%kt.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((t,i)=>{t.forEach((n,s)=>{n<e&&t.delete(s)}),t.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%kt.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(t=>{let i=this.peers.get(t);(!i||!i.isWritable)&&e.push(t)}),e.length&&e.forEach(t=>{this._connect(t)})}_pxConnect(e){return wp(this,void 0,void 0,function*(){e.length>kt.GossipsubPrunePeers&&(Fi.shuffle(e),e=e.slice(0,kt.GossipsubPrunePeers));let t=[];yield Promise.all(e.map(i=>wp(this,void 0,void 0,function*(){if(!i.peerID)return;let s=wT.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){t.push(s);return}try{let o=yield TQe.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}t.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!t.length&&t.forEach(i=>this._connect(i))})}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(e=>{this._connect(e)})},kt.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(wT.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let t=this.fanout.get(e);if(t)t.forEach(i=>{this.score.score(i)<0&&t.delete(i)}),t.size<this._options.D&&g2.getGossipPeers(this,e,this._options.D-t.size,i=>!t.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>t.add(i)),this.mesh.set(e,t),this.fanout.delete(e),this.lastpub.delete(e);else{let i=g2.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let t=this.mesh.get(e);t&&(t.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}_publish(e){return wp(this,void 0,void 0,function*(){e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e),this.gossipTracer.deliverMessage(e));let t=yield this.getMsgId(e),i=Fi.messageIdToString(t);this.seenCache.put(i),this.messageCache.put(e);let n=new Set;e.topicIDs.forEach(o=>{let a=this.topics.get(o);if(!!a)if(this._options.floodPublish&&e.from===this.peerId.toB58String())a.forEach(c=>{(this.direct.has(c)||this.score.score(c)>=this._options.scoreThresholds.publishThreshold)&&n.add(c)});else{this.direct.forEach(f=>{n.add(f)}),a.forEach(f=>{let l=this.score.score(f),h=this.peers.get(f);!h||h.protocol===kt.FloodsubID&&l>=this._options.scoreThresholds.publishThreshold&&n.add(f)});let c=this.mesh.get(o);if(!c||!c.size){if(c=this.fanout.get(o),!c){let f=g2.getGossipPeers(this,o,this._options.D,l=>this.score.score(l)>=this._options.scoreThresholds.publishThreshold);f.size>0?(c=f,this.fanout.set(o,f)):c=new Set}this.lastpub.set(o,this._now())}c.forEach(f=>{n.add(f)})}});let s=Fi.createGossipRpc([bT.utils.normalizeOutRpcMessage(e)]);n.forEach(o=>{o!==e.from&&this._sendRpc(o,s)})})}_sendGraft(e,t){let i=[{topicID:t}],n=Fi.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,t){let i=[this._makePrune(e,t,this._options.doPX)],n=Fi.createGossipRpc([],{prune:i});this._sendRpc(e,n)}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,t,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,t,s),this.gossip.delete(e)),i.write(mT.RPC.encode(t).finish())}_piggybackControl(e,t,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(n),t.control.prune=t.control.prune&&t.control.prune.concat(s)):t.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,t,i){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=i}_sendGraftPrune(e,t,i){let n=this._options.doPX;for(let[s,o]of e){let a=o.map(h=>({topicID:h})),c=[],f=t.get(s);f&&(c=f.map(h=>this._makePrune(s,h,n&&!i.get(s))),t.delete(s));let l=Fi.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,l)}for(let[s,o]of t){let a=o.map(f=>this._makePrune(s,f,n&&!i.get(s))),c=Fi.createGossipRpc([],{prune:a});this._sendRpc(s,c)}}_emitGossip(e,t){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;Fi.shuffle(i),i.length>kt.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let f=this.peers.get(c);!f||!t.has(c)&&!this.direct.has(c)&&Fi.hasGossipProtocol(f.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&n.push(c)});let o=this._options.Dlazy,a=kt.GossipsubGossipFactor*n.length;a>o&&(o=a),o>n.length?o=n.length:Fi.shuffle(n),n.slice(0,o).forEach(c=>{let f=i;i.length>kt.GossipsubMaxIHaveLength&&(f=Fi.shuffle(f.slice()).slice(0,kt.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:f})})}_flush(){for(let[e,t]of this.gossip.entries()){this.gossip.delete(e);let i=Fi.createGossipRpc([],{ihave:t});this._sendRpc(e,i)}for(let[e,t]of this.control.entries()){this.control.delete(e);let i=Fi.createGossipRpc([],{graft:t.graft,prune:t.prune});this._sendRpc(e,i)}}_pushGossip(e,t){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(t))}_now(){return Date.now()}_makePrune(e,t,i){if(this.peers.get(e).protocol===kt.GossipsubIDv10)return{topicID:t,peers:[]};let n=kt.GossipsubPruneBackoff/1e3,s=[];return i&&g2.getGossipPeers(this,t,kt.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0).forEach(a=>{let c=wT.createFromB58String(a);s.push({peerID:c.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(c)})}),{topicID:t,peers:s,backoff:n}}};_T.multicodec=kt.GossipsubIDv11;lse.exports=_T});var hse=p((_Rt,fse)=>{u();"use strict";fse.exports={gossipsub:ET()}});var Qu=p((ERt,dse)=>{u();"use strict";var RQe=()=>{let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r};dse.exports=RQe});var vse=p((SRt,mse)=>{u();"use strict";var ST=rt(),{base58btc:PQe}=(zr(),Vr),{default:CQe}=_c(),pse=Qu(),yse=me(),Ju=yse("libp2p-delegated-peer-routing");Ju.error=yse("libp2p-delegated-peer-routing:error");var gse=3e4,OQe=4,bse=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this._client=e,this._httpQueue=new CQe({concurrency:OQe});let{protocol:t,host:i,port:n}=e.getEndpointConfig();Ju(`enabled DelegatedPeerRouting via ${t}://${i}:${n}`)}async findPeer(e,t={}){let i=e;ST.isPeerId(i)&&(i=e.toB58String()),Ju("findPeer starts: "+e),t.timeout=t.timeout||gse;try{return await this._httpQueue.add(async()=>{let{addrs:n}=await this._client.dht.findPeer(i,{timeout:t.timeout});return{id:e,multiaddrs:n}})}catch(n){if(n.message.includes("not found"))return;throw n}finally{Ju("findPeer finished: "+e)}}async*getClosestPeers(e,t={}){let i=PQe.encode(e).substring(1);Ju("getClosestPeers starts:",i),t.timeout=t.timeout||gse;let n=pse(),s=pse();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;let o=new Map;for await(let a of this._client.dht.query(i,{timeout:t.timeout}))switch(a.type){case 1:a.responses.forEach(c=>{o.set(c.id,{id:ST.parse(c.id),multiaddrs:c.addrs})});break;case 2:yield o.get(a.id.string)||{id:ST.createFromCID(a.id),multiaddrs:[]};break;default:Ju("getClosestPeers unhandled response",a)}}catch(o){throw Ju.error("getClosestPeers errored:",o),o}finally{s.resolve(),Ju("getClosestPeers finished:",i)}}};mse.exports=bse});var xse=p((ARt,Ase)=>{u();"use strict";var wse=me(),qQe=rt(),kQe=Ia(),{default:_se}=_c(),Ese=Qu(),kf=wse("libp2p-delegated-content-routing");kf.error=wse("libp2p-delegated-content-routing:error");var BQe=3e4,NQe=4,Sse=class{constructor(e,t){if(e==null)throw new Error("missing self peerId");if(t==null)throw new Error("missing ipfs http client");this._client=t,this.peerId=e;let i={concurrency:NQe};this._httpQueue=new _se(i),this._httpQueueRefs=new _se(Object.assign({},i,{concurrency:2}));let{protocol:n,host:s,port:o}=t.getEndpointConfig();kf(`enabled DelegatedContentRouting via ${n}://${s}:${o}`)}async*findProviders(e,t={}){kf(`findProviders starts: ${e}`),t.timeout=t.timeout||BQe;let i=0,n=Ese(),s=Ese();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let{id:o,addrs:a}of this._client.dht.findProvs(e,{numProviders:t.numProviders,timeout:t.timeout}))yield{id:qQe.parse(o),multiaddrs:a},i++}catch(o){throw kf.error("findProviders errored:",o),o}finally{s.resolve(),kf(`findProviders finished: ${e} found ${i} providers`)}}async provide(e){kf(`provide starts: ${e}`),await this._httpQueueRefs.add(async()=>{await this._client.block.stat(e),await kQe(this._client.dht.provide(e))}),kf(`provide finished: ${e}`)}};Ase.exports=Sse});var AT=p((xRt,Tse)=>{u();"use strict";var DQe=r=>Promise.reject(new Error(`No codec found for "${r}"`)),Ise=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||DQe;for(let t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let t=typeof e=="string"?this._codecsByName:this._codecsByCode;if(t[e])return t[e];let i=await this._loadCodec(e);return t[e]==null&&this.addCodec(i),i}listCodecs(){return Object.values(this._codecsByName)}};Tse.exports=Ise});var xT=p((IRt,Pse)=>{u();"use strict";var MQe=r=>Promise.reject(new Error(`No hasher found for "${r}"`)),Rse=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||MQe;for(let t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let t=typeof e=="string"?this._hashersByName:this._hashersByCode;if(t[e])return t[e];let i=await this._loadHasher(e);return t[e]==null&&this.addHasher(i),i}listHashers(){return Object.values(this._hashersByName)}};Pse.exports=Rse});var IT=p((TRt,Ose)=>{u();"use strict";var LQe=r=>Promise.reject(new Error(`No base found for "${r}"`)),Cse=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||LQe;for(let t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let t=await this._loadBase(e);return this._basesByName[t.name]==null&&this._basesByPrefix[t.prefix]==null&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}};Ose.exports=Cse});var Xr=p((RRt,qse)=>{u();"use strict";qse.exports=r=>{if(r==null)return r;let e=/^[A-Z]+$/,t={};return Object.keys(r).reduce((i,n)=>(e.test(n)?i[n.toLowerCase()]=r[n]:e.test(n[0])?i[n[0].toLowerCase()+n.slice(1)]=r[n]:i[n]=r[n],i),t)}});var Bse=p((PRt,kse)=>{u();"use strict";var{Multiaddr:UQe}=et(),FQe=Lw();kse.exports=r=>{try{r=FQe(new UQe(r))}catch(e){}return r=r.toString(),r}});var Nse=p(()=>{u()});var Dse=p(()=>{u()});var m2=p((BRt,jse)=>{u();"use strict";var{Multiaddr:Mse}=et(),{isBrowser:TT,isWebWorker:RT,isNode:KQe}=G0(),{default:jQe}=rg(),Lse=me()("ipfs-http-client:lib:error-handler"),b2=X0(),VQe=mr().bind({ignoreUndefined:!0}),Use=Bse(),zQe=Nse(),HQe=Dse(),$Qe=TT||RT?location.protocol:"http",GQe=TT||RT?location.hostname:"localhost",WQe=TT||RT?location.port:"5001",YQe=(r={})=>{let e,t={},i;if(typeof r=="string"||Mse.isMultiaddr(r))e=new URL(Use(r));else if(r instanceof URL)e=r;else if(typeof r.url=="string"||Mse.isMultiaddr(r.url))e=new URL(Use(r.url)),t=r;else if(r.url instanceof URL)e=r.url,t=r;else{t=r||{};let n=(t.protocol||$Qe).replace(":",""),s=(t.host||GQe).split(":")[0],o=t.port||WQe;e=new URL(`${n}://${s}:${o}`)}if(t.apiPath?e.pathname=t.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),KQe){let n=e.protocol.startsWith("https")?HQe.Agent:zQe.Agent;i=t.agent||new n({keepAlive:!0,maxSockets:6})}return{...t,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:i}},Fse=async r=>{let e;try{if((r.headers.get("Content-Type")||"").startsWith("application/json")){let i=await r.json();Lse(i),e=i.Message||i.message}else e=await r.text()}catch(i){Lse("Failed to parse error response",i),e=i.message}let t=new b2.HTTPError(r);throw e&&e.includes("context deadline exceeded")&&(t=new b2.TimeoutError("Request timed out")),e&&e.includes("request timed out")&&(t=new b2.TimeoutError("Request timed out")),e&&(t.message=e),t},XQe=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,Kse=r=>r.replace(XQe,function(e){return"-"+e.toLowerCase()}),QQe=r=>typeof r=="string"?jQe(r):r,PT=class extends b2{constructor(e={}){let t=YQe(e);super({timeout:QQe(t.timeout||0)||6e4*20,headers:t.headers,base:`${t.url}`,handleError:Fse,transformSearchParams:n=>{let s=new URLSearchParams;for(let[o,a]of n)a!=="undefined"&&a!=="null"&&o!=="signal"&&s.append(Kse(o),a),o==="timeout"&&!isNaN(a)&&s.append(Kse(o),a);return s},agent:t.agent});delete this.get,delete this.put,delete this.delete,delete this.options;let i=this.fetch;this.fetch=(n,s={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${t.url}/${n}`),i.call(this,n,VQe(s,{method:"POST"})))}};PT.errorHandler=Fse;jse.exports=PT});var ve=p((NRt,Vse)=>{u();"use strict";var JQe=m2(),ZQe=r=>e=>r(new JQe(e),e);Vse.exports=ZQe});var Gse=p((DRt,$se)=>{u();"use strict";var eJe=ue(),tJe=kg(),rJe=qg(),iJe=bd(),{isBytes:zse,isBlob:nJe,isReadableStream:sJe}=Iw();async function oJe(r){if(zse(r))return new Blob([r]);if(typeof r=="string"||r instanceof String)return new Blob([r.toString()]);if(nJe(r))return r;if(sJe(r)&&(r=rJe(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=tJe(r),{value:t,done:i}=await e.peek();if(i)return Hse(e);if(e.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(await iJe(e))]);if(zse(t)||typeof t=="string"||t instanceof String)return Hse(e)}throw eJe(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}async function Hse(r){let e=[];for await(let t of r)e.push(t);return new Blob(e)}$se.exports=oJe});var Yse=p((MRt,Wse)=>{u();"use strict";var aJe=Gse(),cJe=JI();Wse.exports=r=>cJe(r,aJe)});var v2=p((LRt,Xse)=>{u();"use strict";Xse.exports=r=>{if(r!=null)return typeof r=="string"?r:r.toString(8).padStart(4,"0")}});var Co=p((URt,Qse)=>{u();"use strict";var uJe=Yse(),lJe=v2();async function fJe(r,e,t={}){let i=[],n=new FormData,s=0,o=0;for await(let{content:a,path:c,mode:f,mtime:l}of uJe(r)){let h="",d=a?"file":"dir";s>0&&(h=`-${s}`);let y=d+h,g=[];if(f!=null&&g.push(`mode=${lJe(f)}`),l!=null){let{secs:m,nsecs:E}=l;g.push(`mtime=${m}`),E!=null&&g.push(`mtime-nsecs=${E}`)}if(g.length&&(y=`${y}?${g.join("&")}`),a){n.set(y,a,c!=null?encodeURIComponent(c):void 0);let m=o+a.size;i.push({name:c,start:o,end:m}),o=m}else if(c!=null)n.set(y,new File([""],encodeURIComponent(c),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:o,parts:i,headers:t,body:n}}Qse.exports=fJe});var CT=p((FRt,Jse)=>{u();"use strict";var hJe=ue();function dJe(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw hJe(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}Jse.exports=dJe});var Se=p((KRt,Zse)=>{u();"use strict";var pJe=v2(),yJe=CT();Zse.exports=({arg:r,searchParams:e,hashAlg:t,mtime:i,mode:n,...s}={})=>{e&&(s={...s,...e}),t&&(s.hash=t),i!=null&&(i=yJe(i),s.mtime=i.secs,s.mtimeNsecs=i.nsecs),n!=null&&(s.mode=pJe(n)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),r==null?r=[]:Array.isArray(r)||(r=[r]);let o=new URLSearchParams(s);return r.forEach(a=>o.append("arg",a)),o}});var Oo=p((jRt,eoe)=>{u();"use strict";var{anySignal:gJe}=wl();function bJe(r){return r.filter(Boolean)}eoe.exports=(...r)=>gJe(bJe(r))});var OT=p((VRt,toe)=>{u();"use strict";var{CID:mJe}=(xe(),Ce),vJe=Xr(),wJe=ve(),_Je=Co(),EJe=Se(),SJe=Oo(),{AbortController:AJe}=Ji();toe.exports=wJe(r=>{async function*e(t,i={}){let n=new AJe,s=SJe(n.signal,i.signal),{headers:o,body:a,total:c,parts:f}=await _Je(t,n,i.headers),[l,h]=typeof i.progress=="function"?xJe(c,f,i.progress):[void 0,void 0],d=await r.post("add",{searchParams:EJe({"stream-channels":!0,...i,progress:Boolean(l)}),timeout:i.timeout,onUploadProgress:h,signal:s,headers:o,body:a});for await(let y of d.ndjson())y=vJe(y),y.hash!==void 0?yield TJe(y):l&&l(y.bytes||0,y.name)}return e});var xJe=(r,e,t)=>e?[void 0,IJe(r,e,t)]:[t,void 0],IJe=(r,e,t)=>{let i=0,n=e.length;return({loaded:s,total:o})=>{let a=Math.floor(s/o*r);for(;i<n;){let{start:c,end:f,name:l}=e[i];if(a<f){t(a-c,l);break}else t(f-c,l),i+=1}}};function TJe({name:r,hash:e,size:t,mode:i,mtime:n,mtimeNsecs:s}){let o={path:r,cid:mJe.parse(e),size:parseInt(t)};return i!=null&&(o.mode=parseInt(i,8)),n!=null&&(o.mtime={secs:n,nsecs:s||0}),o}});var ioe=p((zRt,roe)=>{u();"use strict";var RJe=OT(),PJe=Un(),CJe=ve();roe.exports=r=>{let e=RJe(r);return CJe(()=>{async function t(i,n={}){return await PJe(e(i,n))}return t})(r)}});var soe=p((HRt,noe)=>{u();"use strict";var{CID:OJe}=(xe(),Ce),qJe=ve(),kJe=Se();noe.exports=qJe(r=>{async function e(t={}){return((await(await r.post("bitswap/wantlist",{timeout:t.timeout,signal:t.signal,searchParams:kJe(t),headers:t.headers})).json()).Keys||[]).map(n=>OJe.parse(n["/"]))}return e})});var aoe=p(($Rt,ooe)=>{u();"use strict";var{CID:BJe}=(xe(),Ce),NJe=ve(),DJe=Se();ooe.exports=NJe(r=>{async function e(t,i={}){return((await(await r.post("bitswap/wantlist",{timeout:i.timeout,signal:i.signal,searchParams:DJe({...i,peer:t.toString()}),headers:i.headers})).json()).Keys||[]).map(s=>BJe.parse(s["/"]))}return e})});var qT=p((GRt,coe)=>{u();"use strict";var{CID:MJe}=(xe(),Ce),LJe=ve(),UJe=Se();coe.exports=LJe(r=>{async function e(t={}){let i=await r.post("bitswap/stat",{searchParams:UJe(t),timeout:t.timeout,signal:t.signal,headers:t.headers});return FJe(await i.json())}return e});function FJe(r){return{provideBufLen:r.ProvideBufLen,wantlist:(r.Wantlist||[]).map(e=>MJe.parse(e["/"])),peers:r.Peers||[],blocksReceived:BigInt(r.BlocksReceived),dataReceived:BigInt(r.DataReceived),blocksSent:BigInt(r.BlocksSent),dataSent:BigInt(r.DataSent),dupBlksReceived:BigInt(r.DupBlksReceived),dupDataReceived:BigInt(r.DupDataReceived)}}});var loe=p((WRt,uoe)=>{u();"use strict";var KJe=ve(),jJe=Se();uoe.exports=KJe(r=>{async function e(t,i={}){return(await r.post("bitswap/unwant",{timeout:i.timeout,signal:i.signal,searchParams:jJe({arg:t.toString(),...i}),headers:i.headers})).json()}return e})});var hoe=p((YRt,foe)=>{u();"use strict";foe.exports=r=>({wantlist:soe()(r),wantlistForPeer:aoe()(r),stat:qT()(r),unwant:loe()(r)})});var kT=p((XRt,doe)=>{u();"use strict";var VJe=ve(),zJe=Se();doe.exports=VJe(r=>{async function e(t,i={}){let n=await r.post("block/get",{timeout:i.timeout,signal:i.signal,searchParams:zJe({arg:t.toString(),...i}),headers:i.headers});return new Uint8Array(await n.arrayBuffer())}return e})});var yoe=p((QRt,poe)=>{u();"use strict";var{CID:HJe}=(xe(),Ce),$Je=ve(),GJe=Se();poe.exports=$Je(r=>{async function e(t,i={}){let s=await(await r.post("block/stat",{timeout:i.timeout,signal:i.signal,searchParams:GJe({arg:t.toString(),...i}),headers:i.headers})).json();return{cid:HJe.parse(s.Key),size:s.Size}}return e})});var boe=p((JRt,goe)=>{u();"use strict";var{CID:WJe}=(xe(),Ce),YJe=Co(),XJe=ve(),QJe=Se(),JJe=Oo(),{AbortController:ZJe}=Ji();goe.exports=XJe(r=>{async function e(t,i={}){let n=new ZJe,s=JJe(n.signal,i.signal),o;try{o=await(await r.post("block/put",{timeout:i.timeout,signal:s,searchParams:QJe(i),...await YJe(t,n,i.headers)})).json()}catch(a){if(i.format==="dag-pb")return e(t,{...i,format:"protobuf"});if(i.format==="dag-cbor")return e(t,{...i,format:"cbor"});throw a}return WJe.parse(o.Key)}return e})});var voe=p((ZRt,moe)=>{u();"use strict";var{CID:eZe}=(xe(),Ce),tZe=ve(),rZe=Se();moe.exports=tZe(r=>{async function*e(t,i={}){Array.isArray(t)||(t=[t]);let n=await r.post("block/rm",{timeout:i.timeout,signal:i.signal,searchParams:rZe({arg:t.map(s=>s.toString()),"stream-channels":!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield iZe(s)}return e});function iZe(r){let e={cid:eZe.parse(r.Hash)};return r.Error&&(e.error=new Error(r.Error)),e}});var _oe=p((e8t,woe)=>{u();"use strict";woe.exports=r=>({get:kT()(r),stat:yoe()(r),put:boe()(r),rm:voe()(r)})});var Soe=p((t8t,Eoe)=>{u();"use strict";var nZe=ve(),sZe=Se(),{Multiaddr:oZe}=et();Eoe.exports=nZe(r=>{async function e(t,i={}){let n=await r.post("bootstrap/add",{timeout:i.timeout,signal:i.signal,searchParams:sZe({arg:t,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new oZe(o))}}return e})});var xoe=p((r8t,Aoe)=>{u();"use strict";var aZe=ve(),cZe=Se(),{Multiaddr:uZe}=et();Aoe.exports=aZe(r=>{async function e(t={}){let i=await r.post("bootstrap/rm",{timeout:t.timeout,signal:t.signal,searchParams:cZe({...t,all:!0}),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new uZe(s))}}return e})});var Toe=p((i8t,Ioe)=>{u();"use strict";var lZe=ve(),fZe=Se(),{Multiaddr:hZe}=et();Ioe.exports=lZe(r=>{async function e(t,i={}){let n=await r.post("bootstrap/rm",{timeout:i.timeout,signal:i.signal,searchParams:fZe({arg:t,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new hZe(o))}}return e})});var Poe=p((n8t,Roe)=>{u();"use strict";var dZe=ve(),pZe=Se(),{Multiaddr:yZe}=et();Roe.exports=dZe(r=>{async function e(t={}){let i=await r.post("bootstrap/add",{timeout:t.timeout,signal:t.signal,searchParams:pZe({...t,default:!0}),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new yZe(s))}}return e})});var Ooe=p((s8t,Coe)=>{u();"use strict";var gZe=ve(),bZe=Se(),{Multiaddr:mZe}=et();Coe.exports=gZe(r=>{async function e(t={}){let i=await r.post("bootstrap/list",{timeout:t.timeout,signal:t.signal,searchParams:bZe(t),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new mZe(s))}}return e})});var koe=p((o8t,qoe)=>{u();"use strict";qoe.exports=r=>({add:Soe()(r),clear:xoe()(r),rm:Toe()(r),reset:Poe()(r),list:Ooe()(r)})});var Noe=p((a8t,Boe)=>{u();"use strict";var vZe=ve(),wZe=Se();Boe.exports=vZe(r=>{async function*e(t,i={}){yield*(await r.post("cat",{timeout:i.timeout,signal:i.signal,searchParams:wZe({arg:t.toString(),...i}),headers:i.headers})).iterator()}return e})});var Moe=p((c8t,Doe)=>{u();"use strict";var _Ze=ve(),EZe=Se();Doe.exports=_Ze(r=>async(t={})=>(await r.post("commands",{timeout:t.timeout,signal:t.signal,searchParams:EZe(t),headers:t.headers})).json())});var Uoe=p((u8t,Loe)=>{u();"use strict";var SZe=ve(),AZe=Se();Loe.exports=SZe(r=>async(t={})=>await(await r.post("config/show",{timeout:t.timeout,signal:t.signal,searchParams:AZe({...t}),headers:t.headers})).json())});var Koe=p((l8t,Foe)=>{u();"use strict";var xZe=ve(),IZe=Se();Foe.exports=xZe(r=>async(t,i={})=>{if(!t)throw new Error("key argument is required");return(await(await r.post("config",{timeout:i.timeout,signal:i.signal,searchParams:IZe({arg:t,...i}),headers:i.headers})).json()).Value})});var Voe=p((f8t,joe)=>{u();"use strict";var TZe=ve(),RZe=Se();joe.exports=TZe(r=>async(t,i,n={})=>{if(typeof t!="string")throw new Error("Invalid key type");let s={...n,...PZe(t,i)};await(await r.post("config",{timeout:n.timeout,signal:n.signal,searchParams:RZe(s),headers:n.headers})).text()});var PZe=(r,e)=>{switch(typeof e){case"boolean":return{arg:[r,e.toString()],bool:!0};case"string":return{arg:[r,e]};default:return{arg:[r,JSON.stringify(e)],json:!0}}}});var Hoe=p((h8t,zoe)=>{u();"use strict";var CZe=ct(),OZe=Co(),qZe=ve(),kZe=Se(),BZe=Oo(),{AbortController:NZe}=Ji();zoe.exports=qZe(r=>async(t,i={})=>{let n=new NZe,s=BZe(n.signal,i.signal);await(await r.post("config/replace",{timeout:i.timeout,signal:s,searchParams:kZe(i),...await OZe(CZe(JSON.stringify(t)),n,i.headers)})).text()})});var Goe=p((d8t,$oe)=>{u();"use strict";var DZe=ve(),MZe=Se();$oe.exports=DZe(r=>{async function e(t,i={}){let s=await(await r.post("config/profile/apply",{timeout:i.timeout,signal:i.signal,searchParams:MZe({arg:t,...i}),headers:i.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return e})});var Yoe=p((p8t,Woe)=>{u();"use strict";var LZe=Xr(),UZe=ve(),FZe=Se();Woe.exports=UZe(r=>{async function e(t={}){return(await(await r.post("config/profile/list",{timeout:t.timeout,signal:t.signal,searchParams:FZe(t),headers:t.headers})).json()).map(s=>LZe(s))}return e})});var Qoe=p((y8t,Xoe)=>{u();"use strict";Xoe.exports=r=>({apply:Goe()(r),list:Yoe()(r)})});var Zoe=p((g8t,Joe)=>{u();"use strict";Joe.exports=r=>({getAll:Uoe()(r),get:Koe()(r),set:Voe()(r),replace:Hoe()(r),profiles:Qoe()(r)})});var tae=p((b8t,eae)=>{u();"use strict";var KZe=ve(),jZe=Se();eae.exports=KZe(r=>{async function*e(t,i={}){yield*(await r.post("dag/export",{timeout:i.timeout,signal:i.signal,searchParams:jZe({arg:t.toString()}),headers:i.headers})).iterator()}return e})});var nae=p((m8t,iae)=>{u();"use strict";var{CID:VZe}=(xe(),Ce),rae=ue(),zZe=async function*(r,e,t,i,n){let s=async f=>{let l=await t.getCodec(f.code),h=await i(f,n);return l.decode(h)},o=e.split("/").filter(Boolean),a=await s(r),c=r;for(o.length||(yield{value:a,remainderPath:""});o.length;){let f=o.shift();if(!f)throw rae(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,f))a=a[f],yield{value:a,remainderPath:o.join("/")};else throw rae(new Error(`no link named "${f}" under ${c}`),"ERR_NO_LINK");a instanceof VZe&&(c=a,a=await s(a))}};iae.exports=zZe});var oae=p((v8t,sae)=>{u();"use strict";var HZe=async r=>{for await(let e of r)return e};sae.exports=HZe});var uae=p((w8t,cae)=>{u();"use strict";var $Ze=ve(),aae=nae(),GZe=oae(),WZe=Un(),YZe=ue();cae.exports=(r,e)=>$Ze((i,n)=>{let s=kT()(n);return async(a,c={})=>{if(c.path){let y=c.localResolve?await GZe(aae(a,c.path,r,s,c)):await WZe(aae(a,c.path,r,s,c));if(!y)throw YZe(new Error("Not found"),"ERR_NOT_FOUND");return y}let f=await r.getCodec(a.code),l=await s(a,c);return{value:f.decode(l),remainderPath:""}}})(e)});var fae=p((_8t,lae)=>{u();"use strict";var XZe=ve(),QZe=Se(),JZe=Oo(),ZZe=Co(),{AbortController:eet}=Ji(),{CID:tet}=(xe(),Ce);lae.exports=XZe(r=>{async function*e(t,i={}){let n=new eet,s=JZe(n.signal,i.signal),{headers:o,body:a}=await ZZe(t,n,i.headers),c=await r.post("dag/import",{timeout:i.timeout,signal:s,headers:o,body:a,searchParams:QZe({"pin-roots":i.pinRoots})});for await(let{Root:f}of c.ndjson())if(f!==void 0){let{Cid:{"/":l},PinErrorMsg:h}=f;yield{root:{cid:tet.parse(l),pinErrorMsg:h}}}}return e})});var BT=p((E8t,hae)=>{u();"use strict";var{CID:ret}=(xe(),Ce),iet=ve(),net=Co(),set=Se(),oet=Oo(),{AbortController:aet}=Ji();hae.exports=(r,e)=>iet(i=>async(s,o={})=>{let a={format:"dag-cbor",hashAlg:"sha2-256",inputEnc:"raw",...o},f=(await r.getCodec(a.format)).encode(s),l=new aet,h=oet(l.signal,a.signal),y=await(await i.post("dag/put",{timeout:a.timeout,signal:h,searchParams:set(a),...await net(f,l,a.headers)})).json();return ret.parse(y.Cid["/"])})(e)});var pae=p((S8t,dae)=>{u();"use strict";var{CID:cet}=(xe(),Ce),uet=ve(),fet=Se();dae.exports=uet(r=>async(t,i={})=>{let s=await(await r.post("dag/resolve",{timeout:i.timeout,signal:i.signal,searchParams:fet({arg:`${t}${i.path?`/${i.path}`.replace(/\/[/]+/g,"/"):""}`,...i}),headers:i.headers})).json();return{cid:cet.parse(s.Cid["/"]),remainderPath:s.RemPath}})});var gae=p((A8t,yae)=>{u();"use strict";yae.exports=(r,e)=>({export:tae()(e),get:uae()(r,e),import:fae()(e),put:BT()(r,e),resolve:pae()(e)})});var w2=p((x8t,bae)=>{u();"use strict";bae.exports={SendingQuery:0,PeerResponse:1,FinalPeer:2,QueryError:3,Provider:4,Value:5,AddingPeer:6,DialingPeer:7}});var vae=p((I8t,mae)=>{u();"use strict";var het=ve(),det=Se(),{Value:pet}=w2(),yet=Ze(),get=ct();mae.exports=het(r=>{async function e(t,i={}){let n=await r.post("dht/get",{timeout:i.timeout,signal:i.signal,searchParams:det({arg:t instanceof Uint8Array?yet(t):t,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===pet)return get(s.Extra,"base64pad");throw new Error("not found")}return e})});var _ae=p((T8t,wae)=>{u();"use strict";var{Multiaddr:bet}=et(),met=Xr(),vet=ve(),wet=Se(),_et=Co(),Eet=Oo(),{AbortController:Aet}=Ji();wae.exports=vet(r=>{async function*e(t,i,n={}){let s=new Aet,o=Eet(s.signal,n.signal),a=await r.post("dht/put",{timeout:n.timeout,signal:o,searchParams:wet({arg:t,...n}),...await _et(i,s,n.headers)});for await(let c of a.ndjson())c=met(c),c.responses&&(c.responses=c.responses.map(({ID:f,Addrs:l})=>({id:f,addrs:(l||[]).map(h=>new bet(h))}))),yield c}return e})});var Sae=p((R8t,Eae)=>{u();"use strict";var{Multiaddr:xet}=et(),Iet=ve(),Tet=Se(),{Provider:Ret}=w2();Eae.exports=Iet(r=>{async function*e(t,i={}){let n=await r.post("dht/findprovs",{timeout:i.timeout,signal:i.signal,searchParams:Tet({arg:t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===Ret&&s.Responses)for(let{ID:o,Addrs:a}of s.Responses)yield{id:o,addrs:(a||[]).map(c=>new xet(c))}}return e})});var xae=p((P8t,Aae)=>{u();"use strict";var{Multiaddr:Pet}=et(),Cet=ve(),Oet=Se(),{FinalPeer:qet}=w2();Aae.exports=Cet(r=>{async function e(t,i={}){let n=await r.post("dht/findpeer",{timeout:i.timeout,signal:i.signal,searchParams:Oet({arg:t,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===qet&&s.Responses){let{ID:o,Addrs:a}=s.Responses[0];return{id:o,addrs:(a||[]).map(c=>new Pet(c))}}throw new Error("not found")}return e})});var Tae=p((C8t,Iae)=>{u();"use strict";var{Multiaddr:ket}=et(),Bet=Xr(),Net=ve(),Det=Se();Iae.exports=Net(r=>{async function*e(t,i={recursive:!1}){let n=Array.isArray(t)?t:[t],s=await r.post("dht/provide",{timeout:i.timeout,signal:i.signal,searchParams:Det({arg:n.map(o=>o.toString()),...i}),headers:i.headers});for await(let o of s.ndjson())o=Bet(o),o.responses?o.responses=o.responses.map(({ID:a,Addrs:c})=>({id:a,addrs:(c||[]).map(f=>new ket(f))})):o.responses=[],yield o}return e})});var Pae=p((O8t,Rae)=>{u();"use strict";var{Multiaddr:Met}=et(),Let=Xr(),Uet=ve(),Fet=Se();Rae.exports=Uet(r=>{async function*e(t,i={}){let n=await r.post("dht/query",{timeout:i.timeout,signal:i.signal,searchParams:Fet({arg:t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())s=Let(s),s.responses=(s.responses||[]).map(({ID:o,Addrs:a})=>({id:o,addrs:(a||[]).map(c=>new Met(c))})),yield s}return e})});var Oae=p((q8t,Cae)=>{u();"use strict";Cae.exports=r=>({get:vae()(r),put:_ae()(r),findProvs:Sae()(r),findPeer:xae()(r),provide:Tae()(r),query:Pae()(r)})});var kae=p((k8t,qae)=>{u();"use strict";var Ket=ve(),jet=Se();qae.exports=Ket(r=>{async function e(t={}){return(await r.post("diag/net",{timeout:t.timeout,signal:t.signal,searchParams:jet(t),headers:t.headers})).json()}return e})});var Nae=p((B8t,Bae)=>{u();"use strict";var Vet=ve(),zet=Se();Bae.exports=Vet(r=>{async function e(t={}){return(await r.post("diag/sys",{timeout:t.timeout,signal:t.signal,searchParams:zet(t),headers:t.headers})).json()}return e})});var Mae=p((N8t,Dae)=>{u();"use strict";var Het=ve(),$et=Se();Dae.exports=Het(r=>{async function e(t={}){return(await r.post("diag/cmds",{timeout:t.timeout,signal:t.signal,searchParams:$et(t),headers:t.headers})).json()}return e})});var Uae=p((D8t,Lae)=>{u();"use strict";Lae.exports=r=>({net:kae()(r),sys:Nae()(r),cmds:Mae()(r)})});var Kae=p((M8t,Fae)=>{u();"use strict";var Get=ve(),Wet=Se();Fae.exports=Get(r=>async(t,i={})=>(await(await r.post("dns",{timeout:i.timeout,signal:i.signal,searchParams:Wet({arg:t,...i}),headers:i.headers})).json()).Path)});var Vae=p((L8t,jae)=>{u();"use strict";var Yet=ve(),Xet=Se();jae.exports=Yet(r=>{async function e(t,i,n={}){await(await r.post("files/chmod",{timeout:n.timeout,signal:n.signal,searchParams:Xet({arg:t,mode:i,...n}),headers:n.headers})).text()}return e})});var Hae=p((U8t,zae)=>{u();"use strict";var{CID:Qet}=(xe(),Ce),Jet=ve(),Zet=Se();zae.exports=Jet(r=>{async function e(t,i,n={}){let s=Array.isArray(t)?t:[t];await(await r.post("files/cp",{timeout:n.timeout,signal:n.signal,searchParams:Zet({arg:s.concat(i).map(a=>a instanceof Qet?`/ipfs/${a}`:a),...n}),headers:n.headers})).text()}return e})});var Gae=p((F8t,$ae)=>{u();"use strict";var{CID:ett}=(xe(),Ce),ttt=ve(),rtt=Se();$ae.exports=ttt(r=>{async function e(t,i={}){if(!t||typeof t!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await r.post("files/flush",{timeout:i.timeout,signal:i.signal,searchParams:rtt({arg:t,...i}),headers:i.headers})).json();return ett.parse(s.Cid)}return e})});var NT=p((K8t,Wae)=>{u();"use strict";var itt=Xr();function ntt(r){let e=itt(r);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}Wae.exports=ntt});var Zae=p((j8t,Jae)=>{u();"use strict";var{CID:Yae}=(xe(),Ce),Xae=NT(),stt=ve(),ott=Se();Jae.exports=stt(r=>{async function*e(t,i={}){if(!t)throw new Error("ipfs.files.ls requires a path");let n=await r.post("files/ls",{timeout:i.timeout,signal:i.signal,searchParams:ott({arg:t instanceof Yae?`/ipfs/${t}`:t,long:!0,...i,stream:!0}),headers:i.headers});for await(let s of n.ndjson())if("Entries"in s)for(let o of s.Entries||[])yield Qae(Xae(o));else yield Qae(Xae(s))}return e});function Qae(r){return r.hash&&(r.cid=Yae.parse(r.hash)),delete r.hash,r.type=r.type===1?"directory":"file",r}});var tce=p((V8t,ece)=>{u();"use strict";var att=ve(),ctt=Se();ece.exports=att(r=>{async function e(t,i={}){await(await r.post("files/mkdir",{timeout:i.timeout,signal:i.signal,searchParams:ctt({arg:t,...i}),headers:i.headers})).text()}return e})});var ice=p((z8t,rce)=>{u();"use strict";var utt=ve(),ltt=Se();rce.exports=utt(r=>{async function e(t,i,n={}){Array.isArray(t)||(t=[t]),await(await r.post("files/mv",{timeout:n.timeout,signal:n.signal,searchParams:ltt({arg:t.concat(i),...n}),headers:n.headers})).text()}return e})});var yb=p((H8t,nce)=>{u();nce.exports=r=>{if(r[Symbol.asyncIterator])return r;if(r.getReader)return async function*(){let e=r.getReader();try{for(;;){let{done:t,value:i}=await e.read();if(t)return;yield i}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var oce=p(($8t,sce)=>{u();"use strict";var ftt=yb(),htt=ve(),dtt=Se();sce.exports=htt(r=>{async function*e(t,i={}){let n=await r.post("files/read",{timeout:i.timeout,signal:i.signal,searchParams:dtt({arg:t,count:i.length,...i}),headers:i.headers});yield*ftt(n.body)}return e})});var cce=p((G8t,ace)=>{u();"use strict";var ptt=ve(),ytt=Se();ace.exports=ptt(r=>{async function e(t,i={}){await(await r.post("files/rm",{timeout:i.timeout,signal:i.signal,searchParams:ytt({arg:t,...i}),headers:i.headers})).text()}return e})});var DT=p((W8t,lce)=>{u();"use strict";var{CID:uce}=(xe(),Ce),gtt=NT(),btt=ve(),mtt=Se();lce.exports=btt(r=>{async function e(t,i={}){t&&!(t instanceof uce)&&typeof t!="string"&&(i=t||{},t="/"),i=i||{};let s=await(await r.post("files/stat",{timeout:i.timeout,signal:i.signal,searchParams:mtt({arg:t,...i}),headers:i.headers})).json();return s.WithLocality=s.WithLocality||!1,vtt(gtt(s))}return e});function vtt(r){return r.cid=uce.parse(r.hash),delete r.hash,r}});var hce=p((Y8t,fce)=>{u();"use strict";var wtt=ve(),_tt=Se();fce.exports=wtt(r=>{async function e(t,i={}){await(await r.post("files/touch",{timeout:i.timeout,signal:i.signal,searchParams:_tt({arg:t,...i}),headers:i.headers})).text()}return e})});var pce=p((X8t,dce)=>{u();"use strict";var Ett=v2(),Stt=CT(),Att=ve(),xtt=Co(),Itt=Se(),Ttt=Oo(),{AbortController:Rtt}=Ji();dce.exports=Att(r=>{async function e(t,i,n={}){let s=new Rtt,o=Ttt(s.signal,n.signal);await(await r.post("files/write",{timeout:n.timeout,signal:o,searchParams:Itt({arg:t,streamChannels:!0,count:n.length,...n}),...await xtt({content:i,path:"arg",mode:Ett(n.mode),mtime:Stt(n.mtime)},s,n.headers)})).text()}return e})});var gce=p((Q8t,yce)=>{u();"use strict";yce.exports=r=>({chmod:Vae()(r),cp:Hae()(r),flush:Gae()(r),ls:Zae()(r),mkdir:tce()(r),mv:ice()(r),read:oce()(r),rm:cce()(r),stat:DT()(r),touch:hce()(r),write:pce()(r)})});var _2=p((J8t,mce)=>{u();"use strict";var{Buffer:qo}=pt(),bce=Symbol.for("BufferList");function ar(r){if(!(this instanceof ar))return new ar(r);ar._init.call(this,r)}ar._init=function(e){Object.defineProperty(this,bce,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};ar.prototype._new=function(e){return new ar(e)};ar.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};ar.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};ar.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};ar.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};ar.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||qo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,f=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:qo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,f),f+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=qo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-l;if(c>d)this._bufs[h].copy(e,f,l),f+=d;else{this._bufs[h].copy(e,f,l,l+c),f+=d;break}c-=d,l&&(l=0)}return e.length>f?e.slice(0,f):e};ar.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};ar.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};ar.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};ar.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};ar.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(qo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(qo.from(e));return this};ar.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};ar.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=qo.from([r]):typeof r=="string"?r=qo.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=qo.from(r.buffer,r.byteOffset,r.byteLength):qo.isBuffer(r)||(r=qo.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};ar.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?ar.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:ar.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();ar.prototype._isBufferList=function(e){return e instanceof ar||ar.isBufferList(e)};ar.isBufferList=function(e){return e!=null&&e[bce]};mce.exports=ar});var _ce=p(S2=>{u();var{Buffer:MT}=pt(),_p=_2(),Ptt="0".charCodeAt(0),Ctt=MT.from("ustar\0","binary"),Ott=MT.from("ustar ","binary"),qtt=MT.from(" \0","binary"),E2=257,vce=263,ktt=function(r,e,t){return typeof r!="number"?t:(r=~~r,r>=e?e:r>=0||(r+=e,r>=0)?r:0)},Btt=function(r){switch(r){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},wce=function(r,e,t,i){for(;t<i;t++)if(r.get(t)===e)return t;return i},Ntt=function(r){let e=8*32;for(let t=0;t<148;t++)e+=r.get(t);for(let t=156;t<512;t++)e+=r.get(t);return e};function Dtt(r){let e;if(r.get(0)===128)e=!0;else if(r.get(0)===255)e=!1;else return null;let t=!1,i=[];for(let o=r.length-1;o>0;o--){let a=r.get(o);e?i.push(a):t&&a===0?i.push(0):t?(t=!1,i.push(256-a)):i.push(255-a)}let n=0,s=i.length;for(let o=0;o<s;o++)n+=i[o]*Math.pow(256,o);return e?n:-1*n}var Zu=function(r,e,t){if(r=r.shallowSlice(e,e+t),e=0,r.get(e)&128)return Dtt(r);{for(;e<r.length&&r.get(e)===32;)e++;let i=ktt(wce(r,32,e,r.length),r.length,r.length);for(;e<i&&r.get(e)===0;)e++;return i===e?0:parseInt(r.shallowSlice(e,i).toString(),8)}},Ep=function(r,e,t,i){return r.shallowSlice(e,wce(r,0,e,e+t)).toString(i)};S2.decodeLongPath=function(r,e){return r=_p.isBufferList(r)?r:new _p(r),Ep(r,0,r.length,e)};S2.decodePax=function(r){r=_p.isBufferList(r)?r:new _p(r);let e={};for(;r.length;){let t=0;for(;t<r.length&&r.get(t)!==32;)t++;let i=parseInt(r.shallowSlice(0,t).toString(),10);if(!i)return e;let n=r.shallowSlice(t+1,i-1).toString(),s=n.indexOf("=");if(s===-1)return e;e[n.slice(0,s)]=n.slice(s+1),r=r.shallowSlice(i)}return e};S2.decode=function(r,e){r=_p.isBufferList(r)?r:new _p(r);let t=r.get(156)===0?0:r.get(156)-Ptt,i=Ep(r,0,100,e),n=Zu(r,100,8),s=Zu(r,108,8),o=Zu(r,116,8),a=Zu(r,124,12),c=Zu(r,136,12),f=Btt(t),l=r.get(157)===0?null:Ep(r,157,100,e),h=Ep(r,265,32),d=Ep(r,297,32),y=Zu(r,329,8),g=Zu(r,337,8),m=Ntt(r);if(m===8*32)return null;if(m!==Zu(r,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(Ctt.compare(r.slice(E2,E2+6))===0)r.get(345)&&(i=Ep(r,345,155,e)+"/"+i);else if(!(Ott.compare(r.slice(E2,E2+6))===0&&qtt.compare(r.slice(vce,vce+2))===0))throw new Error("Invalid tar header: unknown format.");return t===0&&i&&i[i.length-1]==="/"&&(t=5),{name:i,mode:n,uid:s,gid:o,size:a,mtime:new Date(1e3*c),type:f,linkname:l,uname:h,gname:d,devmajor:y,devminor:g}}});var Ace=p((ePt,Sce)=>{u();"use strict";var{Buffer:ko}=pt(),Ece=Symbol.for("BufferList");function cr(r){if(!(this instanceof cr))return new cr(r);cr._init.call(this,r)}cr._init=function(e){Object.defineProperty(this,Ece,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};cr.prototype._new=function(e){return new cr(e)};cr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};cr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};cr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};cr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};cr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||ko.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,f=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:ko.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,f),f+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=ko.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-l;if(c>d)this._bufs[h].copy(e,f,l),f+=d;else{this._bufs[h].copy(e,f,l,l+c),f+=d;break}c-=d,l&&(l=0)}return e.length>f?e.slice(0,f):e};cr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};cr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};cr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};cr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};cr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(ko.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(ko.from(e));return this};cr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};cr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=ko.from([r]):typeof r=="string"?r=ko.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=ko.from(r.buffer,r.byteOffset,r.byteLength):ko.isBuffer(r)||(r=ko.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};cr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?cr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:cr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();cr.prototype._isBufferList=function(e){return e instanceof cr||cr.isBufferList(e)};cr.isBufferList=function(e){return e!=null&&e[Ece]};Sce.exports=cr});var A2=p((tPt,xce)=>{u();var LT=Ace();xce.exports=r=>{let e=async function*(){let t=yield,i=new LT;for await(let n of r){if(!t){t=yield i.append(n),i=new LT;continue}for(i.append(n);i.length>=t;){let s=i.shallowSlice(0,t);if(i.consume(t),t=yield s,!t){i.length&&(t=yield i,i=new LT);break}}}if(t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var Tce=p((rPt,Ice)=>{u();var UT=_2(),Mtt=A2();Ice.exports=function(e){let t=Mtt(e),i,n={[Symbol.asyncIterator]:()=>n,async next(s){if(i){let o;if(s==null||i.length===s)o=i,i=null;else if(i.length>s)o=i.shallowSlice(0,s),i=i.shallowSlice(s);else if(i.length<s){let{value:a,done:c}=await t.next(s-i.length);if(c)throw Object.assign(new Error(`stream ended before ${s-i.length} bytes became available`),{code:"ERR_UNDER_READ"});o=new UT([i,a]),i=null}return{value:o}}return t.next(s)},async nextLte(s){let{done:o,value:a}=await n.next();return o?{done:o}:a.length<=s?{value:a}:(a=UT.isBufferList(a)?a:new UT(a),i?i.append(a.shallowSlice(s)):i=a.shallowSlice(s),{value:a.shallowSlice(0,s)})},return(){return t.return()}};return n}});var Pce=p((iPt,Rce)=>{u();var Ltt=Qu(),gb=_ce(),Utt=Tce();function Ftt(r){return r&=511,r&&512-r}async function bb(r,e){let t=Ftt(e);t&&await r.next(t)}Rce.exports=r=>(r=r||{},r.highWaterMark=r.highWaterMark||1024*16,e=>async function*(){let t=Utt(e),i,n,s,o;try{for(;;){let a;try{let{done:y,value:g}=await t.next(512);if(y)return;a=g}catch(y){if(y.code==="ERR_UNDER_READ")return;throw y}let c=gb.decode(a,r.filenameEncoding);if(!c)continue;if(c.type==="gnu-long-path"){let{done:y,value:g}=await t.next(c.size);if(y)return;i=gb.decodeLongPath(g,r.filenameEncoding),await bb(t,c.size);continue}if(c.type==="gnu-long-link-path"){let{done:y,value:g}=await t.next(c.size);if(y)return;n=gb.decodeLongPath(g,r.filenameEncoding),await bb(t,c.size);continue}if(c.type==="pax-global-header"){let{done:y,value:g}=await t.next(c.size);if(y)return;s=gb.decodePax(g,r.filenameEncoding),await bb(t,c.size);continue}if(c.type==="pax-header"){let{done:y,value:g}=await t.next(c.size);if(y)return;o=gb.decodePax(g,r.filenameEncoding),s&&(o={...s,...o}),await bb(t,c.size);continue}if(i&&(c.name=i,i=null),n&&(c.linkname=n,n=null),o&&(o.path&&(c.name=o.path),o.linkpath&&(c.linkname=o.linkpath),o.size&&(c.size=parseInt(o.size,10)),c.pax=o,o=null),!c.size||c.type==="directory"){yield{header:c,body:async function*(){}()};continue}let f=c.size,l=Ltt(),h=await t.nextLte(Math.min(f,r.highWaterMark));f-=h.value.length,f||l.resolve();let d=async function*(){try{for(yield h.value;f;){let{done:y,value:g}=await t.nextLte(f);if(y){f=0;return}f-=g.length,yield g}}finally{l.resolve()}}();if(yield{header:c,body:d},await l.promise,f)for await(let y of d);await bb(t,c.size)}}finally{await t.return()}}())});var Oce=p((nPt,Cce)=>{u();"use strict";Cce.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:8,RTLD_LOCAL:4,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGINFO:29,SIGSYS:12,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,UV_FS_O_FILEMAP:0,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_DSYNC:4194304,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488303,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var Bce=p((sPt,kce)=>{u();"use strict";var{Buffer:Bo}=pt(),qce=Symbol.for("BufferList");function ur(r){if(!(this instanceof ur))return new ur(r);ur._init.call(this,r)}ur._init=function(e){Object.defineProperty(this,qce,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};ur.prototype._new=function(e){return new ur(e)};ur.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};ur.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};ur.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};ur.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};ur.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Bo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,f=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Bo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,f),f+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=Bo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-l;if(c>d)this._bufs[h].copy(e,f,l),f+=d;else{this._bufs[h].copy(e,f,l,l+c),f+=d;break}c-=d,l&&(l=0)}return e.length>f?e.slice(0,f):e};ur.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};ur.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};ur.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};ur.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};ur.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Bo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Bo.from(e));return this};ur.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};ur.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=Bo.from([r]):typeof r=="string"?r=Bo.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=Bo.from(r.buffer,r.byteOffset,r.byteLength):Bo.isBuffer(r)||(r=Bo.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};ur.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?ur.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:ur.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();ur.prototype._isBufferList=function(e){return e instanceof ur||ur.isBufferList(e)};ur.isBufferList=function(e){return e!=null&&e[qce]};kce.exports=ur});var Dce=p((oPt,Nce)=>{u();var Ktt=Bce(),FT={string:()=>"",buffer:()=>Ktt()};Nce.exports=async(r,e)=>{if(e=e||{},e.type&&!FT[e.type])throw new Error(`invalid type "${e.type}"`);let t,i;for await(let n of r)t||(i=e.type||(typeof n=="string"?"string":"buffer"),t=FT[i]()),i==="string"?t+=n:t.append(n);return t||FT[e.type||"buffer"]()}});var Mce=p(jT=>{u();var{Buffer:Ua}=pt(),jtt=Ua.alloc,Vtt="0000000000000000000",ztt="7777777777777777777",Htt="0".charCodeAt(0),$tt=Ua.from("ustar\0","binary"),Gtt=Ua.from("00","binary"),Wtt=parseInt("7777",8),Ytt=257,Xtt=263,Qtt=function(r){switch(r){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},Jtt=function(r){let e=8*32;for(let t=0;t<148;t++)e+=r[t];for(let t=156;t<512;t++)e+=r[t];return e},el=function(r,e){return r=r.toString(8),r.length>e?ztt.slice(0,e)+" ":Vtt.slice(0,e-r.length)+r+" "},KT=function(r){let e=Ua.byteLength(r),t=Math.floor(Math.log(e)/Math.log(10))+1;return e+t>=Math.pow(10,t)&&t++,e+t+r};jT.encodePax=function(r){let e="";r.name&&(e+=KT(" path="+r.name+`
`)),r.linkname&&(e+=KT(" linkpath="+r.linkname+`
`));let t=r.pax;if(t)for(let i in t)e+=KT(" "+i+"="+t[i]+`
`);return Ua.from(e)};jT.encode=function(r){let e=jtt(512),t=r.name,i="";if(r.typeflag===5&&t[t.length-1]!=="/"&&(t+="/"),Ua.byteLength(t)!==t.length)return null;for(;Ua.byteLength(t)>100;){let n=t.indexOf("/");if(n===-1)return null;i+=i?"/"+t.slice(0,n):t.slice(0,n),t=t.slice(n+1)}return Ua.byteLength(t)>100||Ua.byteLength(i)>155||r.linkname&&Ua.byteLength(r.linkname)>100?null:(e.write(t),e.write(el(r.mode&Wtt,6),100),e.write(el(r.uid,6),108),e.write(el(r.gid,6),116),e.write(el(r.size,11),124),e.write(el(r.mtime.getTime()/1e3|0,11),136),e[156]=Htt+Qtt(r.type),r.linkname&&e.write(r.linkname,157),$tt.copy(e,Ytt),Gtt.copy(e,Xtt),r.uname&&e.write(r.uname,265),r.gname&&e.write(r.gname,297),e.write(el(r.devmajor||0,6),329),e.write(el(r.devminor||0,6),337),i&&e.write(i,345),e.write(el(Jtt(e),6),148),e)}});var Fce=p((cPt,Uce)=>{u();var{Buffer:VT}=pt(),Bf=_2(),{S_IFMT:Ztt,S_IFBLK:ert,S_IFCHR:trt,S_IFDIR:rrt,S_IFIFO:irt,S_IFLNK:nrt}=Oce(),srt=Dce(),x2=Mce(),ort=parseInt("755",8),art=parseInt("644",8),Lce=VT.alloc(1024);function crt(r){switch(r&Ztt){case ert:return"block-device";case trt:return"character-device";case rrt:return"directory";case irt:return"fifo";case nrt:return"symlink"}return"file"}function zT(r){if(r&=511,r)return new Bf(Lce.slice(0,512-r))}function HT(r){if(!r.pax){let e=x2.encode(r);if(e)return e}return urt(r)}function urt(r){let e=x2.encodePax({name:r.name,linkname:r.linkname,pax:r.pax}),t={name:"PaxHeader",mode:r.mode,uid:r.uid,gid:r.gid,size:e.length,mtime:r.mtime,type:"pax-header",linkname:r.linkname&&"PaxHeader",uname:r.uname,gname:r.gname,devmajor:r.devmajor,devminor:r.devminor};return new Bf([x2.encode(t),e,zT(e.length),x2.encode({...t,size:r.size,type:r.type})])}Uce.exports=()=>async function*(r){for await(let{header:e,body:t}of r){if((!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=crt(e.mode)),e.mode||(e.mode=e.type==="directory"?ort:art),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof t=="string"&&(t=VT.from(t)),VT.isBuffer(t)||Bf.isBufferList(t)){e.size=t.length,yield new Bf([HT(e),t,zT(e.size)]);continue}if(e.type==="symlink"&&!e.linkname){e.linkname=(await srt(t)).toString(),yield HT(e);continue}if(yield HT(e),e.type!=="file"&&e.type!=="contiguous-file")continue;let i=0;for await(let s of t)i+=s.length,yield Bf.isBufferList(s)?s:new Bf(s);if(i!==e.size)throw new Error("size mismatch");let n=zT(e.size);n&&(yield n)}yield new Bf(Lce)}});var Kce=p($T=>{u();$T.extract=Pce();$T.pack=Fce()});var Vce=p((lPt,jce)=>{u();"use strict";var lrt=Kce(),{CID:frt}=(xe(),Ce),hrt=ve(),drt=Se(),prt=mo();jce.exports=hrt(r=>{async function*e(t,i={}){let n=await r.post("get",{timeout:i.timeout,signal:i.signal,searchParams:drt({arg:`${t instanceof Uint8Array?frt.decode(t):t}`,...i}),headers:i.headers}),s=lrt.extract();for await(let{header:o,body:a}of s(n.iterator()))o.type==="directory"?yield{type:"dir",path:o.name}:yield{type:"file",path:o.name,content:prt(a,c=>c.slice())}}return e})});var Hce=p((fPt,zce)=>{u();"use strict";var yrt=ve();zce.exports=yrt(r=>()=>{let e=new URL(r.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}})});var GT=p((hPt,$ce)=>{u();"use strict";var grt=Xr(),{Multiaddr:brt}=et(),mrt=ve(),vrt=Se();$ce.exports=mrt(r=>{async function e(t={}){let n=await(await r.post("id",{timeout:t.timeout,signal:t.signal,searchParams:vrt({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers})).json(),s={...grt(n)};return s.addresses&&(s.addresses=s.addresses.map(o=>new brt(o))),s}return e})});var Wce=p((dPt,Gce)=>{u();"use strict";var wrt=GT();Gce.exports=r=>{let e=wrt(r);async function t(i={}){let n=await e(i);return Boolean(n&&n.addresses&&n.addresses.length)}return t}});var Xce=p((pPt,Yce)=>{u();"use strict";var _rt=Xr(),Ert=ve(),Srt=Se();Yce.exports=Ert(r=>{async function e(t,i={type:"rsa",size:2048}){let s=await(await r.post("key/gen",{timeout:i.timeout,signal:i.signal,searchParams:Srt({arg:t,...i}),headers:i.headers})).json();return _rt(s)}return e})});var Jce=p((yPt,Qce)=>{u();"use strict";var Art=Xr(),xrt=ve(),Irt=Se();Qce.exports=xrt(r=>{async function e(t={}){return((await(await r.post("key/list",{timeout:t.timeout,signal:t.signal,searchParams:Irt(t),headers:t.headers})).json()).Keys||[]).map(s=>Art(s))}return e})});var eue=p((gPt,Zce)=>{u();"use strict";var Trt=Xr(),Rrt=ve(),Prt=Se();Zce.exports=Rrt(r=>{async function e(t,i,n={}){let s=await r.post("key/rename",{timeout:n.timeout,signal:n.signal,searchParams:Prt({arg:[t,i],...n}),headers:n.headers});return Trt(await s.json())}return e})});var rue=p((bPt,tue)=>{u();"use strict";var Crt=Xr(),Ort=ve(),qrt=Se();tue.exports=Ort(r=>{async function e(t,i={}){let s=await(await r.post("key/rm",{timeout:i.timeout,signal:i.signal,searchParams:qrt({arg:t,...i}),headers:i.headers})).json();return Crt(s.Keys[0])}return e})});var nue=p((mPt,iue)=>{u();"use strict";var krt=Xr(),Brt=ve(),Nrt=Se();iue.exports=Brt(r=>{async function e(t,i,n,s={}){let a=await(await r.post("key/import",{timeout:s.timeout,signal:s.signal,searchParams:Nrt({arg:t,pem:i,password:n,...s}),headers:s.headers})).json();return krt(a)}return e})});var oue=p((vPt,sue)=>{u();"use strict";var Drt=ve();sue.exports=Drt(r=>async(t,i,n={})=>{throw new Error("Not implemented")})});var cue=p((wPt,aue)=>{u();"use strict";var Mrt=ve();aue.exports=Mrt(r=>async(t,i={})=>{throw new Error("Not implemented")})});var lue=p((_Pt,uue)=>{u();"use strict";uue.exports=r=>({gen:Xce()(r),list:Jce()(r),rename:eue()(r),rm:rue()(r),import:nue()(r),export:oue()(r),info:cue()(r)})});var hue=p((EPt,fue)=>{u();"use strict";var Lrt=ve(),Urt=Se();fue.exports=Lrt(r=>{async function*e(t={}){yield*(await r.post("log/tail",{timeout:t.timeout,signal:t.signal,searchParams:Urt(t),headers:t.headers})).ndjson()}return e})});var pue=p((SPt,due)=>{u();"use strict";var Frt=ve(),Krt=Se();due.exports=Frt(r=>{async function e(t={}){return(await(await r.post("log/ls",{timeout:t.timeout,signal:t.signal,searchParams:Krt(t),headers:t.headers})).json()).Strings}return e})});var gue=p((APt,yue)=>{u();"use strict";var jrt=Xr(),Vrt=ve(),zrt=Se();yue.exports=Vrt(r=>{async function e(t,i,n={}){let s=await r.post("log/level",{timeout:n.timeout,signal:n.signal,searchParams:zrt({arg:[t,i],...n}),headers:n.headers});return jrt(await s.json())}return e})});var mue=p((xPt,bue)=>{u();"use strict";bue.exports=r=>({tail:hue()(r),ls:pue()(r),level:gue()(r)})});var _ue=p((IPt,wue)=>{u();"use strict";var{CID:vue}=(xe(),Ce),Hrt=ve(),$rt=Se(),Grt=DT();wue.exports=Hrt((r,e)=>{async function*t(i,n={}){let s=`${i instanceof Uint8Array?vue.decode(i):i}`;async function o(c){let f=c.Hash;if(f.includes("/")){let h=f.startsWith("/ipfs/")?f:`/ipfs/${f}`;f=(await Grt(e)(h)).cid}else f=vue.parse(f);let l={name:c.Name,path:s+(c.Name?`/${c.Name}`:""),size:c.Size,cid:f,type:Wrt(c),depth:c.Depth||1};return c.Mode&&(l.mode=parseInt(c.Mode,8)),c.Mtime!==void 0&&c.Mtime!==null&&(l.mtime={secs:c.Mtime},c.MtimeNsecs!==void 0&&c.MtimeNsecs!==null&&(l.mtime.nsecs=c.MtimeNsecs)),l}let a=await r.post("ls",{timeout:n.timeout,signal:n.signal,searchParams:$rt({arg:s,...n}),headers:n.headers});for await(let c of a.ndjson()){if(c=c.Objects,!c)throw new Error("expected .Objects in results");if(c=c[0],!c)throw new Error("expected one array in results.Objects");let f=c.Links;if(!Array.isArray(f))throw new Error("expected one array in results.Objects[0].Links");if(!f.length){yield o(c);return}yield*f.map(o)}}return t});function Wrt(r){switch(r.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}});var Sue=p((TPt,Eue)=>{u();"use strict";var Yrt=Xr(),Xrt=ve(),Qrt=Se();Eue.exports=Xrt(r=>{async function e(t={}){let i=await r.post("dns",{timeout:t.timeout,signal:t.signal,searchParams:Qrt(t),headers:t.headers});return Yrt(await i.json())}return e})});var xue=p((RPt,Aue)=>{u();"use strict";var Jrt=Xr(),Zrt=ve(),eit=Se();Aue.exports=Zrt(r=>{async function e(t,i={}){let n=await r.post("name/publish",{timeout:i.timeout,signal:i.signal,searchParams:eit({arg:t,...i}),headers:i.headers});return Jrt(await n.json())}return e})});var Tue=p((PPt,Iue)=>{u();"use strict";var tit=ve(),rit=Se();Iue.exports=tit(r=>{async function*e(t,i={}){let n=await r.post("name/resolve",{timeout:i.timeout,signal:i.signal,searchParams:rit({arg:t,stream:!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield s.Path}return e})});var Pue=p((CPt,Rue)=>{u();"use strict";var iit=Xr(),nit=ve(),sit=Se();Rue.exports=nit(r=>{async function e(t,i={}){let n=await r.post("name/pubsub/cancel",{timeout:i.timeout,signal:i.signal,searchParams:sit({arg:t,...i}),headers:i.headers});return iit(await n.json())}return e})});var Oue=p((OPt,Cue)=>{u();"use strict";var oit=Xr(),ait=ve(),cit=Se();Cue.exports=ait(r=>{async function e(t={}){let i=await r.post("name/pubsub/state",{timeout:t.timeout,signal:t.signal,searchParams:cit(t),headers:t.headers});return oit(await i.json())}return e})});var kue=p((qPt,que)=>{u();"use strict";var uit=ve(),lit=Se();que.exports=uit(r=>{async function e(t={}){return(await(await r.post("name/pubsub/subs",{timeout:t.timeout,signal:t.signal,searchParams:lit(t),headers:t.headers})).json()).Strings||[]}return e})});var Nue=p((kPt,Bue)=>{u();"use strict";Bue.exports=r=>({cancel:Pue()(r),state:Oue()(r),subs:kue()(r)})});var Mue=p((BPt,Due)=>{u();"use strict";Due.exports=r=>({publish:xue()(r),resolve:Tue()(r),pubsub:Nue()(r)})});var Uue=p((NPt,Lue)=>{u();"use strict";var{CID:fit}=(xe(),Ce),hit=ve(),dit=Se();Lue.exports=hit(r=>{async function e(t,i={}){let s=await(await r.post("object/data",{timeout:i.timeout,signal:i.signal,searchParams:dit({arg:`${t instanceof Uint8Array?fit.decode(t):t}`,...i}),headers:i.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return e})});var jue=p((DPt,Kue)=>{u();"use strict";var{CID:Fue}=(xe(),Ce),pit=ve(),yit=Se(),git=ct();Kue.exports=pit(r=>{async function e(t,i={}){let s=await(await r.post("object/get",{timeout:i.timeout,signal:i.signal,searchParams:yit({arg:`${t instanceof Uint8Array?Fue.decode(t):t}`,dataEncoding:"base64",...i}),headers:i.headers})).json();return{Data:git(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:Fue.parse(o.Hash),Tsize:o.Size}))}}return e})});var Hue=p((MPt,zue)=>{u();"use strict";var{CID:Vue}=(xe(),Ce),bit=ve(),mit=Se();zue.exports=bit(r=>{async function e(t,i={}){return((await(await r.post("object/links",{timeout:i.timeout,signal:i.signal,searchParams:mit({arg:`${t instanceof Uint8Array?Vue.decode(t):t}`,...i}),headers:i.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:Vue.parse(o.Hash)}))}return e})});var Gue=p((LPt,$ue)=>{u();"use strict";var{CID:vit}=(xe(),Ce),wit=ve(),_it=Se();$ue.exports=wit(r=>{async function e(t={}){let i=await r.post("object/new",{timeout:t.timeout,signal:t.signal,searchParams:_it({arg:t.template,...t}),headers:t.headers}),{Hash:n}=await i.json();return vit.parse(n)}return e})});var Yue=p((UPt,Wue)=>{u();"use strict";var{CID:Eit}=(xe(),Ce),Sit=ve(),Ait=Se();Wue.exports=Sit(r=>{async function e(t,i,n={}){let s=await r.post("object/patch/add-link",{timeout:n.timeout,signal:n.signal,searchParams:Ait({arg:[`${t}`,i.Name||i.name||"",(i.Hash||i.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return Eit.parse(o)}return e})});var Que=p((FPt,Xue)=>{u();"use strict";var{CID:xit}=(xe(),Ce),Iit=Co(),Tit=ve(),Rit=Se(),Pit=Oo(),{AbortController:Cit}=Ji();Xue.exports=Tit(r=>{async function e(t,i,n={}){let s=new Cit,o=Pit(s.signal,n.signal),a=await r.post("object/patch/append-data",{timeout:n.timeout,signal:o,searchParams:Rit({arg:`${t}`,...n}),...await Iit(i,s,n.headers)}),{Hash:c}=await a.json();return xit.parse(c)}return e})});var Zue=p((KPt,Jue)=>{u();"use strict";var{CID:Oit}=(xe(),Ce),qit=ve(),kit=Se();Jue.exports=qit(r=>{async function e(t,i,n={}){let s=await r.post("object/patch/rm-link",{timeout:n.timeout,signal:n.signal,searchParams:kit({arg:[`${t}`,i.Name||i.name||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return Oit.parse(o)}return e})});var tle=p((jPt,ele)=>{u();"use strict";var{CID:Bit}=(xe(),Ce),Nit=Co(),Dit=ve(),Mit=Se(),Lit=Oo(),{AbortController:Uit}=Ji();ele.exports=Dit(r=>{async function e(t,i,n={}){let s=new Uit,o=Lit(s.signal,n.signal),a=await r.post("object/patch/set-data",{timeout:n.timeout,signal:o,searchParams:Mit({arg:[`${t}`],...n}),...await Nit(i,s,n.headers)}),{Hash:c}=await a.json();return Bit.parse(c)}return e})});var ile=p((VPt,rle)=>{u();"use strict";rle.exports=r=>({addLink:Yue()(r),appendData:Que()(r),rmLink:Zue()(r),setData:tle()(r)})});var sle=p((zPt,nle)=>{u();"use strict";var Fit=ve();nle.exports=(r,e)=>Fit(i=>{let n=BT()(r,e);async function s(o,a={}){return n(o,{...a,format:"dag-pb",hashAlg:"sha2-256",version:0})}return s})(e)});var ale=p((HPt,ole)=>{u();"use strict";var{CID:Kit}=(xe(),Ce),jit=ve(),Vit=Se();ole.exports=jit(r=>{async function e(t,i={}){let s=await(await r.post("object/stat",{timeout:i.timeout,signal:i.signal,searchParams:Vit({arg:`${t}`,...i}),headers:i.headers})).json();return{...s,Hash:Kit.parse(s.Hash)}}return e})});var ule=p(($Pt,cle)=>{u();"use strict";cle.exports=(r,e)=>({data:Uue()(e),get:jue()(e),links:Hue()(e),new:Gue()(e),patch:ile()(e),put:sle()(r,e),stat:ale()(e)})});var fle=p((GPt,lle)=>{u();"use strict";var zit=m2(),WT=Se(),Bc=class{constructor(e){this.client=new zit(e)}static encodeEndpoint(e){let t=String(e);if(t==="undefined")throw Error("endpoint is required");return t[t.length-1]==="/"?t.slice(0,-1):t}static decodeRemoteService(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:Bc.decodeStat(e.Stat)}}}static decodeStat(e){switch(e.Status){case"valid":{let{Pinning:t,Pinned:i,Queued:n,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:t,pinned:i,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}};Bc.prototype.add=async function(e,t){let{endpoint:i,key:n,headers:s,timeout:o,signal:a}=t;await this.client.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:WT({arg:[e,Bc.encodeEndpoint(i),n]}),headers:s})};Bc.prototype.rm=async function(e,t={}){await this.client.post("pin/remote/service/rm",{timeout:t.timeout,signal:t.signal,headers:t.headers,searchParams:WT({arg:e})})};Bc.prototype.ls=async function(e={}){let{stat:t,headers:i,timeout:n,signal:s}=e,o=await this.client.post("pin/remote/service/ls",{timeout:n,signal:s,headers:i,searchParams:t===!0?WT({stat:t}):void 0}),{RemoteServices:a}=await o.json();return a.map(Bc.decodeRemoteService)};lle.exports=Bc});var mle=p((WPt,ble)=>{u();"use strict";var{CID:hle}=(xe(),Ce),Hit=m2(),$it=fle(),dle=Se(),Sp=class{constructor(e){this.client=new Hit(e),this.service=new $it(e)}};Sp.prototype.add=async function(e,{timeout:t,signal:i,headers:n,...s}){let o=await this.client.post("pin/remote/add",{timeout:t,signal:i,headers:n,searchParams:Git({cid:e,...s})});return ple(await o.json())};Sp.prototype.ls=async function*({timeout:e,signal:t,headers:i,...n}){let s=await this.client.post("pin/remote/ls",{timeout:e,signal:t,headers:i,searchParams:YT(n)});for await(let o of s.ndjson())yield ple(o)};Sp.prototype.rm=async function({timeout:e,signal:t,headers:i,...n}){await this.client.post("pin/remote/rm",{timeout:e,signal:t,headers:i,searchParams:YT({...n,all:!1})})};Sp.prototype.rmAll=async function({timeout:r,signal:e,headers:t,...i}){await this.client.post("pin/remote/rm",{timeout:r,signal:e,headers:t,searchParams:YT({...i,all:!0})})};var ple=({Name:r,Status:e,Cid:t})=>({cid:hle.parse(t),name:r,status:e}),yle=r=>{if(typeof r=="string"&&r!=="")return r;throw new TypeError("service name must be passed")},gle=r=>{if(r instanceof hle)return r.toString();throw new TypeError(`CID instance expected instead of ${typeof r}`)},YT=({service:r,cid:e,name:t,status:i,all:n})=>{let s=dle({service:yle(r),name:t,force:n?!0:void 0});if(e)for(let o of e)s.append("cid",gle(o));if(i)for(let o of i)s.append("status",o);return s},Git=({cid:r,service:e,background:t,name:i,origins:n})=>{let s=dle({arg:gle(r),service:yle(e),name:i,background:t?!0:void 0});if(n)for(let o of n)s.append("origin",o.toString());return s};ble.exports=Sp});var XT=p((YPt,wle)=>{u();"use strict";var{CID:vle}=(xe(),Ce),Wit=ve(),Yit=_d(),Xit=Se();wle.exports=Wit(r=>{async function*e(t,i={}){for await(let{path:n,recursive:s,metadata:o}of Yit(t)){let a=await r.post("pin/add",{timeout:i.timeout,signal:i.signal,searchParams:Xit({...i,arg:n,recursive:s,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:i.headers});for await(let c of a.ndjson()){if(c.Pins){for(let f of c.Pins)yield vle.parse(f);continue}yield vle.parse(c)}}}return e})});var Ele=p((XPt,_le)=>{u();"use strict";var Qit=XT(),Jit=Un(),Zit=ve();_le.exports=r=>{let e=Qit(r);return Zit(()=>{async function t(i,n={}){return Jit(e([{path:i,...n}],n))}return t})(r)}});var xle=p((QPt,Ale)=>{u();"use strict";var{CID:ent}=(xe(),Ce),tnt=ve(),rnt=Se();function Sle(r,e,t){let i={type:r,cid:ent.parse(e)};return t&&(i.metadata=t),i}Ale.exports=tnt(r=>{async function*e(t={}){let i=[];t.paths&&(i=Array.isArray(t.paths)?t.paths:[t.paths]);let n=await r.post("pin/ls",{timeout:t.timeout,signal:t.signal,searchParams:rnt({...t,arg:i.map(s=>`${s}`),stream:!0}),headers:t.headers});for await(let s of n.ndjson()){if(s.Keys){for(let o of Object.keys(s.Keys))yield Sle(s.Keys[o].Type,o,s.Keys[o].Metadata);return}yield Sle(s.Type,s.Cid,s.Metadata)}}return e})});var QT=p((JPt,Tle)=>{u();"use strict";var{CID:Ile}=(xe(),Ce),int=ve(),nnt=_d(),snt=Se();Tle.exports=int(r=>{async function*e(t,i={}){for await(let{path:n,recursive:s}of nnt(t)){let o=new URLSearchParams(i.searchParams);o.append("arg",`${n}`),s!=null&&o.set("recursive",String(s));let a=await r.post("pin/rm",{timeout:i.timeout,signal:i.signal,headers:i.headers,searchParams:snt({...i,arg:`${n}`,recursive:s})});for await(let c of a.ndjson()){if(c.Pins){yield*c.Pins.map(f=>Ile.parse(f));continue}yield Ile.parse(c)}}}return e})});var Ple=p((ZPt,Rle)=>{u();"use strict";var ont=QT(),ant=Un(),cnt=ve();Rle.exports=r=>{let e=ont(r);return cnt(()=>{async function t(i,n={}){return ant(e([{path:i,...n}],n))}return t})(r)}});var Ole=p((eCt,Cle)=>{u();"use strict";var unt=mle();Cle.exports=r=>({add:Ele()(r),addAll:XT()(r),ls:xle()(r),rm:Ple()(r),rmAll:QT()(r),remote:new unt(r)})});var kle=p((tCt,qle)=>{u();"use strict";var lnt=Xr(),fnt=ve(),hnt=Se();qle.exports=fnt(r=>{async function*e(t,i={}){yield*(await r.post("ping",{timeout:i.timeout,signal:i.signal,searchParams:hnt({arg:`${t}`,...i}),headers:i.headers,transform:lnt})).ndjson()}return e})});var Dle=p((rCt,Nle)=>{u();"use strict";var{AbortController:dnt}=Ji(),Ble=class{constructor(){this._subs=new Map}subscribe(e,t,i){let n=this._subs.get(e)||[];if(n.find(o=>o.handler===t))throw new Error(`Already subscribed to ${e} with this handler`);let s=new dnt;return this._subs.set(e,[{handler:t,controller:s}].concat(n)),i&&i.addEventListener("abort",()=>this.unsubscribe(e,t)),s.signal}unsubscribe(e,t){let i=this._subs.get(e)||[],n;t?(this._subs.set(e,i.filter(s=>s.handler!==t)),n=i.filter(s=>s.handler===t)):(this._subs.set(e,[]),n=i),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(s=>s.controller.abort())}};Nle.exports=Ble});var Lle=p((iCt,Mle)=>{u();"use strict";var pnt=ve(),ynt=Se();Mle.exports=pnt(r=>{async function e(t={}){let{Strings:i}=await(await r.post("pubsub/ls",{timeout:t.timeout,signal:t.signal,searchParams:ynt(t),headers:t.headers})).json();return i||[]}return e})});var Fle=p((nCt,Ule)=>{u();"use strict";var gnt=ve(),bnt=Se();Ule.exports=gnt(r=>{async function e(t,i={}){let n=await r.post("pubsub/peers",{timeout:i.timeout,signal:i.signal,searchParams:bnt({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var jle=p((sCt,Kle)=>{u();"use strict";var mnt=ve(),vnt=Se(),wnt=Co(),_nt=Oo(),{AbortController:Ent}=Ji();Kle.exports=mnt(r=>{async function e(t,i,n={}){let s=vnt({arg:t,...n}),o=new Ent,a=_nt(o.signal,n.signal);await(await r.post("pubsub/pub",{timeout:n.timeout,signal:a,searchParams:s,...await wnt(i,o,n.headers)})).text()}return e})});var zle=p((oCt,Vle)=>{u();"use strict";var JT=ct(),Snt=Ze(),Ant=me()("ipfs-http-client:pubsub:subscribe"),xnt=ve(),Int=Se();Vle.exports=(r,e)=>xnt(t=>{async function i(n,s,o={}){o.signal=e.subscribe(n,s,o.signal);let a,c,f=new Promise((h,d)=>{a=h,c=d}),l=setTimeout(()=>a(),1e3);return setTimeout(()=>{t.post("pubsub/sub",{timeout:o.timeout,signal:o.signal,searchParams:Int({arg:n,...o}),headers:o.headers}).catch(h=>{e.unsubscribe(n,s),c(h)}).then(h=>{clearTimeout(l),!!h&&(Tnt(h,{onMessage:s,onEnd:()=>e.unsubscribe(n,s),onError:o.onError}),a())})},0),f}return i})(r);async function Tnt(r,{onMessage:e,onEnd:t,onError:i}){i=i||Ant;try{for await(let n of r.ndjson())try{if(!n.from)continue;e({from:Snt(JT(n.from,"base64pad"),"base58btc"),data:JT(n.data,"base64pad"),seqno:JT(n.seqno,"base64pad"),topicIDs:n.topicIDs})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,i(s,!1,n)}}catch(n){Rnt(n)||i(n,!0)}finally{t()}}var Rnt=r=>{switch(r.type){case"aborted":return!0;case"abort":return!0;default:return r.name==="AbortError"}}});var $le=p((aCt,Hle)=>{u();"use strict";Hle.exports=(r,e)=>{async function t(i,n){e.unsubscribe(i,n)}return t}});var Wle=p((cCt,Gle)=>{u();"use strict";var Pnt=Dle();Gle.exports=r=>{let e=new Pnt;return{ls:Lle()(r),peers:Fle()(r),publish:jle()(r),subscribe:zle()(r,e),unsubscribe:$le()(r,e)}}});var Xle=p((uCt,Yle)=>{u();"use strict";var Cnt=Xr(),Ont=ve(),qnt=Se();Yle.exports=Ont(r=>{async function*e(t={}){yield*(await r.post("refs/local",{timeout:t.timeout,signal:t.signal,transform:Cnt,searchParams:qnt(t),headers:t.headers})).ndjson()}return e})});var Jle=p((lCt,Qle)=>{u();"use strict";var{CID:knt}=(xe(),Ce),Bnt=Xr(),Nnt=ve(),Dnt=Se();Qle.exports=Nnt((r,e)=>Object.assign(async function*(i,n={}){let s=Array.isArray(i)?i:[i];yield*(await r.post("refs",{timeout:n.timeout,signal:n.signal,searchParams:Dnt({arg:s.map(a=>`${a instanceof Uint8Array?knt.decode(a):a}`),...n}),headers:n.headers,transform:Bnt})).ndjson()},{local:Xle()(e)}))});var efe=p((fCt,Zle)=>{u();"use strict";var{CID:Mnt}=(xe(),Ce),Lnt=ve(),Unt=Se();Zle.exports=Lnt(r=>{async function*e(t={}){yield*(await r.post("repo/gc",{timeout:t.timeout,signal:t.signal,searchParams:Unt(t),headers:t.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?Mnt.parse(n.Key["/"]):null})})).ndjson()}return e})});var ZT=p((hCt,tfe)=>{u();"use strict";var Fnt=ve(),Knt=Se();tfe.exports=Fnt(r=>{async function e(t={}){let n=await(await r.post("repo/stat",{timeout:t.timeout,signal:t.signal,searchParams:Knt(t),headers:t.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return e})});var ife=p((dCt,rfe)=>{u();"use strict";var jnt=ve(),Vnt=Se();rfe.exports=jnt(r=>{async function e(t={}){return(await(await r.post("repo/version",{timeout:t.timeout,signal:t.signal,searchParams:Vnt(t),headers:t.headers})).json()).Version}return e})});var sfe=p((pCt,nfe)=>{u();"use strict";nfe.exports=r=>({gc:efe()(r),stat:ZT()(r),version:ife()(r)})});var afe=p((yCt,ofe)=>{u();"use strict";var znt=ve(),Hnt=Se();ofe.exports=znt(r=>{async function e(t,i={}){let n=await r.post("resolve",{timeout:i.timeout,signal:i.signal,searchParams:Hnt({arg:t,...i}),headers:i.headers}),{Path:s}=await n.json();return s}return e})});var ufe=p((gCt,cfe)=>{u();"use strict";var $nt=ve();cfe.exports=$nt(r=>async(t={})=>{throw new Error("Not implemented")})});var ffe=p((bCt,lfe)=>{u();"use strict";var Gnt=ve(),Wnt=Se();lfe.exports=Gnt(r=>{async function*e(t={}){yield*(await r.post("stats/bw",{timeout:t.timeout,signal:t.signal,searchParams:Wnt(t),headers:t.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:BigInt(n.RateIn),rateOut:BigInt(n.RateOut)})})).ndjson()}return e})});var dfe=p((mCt,hfe)=>{u();"use strict";hfe.exports=r=>({bitswap:qT()(r),bw:ffe()(r),repo:ZT()(r)})});var yfe=p((vCt,pfe)=>{u();"use strict";var Ynt=ve(),Xnt=Se();pfe.exports=Ynt(r=>{async function e(t={}){await(await r.post("shutdown",{timeout:t.timeout,signal:t.signal,searchParams:Xnt(t),headers:t.headers})).text()}return e})});var bfe=p((wCt,gfe)=>{u();"use strict";var{Multiaddr:Qnt}=et(),Jnt=ve(),Znt=Se();gfe.exports=Jnt(r=>{async function e(t={}){let i=await r.post("swarm/addrs",{timeout:t.timeout,signal:t.signal,searchParams:Znt(t),headers:t.headers}),{Addrs:n}=await i.json();return Object.keys(n).map(s=>({id:s,addrs:(n[s]||[]).map(o=>new Qnt(o))}))}return e})});var vfe=p((_Ct,mfe)=>{u();"use strict";var est=ve(),tst=Se();mfe.exports=est(r=>{async function e(t,i={}){let n=await r.post("swarm/connect",{timeout:i.timeout,signal:i.signal,searchParams:tst({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var _fe=p((ECt,wfe)=>{u();"use strict";var rst=ve(),ist=Se();wfe.exports=rst(r=>{async function e(t,i={}){let n=await r.post("swarm/disconnect",{timeout:i.timeout,signal:i.signal,searchParams:ist({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var Sfe=p((SCt,Efe)=>{u();"use strict";var{Multiaddr:nst}=et(),sst=ve(),ost=Se();Efe.exports=sst(r=>{async function e(t={}){let i=await r.post("swarm/addrs/local",{timeout:t.timeout,signal:t.signal,searchParams:ost(t),headers:t.headers}),{Strings:n}=await i.json();return(n||[]).map(s=>new nst(s))}return e})});var xfe=p((ACt,Afe)=>{u();"use strict";var{Multiaddr:ast}=et(),cst=ve(),ust=Se();Afe.exports=cst(r=>{async function e(t={}){let i=await r.post("swarm/peers",{timeout:t.timeout,signal:t.signal,searchParams:ust(t),headers:t.headers}),{Peers:n}=await i.json();return(n||[]).map(s=>({addr:new ast(s.Addr),peer:s.Peer,muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return e})});var Tfe=p((xCt,Ife)=>{u();"use strict";Ife.exports=r=>({addrs:bfe()(r),connect:vfe()(r),disconnect:_fe()(r),localAddrs:Sfe()(r),peers:xfe()(r)})});var Pfe=p((ICt,Rfe)=>{u();"use strict";var lst=Xr(),fst=ve(),hst=Se();Rfe.exports=fst(r=>{async function e(t={}){let i=await r.post("version",{timeout:t.timeout,signal:t.signal,searchParams:hst(t),headers:t.headers});return lst(await i.json())}return e})});var Ofe=p((TCt,Cfe)=>{u();"use strict";var{CID:dst}=(xe(),Ce),{multiaddr:pst}=et(),yst=QS(),gst=c3(),bst=AT(),mst=xT(),vst=IT(),wst=(xt(),At),_st=(mc(),$l),Est=(Xn(),kn),Sst=(_1(),hy),{sha256:Ast,sha512:xst}=(Hr(),Ir),{identity:eR}=(cc(),aa),{base58btc:Ist}=(zr(),Vr);function Tst(r={}){let e={name:eR.name,code:eR.code,encode:o=>o,decode:o=>o},t=new vst({bases:[Ist].concat(r.ipld&&r.ipld.bases?r.ipld.bases:[]),loadBase:r.ipld&&r.ipld.loadBase}),i=new bst({codecs:[wst,_st,Est,Sst,e].concat(r.ipld?.codecs||[]),loadCodec:r.ipld&&r.ipld.loadCodec}),n=new mst({hashers:[Ast,xst,eR].concat(r.ipld&&r.ipld.hashers?r.ipld.hashers:[]),loadHasher:r.ipld&&r.ipld.loadHasher});return{add:ioe()(r),addAll:OT()(r),bitswap:hoe()(r),block:_oe()(r),bootstrap:koe()(r),cat:Noe()(r),commands:Moe()(r),config:Zoe()(r),dag:gae()(i,r),dht:Oae()(r),diag:Uae()(r),dns:Kae()(r),files:gce()(r),get:Vce()(r),getEndpointConfig:Hce()(r),id:GT()(r),isOnline:Wce()(r),key:lue()(r),log:mue()(r),ls:_ue()(r),mount:Sue()(r),name:Mue()(r),object:ule()(i,r),pin:Ole()(r),ping:kle()(r),pubsub:Wle()(r),refs:Jle()(r),repo:sfe()(r),resolve:afe()(r),start:ufe()(r),stats:dfe()(r),stop:yfe()(r),swarm:Tfe()(r),version:Pfe()(r),bases:t,codecs:i,hashers:n}}Cfe.exports={create:Tst,CID:dst,multiaddr:pst,globSource:yst,urlSource:gst}});var tR=p((RCt,qfe)=>{u();"use strict";var Rst=ue(),Pst=wc(),Cst=mo(),Ost=md();function qst(r,e){return Cst(r,t=>(e.addressBook.add(t.id,t.multiaddrs),t))}function kst(r){let e=new Set;return Pst(r,t=>e.has(t.id.toString())?!1:(e.add(t.id.toString()),!0))}async function*Bst(r,e=1){let t=0;for await(let i of r)t++,yield i;if(t<e)throw Rst(new Error("not found"),"NOT_FOUND")}function Nst(r,e){return e?Ost(r,e):r}qfe.exports={storeAddresses:qst,uniquePeers:kst,requirePeers:Bst,maybeLimitSource:Nst}});var rR=p((PCt,kfe)=>{u();"use strict";var Ap=new Map,Dst=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function Mst(r,e,t){for(;Ap.get(t);){try{await r()}catch(i){setTimeout(()=>{throw i},1);break}if(!Ap.get(t))break;await new Promise(i=>{let n=setTimeout(i,e);Ap.set(t,n)})}}function Lst(r,e,t){t=t||e;let i=Dst(),n=setTimeout(()=>{Mst(r,e,i)},t);return Ap.set(i,n),i}function Ust(r){let e=Ap.get(r);e&&(clearTimeout(e),Ap.delete(r))}kfe.exports={setDelayedInterval:Lst,clearDelayedInterval:Ust}});var Ffe=p((CCt,Ufe)=>{u();"use strict";var Bfe=me(),Fst=Object.assign(Bfe("libp2p:peer-routing"),{error:Bfe("libp2p:peer-routing:err")}),I2=ue(),{storeAddresses:Nfe,uniquePeers:Kst,requirePeers:jst}=tR(),Dfe=Pd(),{pipe:Mfe}=Gr(),Vst=xd(),zst=Ia(),Hst=wc(),{setDelayedInterval:$st,clearDelayedInterval:Gst}=rR(),Lfe=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(e._dht),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=$st(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await zst(this.getClosestPeers(this._peerId.id))}catch(e){Fst.error(e)}}stop(){Gst(this._timeoutId)}async findPeer(e,t){if(!this._routers.length)throw I2(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");if(e.toB58String()===this._peerId.toB58String())throw I2(new Error("Should not try to find self"),"ERR_FIND_SELF");let i=await Mfe(Dfe(...this._routers.map(n=>[n.findPeer(e,t)])),n=>Hst(n,Boolean),n=>Nfe(n,this._peerStore),n=>Vst(n));if(i)return i;throw I2(new Error("not found"),"NOT_FOUND")}async*getClosestPeers(e,t={timeout:3e4}){if(!this._routers.length)throw I2(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");yield*Mfe(Dfe(...this._routers.map(i=>i.getClosestPeers(e,t))),i=>Nfe(i,this._peerStore),i=>Kst(i),i=>jst(i))}};Ufe.exports=Lfe});var Vfe=p((OCt,jfe)=>{u();"use strict";var mb=ue(),{messages:iR,codes:nR}=di(),{storeAddresses:Wst,uniquePeers:Yst,requirePeers:Xst,maybeLimitSource:Qst}=tR(),Jst=Pd(),{pipe:Zst}=Gr(),Kfe=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(this.dht)}async*findProviders(e,t={}){if(!this.routers.length)throw mb(new Error("No content this.routers available"),"NO_ROUTERS_AVAILABLE");yield*Zst(Jst(...this.routers.map(i=>i.findProviders(e,t))),i=>Wst(i,this.libp2p.peerStore),i=>Yst(i),i=>Qst(i,t.maxNumProviders),i=>Xst(i))}async provide(e){if(!this.routers.length)throw mb(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");await Promise.all(this.routers.map(t=>t.provide(e)))}put(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw mb(new Error(iR.NOT_STARTED_YET),nR.DHT_NOT_STARTED);return this.dht.put(e,t,i)}get(e,t){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw mb(new Error(iR.NOT_STARTED_YET),nR.DHT_NOT_STARTED);return this.dht.get(e,t)}async getMany(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw mb(new Error(iR.NOT_STARTED_YET),nR.DHT_NOT_STARTED);return this.dht.getMany(e,t,i)}};jfe.exports=Kfe});var sR=p((qCt,Gfe)=>{u();"use strict";var eot=rt(),{Multiaddr:zfe}=et(),Hfe=ue(),{codes:$fe}=di();function tot(r){typeof r=="string"&&(r=new zfe(r));let e;if(zfe.isMultiaddr(r)){e=r;let t=r.getPeerId();if(!t)throw Hfe(new Error(`${r} does not have a valid peer type`),$fe.ERR_INVALID_MULTIADDR);try{r=eot.createFromB58String(t)}catch(i){throw Hfe(new Error(`${r} is not a valid peer type`),$fe.ERR_INVALID_MULTIADDR)}}return{id:r,multiaddrs:e?[e]:void 0}}Gfe.exports=tot});var Yfe=p((kCt,Wfe)=>{u();var xp=1e3,Ip=xp*60,Tp=Ip*60,Nf=Tp*24,rot=Nf*7,iot=Nf*365.25;Wfe.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return not(r);if(t==="number"&&isFinite(r))return e.long?oot(r):sot(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function not(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*iot;case"weeks":case"week":case"w":return t*rot;case"days":case"day":case"d":return t*Nf;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Tp;case"minutes":case"minute":case"mins":case"min":case"m":return t*Ip;case"seconds":case"second":case"secs":case"sec":case"s":return t*xp;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function sot(r){var e=Math.abs(r);return e>=Nf?Math.round(r/Nf)+"d":e>=Tp?Math.round(r/Tp)+"h":e>=Ip?Math.round(r/Ip)+"m":e>=xp?Math.round(r/xp)+"s":r+"ms"}function oot(r){var e=Math.abs(r);return e>=Nf?T2(r,e,Nf,"day"):e>=Tp?T2(r,e,Tp,"hour"):e>=Ip?T2(r,e,Ip,"minute"):e>=xp?T2(r,e,xp,"second"):r+" ms"}function T2(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var Jfe=p((BCt,Qfe)=>{u();"use strict";Qfe.exports=Xfe;var aot=Yfe(),tl=Xfe.prototype,cot=new Date%1e9;function uot(){return(Math.random()*1e9>>>0)+cot++}function Xfe(r){r=r||{},this.id=r.id||uot(),this.max=r.max||1/0,this.items=r.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(r.lastModified||new Date);for(var e,t,i=this.items.length;i--;)e=this.items[i],t=new Date(e.expires)-new Date,this._lookup[e.key]=e,t>0?this.expire(e.key,t):t<=0&&this.delete(e.key)}tl.has=function(r){return r in this._lookup};tl.get=function(r){if(!this.has(r))return null;var e=this._lookup[r];return e.refresh&&this.expire(r,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};tl.meta=function(r){if(!this.has(r))return null;var e=this._lookup[r];return"meta"in e?e.meta:null};tl.set=function(r,e,t){var i=this._lookup[r],n=this._lookup[r]={key:r,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),t&&("ttl"in t&&this.expire(r,t.ttl),"meta"in t&&(n.meta=t.meta),t.refresh&&(n.refresh=t.ttl)),this};tl.delete=function(r){var e=this._lookup[r];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[r],this.size--,this):!1};tl.expire=function(r,e){var t=e||0,i=this._lookup[r];if(!i)return this;if(typeof t=="string"&&(t=aot(e)),typeof t!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),t),i.expires=Number(new Date)+t,this};tl.clear=function(){for(var r=this.items.length;r--;)this.delete(this.items[r].key);return this};tl.toJSON=function(){for(var r=new Array(this.items.length),e,t=r.length;t--;)e=this.items[t],r[t]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:r}}});var ehe=p((NCt,Zfe)=>{u();"use strict";var{default:lot,Headers:fot}=t3();function hot({serverResolver:r,hostname:e,recordType:t}){return`${r}?name=${e}&type=${t}`}function dot(r){return lot(r,{headers:new fot({accept:"application/dns-json"})})}function pot(r,e){return`${e}_${r}`}Zfe.exports={buildResource:hot,fetch:dot,getCacheKey:pot}});var ihe=p((DCt,rhe)=>{u();"use strict";var the=me(),R2=the("dns-over-http-resolver");R2.error=the("dns-over-http-resolver:error");var yot=Jfe(),Ls=ehe(),P2=class{constructor({maxCache:e=100}={}){this._cache=new yot({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let t=e.length-1;t>0;t--){let i=Math.floor(Math.random()*t),n=e[t];e[t]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,t="A"){switch(t){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){let t="A",i=this._cache.get(Ls.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Ls.fetch(Ls.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(f=>f.data),c=Math.min(o.Answer.map(f=>f.TTL));return this._cache.set(Ls.getCacheKey(e,t),a,{ttl:c}),a}catch(s){R2.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){let t="AAAA",i=this._cache.get(Ls.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Ls.fetch(Ls.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(f=>f.data),c=Math.min(o.Answer.map(f=>f.TTL));return this._cache.set(Ls.getCacheKey(e,t),a,{ttl:c}),a}catch(s){R2.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){let t="TXT",i=this._cache.get(Ls.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Ls.fetch(Ls.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(f=>[f.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(f=>f.TTL));return this._cache.set(Ls.getCacheKey(e,t),a,{ttl:c}),a}catch(s){R2.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}};P2.Resolver=P2;rhe.exports=P2});var she=p((MCt,nhe)=>{u();"use strict";var got=ihe();nhe.exports=got});var ahe=p((LCt,ohe)=>{u();"use strict";var bot=Oy(),{code:mot}=bot("dnsaddr");async function vot(r){let e=she(),t=new e,i=r.getPeerId(),[,n]=r.stringTuples().find(([a])=>a===mot)||[],o=(await t.resolveTxt(`_dnsaddr.${n}`)).flat().map(a=>a.split("=")[1]);return i&&(o=o.filter(a=>a.includes(i))),o}ohe.exports={dnsaddrResolver:vot}});var C2=p((UCt,che)=>{u();"use strict";che.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var oR=p((FCt,wot)=>{wot.exports={_from:"libp2p@^0.32.0",_id:"libp2p@0.32.1",_inBundle:!1,_integrity:"sha512-2kRyCPBgEAhBIjoOgboOiAmhtfDNXti+63DwVQ3WdakznZj+zn101SPV7EmLLatBq3IJkVh+tdCI0S1W46Wvyw==",_location:"/libp2p",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"libp2p@^0.32.0",name:"libp2p",escapedName:"libp2p",rawSpec:"^0.32.0",saveSpec:null,fetchSpec:"^0.32.0"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/libp2p/-/libp2p-0.32.1.tgz",_shasum:"76efbcdb6a44aceb21632186ffd5964437592487",_spec:"libp2p@^0.32.0",_where:"/Users/alex/Documents/Workspaces/ipfs/js-ipfs",browser:{"@motrix/nat-api":!1},bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},bundleDependencies:!1,contributors:[{name:"Vasco Santos",email:"vasco.santos@moxy.studio"},{name:"David Dias",email:"daviddias.p@gmail.com"},{name:"Jacob Heun",email:"jacobheun@gmail.com"},{name:"Alex Potsides",email:"alex@achingbrain.net"},{name:"Alan Shaw",email:"alan@tableflip.io"},{name:"Cayman",email:"caymannava@gmail.com"},{name:"Pedro Teixeira",email:"i@pgte.me"},{name:"Friedel Ziegelmayer",email:"dignifiedquire@gmail.com"},{name:"Maciej Kr\xFCger",email:"mkg20001@gmail.com"},{name:"Hugo Dias",email:"mail@hugodias.me"},{name:"Volker Mische",email:"volker.mische@gmail.com"},{name:"Chris Dostert",email:"chrisdostert@users.noreply.github.com"},{name:"dirkmc",email:"dirkmdev@gmail.com"},{name:"zeim839",email:"50573884+zeim839@users.noreply.github.com"},{name:"Richard Littauer",email:"richard.littauer@gmail.com"},{name:"Ryan Bell",email:"ryan@piing.net"},{name:"a1300",email:"matthias-knopp@gmx.net"},{name:"\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D",email:"victorbjelkholm@gmail.com"},{name:"Samlior",email:"samlior@foxmail.com"},{name:"Franck Royer",email:"franck@royer.one"},{name:"Thomas Eizinger",email:"thomas@eizinger.io"},{name:"Giovanni T. Parra",email:"fiatjaf@gmail.com"},{name:"acolytec3",email:"17355484+acolytec3@users.noreply.github.com"},{name:"Elven",email:"mon.samuel@qq.com"},{name:"Andrew Nesbitt",email:"andrewnez@gmail.com"},{name:"Didrik Nordstr\xF6m",email:"didrik.nordstrom@gmail.com"},{name:"RasmusErik Voel Jensen",email:"github@solsort.com"},{name:"Robert Kiel",email:"robert.kiel@hoprnet.org"},{name:"Aditya Bose",email:"13054902+adbose@users.noreply.github.com"},{name:"Smite Chow",email:"xiaopengyou@live.com"},{name:"Soeren",email:"nikorpoulsen@gmail.com"},{name:"S\xF6nke Hahn",email:"soenkehahn@gmail.com"},{name:"TJKoury",email:"TJKoury@gmail.com"},{name:"Tiago Alves",email:"alvesjtiago@gmail.com"},{name:"Yusef Napora",email:"yusef@napora.org"},{name:"Zane Starr",email:"zcstarr@gmail.com"},{name:"ebinks",email:"elizabethjbinks@gmail.com"},{name:"isan_rivkin",email:"isanrivkin@gmail.com"},{name:"mayerwin",email:"mayerwin@users.noreply.github.com"},{name:"mcclure",email:"andi.m.mcclure@gmail.com"},{name:"phillmac",email:"phillmac@users.noreply.github.com"},{name:"robertkiel",email:"robert.kiel@validitylabs.org"},{name:"shresthagrawal",email:"34920931+shresthagrawal@users.noreply.github.com"},{name:"swedneck",email:"40505480+swedneck@users.noreply.github.com"},{name:"Aleksei",email:"vozhdb@gmail.com"},{name:"Bernd Strehl",email:"bernd.strehl@gmail.com"},{name:"Chris Bratlien",email:"chrisbratlien@gmail.com"},{name:"Cindy Wu",email:"ciindy.wu@gmail.com"},{name:"Daijiro Wachi",email:"daijiro.wachi@gmail.com"},{name:"Diogo Silva",email:"fsdiogo@gmail.com"},{name:"Dmitriy Ryajov",email:"dryajov@gmail.com"},{name:"Ethan Lam",email:"elmemphis2000@gmail.com"},{name:"Fei Liu",email:"liu.feiwood@gmail.com"},{name:"Felipe Martins",email:"felipebrasil93@gmail.com"},{name:"Florian-Merle",email:"florian.david.merle@gmail.com"},{name:"Francis Gulotta",email:"wizard@roborooter.com"},{name:"Guy Sviry",email:"32539816+guysv@users.noreply.github.com"},{name:"Henrique Dias",email:"hacdias@gmail.com"},{name:"Irakli Gozalishvili",email:"rfobic@gmail.com"},{name:"Joel Gustafson",email:"joelg@mit.edu"},{name:"John Rees",email:"johnrees@users.noreply.github.com"},{name:"Jo\xE3o Santos",email:"joaosantos15@users.noreply.github.com"},{name:"Julien Bouquillon",email:"contact@revolunet.com"},{name:"Kevin Kwok",email:"antimatter15@gmail.com"},{name:"Kevin Lacker",email:"lacker@gmail.com"},{name:"Lars Gierth",email:"lgierth@users.noreply.github.com"},{name:"Marcin Tojek",email:"mtojek@users.noreply.github.com"},{name:"Michael Burns",email:"5170+mburns@users.noreply.github.com"},{name:"Miguel Mota",email:"miguelmota2@gmail.com"},{name:"Nuno Nogueira",email:"nunofmn@gmail.com"},{name:"Philipp Muens",email:"raute1337@gmx.de"}],dependencies:{"@motrix/nat-api":"^0.3.1","@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1","class-is":"^1.1.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^6.1.1",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^5.1.1","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-take":"^1.0.0","libp2p-crypto":"^0.19.4","libp2p-interfaces":"^1.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.15.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^1.1.1",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},deprecated:!1,description:"JavaScript implementation of libp2p, a modular peer to peer network stack",devDependencies:{"@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^0.10.1","@types/varint":"^6.0.0","abortable-iterator":"^3.0.0",aegir:"^33.1.1",buffer:"^6.0.3",delay:"^5.0.0","interop-libp2p":"^0.4.0","into-stream":"^6.0.0","ipfs-http-client":"^50.1.1","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.13.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.10.0","libp2p-interfaces-compliance-tests":"^1.0.0","libp2p-kad-dht":"^0.23.0","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.1","libp2p-noise":"^4.0.0","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.0",multihashes:"^4.0.2",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^11.1.1",uint8arrays:"^2.1.3",util:"^0.12.3"},engines:{node:">=14.0.0"},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use"]},files:["dist","src"],homepage:"https://libp2p.io",keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",license:"MIT",main:"src/index.js",name:"libp2p",repository:{type:"git",url:"git+https://github.com/libp2p/js-libp2p.git"},scripts:{build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",lint:"aegir lint",prepare:"aegir build --no-bundle",release:"aegir release -t node -t browser","release-major":"aegir release --type major -t node -t browser","release-minor":"aegir release --type minor -t node -t browser",test:"aegir test","test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use"},types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},version:"0.32.1"}});var aR=p((KCt,vb)=>{u();"use strict";var _ot=oR().version;vb.exports.PROTOCOL_VERSION="ipfs/0.1.0";vb.exports.AGENT_VERSION=`js-libp2p/${_ot}`;vb.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";vb.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0"});var O2=p((jCt,lhe)=>{u();"use strict";var uhe=60*1e3;lhe.exports={ADVERTISE_BOOT_DELAY:15*uhe,ADVERTISE_TTL:30*uhe,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var fhe=p(wb=>{u();(function(){var r,e,t,i,n,s,o,a;a=function(c){var f,l,h,d;return f=(c&255<<24)>>>24,l=(c&255<<16)>>>16,h=(c&255<<8)>>>8,d=c&255,[f,l,h,d].join(".")},o=function(c){var f,l,h,d,y,g;for(f=[],h=d=0;d<=3&&c.length!==0;h=++d){if(h>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}g=e(c),y=g[0],l=g[1],c=c.substring(l),f.push(y)}if(c.length!==0)throw new Error("Invalid IP");switch(f.length){case 1:if(f[0]>4294967295)throw new Error("Invalid IP");return f[0]>>>0;case 2:if(f[0]>255||f[1]>16777215)throw new Error("Invalid IP");return(f[0]<<24|f[1])>>>0;case 3:if(f[0]>255||f[1]>255||f[2]>65535)throw new Error("Invalid IP");return(f[0]<<24|f[1]<<16|f[2])>>>0;case 4:if(f[0]>255||f[1]>255||f[2]>255||f[3]>255)throw new Error("Invalid IP");return(f[0]<<24|f[1]<<16|f[2]<<8|f[3])>>>0;default:throw new Error("Invalid IP")}},t=function(c){return c.charCodeAt(0)},i=t("0"),s=t("a"),n=t("A"),e=function(c){var f,l,h,d,y;for(d=0,f=10,l="9",h=0,c.length>1&&c[h]==="0"&&(c[h+1]==="x"||c[h+1]==="X"?(h+=2,f=16):"0"<=c[h+1]&&c[h+1]<="9"&&(h++,f=8,l="7")),y=h;h<c.length;){if("0"<=c[h]&&c[h]<=l)d=d*f+(t(c[h])-i)>>>0;else if(f===16)if("a"<=c[h]&&c[h]<="f")d=d*f+(10+t(c[h])-s)>>>0;else if("A"<=c[h]&&c[h]<="F")d=d*f+(10+t(c[h])-n)>>>0;else break;else break;if(d>4294967295)throw new Error("too large");h++}if(h===y)throw new Error("empty octet");return[d,h]},r=function(){function c(f,l){var h,d,y,g;if(typeof f!="string")throw new Error("Missing `net' parameter");if(l||(g=f.split("/",2),f=g[0],l=g[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(m){throw h=m,new Error("Invalid mask: "+l)}for(d=y=32;y>=0;d=--y)if(this.maskLong===4294967295<<32-d>>>0){this.bitmask=d;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(f)&this.maskLong)>>>0}catch(m){throw h=m,new Error("Invalid net address: "+f)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(f){return typeof f=="string"&&(f.indexOf("/")>0||f.split(".").length!==4)&&(f=new c(f)),f instanceof c?this.contains(f.base)&&this.contains(f.broadcast||f.last):(o(f)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(f){return f==null&&(f=1),new c(a(this.netLong+this.size*f),this.mask)},c.prototype.forEach=function(f){var l,h,d;for(d=o(this.first),h=o(this.last),l=0;d<=h;)f(a(d),d,l),l++,d++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),wb.ip2long=o,wb.long2ip=a,wb.Netmask=r}).call(wb)});var phe=p((zCt,dhe)=>{u();var Eot=fhe().Netmask,hhe=eA(),Sot=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],Aot=Sot.map(r=>new Eot(r));function xot(r){for(let e of Aot)if(e.contains(r))return!0;return!1}function Iot(r){return/^::$/.test(r)||/^::1$/.test(r)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(r)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(r)||/^ff([0-9a-fA-F]{2,2}):/i.test(r)}dhe.exports=r=>hhe.v6().test(r)?Iot(r):hhe().test(r)||r.startsWith("0")?xot(r):!1});var cR=p((HCt,yhe)=>{u();"use strict";yhe.exports=phe()});var bhe=p(($Ct,ghe)=>{u();"use strict";var Tot=cR();function Rot(r){let{address:e}=r.nodeAddress();return Tot(e)}ghe.exports=Rot});var uR=p((GCt,vhe)=>{u();"use strict";var mhe=bhe();function Pot(r,e){let t=mhe(r.multiaddr),i=mhe(e.multiaddr);return t&&!i?1:!t&&i||r.isCertified&&!e.isCertified?-1:!r.isCertified&&e.isCertified?1:0}function Cot(r){return[...r].sort(Pot)}vhe.exports.publicAddressesFirst=Cot});var _he=p((WCt,lR)=>{u();"use strict";var whe=async r=>{try{let e=await r;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};lR.exports=whe;lR.exports.default=whe});var She=p((YCt,fR)=>{u();"use strict";var Ehe=(r,...e)=>new Promise(t=>{t(r(...e))});fR.exports=Ehe;fR.exports.default=Ehe});var xhe=p((XCt,hR)=>{u();"use strict";var Oot=She(),Ahe=r=>{if(!((Number.isInteger(r)||r===1/0)&&r>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],t=0,i=()=>{t--,e.length>0&&e.shift()()},n=(a,c,...f)=>{t++;let l=Oot(a,...f);c(l),l.then(i,i)},s=(a,c,...f)=>{t<r?n(a,c,...f):e.push(n.bind(null,a,c,...f))},o=(a,...c)=>new Promise(f=>s(a,f,...c));return Object.defineProperties(o,{activeCount:{get:()=>t},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};hR.exports=Ahe;hR.exports.default=Ahe});var The=p((QCt,Ihe)=>{u();"use strict";var dR=_he(),qot=xhe();Ihe.exports=async(r,e={})=>{let{concurrency:t=1/0}=e,i=qot(t);return Promise.all(r.map(n=>n&&typeof n.then=="function"?dR(n):typeof n=="function"?dR(i(()=>n())):dR(Promise.resolve(n))))}});var Phe=p((JCt,Rhe)=>{u();"use strict";function kot(r,e){return r.length===e.length&&e.sort()&&r.sort().every((t,i)=>e[i].equals(t))}Rhe.exports=kot});var qhe=p((ZCt,Ohe)=>{u();"use strict";var Df=Pi(),q2=Df.Reader,Che=Df.Writer,Qr=Df.util,Us=Df.roots["libp2p-peer-record"]||(Df.roots["libp2p-peer-record"]={});Us.PeerRecord=function(){function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.peerId=Qr.newBuffer([]),r.prototype.seq=Qr.Long?Qr.Long.fromBits(0,0,!0):0,r.prototype.addresses=Qr.emptyArray,r.encode=function(t,i){if(i||(i=Che.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&i.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&i.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)Us.PeerRecord.AddressInfo.encode(t.addresses[n],i.uint32(26).fork()).ldelim();return i},r.decode=function(t,i){t instanceof q2||(t=q2.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Us.PeerRecord;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.peerId=t.bytes();break;case 2:s.seq=t.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(Us.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Us.PeerRecord)return t;var i=new Us.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?Qr.base64.decode(t.peerId,i.peerId=Qr.newBuffer(Qr.base64.length(t.peerId)),0):t.peerId.length&&(i.peerId=t.peerId)),t.seq!=null&&(Qr.Long?(i.seq=Qr.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?i.seq=parseInt(t.seq,10):typeof t.seq=="number"?i.seq=t.seq:typeof t.seq=="object"&&(i.seq=new Qr.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=Us.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=Qr.newBuffer(n.peerId))),Qr.Long){var s=new Qr.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?Qr.base64.encode(t.peerId,0,t.peerId.length):i.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=i.longs===String?String(t.seq):t.seq:n.seq=i.longs===String?Qr.Long.prototype.toString.call(t.seq):i.longs===Number?new Qr.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var o=0;o<t.addresses.length;++o)n.addresses[o]=Us.PeerRecord.AddressInfo.toObject(t.addresses[o],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Df.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=Qr.newBuffer([]),e.encode=function(i,n){return n||(n=Che.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof q2||(i=q2.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Us.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Us.PeerRecord.AddressInfo)return i;var n=new Us.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Qr.base64.decode(i.multiaddr,n.multiaddr=Qr.newBuffer(Qr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=Qr.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?Qr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Df.util.toJSONOptions)},e}(),r}();Ohe.exports=Us});var Bhe=p((eOt,khe)=>{u();"use strict";var Bot="libp2p-peer-record",Not=Uint8Array.from([3,1]);khe.exports={ENVELOPE_DOMAIN_PEER_RECORD:Bot,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Not}});var k2=p((tOt,Mhe)=>{u();"use strict";var{Multiaddr:Dot}=et(),Mot=rt(),Lot=Phe(),{PeerRecord:Nhe}=qhe(),{ENVELOPE_DOMAIN_PEER_RECORD:Dhe,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Uot}=Bhe(),Mf=class{constructor({peerId:e,multiaddrs:t=[],seqNumber:i=Date.now()}){this.domain=Dhe,this.codec=Uot,this.peerId=e,this.multiaddrs=t,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=Nhe.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof Mf)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!Lot(this.multiaddrs,e.multiaddrs))}};Mf.createFromProtobuf=r=>{let e=Nhe.decode(r),t=Mot.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new Dot(s.multiaddr)),n=Number(e.seq);return new Mf({peerId:t,multiaddrs:i,seqNumber:n})};Mf.DOMAIN=Dhe;Mhe.exports=Mf});var pR=p((rOt,Lhe)=>{u();"use strict";var Fot=pb(),Kot=k2();async function jot(r){let e=new Kot({peerId:r.peerId,multiaddrs:r.multiaddrs}),t=await Fot.seal(e,r.peerId);r.peerStore.addressBook.consumePeerRecord(t)}Lhe.exports.updateSelfPeerRecord=jot});var gR=p((iOt,Khe)=>{u();"use strict";var Uhe=me(),Lf=Object.assign(Uhe("libp2p:transports"),{error:Uhe("libp2p:transports:err")}),Vot=The(),{codes:Rp}=di(),_b=ue(),{updateSelfPeerRecord:Fhe}=pR(),yR=class{constructor({libp2p:e,upgrader:t,faultTolerance:i=B2.FATAL_ALL}){this.libp2p=e,this.upgrader=t,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,t,i={}){if(Lf("adding %s",e),!e)throw _b(new Error(`Transport must have a valid key, was given '${e}'`),Rp.ERR_INVALID_KEY);if(this._transports.has(e))throw _b(new Error("There is already a transport with this key"),Rp.ERR_DUPLICATE_TRANSPORT);let n=new t({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[t,i]of this._listeners)for(Lf("closing listeners for %s",t);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),Lf("all listeners closed");for(let t of this._listeners.keys())this._listeners.set(t,[])}async dial(e,t){let i=this.transportForMultiaddr(e);if(!i)throw _b(new Error(`No transport available for address ${String(e)}`),Rp.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,t)}catch(n){throw n.code||(n.code=Rp.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let t of this._listeners.values())for(let i of t)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let t of this._transports.values())if(t.filter([e]).length)return t;return null}async listen(e){if(!e||e.length===0){Lf("no addresses were provided for listening, this node is dial only");return}let t=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),o=[];for(let f of s){Lf("creating listener for %s on %s",i,f);let l=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(l),l.on("listening",()=>Fhe(this.libp2p)),l.on("close",()=>Fhe(this.libp2p)),o.push(l.listen(f))}if(o.length===0){t.push(i);continue}if(!(await Vot(o)).find(f=>f.isFulfilled===!0)&&this.faultTolerance!==B2.NO_FATAL)throw _b(new Error(`Transport (${i}) could not listen on any available address`),Rp.ERR_NO_VALID_ADDRESSES)}if(t.length===this._transports.size){let i=`no valid addresses were provided for transports [${t}]`;if(this.faultTolerance===B2.FATAL_ALL)throw _b(new Error(i),Rp.ERR_NO_VALID_ADDRESSES);Lf(`libp2p in dial mode only: ${i}`)}}async remove(e){if(Lf("removing %s",e),this._listeners.has(e))for(let t of this._listeners.get(e))t.removeAllListeners("listening"),t.removeAllListeners("close"),await t.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let t of this._transports.keys())e.push(this.remove(t));await Promise.all(e)}},B2={FATAL_ALL:0,NO_FATAL:1};yR.FaultTolerance=B2;Khe.exports=yR});var zhe=p((nOt,Vhe)=>{u();"use strict";var zot=mr(),{dnsaddrResolver:Hot}=ahe(),bR=C2(),{AGENT_VERSION:$ot}=aR(),jhe=O2(),{publicAddressesFirst:Got}=uR(),{FaultTolerance:Wot}=gR(),Yot={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:r=>r},connectionManager:{minConnections:25},transportManager:{faultTolerance:Wot.FATAL_ALL},dialer:{maxParallelDials:bR.MAX_PARALLEL_DIALS,maxDialsPerPeer:bR.MAX_PER_PEER_DIALS,dialTimeout:bR.DIAL_TIMEOUT,resolvers:{dnsaddr:Hot},addressSorter:Got},host:{agentVersion:$ot},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:jhe.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:jhe.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};Vhe.exports.validate=r=>{let e=zot(Yot,r);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var Ghe=p((sOt,$he)=>{u();"use strict";var{EventEmitter:Xot}=br(),{Multiaddr:Eb}=et(),Qot=rt(),Hhe=class extends Xot{constructor(e,{listen:t=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(t.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new Eb(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new Eb(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new Eb(e))}addObservedAddr(e){let t=new Eb(e),i=t.getPeerId();i&&Qot.createFromB58String(i).equals(this.peerId)&&(t=t.decapsulate(new Eb(`/p2p/${this.peerId}`)));let n=t.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};$he.exports=Hhe});var Xhe=p((oOt,Yhe)=>{u();"use strict";var{EventEmitter:Jot}=br(),mR=me()("latency-monitor:VisibilityChangeEmitter"),Whe=class extends Jot{constructor(){super();if(typeof document=="undefined"){mR('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,t;typeof document.hidden!="undefined"?(e="hidden",t="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",t="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",t="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",t="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=t}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?mR("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];mR(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};Yhe.exports=Whe});var Zhe=p((aOt,Jhe)=>{u();"use strict";var{EventEmitter:Zot}=br(),eat=Xhe(),Nc=me()("latency-monitor:LatencyMonitor"),Qhe=class extends Zot{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:t,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=t===null||t===0?void 0:t||5*1e3,Nc("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?Nc("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):Nc("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(Nc("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let t=this.now(e);return t[0]*1e3+t[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(Nc("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(Nc("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),tat()&&(this._visibilityChangeEmitter=new eat,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),Nc("Summary: %O",e),e}_checkLatency(){let e=this,t=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+t),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,Nc("MS: %s Data: %O",s,e._latencyData)};Nc("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function tat(){return typeof window!="undefined"}Jhe.exports=Qhe});var tde=p((cOt,ede)=>{u();"use strict";ede.exports=function(){return Date.now()}});var vR=p((uOt,ide)=>{u();"use strict";var N2=tde(),rde=class{constructor(e,t,i){let n=this;this._started=N2(),this._rescheduled=0,this._scheduled=t,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(N2()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=N2();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=N2(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function rat(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new rde(arguments[0],arguments[1],r)}ide.exports=rat});var ude=p((lOt,cde)=>{u();"use strict";var nde=me(),No=Object.assign(nde("libp2p:connection-manager"),{error:nde("libp2p:connection-manager:err")}),sde=ue(),iat=mr(),nat=Zhe(),D2=vR(),{EventEmitter:sat}=br(),oat=rt(),{codes:{ERR_INVALID_PARAMETERS:ode}}=di(),aat={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},ade=class extends sat{constructor(e,t={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=iat.call({ignoreUndefined:!0},aat,t),this._options.maxConnections<this._options.minConnections)throw sde(new Error("Connection Manager maxConnections must be greater than minConnections"),ode);No("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._autoDialTimeout=null,this._checkMetrics=this._checkMetrics.bind(this),this._autoDial=this._autoDial.bind(this),this._latencyMonitor=new nat({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,t)=>e+t.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||D2(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,No("started"),this._options.autoDial&&this._autoDial()}async stop(){this._autoDialTimeout&&this._autoDialTimeout.clear(),this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),No("stopped")}async _close(){let e=[];for(let t of this.connections.values())for(let i of t)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,t){if(t<0||t>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),t)}_checkMetrics(){if(this._libp2p.metrics){let e=this._libp2p.metrics.global.movingAverages,t=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",t);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",i);let n=t+i;this._checkMaxLimit("maxData",n),No("metrics update",n),this._timer=D2(this._checkMetrics,this._options.pollInterval)}}onConnect(e){let t=e.remotePeer,i=t.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),this._libp2p.peerStore.keyBook.set(t,t.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let t=e.remotePeer.toB58String(),i=this.connections.get(t);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(t,i)):i&&(this.connections.delete(t),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e))}get(e){let t=this.getAll(e);return t.length?t[0]:null}getAll(e){if(!oat.isPeerId(e))throw sde(new Error("peerId must be an instance of peer-id"),ode);let t=e.toB58String(),i=this.connections.get(t);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,t){let i=this._options[e];No("checking limit of %s. current value: %d of %d",e,t,i),t>i&&(No("%s: limit exceeded: %s, %d",this._peerId,e,t),this._maybeDisconnectOne())}async _autoDial(){let e=this._options.minConnections;if(this.size>=e){this._autoDialTimeout=D2(this._autoDial,this._options.autoDialInterval);return}let t=Array.from(this._libp2p.peerStore.peers.values()).sort((i,n)=>n.protocols&&n.protocols.length&&(!i.protocols||!i.protocols.length)||n.id.pubKey&&!i.id.pubKey?1:-1);for(let i=0;i<t.length&&this.size<e;i++)if(!this.get(t[i].id)){No("connecting to a peerStore stored peer %s",t[i].id.toB58String());try{if(await this._libp2p.dialer.connectToPeer(t[i].id),!this._started)return}catch(n){No.error("could not connect to peerStore stored peer",n)}}this._autoDialTimeout=D2(this._autoDial,this._options.autoDialInterval)}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));No("%s: sorted peer values: %j",this._peerId,e);let t=e[0];if(t){let i=t[0];No("%s: lowest value peer is %s",this._peerId,i),No("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close();break}}}}};cde.exports=ade});var Pp=p((fOt,fde)=>{u();"use strict";var Uf=Pi(),M2=Uf.Reader,lde=Uf.Writer,Fs=Uf.util,Ki=Uf.roots["libp2p-circuit"]||(Uf.roots["libp2p-circuit"]={});Ki.CircuitRelay=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.type=1,r.prototype.srcPeer=null,r.prototype.dstPeer=null,r.prototype.code=100,r.encode=function(t,i){return i||(i=lde.create()),t.type!=null&&Object.hasOwnProperty.call(t,"type")&&i.uint32(8).int32(t.type),t.srcPeer!=null&&Object.hasOwnProperty.call(t,"srcPeer")&&Ki.CircuitRelay.Peer.encode(t.srcPeer,i.uint32(18).fork()).ldelim(),t.dstPeer!=null&&Object.hasOwnProperty.call(t,"dstPeer")&&Ki.CircuitRelay.Peer.encode(t.dstPeer,i.uint32(26).fork()).ldelim(),t.code!=null&&Object.hasOwnProperty.call(t,"code")&&i.uint32(32).int32(t.code),i},r.decode=function(t,i){t instanceof M2||(t=M2.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ki.CircuitRelay;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.type=t.int32();break;case 2:s.srcPeer=Ki.CircuitRelay.Peer.decode(t,t.uint32());break;case 3:s.dstPeer=Ki.CircuitRelay.Peer.decode(t,t.uint32());break;case 4:s.code=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ki.CircuitRelay)return t;var i=new Ki.CircuitRelay;switch(t.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(t.srcPeer!=null){if(typeof t.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=Ki.CircuitRelay.Peer.fromObject(t.srcPeer)}if(t.dstPeer!=null){if(typeof t.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=Ki.CircuitRelay.Peer.fromObject(t.dstPeer)}switch(t.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),t.type!=null&&t.hasOwnProperty("type")&&(n.type=i.enums===String?Ki.CircuitRelay.Type[t.type]:t.type),t.srcPeer!=null&&t.hasOwnProperty("srcPeer")&&(n.srcPeer=Ki.CircuitRelay.Peer.toObject(t.srcPeer,i)),t.dstPeer!=null&&t.hasOwnProperty("dstPeer")&&(n.dstPeer=Ki.CircuitRelay.Peer.toObject(t.dstPeer,i)),t.code!=null&&t.hasOwnProperty("code")&&(n.code=i.enums===String?Ki.CircuitRelay.Status[t.code]:t.code),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Uf.util.toJSONOptions)},r.Status=function(){var e={},t=Object.create(e);return t[e[100]="SUCCESS"]=100,t[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,t[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,t[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,t[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,t[e[260]="HOP_NO_CONN_TO_DST"]=260,t[e[261]="HOP_CANT_DIAL_DST"]=261,t[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,t[e[270]="HOP_CANT_SPEAK_RELAY"]=270,t[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,t[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,t[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,t[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,t[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,t[e[390]="STOP_RELAY_REFUSED"]=390,t[e[400]="MALFORMED_MESSAGE"]=400,t}(),r.Type=function(){var e={},t=Object.create(e);return t[e[1]="HOP"]=1,t[e[2]="STOP"]=2,t[e[3]="STATUS"]=3,t[e[4]="CAN_HOP"]=4,t}(),r.Peer=function(){function e(t){if(this.addrs=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.id=Fs.newBuffer([]),e.prototype.addrs=Fs.emptyArray,e.encode=function(i,n){if(n||(n=lde.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof M2||(i=M2.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ki.CircuitRelay.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;default:i.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw Fs.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(i){if(i instanceof Ki.CircuitRelay.Peer)return i;var n=new Ki.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?Fs.base64.decode(i.id,n.id=Fs.newBuffer(Fs.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?Fs.base64.decode(i.addrs[s],n.addrs[s]=Fs.newBuffer(Fs.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=Fs.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?Fs.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?Fs.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Uf.util.toJSONOptions)},e}(),r}();fde.exports=Ki});var pde=p((hOt,dde)=>{u();"use strict";var{source:hde}=Da(),cat=me(),uat=cat("libp2p:stream:converter");function lat({stream:r,remoteAddr:e,localAddr:t},i={}){let{sink:n,source:s}=r,o={async sink(c){i.signal&&(c=hde(c,i.signal));try{await n(c)}catch(f){f.type!=="aborted"&&uat(f)}a()},source:i.signal?hde(s,i.signal):s,conn:r,localAddr:t,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}dde.exports=lat});var Sb=p((dOt,yde)=>{u();"use strict";yde.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var bde=p((pOt,gde)=>{u();"use strict";var{EventEmitter:fat}=br(),{Multiaddr:hat}=et();gde.exports=r=>{let e=new Map;async function t(s){let o=String(s).split("/p2p-circuit").find(f=>f!==""),a=await r.dial(new hat(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let o of e.values())s.push(o);return s}let n=Object.assign(new fat,{close:()=>Promise.resolve(),listen:t,getAddrs:i});return r.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var wR=p((yOt,wde)=>{u();"use strict";var{Multiaddr:mde}=et(),{CircuitRelay:Ff}=Pp();function vde(r,e){r.write({type:Ff.Type.STATUS,code:e})}function dat(r,e){try{r.dstPeer&&r.dstPeer.addrs&&r.dstPeer.addrs.forEach(t=>new mde(t))}catch(t){throw vde(e,r.type===Ff.Type.HOP?Ff.Status.HOP_DST_MULTIADDR_INVALID:Ff.Status.STOP_DST_MULTIADDR_INVALID),t}try{r.srcPeer&&r.srcPeer.addrs&&r.srcPeer.addrs.forEach(t=>new mde(t))}catch(t){throw vde(e,r.type===Ff.Type.HOP?Ff.Status.HOP_SRC_MULTIADDR_INVALID:Ff.Status.STOP_SRC_MULTIADDR_INVALID),t}}wde.exports={validateAddrs:dat}});var Cp=p((gOt,_de)=>{u();"use strict";var pat=A2(),yat=Ra(),gat=Qu();_de.exports=r=>{let e=yat(),t=pat(r.source),i=gat(),n,s=r.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:t,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:t},rest:()=>e.end(),write:e.push,read:async()=>(await t.next()).value}}});var U2=p((bOt,Ide)=>{u();"use strict";var Ede=me(),L2=Object.assign(Ede("libp2p:circuit:stream-handler"),{error:Ede("libp2p:circuit:stream-handler:err")}),Sde=To(),bat=Cp(),{CircuitRelay:Ade}=Pp(),xde=class{constructor({stream:e,maxLength:t=4096}){this.stream=e,this.shake=bat(this.stream),this.decoder=Sde.decode.fromReader(this.shake.reader,{maxDataLength:t})}async read(){let e=await this.decoder.next();if(e.value){let t=Ade.decode(e.value.slice());return L2("read message type",t.type),t}L2("read received no value, closing stream"),this.close()}write(e){L2("write message type %s",e.type),this.shake.write(Sde.encode.single(Ade.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){L2("closing the stream"),this.rest().sink([])}};Ide.exports=xde});var SR=p((mOt,ER)=>{u();"use strict";var Tde=me(),Ab=Object.assign(Tde("libp2p:circuit:stop"),{error:Tde("libp2p:circuit:stop:err")}),{CircuitRelay:_R}=Pp(),mat=Sb(),vat=U2(),{validateAddrs:wat}=wR();ER.exports.handleStop=function({connection:e,request:t,streamHandler:i}){try{wat(t,i)}catch(n){return Ab.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return Ab("stop request is valid"),i.write({type:_R.Type.STATUS,code:_R.Status.SUCCESS}),i.rest()};ER.exports.stop=async function({connection:e,request:t}){let{stream:i}=await e.newStream([mat.relay]);Ab("starting stop request to %s",e.remotePeer.toB58String());let n=new vat({stream:i});n.write(t);let s=await n.read();if(!s)return n.close();if(s.code===_R.Status.SUCCESS)return Ab("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();Ab("stop request failed with code %d",s.code),n.close()}});var AR=p((vOt,kde)=>{u();"use strict";var Rde=me(),Dc=Object.assign(Rde("libp2p:circuit:hop"),{error:Rde("libp2p:circuit:hop:err")}),Pde=ue(),_at=rt(),{validateAddrs:Eat}=wR(),Cde=U2(),{CircuitRelay:as}=Pp(),{pipe:Sat}=Gr(),{codes:Ode}=di(),{stop:Aat}=SR(),qde=Sb();async function xat({connection:r,request:e,streamHandler:t,circuit:i}){if(!i._options.hop.enabled)return Dc("HOP request received but we are not acting as a relay"),t.end({type:as.Type.STATUS,code:as.Status.HOP_CANT_SPEAK_RELAY});try{Eat(e,t)}catch(f){return Dc.error("invalid hop request via peer %s",r.remotePeer.toB58String(),f)}if(!e.dstPeer){Dc("HOP request received but we do not receive a dstPeer");return}let n=new _at(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return Dc("HOP request received but we are not connected to the destination peer"),t.end({type:as.Type.STATUS,code:as.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:as.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await Aat({connection:s,request:o})}catch(f){return Dc.error(f)}Dc("hop request from %s is valid",r.remotePeer.toB58String()),t.write({type:as.Type.STATUS,code:as.Status.SUCCESS});let c=t.rest();return Sat(c,a,c)}async function Iat({connection:r,request:e}){let{stream:t}=await r.newStream([qde.relay]),i=new Cde({stream:t});i.write(e);let n=await i.read();if(!n)throw Pde(new Error("HOP request had no response"),Ode.ERR_HOP_REQUEST_FAILED);if(n.code===as.Status.SUCCESS)return Dc("hop request was successful"),i.rest();throw Dc("hop request failed with code %d, closing stream",n.code),i.close(),Pde(new Error(`HOP request failed with code ${n.code}`),Ode.ERR_HOP_REQUEST_FAILED)}async function Tat({connection:r}){let{stream:e}=await r.newStream([qde.relay]),t=new Cde({stream:e});t.write({type:as.Type.CAN_HOP});let i=await t.read();return await t.close(),!(!i||i.code!==as.Status.SUCCESS)}function Rat({connection:r,streamHandler:e,circuit:t}){let i=t._options.hop.enabled;Dc("can hop (%s) request from %s",i,r.remotePeer.toB58String()),e.end({type:as.Type.STATUS,code:i?as.Status.SUCCESS:as.Status.HOP_CANT_SPEAK_RELAY})}kde.exports={handleHop:xat,hop:Iat,canHop:Tat,handleCanHop:Rat}});var Ude=p((wOt,Lde)=>{u();"use strict";var Bde=me(),Mc=Object.assign(Bde("libp2p:circuit"),{error:Bde("libp2p:circuit:err")}),Pat=ue(),Cat=zl(),{Multiaddr:xb}=et(),Nde=rt(),{CircuitRelay:Ib}=Pp(),{codes:Oat}=di(),Dde=pde(),{relay:qat}=Sb(),kat=bde(),{handleCanHop:Bat,handleHop:Nat,hop:Dat}=AR(),{handleStop:Mat}=SR(),Lat=U2(),Uat=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),Mde=class{constructor({libp2p:e,upgrader:t}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=t,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(qat,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:t}){let i=new Lat({stream:t}),n=await i.read();if(!n)return;let s=this,o;switch(n.type){case Ib.Type.CAN_HOP:{Mc("received CAN_HOP request from %s",e.remotePeer.toB58String()),await Bat({circuit:s,connection:e,streamHandler:i});break}case Ib.Type.HOP:{Mc("received HOP request from %s",e.remotePeer.toB58String()),o=await Nat({connection:e,request:n,streamHandler:i,circuit:s});break}case Ib.Type.STOP:{Mc("received STOP request from %s",e.remotePeer.toB58String()),o=await Mat({connection:e,request:n,streamHandler:i});break}default:Mc("Request of type %s not supported",n.type)}if(o){let a=new xb(n.dstPeer.addrs[0]),c=new xb(n.srcPeer.addrs[0]),f=Dde({stream:o,remoteAddr:a,localAddr:c}),l=n.type===Ib.Type.HOP?"relay":"inbound";Mc("new %s connection %s",l,f.remoteAddr);let h=await this._upgrader.upgradeInbound(f);Mc("%s connection %s upgraded",l,f.remoteAddr),this.handler&&this.handler(h)}}async dial(e,t){let i=e.toString().split("/p2p-circuit"),n=new xb(i[0]),s=new xb(i[i.length-1]),o=n.getPeerId(),a=s.getPeerId();if(!o||!a){let d="Circuit relay dial failed as addresses did not have peer id";throw Mc.error(d),Pat(new Error(d),Oat.ERR_RELAYED_DIAL)}let c=Nde.createFromB58String(o),f=Nde.createFromB58String(a),l=!1,h=this._connectionManager.get(c);h||(h=await this._dialer.connectToPeer(n,t),l=!0);try{let d=await Dat({connection:h,request:{type:Ib.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(m=>m.bytes)},dstPeer:{id:f.toBytes(),addrs:[new xb(s).bytes]}}}),y=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),g=Dde({stream:d,remoteAddr:e,localAddr:y});return Mc("new outbound connection %s",g.remoteAddr),this._upgrader.upgradeOutbound(g)}catch(d){throw Mc.error("Circuit relay dial failed",d),l&&await h.close(),d}}createListener(e,t){return typeof e=="function"&&(t=e,e={}),this.handler=t,kat(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>Cat.Circuit.matches(t))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[Uat])}};Lde.exports=Mde});var xR=p((_Ot,Fde)=>{u();"use strict";var{CID:Fat}=(xe(),Ce),{sha256:Kat}=(Hr(),Ir);Fde.exports.namespaceToCid=async r=>{let e=new TextEncoder().encode(r),t=await Kat.digest(e);return Fat.createV0(t)}});var Gde=p((EOt,$de)=>{u();"use strict";var Kde=me(),jde=Object.assign(Kde("libp2p:auto-relay"),{error:Kde("libp2p:auto-relay:err")}),jat=ct(),Vat=Ze(),{Multiaddr:zat}=et(),Hat=rt(),{relay:$at}=Sb(),{canHop:Gat}=AR(),{namespaceToCid:Wat}=xR(),{CIRCUIT_PROTO_CODE:Yat,HOP_METADATA_KEY:Vde,HOP_METADATA_VALUE:zde,RELAY_RENDEZVOUS_NS:Xat}=O2(),Hde=class{constructor({libp2p:e,maxListeners:t=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=t,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{jde.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:t}){let i=e.toB58String(),n=t.find(s=>s===$at);if(!n&&this._listenRelays.has(i)){this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(Yat)){jde(`relayed connection to ${i} will not be used to hop on`);return}await Gat({connection:s})&&(this._peerStore.metadataBook.set(e,Vde,jat(zde)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i)}async _addListenRelay(e,t){if(this._listenRelays.size>=this.maxListeners)return;let i=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!i||!i.length)return;let n=`${i[0].toString()}/p2p-circuit`;this._listenRelays.add(t);try{await this._transportManager.listen([new zat(n)])}catch(s){this._onError(s),this._listenRelays.delete(t)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let t=[];for(let[i,n]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(i)||e.includes(i))continue;let s=n.get(Vde);if(!s||Vat(s)!==zde)continue;let o=Hat.createFromB58String(i),a=this._connectionManager.get(o);if(!a){t.push(o);continue}if(await this._addListenRelay(a,i),this._listenRelays.size>=this.maxListeners)return}for(let i of t)if(await this._tryToListenOnRelay(i),this._listenRelays.size>=this.maxListeners)return;try{let i=await Wat(Xat);for await(let n of this._libp2p.contentRouting.findProviders(i)){if(!n.multiaddrs.length)continue;let s=n.id;if(this._peerStore.addressBook.add(s,n.multiaddrs),await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return}}catch(i){this._onError(i)}}async _tryToListenOnRelay(e){try{let t=await this._libp2p.dial(e);await this._addListenRelay(t,e.toB58String())}catch(t){this._onError(t,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};$de.exports=Hde});var Jde=p((SOt,Qde)=>{u();"use strict";var Wde=me(),Yde=Object.assign(Wde("libp2p:relay"),{error:Wde("libp2p:relay:err")}),{setDelayedInterval:Qat,clearDelayedInterval:Jat}=rR(),Zat=Gde(),{namespaceToCid:ect}=xR(),{RELAY_RENDEZVOUS_NS:tct}=O2(),Xde=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new Zat({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=Qat(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){Jat(this._timeout)}async _advertiseService(){try{let e=await ect(tct);await this._libp2p.contentRouting.provide(e)}catch(e){e.code==="NO_ROUTERS_AVAILABLE"?(Yde.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):Yde.error(e)}}};Qde.exports=Xde});var rpe=p((xOt,tpe)=>{u();var Zde=Ux(),epe=Qu();tpe.exports=class{constructor(){this._buffer=new Zde,this._waitingConsumers=new Zde}push(e){let{promise:t,resolve:i}=epe();return this._buffer.push({chunk:e,resolve:i}),this._consume(),t}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){let{promise:e,resolve:t}=epe();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var npe=p((IOt,ipe)=>{u();"use strict";ipe.exports=(r,e=1,t)=>{if(t={indent:" ",includeEmptyLines:!1,...t},typeof r!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof r}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof t.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof t.indent}\``);if(e===0)return r;let i=t.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return r.replace(i,t.indent.repeat(e))}});var spe=p(()=>{u()});var upe=p((POt,cpe)=>{u();"use strict";var ope=spe(),ape=/\s+at.*(?:\(|\s)(.*)\)?/,rct=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,ict=typeof ope.homedir=="undefined"?"":ope.homedir();cpe.exports=(r,e)=>(e=Object.assign({pretty:!1},e),r.replace(/\\/g,"/").split(`
`).filter(t=>{let i=t.match(ape);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!rct.test(n)}).filter(t=>t.trim()!=="").map(t=>e.pretty?t.replace(ape,(i,n)=>i.replace(n,n.replace(ict,"~"))):t).join(`
`))});var IR=p((COt,fpe)=>{u();"use strict";var nct=npe(),sct=upe(),oct=r=>r.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),lpe=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let t=e.map(i=>typeof i.stack=="string"?oct(sct(i.stack)):String(i)).join(`
`);t=`
`+nct(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};fpe.exports=lpe});var hpe=p((OOt,RR)=>{u();"use strict";var TR=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},Tb=class{static fn(e){return(...t)=>new Tb((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new TR(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Tb.prototype,Promise.prototype);RR.exports=Tb;RR.exports.CancelError=TR});var ppe=p((qOt,F2)=>{u();"use strict";var dpe=IR(),act=hpe(),PR=class extends Error{},cct=(r,e)=>new act((t,i,n)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],f=0,l=!1,h=new Set,d=()=>(a.length===s&&(t(a),l=!0),f-c.length<s&&(i(new dpe(c)),l=!0),l),y=()=>{for(let g of r)!h.has(g)&&typeof g.cancel=="function"&&g.cancel()};n(y);for(let g of r)f++,(async()=>{try{let m=await g;if(l)return;if(!o(m))throw new PR("Value does not satisfy filter");a.push(m)}catch(m){c.push(m)}finally{h.add(g),!l&&d()&&y()}})();s>f&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${f} items`)),y())});F2.exports=cct;F2.exports.AggregateError=dpe;F2.exports.FilterError=PR});var ype=p((kOt,OR)=>{u();"use strict";var CR=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},Rb=class{static fn(e){return(...t)=>new Rb((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new CR(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Rb.prototype,Promise.prototype);OR.exports=Rb;OR.exports.CancelError=CR});var bpe=p((BOt,qR)=>{u();"use strict";var gpe=ppe(),uct=ype();qR.exports=(r,e)=>{let t=gpe(r,{...e,count:1});return uct.fn(async i=>{i(()=>{t.cancel()});let[n]=await t;return n})()};qR.exports.AggregateError=gpe.AggregateError});var wpe=p((NOt,vpe)=>{u();"use strict";var lct=ue(),fct=vl().default,{anySignal:hct}=wl(),dct=rpe(),pct=bpe(),mpe=class{constructor({addrs:e,dialAction:t,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=t}async run(e={}){let t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw lct(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");let i=new dct;t.forEach(o=>i.push(o));let n=this.addrs.map(()=>new fct),s=0;try{return await pct(this.addrs.map(async(o,a)=>{let c=await i.shift(),f;try{let l=n[a].signal;f=await this.dialAction(o,{...e,signal:e.signal?hct([l,e.signal]):l}),n.splice(a,1)}finally{s++,this.addrs.length-s>=t.length?i.push(c):this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0])}return f}))}finally{n.map(o=>o.abort()),t.forEach(o=>this.dialer.releaseToken(o))}}};vpe.exports=mpe});var Ape=p((DOt,Spe)=>{u();"use strict";var _pe=me(),Op=Object.assign(_pe("libp2p:dialer"),{error:_pe("libp2p:dialer:err")}),kR=ue(),{Multiaddr:BR}=et(),yct=ex(),{AbortError:gct}=Da(),{anySignal:bct}=wl(),mct=wpe(),{publicAddressesFirst:vct}=uR(),wct=sR(),{codes:K2}=di(),{DIAL_TIMEOUT:_ct,MAX_PARALLEL_DIALS:Ect,MAX_PER_PEER_DIALS:Sct,MAX_ADDRS_TO_DIAL:Act}=C2(),Epe=class{constructor({transportManager:e,peerStore:t,addressSorter:i=vct,maxParallelDials:n=Ect,maxAddrsToDial:s=Act,dialTimeout:o=_ct,maxDialsPerPeer:a=Sct,resolvers:c={}}){this.transportManager=e,this.peerStore=t,this.addressSorter=i,this.maxParallelDials=n,this.maxAddrsToDial=s,this.timeout=o,this.maxDialsPerPeer=a,this.tokens=[...new Array(n)].map((f,l)=>l),this._pendingDials=new Map,this._pendingDialTargets=new Map;for(let[f,l]of Object.entries(c))BR.resolvers.set(f,l)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(t){Op.error(t)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new gct("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,t={}){let i=await this._createCancellableDialTarget(e);if(!i.addrs.length)throw kR(new Error("The dial request has no valid addresses"),K2.ERR_NO_VALID_ADDRESSES);let n=this._pendingDials.get(i.id)||this._createPendingDial(i,t);try{let s=await n.promise;return Op("dial succeeded to %s",i.id),s}catch(s){throw n.controller.signal.aborted&&(s.code=K2.ERR_TIMEOUT),Op.error(s),s}finally{n.destroy()}}async _createCancellableDialTarget(e){let t=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((s,o)=>{this._pendingDialTargets.set(t,{resolve:s,reject:o})}),n=await Promise.race([this._createDialTarget(e),i]);return this._pendingDialTargets.delete(t),n}async _createDialTarget(e){let{id:t,multiaddrs:i}=wct(e);i&&this.peerStore.addressBook.add(t,i);let n=this.peerStore.addressBook.getMultiaddrsForPeer(t,this.addressSorter)||[];BR.isMultiaddr(e)&&(n=n.filter(a=>!e.equals(a)),n.unshift(e));let s=[];for(let a of n)(await this._resolve(a)).forEach(f=>s.push(f));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw this.peerStore.delete(t),kR(new Error("dial with more addresses than allowed"),K2.ERR_TOO_MANY_ADDRESSES);return{id:t.toB58String(),addrs:o}}_createPendingDial(e,t={}){let i=(f,l)=>{if(l.signal.aborted)throw kR(new Error("already aborted"),K2.ERR_ALREADY_ABORTED);return this.transportManager.dial(f,l)},n=new mct({addrs:e.addrs,dialAction:i,dialer:this}),s=new yct(this.timeout),o=[s.signal];t.signal&&o.push(t.signal);let a=bct(o),c={dialRequest:n,controller:s,promise:n.run({...t,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,t);return Op("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(Op("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new BR(e.toString()),await e.resolve()}catch(t){return Op.error(`multiaddr ${e} could not be resolved`),[]}}};Spe.exports=Epe});var Ipe=p((MOt,xpe)=>{u();"use strict";function xct(r){return r>=55296&&r<=56319}function Ict(r){return r>=56320&&r<=57343}xpe.exports=function(e,t,i){if(typeof t!="string")throw new Error("Input must be string");for(var n=t.length,s=0,o,a,c=0;c<n;c+=1){if(o=t.charCodeAt(c),a=t[c],xct(o)&&Ict(t.charCodeAt(c+1))&&(c+=1,a+=t[c]),s+=e(a),s===i)return t.slice(0,c+1);if(s>i)return t.slice(0,c-a.length+1)}return t}});var Rpe=p((LOt,Tpe)=>{u();"use strict";function Tct(r){return r>=55296&&r<=56319}function Rct(r){return r>=56320&&r<=57343}Tpe.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var t=e.length,i=0,n=null,s=null,o=0;o<t;o++)n=e.charCodeAt(o),Rct(n)?s!=null&&Tct(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var Cpe=p((UOt,Ppe)=>{u();"use strict";var Pct=Ipe(),Cct=Rpe();Ppe.exports=Pct.bind(null,Cct)});var kpe=p((FOt,qpe)=>{u();"use strict";var Oct=Cpe(),qct=/[\/\?<>\\:\*\|"]/g,kct=/[\x00-\x1f\x80-\x9f]/g,Bct=/^\.+$/,Nct=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,Dct=/[\. ]+$/;function Ope(r,e){if(typeof r!="string")throw new Error("Input must be string");var t=r.replace(qct,e).replace(kct,e).replace(Bct,e).replace(Nct,e).replace(Dct,e);return Oct(t,255)}qpe.exports=function(r,e){var t=e&&e.replacement||"",i=Ope(r,t);return t===""?i:Ope(i,"")}});var Mpe=p((KOt,Dpe)=>{u();var qp=lt();nc();$t();var Me=qp.asn1,kp=Dpe.exports=qp.pkcs7asn1=qp.pkcs7asn1||{};qp.pkcs7=qp.pkcs7||{};qp.pkcs7.asn1=kp;var Bpe={name:"ContentInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};kp.contentInfoValidator=Bpe;var Npe={name:"EncryptedContentInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};kp.envelopedDataValidator={name:"EnvelopedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(Npe)};kp.encryptedDataValidator={name:"EncryptedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"}].concat(Npe)};var Mct={name:"SignerInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Me.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};kp.signedDataValidator={name:"SignedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Bpe,{name:"SignedData.Certificates",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Me.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,capture:"signerInfos",optional:!0,value:[Mct]}]};kp.recipientInfoValidator={name:"RecipientInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var Upe=p((jOt,Lpe)=>{u();var Kf=lt();$t();Kf.mgf=Kf.mgf||{};var Lct=Lpe.exports=Kf.mgf.mgf1=Kf.mgf1=Kf.mgf1||{};Lct.create=function(r){var e={generate:function(t,i){for(var n=new Kf.util.ByteBuffer,s=Math.ceil(i/r.digestLength),o=0;o<s;o++){var a=new Kf.util.ByteBuffer;a.putInt32(o),r.start(),r.update(t+a.getBytes()),n.putBuffer(r.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var Kpe=p((VOt,Fpe)=>{u();var j2=lt();Upe();Fpe.exports=j2.mgf=j2.mgf||{};j2.mgf.mgf1=j2.mgf1});var Vpe=p((zOt,jpe)=>{u();var jf=lt();ou();$t();var Uct=jpe.exports=jf.pss=jf.pss||{};Uct.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=r.md,t=r.mgf,i=e.digestLength,n=r.salt||null;typeof n=="string"&&(n=jf.util.createBuffer(n));var s;if("saltLength"in r)s=r.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=r.prng||jf.random,a={};return a.encode=function(c,f){var l,h=f-1,d=Math.ceil(h/8),y=c.digest().getBytes();if(d<i+s+2)throw new Error("Message is too long to encrypt.");var g;n===null?g=o.getBytesSync(s):g=n.bytes();var m=new jf.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(y),m.putBytes(g),e.start(),e.update(m.getBytes());var E=e.digest().getBytes(),_=new jf.util.ByteBuffer;_.fillWithByte(0,d-s-i-2),_.putByte(1),_.putBytes(g);var T=_.getBytes(),q=d-i-1,z=t.generate(E,q),V="";for(l=0;l<q;l++)V+=String.fromCharCode(T.charCodeAt(l)^z.charCodeAt(l));var M=65280>>8*d-h&255;return V=String.fromCharCode(V.charCodeAt(0)&~M)+V.substr(1),V+E+String.fromCharCode(188)},a.verify=function(c,f,l){var h,d=l-1,y=Math.ceil(d/8);if(f=f.substr(-y),y<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(f.charCodeAt(y-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=y-i-1,m=f.substr(0,g),E=f.substr(g,i),_=65280>>8*y-d&255;if((m.charCodeAt(0)&_)!=0)throw new Error("Bits beyond keysize not zero as expected.");var T=t.generate(E,g),q="";for(h=0;h<g;h++)q+=String.fromCharCode(m.charCodeAt(h)^T.charCodeAt(h));q=String.fromCharCode(q.charCodeAt(0)&~_)+q.substr(1);var z=y-i-s-2;for(h=0;h<z;h++)if(q.charCodeAt(h)!==0)throw new Error("Leftmost octets not zero as expected");if(q.charCodeAt(z)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var V=q.substr(-s),M=new jf.util.ByteBuffer;M.fillWithByte(0,8),M.putBytes(c),M.putBytes(V),e.start(),e.update(M.getBytes());var $=e.digest().getBytes();return E===$},a}});var DR=p((HOt,Gpe)=>{u();var qe=lt();Sh();nc();l1();su();Kpe();wh();p1();Vpe();ly();$t();var R=qe.asn1,Ie=Gpe.exports=qe.pki=qe.pki||{},nt=Ie.oids,Jr={};Jr.CN=nt.commonName;Jr.commonName="CN";Jr.C=nt.countryName;Jr.countryName="C";Jr.L=nt.localityName;Jr.localityName="L";Jr.ST=nt.stateOrProvinceName;Jr.stateOrProvinceName="ST";Jr.O=nt.organizationName;Jr.organizationName="O";Jr.OU=nt.organizationalUnitName;Jr.organizationalUnitName="OU";Jr.E=nt.emailAddress;Jr.emailAddress="E";var zpe=qe.pki.rsa.publicKeyValidator,Fct={name:"Certificate",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:R.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:R.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:R.Class.UNIVERSAL,type:R.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:R.Class.UNIVERSAL,type:R.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:R.Class.UNIVERSAL,type:R.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:R.Class.UNIVERSAL,type:R.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},zpe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:R.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:R.Class.UNIVERSAL,type:R.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:R.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:R.Class.UNIVERSAL,type:R.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:R.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:R.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:R.Class.UNIVERSAL,type:R.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},Kct={name:"rsapss",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:R.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:R.Class.UNIVERSAL,type:R.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:R.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:R.Class.UNIVERSAL,type:R.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:R.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:R.Class.UNIVERSAL,type:R.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:R.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:R.Class.UNIVERSAL,type:R.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},jct={name:"CertificationRequestInfo",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},zpe,{name:"CertificationRequestInfo.attributes",tagClass:R.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:R.Class.UNIVERSAL,type:R.Type.SET,constructed:!0}]}]}]},Vct={name:"CertificationRequest",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[jct,{name:"CertificationRequest.signatureAlgorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:R.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:R.Class.UNIVERSAL,type:R.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Ie.RDNAttributesAsArray=function(r,e){for(var t=[],i,n,s,o=0;o<r.value.length;++o){i=r.value[o];for(var a=0;a<i.value.length;++a)s={},n=i.value[a],s.type=R.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in nt&&(s.name=nt[s.type],s.name in Jr&&(s.shortName=Jr[s.name])),e&&(e.update(s.type),e.update(s.value)),t.push(s)}return t};Ie.CRIAttributesAsArray=function(r){for(var e=[],t=0;t<r.length;++t)for(var i=r[t],n=R.derToOid(i.value[0].value),s=i.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=n,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in nt&&(a.name=nt[a.type],a.name in Jr&&(a.shortName=Jr[a.name])),a.type===nt.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(Ie.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function rl(r,e){typeof e=="string"&&(e={shortName:e});for(var t=null,i,n=0;t===null&&n<r.attributes.length;++n)i=r.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(t=i);return t}var V2=function(r,e,t){var i={};if(r!==nt["RSASSA-PSS"])return i;t&&(i={hash:{algorithmOid:nt.sha1},mgf:{algorithmOid:nt.mgf1,hash:{algorithmOid:nt.sha1}},saltLength:20});var n={},s=[];if(!R.validate(e,Kct,n,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=R.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=R.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=R.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i};Ie.certificateFromPem=function(r,e,t){var i=qe.pem.decode(r)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=R.fromDer(i.body,t);return Ie.certificateFromAsn1(s,e)};Ie.certificateToPem=function(r,e){var t={type:"CERTIFICATE",body:R.toDer(Ie.certificateToAsn1(r)).getBytes()};return qe.pem.encode(t,{maxline:e})};Ie.publicKeyFromPem=function(r){var e=qe.pem.decode(r)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var t=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=R.fromDer(e.body);return Ie.publicKeyFromAsn1(i)};Ie.publicKeyToPem=function(r,e){var t={type:"PUBLIC KEY",body:R.toDer(Ie.publicKeyToAsn1(r)).getBytes()};return qe.pem.encode(t,{maxline:e})};Ie.publicKeyToRSAPublicKeyPem=function(r,e){var t={type:"RSA PUBLIC KEY",body:R.toDer(Ie.publicKeyToRSAPublicKey(r)).getBytes()};return qe.pem.encode(t,{maxline:e})};Ie.getPublicKeyFingerprint=function(r,e){e=e||{};var t=e.md||qe.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=R.toDer(Ie.publicKeyToRSAPublicKey(r)).getBytes();break;case"SubjectPublicKeyInfo":n=R.toDer(Ie.publicKeyToAsn1(r)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}t.start(),t.update(n);var s=t.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Ie.certificationRequestFromPem=function(r,e,t){var i=qe.pem.decode(r)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=R.fromDer(i.body,t);return Ie.certificationRequestFromAsn1(s,e)};Ie.certificationRequestToPem=function(r,e){var t={type:"CERTIFICATE REQUEST",body:R.toDer(Ie.certificationRequestToAsn1(r)).getBytes()};return qe.pem.encode(t,{maxline:e})};Ie.createCertificate=function(){var r={};return r.version=2,r.serialNumber="00",r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.validity={},r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.issuer={},r.issuer.getField=function(e){return rl(r.issuer,e)},r.issuer.addField=function(e){Ks([e]),r.issuer.attributes.push(e)},r.issuer.attributes=[],r.issuer.hash=null,r.subject={},r.subject.getField=function(e){return rl(r.subject,e)},r.subject.addField=function(e){Ks([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.extensions=[],r.publicKey=null,r.md=null,r.setSubject=function(e,t){Ks(e),r.subject.attributes=e,delete r.subject.uniqueId,t&&(r.subject.uniqueId=t),r.subject.hash=null},r.setIssuer=function(e,t){Ks(e),r.issuer.attributes=e,delete r.issuer.uniqueId,t&&(r.issuer.uniqueId=t),r.issuer.hash=null},r.setExtensions=function(e){for(var t=0;t<e.length;++t)Hpe(e[t],{cert:r});r.extensions=e},r.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var t=null,i,n=0;t===null&&n<r.extensions.length;++n)i=r.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(t=i);return t},r.sign=function(e,t){r.md=t||qe.md.sha1.create();var i=nt[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.tbsCertificate=Ie.getTBSCertificate(r);var s=R.toDer(r.tbsCertificate);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(e){var t=!1;if(!r.issued(e)){var i=e.issuer,n=r.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){if(e.signatureOid in nt){var a=nt[e.signatureOid];switch(a){case"sha1WithRSAEncryption":o=qe.md.sha1.create();break;case"md5WithRSAEncryption":o=qe.md.md5.create();break;case"sha256WithRSAEncryption":o=qe.md.sha256.create();break;case"sha384WithRSAEncryption":o=qe.md.sha384.create();break;case"sha512WithRSAEncryption":o=qe.md.sha512.create();break;case"RSASSA-PSS":o=qe.md.sha256.create();break}}if(o===null){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var c=e.tbsCertificate||Ie.getTBSCertificate(e),f=R.toDer(c);o.update(f.getBytes())}if(o!==null){var l;switch(e.signatureOid){case nt.sha1WithRSAEncryption:l=void 0;break;case nt["RSASSA-PSS"]:var h,d;if(h=nt[e.signatureParameters.mgf.hash.algorithmOid],h===void 0||qe.md[h]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=h,s}if(d=nt[e.signatureParameters.mgf.algorithmOid],d===void 0||qe.mgf[d]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=d,s}if(d=qe.mgf[d].create(qe.md[h].create()),h=nt[e.signatureParameters.hash.algorithmOid],h===void 0||qe.md[h]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:h};l=qe.pss.create(qe.md[h].create(),d,e.signatureParameters.saltLength);break}t=r.publicKey.verify(o.digest().getBytes(),e.signature,l)}return t},r.isIssuer=function(e){var t=!1,i=r.issuer,n=e.subject;if(i.hash&&n.hash)t=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){t=!0;for(var s,o,a=0;t&&a<i.attributes.length;++a)s=i.attributes[a],o=n.attributes[a],(s.type!==o.type||s.value!==o.value)&&(t=!1)}return t},r.issued=function(e){return e.isIssuer(r)},r.generateSubjectKeyIdentifier=function(){return Ie.getPublicKeyFingerprint(r.publicKey,{type:"RSAPublicKey"})},r.verifySubjectKeyIdentifier=function(){for(var e=nt.subjectKeyIdentifier,t=0;t<r.extensions.length;++t){var i=r.extensions[t];if(i.id===e){var n=r.generateSubjectKeyIdentifier().getBytes();return qe.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},r};Ie.certificateFromAsn1=function(r,e){var t={},i=[];if(!R.validate(r,Fct,t,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=R.derToOid(t.publicKeyOid);if(s!==Ie.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Ie.createCertificate();o.version=t.certVersion?t.certVersion.charCodeAt(0):0;var a=qe.util.createBuffer(t.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=qe.asn1.derToOid(t.certSignatureOid),o.signatureParameters=V2(o.signatureOid,t.certSignatureParams,!0),o.siginfo.algorithmOid=qe.asn1.derToOid(t.certinfoSignatureOid),o.siginfo.parameters=V2(o.siginfo.algorithmOid,t.certinfoSignatureParams,!1),o.signature=t.certSignature;var c=[];if(t.certValidity1UTCTime!==void 0&&c.push(R.utcTimeToDate(t.certValidity1UTCTime)),t.certValidity2GeneralizedTime!==void 0&&c.push(R.generalizedTimeToDate(t.certValidity2GeneralizedTime)),t.certValidity3UTCTime!==void 0&&c.push(R.utcTimeToDate(t.certValidity3UTCTime)),t.certValidity4GeneralizedTime!==void 0&&c.push(R.generalizedTimeToDate(t.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=t.tbsCertificate,e){if(o.md=null,o.signatureOid in nt){var s=nt[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=qe.md.sha1.create();break;case"md5WithRSAEncryption":o.md=qe.md.md5.create();break;case"sha256WithRSAEncryption":o.md=qe.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=qe.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=qe.md.sha512.create();break;case"RSASSA-PSS":o.md=qe.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certificate digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var f=R.toDer(o.tbsCertificate);o.md.update(f.getBytes())}var l=qe.md.sha1.create();o.issuer.getField=function(d){return rl(o.issuer,d)},o.issuer.addField=function(d){Ks([d]),o.issuer.attributes.push(d)},o.issuer.attributes=Ie.RDNAttributesAsArray(t.certIssuer,l),t.certIssuerUniqueId&&(o.issuer.uniqueId=t.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var h=qe.md.sha1.create();return o.subject.getField=function(d){return rl(o.subject,d)},o.subject.addField=function(d){Ks([d]),o.subject.attributes.push(d)},o.subject.attributes=Ie.RDNAttributesAsArray(t.certSubject,h),t.certSubjectUniqueId&&(o.subject.uniqueId=t.certSubjectUniqueId),o.subject.hash=h.digest().toHex(),t.certExtensions?o.extensions=Ie.certificateExtensionsFromAsn1(t.certExtensions):o.extensions=[],o.publicKey=Ie.publicKeyFromAsn1(t.subjectPublicKeyInfo),o};Ie.certificateExtensionsFromAsn1=function(r){for(var e=[],t=0;t<r.value.length;++t)for(var i=r.value[t],n=0;n<i.value.length;++n)e.push(Ie.certificateExtensionFromAsn1(i.value[n]));return e};Ie.certificateExtensionFromAsn1=function(r){var e={};if(e.id=R.derToOid(r.value[0].value),e.critical=!1,r.value[1].type===R.Type.BOOLEAN?(e.critical=r.value[1].value.charCodeAt(0)!==0,e.value=r.value[2].value):e.value=r.value[1].value,e.id in nt){if(e.name=nt[e.id],e.name==="keyUsage"){var t=R.fromDer(e.value),i=0,n=0;t.value.length>1&&(i=t.value.charCodeAt(1),n=t.value.length>2?t.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var t=R.fromDer(e.value);t.value.length>0&&t.value[0].type===R.Type.BOOLEAN?e.cA=t.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;t.value.length>0&&t.value[0].type===R.Type.INTEGER?s=t.value[0].value:t.value.length>1&&(s=t.value[1].value),s!==null&&(e.pathLenConstraint=R.derToInteger(s))}else if(e.name==="extKeyUsage")for(var t=R.fromDer(e.value),o=0;o<t.value.length;++o){var a=R.derToOid(t.value[o].value);a in nt?e[nt[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var t=R.fromDer(e.value),i=0;t.value.length>1&&(i=t.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,t=R.fromDer(e.value),f=0;f<t.value.length;++f){c=t.value[f];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=qe.util.bytesToIP(c.value);break;case 8:l.oid=R.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var t=R.fromDer(e.value);e.subjectKeyIdentifier=qe.util.bytesToHex(t.value)}}return e};Ie.certificationRequestFromAsn1=function(r,e){var t={},i=[];if(!R.validate(r,Vct,t,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=R.derToOid(t.publicKeyOid);if(s!==Ie.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Ie.createCertificationRequest();if(o.version=t.csrVersion?t.csrVersion.charCodeAt(0):0,o.signatureOid=qe.asn1.derToOid(t.csrSignatureOid),o.signatureParameters=V2(o.signatureOid,t.csrSignatureParams,!0),o.siginfo.algorithmOid=qe.asn1.derToOid(t.csrSignatureOid),o.siginfo.parameters=V2(o.siginfo.algorithmOid,t.csrSignatureParams,!1),o.signature=t.csrSignature,o.certificationRequestInfo=t.certificationRequestInfo,e){if(o.md=null,o.signatureOid in nt){var s=nt[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=qe.md.sha1.create();break;case"md5WithRSAEncryption":o.md=qe.md.md5.create();break;case"sha256WithRSAEncryption":o.md=qe.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=qe.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=qe.md.sha512.create();break;case"RSASSA-PSS":o.md=qe.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var a=R.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=qe.md.sha1.create();return o.subject.getField=function(f){return rl(o.subject,f)},o.subject.addField=function(f){Ks([f]),o.subject.attributes.push(f)},o.subject.attributes=Ie.RDNAttributesAsArray(t.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=Ie.publicKeyFromAsn1(t.subjectPublicKeyInfo),o.getAttribute=function(f){return rl(o,f)},o.addAttribute=function(f){Ks([f]),o.attributes.push(f)},o.attributes=Ie.CRIAttributesAsArray(t.certificationRequestInfoAttributes||[]),o};Ie.createCertificationRequest=function(){var r={};return r.version=0,r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.subject={},r.subject.getField=function(e){return rl(r.subject,e)},r.subject.addField=function(e){Ks([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.publicKey=null,r.attributes=[],r.getAttribute=function(e){return rl(r,e)},r.addAttribute=function(e){Ks([e]),r.attributes.push(e)},r.md=null,r.setSubject=function(e){Ks(e),r.subject.attributes=e,r.subject.hash=null},r.setAttributes=function(e){Ks(e),r.attributes=e},r.sign=function(e,t){r.md=t||qe.md.sha1.create();var i=nt[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.certificationRequestInfo=Ie.getCertificationRequestInfo(r);var s=R.toDer(r.certificationRequestInfo);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(){var e=!1,t=r.md;if(t===null){if(r.signatureOid in nt){var i=nt[r.signatureOid];switch(i){case"sha1WithRSAEncryption":t=qe.md.sha1.create();break;case"md5WithRSAEncryption":t=qe.md.md5.create();break;case"sha256WithRSAEncryption":t=qe.md.sha256.create();break;case"sha384WithRSAEncryption":t=qe.md.sha384.create();break;case"sha512WithRSAEncryption":t=qe.md.sha512.create();break;case"RSASSA-PSS":t=qe.md.sha256.create();break}}if(t===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=r.signatureOid,n}var s=r.certificationRequestInfo||Ie.getCertificationRequestInfo(r),o=R.toDer(s);t.update(o.getBytes())}if(t!==null){var a;switch(r.signatureOid){case nt.sha1WithRSAEncryption:break;case nt["RSASSA-PSS"]:var c,f;if(c=nt[r.signatureParameters.mgf.hash.algorithmOid],c===void 0||qe.md[c]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=r.signatureParameters.mgf.hash.algorithmOid,n.name=c,n}if(f=nt[r.signatureParameters.mgf.algorithmOid],f===void 0||qe.mgf[f]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=r.signatureParameters.mgf.algorithmOid,n.name=f,n}if(f=qe.mgf[f].create(qe.md[c].create()),c=nt[r.signatureParameters.hash.algorithmOid],c===void 0||qe.md[c]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=r.signatureParameters.hash.algorithmOid,n.name=c,n}a=qe.pss.create(qe.md[c].create(),f,r.signatureParameters.saltLength);break}e=r.publicKey.verify(t.digest().getBytes(),r.signature,a)}return e},r};function Bp(r){for(var e=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]),t,i,n=r.attributes,s=0;s<n.length;++s){t=n[s];var o=t.value,a=R.Type.PRINTABLESTRING;"valueTagClass"in t&&(a=t.valueTagClass,a===R.Type.UTF8&&(o=qe.util.encodeUtf8(o))),i=R.create(R.Class.UNIVERSAL,R.Type.SET,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.type).getBytes()),R.create(R.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function Ks(r){for(var e,t=0;t<r.length;++t){if(e=r[t],typeof e.name=="undefined"&&(e.type&&e.type in Ie.oids?e.name=Ie.oids[e.type]:e.shortName&&e.shortName in Jr&&(e.name=Ie.oids[Jr[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in Ie.oids)e.type=Ie.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in Jr&&(e.shortName=Jr[e.name]),e.type===nt.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=R.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(Ie.certificateExtensionToAsn1(Hpe(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function Hpe(r,e){if(e=e||{},typeof r.name=="undefined"&&r.id&&r.id in Ie.oids&&(r.name=Ie.oids[r.id]),typeof r.id=="undefined")if(r.name&&r.name in Ie.oids)r.id=Ie.oids[r.name];else{var t=new Error("Extension ID not specified.");throw t.extension=r,t}if(typeof r.value!="undefined")return r;if(r.name==="keyUsage"){var i=0,n=0,s=0;r.digitalSignature&&(n|=128,i=7),r.nonRepudiation&&(n|=64,i=6),r.keyEncipherment&&(n|=32,i=5),r.dataEncipherment&&(n|=16,i=4),r.keyAgreement&&(n|=8,i=3),r.keyCertSign&&(n|=4,i=2),r.cRLSign&&(n|=2,i=1),r.encipherOnly&&(n|=1,i=0),r.decipherOnly&&(s|=128,i=7);var o=String.fromCharCode(i);s!==0?o+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(o+=String.fromCharCode(n)),r.value=R.create(R.Class.UNIVERSAL,R.Type.BITSTRING,!1,o)}else if(r.name==="basicConstraints")r.value=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]),r.cA&&r.value.value.push(R.create(R.Class.UNIVERSAL,R.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in r&&r.value.value.push(R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(r.pathLenConstraint).getBytes()));else if(r.name==="extKeyUsage"){r.value=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]);var a=r.value.value;for(var c in r)r[c]===!0&&(c in nt?a.push(R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(nt[c]).getBytes())):c.indexOf(".")!==-1&&a.push(R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(c).getBytes())))}else if(r.name==="nsCertType"){var i=0,n=0;r.client&&(n|=128,i=7),r.server&&(n|=64,i=6),r.email&&(n|=32,i=5),r.objsign&&(n|=16,i=4),r.reserved&&(n|=8,i=3),r.sslCA&&(n|=4,i=2),r.emailCA&&(n|=2,i=1),r.objCA&&(n|=1,i=0);var o=String.fromCharCode(i);n!==0&&(o+=String.fromCharCode(n)),r.value=R.create(R.Class.UNIVERSAL,R.Type.BITSTRING,!1,o)}else if(r.name==="subjectAltName"||r.name==="issuerAltName"){r.value=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]);for(var f,l=0;l<r.altNames.length;++l){f=r.altNames[l];var o=f.value;if(f.type===7&&f.ip){if(o=qe.util.bytesFromIP(f.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else f.type===8&&(f.oid?o=R.oidToDer(R.oidToDer(f.oid)):o=R.oidToDer(o));r.value.value.push(R.create(R.Class.CONTEXT_SPECIFIC,f.type,!1,o))}}else if(r.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(r.comment)||r.comment.length<1||r.comment.length>128)throw new Error('Invalid "nsComment" content.');r.value=R.create(R.Class.UNIVERSAL,R.Type.IA5STRING,!1,r.comment)}else if(r.name==="subjectKeyIdentifier"&&e.cert){var h=e.cert.generateSubjectKeyIdentifier();r.subjectKeyIdentifier=h.toHex(),r.value=R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,h.getBytes())}else if(r.name==="authorityKeyIdentifier"&&e.cert){r.value=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]);var a=r.value.value;if(r.keyIdentifier){var d=r.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():r.keyIdentifier;a.push(R.create(R.Class.CONTEXT_SPECIFIC,0,!1,d))}if(r.authorityCertIssuer){var y=[R.create(R.Class.CONTEXT_SPECIFIC,4,!0,[Bp(r.authorityCertIssuer===!0?e.cert.issuer:r.authorityCertIssuer)])];a.push(R.create(R.Class.CONTEXT_SPECIFIC,1,!0,y))}if(r.serialNumber){var g=qe.util.hexToBytes(r.serialNumber===!0?e.cert.serialNumber:r.serialNumber);a.push(R.create(R.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(r.name==="cRLDistributionPoints"){r.value=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]);for(var a=r.value.value,m=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]),E=R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[]),f,l=0;l<r.altNames.length;++l){f=r.altNames[l];var o=f.value;if(f.type===7&&f.ip){if(o=qe.util.bytesFromIP(f.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else f.type===8&&(f.oid?o=R.oidToDer(R.oidToDer(f.oid)):o=R.oidToDer(o));E.value.push(R.create(R.Class.CONTEXT_SPECIFIC,f.type,!1,o))}m.value.push(R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[E])),a.push(m)}if(typeof r.value=="undefined"){var t=new Error("Extension value not specified.");throw t.extension=r,t}return r}function NR(r,e){switch(r){case nt["RSASSA-PSS"]:var t=[];return e.hash.algorithmOid!==void 0&&t.push(R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(e.hash.algorithmOid).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&t.push(R.create(R.Class.CONTEXT_SPECIFIC,1,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(e.mgf.algorithmOid).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(e.mgf.hash.algorithmOid).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&t.push(R.create(R.Class.CONTEXT_SPECIFIC,2,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(e.saltLength).getBytes())])),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,t);default:return R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")}}function zct(r){var e=R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[]);if(r.attributes.length===0)return e;for(var t=r.attributes,i=0;i<t.length;++i){var n=t[i],s=n.value,o=R.Type.UTF8;"valueTagClass"in n&&(o=n.valueTagClass),o===R.Type.UTF8&&(s=qe.util.encodeUtf8(s));var a=!1;"valueConstructed"in n&&(a=n.valueConstructed);var c=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(n.type).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SET,!0,[R.create(R.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var Hct=new Date("1950-01-01T00:00:00Z"),$ct=new Date("2050-01-01T00:00:00Z");function $pe(r){return r>=Hct&&r<$ct?R.create(R.Class.UNIVERSAL,R.Type.UTCTIME,!1,R.dateToUtcTime(r)):R.create(R.Class.UNIVERSAL,R.Type.GENERALIZEDTIME,!1,R.dateToGeneralizedTime(r))}Ie.getTBSCertificate=function(r){var e=$pe(r.validity.notBefore),t=$pe(r.validity.notAfter),i=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(r.version).getBytes())]),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,qe.util.hexToBytes(r.serialNumber)),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(r.siginfo.algorithmOid).getBytes()),NR(r.siginfo.algorithmOid,r.siginfo.parameters)]),Bp(r.issuer),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[e,t]),Bp(r.subject),Ie.publicKeyToAsn1(r.publicKey)]);return r.issuer.uniqueId&&i.value.push(R.create(R.Class.CONTEXT_SPECIFIC,1,!0,[R.create(R.Class.UNIVERSAL,R.Type.BITSTRING,!1,String.fromCharCode(0)+r.issuer.uniqueId)])),r.subject.uniqueId&&i.value.push(R.create(R.Class.CONTEXT_SPECIFIC,2,!0,[R.create(R.Class.UNIVERSAL,R.Type.BITSTRING,!1,String.fromCharCode(0)+r.subject.uniqueId)])),r.extensions.length>0&&i.value.push(Ie.certificateExtensionsToAsn1(r.extensions)),i};Ie.getCertificationRequestInfo=function(r){var e=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(r.version).getBytes()),Bp(r.subject),Ie.publicKeyToAsn1(r.publicKey),zct(r)]);return e};Ie.distinguishedNameToAsn1=function(r){return Bp(r)};Ie.certificateToAsn1=function(r){var e=r.tbsCertificate||Ie.getTBSCertificate(r);return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[e,R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(r.signatureOid).getBytes()),NR(r.signatureOid,r.signatureParameters)]),R.create(R.Class.UNIVERSAL,R.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};Ie.certificateExtensionsToAsn1=function(r){var e=R.create(R.Class.CONTEXT_SPECIFIC,3,!0,[]),t=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]);e.value.push(t);for(var i=0;i<r.length;++i)t.value.push(Ie.certificateExtensionToAsn1(r[i]));return e};Ie.certificateExtensionToAsn1=function(r){var e=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]);e.value.push(R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(r.id).getBytes())),r.critical&&e.value.push(R.create(R.Class.UNIVERSAL,R.Type.BOOLEAN,!1,String.fromCharCode(255)));var t=r.value;return typeof r.value!="string"&&(t=R.toDer(t).getBytes()),e.value.push(R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,t)),e};Ie.certificationRequestToAsn1=function(r){var e=r.certificationRequestInfo||Ie.getCertificationRequestInfo(r);return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[e,R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(r.signatureOid).getBytes()),NR(r.signatureOid,r.signatureParameters)]),R.create(R.Class.UNIVERSAL,R.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};Ie.createCaStore=function(r){var e={certs:{}};e.getIssuer=function(o){var a=t(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=qe.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];qe.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=qe.pki.certificateFromPem(o));var a=t(o.subject);if(!a)return!1;qe.util.isArray(a)||(a=[a]);for(var c=R.toDer(Ie.certificateToAsn1(o)).getBytes(),f=0;f<a.length;++f){var l=R.toDer(Ie.certificateToAsn1(a[f])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!qe.util.isArray(c))o.push(c);else for(var f=0;f<c.length;++f)o.push(c[f])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=qe.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))return null;var c=t(o.subject);if(!qe.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var f=R.toDer(Ie.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var h=R.toDer(Ie.certificateToAsn1(c[l])).getBytes();f===h&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function t(o){return i(o),e.certs[o.hash]||null}function i(o){if(!o.hash){var a=qe.md.sha1.create();o.attributes=Ie.RDNAttributesAsArray(Bp(o),a),o.hash=a.digest().toHex()}}if(r)for(var n=0;n<r.length;++n){var s=r[n];e.addCertificate(s)}return e};Ie.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Ie.verifyCertificateChain=function(r,e,t){typeof t=="function"&&(t={verify:t}),t=t||{},e=e.slice(0);var i=e.slice(0),n=t.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),f=null,l=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Ie.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),o===null){if(f=e[0]||r.getIssuer(c),f===null&&c.isIssuer(c)&&(l=!0,f=c),f){var h=f;qe.util.isArray(h)||(h=[h]);for(var d=!1;!d&&h.length>0;){f=h.shift();try{d=f.verify(c)}catch(V){}}d||(o={message:"Certificate signature is invalid.",error:Ie.certificateError.bad_certificate})}o===null&&(!f||l)&&!r.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:Ie.certificateError.unknown_ca})}if(o===null&&f&&!c.isIssuer(f)&&(o={message:"Certificate issuer is invalid.",error:Ie.certificateError.bad_certificate}),o===null)for(var y={keyUsage:!0,basicConstraints:!0},g=0;o===null&&g<c.extensions.length;++g){var m=c.extensions[g];m.critical&&!(m.name in y)&&(o={message:"Certificate has an unsupported critical extension.",error:Ie.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!f||l))){var E=c.getExtension("basicConstraints"),_=c.getExtension("keyUsage");if(_!==null&&(!_.keyCertSign||E===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Ie.certificateError.bad_certificate}),o===null&&E!==null&&!E.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Ie.certificateError.bad_certificate}),o===null&&_!==null&&"pathLenConstraint"in E){var T=a-1;T>E.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Ie.certificateError.bad_certificate})}}var q=o===null?!0:o.error,z=t.verify?t.verify(q,a,i):q;if(z===!0)o=null;else throw q===!0&&(o={message:"The application rejected the certificate.",error:Ie.certificateError.bad_certificate}),(z||z===0)&&(typeof z=="object"&&!qe.util.isArray(z)?(z.message&&(o.message=z.message),z.error&&(o.error=z.error)):typeof z=="string"&&(o.error=z)),o;s=!1,++a}while(e.length>0);return!0}});var Xpe=p(($Ot,Ype)=>{u();var Be=lt();Sh();nc();l1();wh();p1();Mpe();ou();$t();DR();var te=Be.asn1,In=Ype.exports=Be.pkcs7=Be.pkcs7||{};In.messageFromPem=function(r){var e=Be.pem.decode(r)[0];if(e.type!=="PKCS7"){var t=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=te.fromDer(e.body);return In.messageFromAsn1(i)};In.messageToPem=function(r,e){var t={type:"PKCS7",body:te.toDer(r.toAsn1()).getBytes()};return Be.pem.encode(t,{maxline:e})};In.messageFromAsn1=function(r){var e={},t=[];if(!te.validate(r,In.asn1.contentInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=t,i}var n=te.derToOid(e.contentType),s;switch(n){case Be.pki.oids.envelopedData:s=In.createEnvelopedData();break;case Be.pki.oids.encryptedData:s=In.createEncryptedData();break;case Be.pki.oids.signedData:s=In.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};In.createSignedData=function(){var r=null;return r={type:Be.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if(LR(r,i,In.asn1.signedDataValidator),r.certificates=[],r.crls=[],r.digestAlgorithmIdentifiers=[],r.contentInfo=null,r.signerInfos=[],r.rawCapture.certificates)for(var n=r.rawCapture.certificates.value,s=0;s<n.length;++s)r.certificates.push(Be.pki.certificateFromAsn1(n[s]))},toAsn1:function(){r.contentInfo||r.sign();for(var i=[],n=0;n<r.certificates.length;++n)i.push(Be.pki.certificateToAsn1(r.certificates[n]));var s=[],o=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(r.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,r.digestAlgorithmIdentifiers),r.contentInfo])]);return i.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(te.create(te.Class.UNIVERSAL,te.Type.SET,!0,r.signerInfos)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.type).getBytes()),o])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var o=i.certificate;typeof o=="string"&&(o=Be.pki.certificateFromPem(o)),n=o.issuer.attributes,s=o.serialNumber}var a=i.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=Be.pki.privateKeyFromPem(a));var c=i.digestAlgorithm||Be.pki.oids.sha1;switch(c){case Be.pki.oids.sha1:case Be.pki.oids.sha256:case Be.pki.oids.sha384:case Be.pki.oids.sha512:case Be.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var f=i.authenticatedAttributes||[];if(f.length>0){for(var l=!1,h=!1,d=0;d<f.length;++d){var y=f[d];if(!l&&y.type===Be.pki.oids.contentType){if(l=!0,h)break;continue}if(!h&&y.type===Be.pki.oids.messageDigest){if(h=!0,l)break;continue}}if(!l||!h)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}r.signers.push({key:a,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:Be.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:f,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof r.content!="object"||r.contentInfo===null)&&(r.contentInfo=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(Be.pki.oids.data).getBytes())]),"content"in r)){var n;r.content instanceof Be.util.ByteBuffer?n=r.content.bytes():typeof r.content=="string"&&(n=Be.util.encodeUtf8(r.content)),i.detached?r.detachedContent=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n):r.contentInfo.value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n)]))}if(r.signers.length!==0){var s=e();t(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=Be.pki.certificateFromPem(i)),r.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},r;function e(){for(var i={},n=0;n<r.signers.length;++n){var s=r.signers[n],o=s.digestAlgorithm;o in i||(i[o]=Be.md[Be.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=i[o]:s.md=Be.md[Be.pki.oids[o]].create()}r.digestAlgorithmIdentifiers=[];for(var o in i)r.digestAlgorithmIdentifiers.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(o).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]));return i}function t(i){var n;if(r.detachedContent?n=r.detachedContent:(n=r.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=te.derToOid(r.contentInfo.value[0].value),o=te.toDer(n);o.getByte(),te.getBerValueLength(o),o=o.getBytes();for(var a in i)i[a].start().update(o);for(var c=new Date,f=0;f<r.signers.length;++f){var l=r.signers[f];if(l.authenticatedAttributes.length===0){if(s!==Be.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[]),d=0;d<l.authenticatedAttributes.length;++d){var y=l.authenticatedAttributes[d];y.type===Be.pki.oids.messageDigest?y.value=i[l.digestAlgorithm].digest():y.type===Be.pki.oids.signingTime&&(y.value||(y.value=c)),h.value.push(MR(y)),l.authenticatedAttributesAsn1.value.push(MR(y))}o=te.toDer(h).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}r.signerInfos=Jct(r.signers)}};In.createEncryptedData=function(){var r=null;return r={type:Be.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Be.pki.oids["aes256-CBC"]},fromAsn1:function(e){LR(r,e,In.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(r.encryptedContent.key=e),Wpe(r)}},r};In.createEnvelopedData=function(){var r=null;return r={type:Be.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Be.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=LR(r,e,In.asn1.envelopedDataValidator);r.recipients=Yct(t.recipientInfos.value)},toAsn1:function(){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.type).getBytes()),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(r.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,Xct(r.recipients)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,Zct(r.encryptedContent))])])])},findRecipient:function(e){for(var t=e.issuer.attributes,i=0;i<r.recipients.length;++i){var n=r.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===t.length){for(var o=!0,a=0;a<t.length;++a)if(s[a].type!==t[a].type||s[a].value!==t[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(e,t){if(r.encryptedContent.key===void 0&&e!==void 0&&t!==void 0)switch(e.encryptedContent.algorithm){case Be.pki.oids.rsaEncryption:case Be.pki.oids.desCBC:var i=t.decrypt(e.encryptedContent.content);r.encryptedContent.key=Be.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}Wpe(r)},addRecipient:function(e){r.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Be.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,t){if(r.encryptedContent.content===void 0){t=t||r.encryptedContent.algorithm,e=e||r.encryptedContent.key;var i,n,s;switch(t){case Be.pki.oids["aes128-CBC"]:i=16,n=16,s=Be.aes.createEncryptionCipher;break;case Be.pki.oids["aes192-CBC"]:i=24,n=16,s=Be.aes.createEncryptionCipher;break;case Be.pki.oids["aes256-CBC"]:i=32,n=16,s=Be.aes.createEncryptionCipher;break;case Be.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=Be.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+t)}if(e===void 0)e=Be.util.createBuffer(Be.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");r.encryptedContent.algorithm=t,r.encryptedContent.key=e,r.encryptedContent.parameter=Be.util.createBuffer(Be.random.getBytes(n));var o=s(e);if(o.start(r.encryptedContent.parameter.copy()),o.update(r.content),!o.finish())throw new Error("Symmetric encryption failed.");r.encryptedContent.content=o.output}for(var a=0;a<r.recipients.length;++a){var c=r.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case Be.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(r.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},r};function Gct(r){var e={},t=[];if(!te.validate(r,In.asn1.recipientInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=t,i}return{version:e.version.charCodeAt(0),issuer:Be.pki.RDNAttributesAsArray(e.issuer),serialNumber:Be.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:te.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function Wct(r){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(r.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[Be.pki.distinguishedNameToAsn1({attributes:r.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Be.util.hexToBytes(r.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.encryptedContent.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.encryptedContent.content)])}function Yct(r){for(var e=[],t=0;t<r.length;++t)e.push(Gct(r[t]));return e}function Xct(r){for(var e=[],t=0;t<r.length;++t)e.push(Wct(r[t]));return e}function Qct(r){var e=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(r.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[Be.pki.distinguishedNameToAsn1({attributes:r.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Be.util.hexToBytes(r.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.digestAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])]);if(r.authenticatedAttributesAsn1&&e.value.push(r.authenticatedAttributesAsn1),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.signatureAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.signature)),r.unauthenticatedAttributes.length>0){for(var t=te.create(te.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<r.unauthenticatedAttributes.length;++i){var n=r.unauthenticatedAttributes[i];t.values.push(MR(n))}e.value.push(t)}return e}function Jct(r){for(var e=[],t=0;t<r.length;++t)e.push(Qct(r[t]));return e}function MR(r){var e;if(r.type===Be.pki.oids.contentType)e=te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.value).getBytes());else if(r.type===Be.pki.oids.messageDigest)e=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.value.bytes());else if(r.type===Be.pki.oids.signingTime){var t=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=r.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=te.utcTimeToDate(n):n=te.generalizedTimeToDate(n):n=new Date(s)}n>=t&&n<i?e=te.create(te.Class.UNIVERSAL,te.Type.UTCTIME,!1,te.dateToUtcTime(n)):e=te.create(te.Class.UNIVERSAL,te.Type.GENERALIZEDTIME,!1,te.dateToGeneralizedTime(n))}return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.type).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[e])])}function Zct(r){return[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(Be.pki.oids.data).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.parameter.getBytes())]),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.content.getBytes())])]}function LR(r,e,t){var i={},n=[];if(!te.validate(e,t,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=te.derToOid(i.contentType);if(o!==Be.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(Be.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;r.encryptedContent={algorithm:te.derToOid(i.encAlgorithm),parameter:Be.util.createBuffer(i.encParameter.value),content:Be.util.createBuffer(a)}}if(i.content){var a="";if(Be.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;r.content=Be.util.createBuffer(a)}return r.version=i.version.charCodeAt(0),r.rawCapture=i,i}function Wpe(r){if(r.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(r.content===void 0){var e;switch(r.encryptedContent.algorithm){case Be.pki.oids["aes128-CBC"]:case Be.pki.oids["aes192-CBC"]:case Be.pki.oids["aes256-CBC"]:e=Be.aes.createDecryptionCipher(r.encryptedContent.key);break;case Be.pki.oids.desCBC:case Be.pki.oids["des-EDE3-CBC"]:e=Be.des.createDecryptionCipher(r.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+r.encryptedContent.algorithm)}if(e.start(r.encryptedContent.parameter),e.update(r.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");r.content=e.output}}});var Zpe=p((GOt,Jpe)=>{u();"use strict";DR();var eut=lt(),Qpe=eut.pki,tut=(r,e)=>{let t=Qpe.setRsaPublicKey(e.n,e.e),i=Qpe.createCertificate();i.publicKey=t,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:r.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function rut(r,e){let t=r.map(e),n=(await Promise.all(t)).findIndex(s=>s);return r[n]}Jpe.exports={certificateForKey:tut,findAsync:rut}});var i0e=p((WOt,r0e)=>{u();"use strict";Xpe();Q3();var il=lt(),{certificateForKey:iut,findAsync:nut}=Zpe(),Np=ue(),e0e=ct(),sut=Ze(),UR=new WeakMap,t0e=class{constructor(e,t){if(!e)throw Np(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e,UR.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw Np(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=UR.get(this).dek,o=il.pki.decryptRsaPrivateKey(n,s),a=await iut(i,o),c=il.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=il.util.createBuffer(t),c.encrypt();let f=il.asn1.toDer(c.toAsn1()).getBytes();return e0e(f,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw Np(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let t;try{let f=il.util.createBuffer(sut(e,"ascii")),l=il.asn1.fromDer(f);t=il.pkcs7.messageFromAsn1(l)}catch(f){throw Np(new Error("Invalid CMS: "+f.message),"ERR_INVALID_CMS")}let i=t.recipients.filter(f=>f.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(f=>f.issuer.find(l=>l.shortName==="CN")).map(f=>({recipient:f,keyId:f.issuer.find(l=>l.shortName==="CN").value})),n=await nut(i,async f=>{try{if(await this.keychain.findKeyById(f.keyId))return!0}catch(l){return!1}return!1});if(!n){let f=i.map(l=>l.keyId);throw Np(new Error("Decryption needs one of the key(s): "+f.join(", ")),"ERR_MISSING_KEYS",{missingKeys:f})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw Np(new Error("No key available to decrypto"),"ERR_NO_KEY");let o=await this.keychain._getPrivateKey(s.name),a=UR.get(this).dek,c=il.pki.decryptRsaPrivateKey(o,a);return t.decrypt(n.recipient,c),e0e(t.content.getBytes(),"ascii")}};r0e.exports=t0e});var l0e=p((YOt,u0e)=>{u();"use strict";var n0e=me(),s0e=Object.assign(n0e("libp2p:keychain"),{error:n0e("libp2p:keychain:err")}),out=kpe(),aut=mr(),Vf=Ea(),{Key:o0e}=Lt(),cut=i0e(),Sr=ue(),zf=Ze(),Lc=ct();E1();var uut="/pkcs8/",a0e="/info/",nl=new WeakMap,Hf={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},FR={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function Uc(r){return!r||typeof r!="string"?!1:r===out(r.trim())}async function Kt(r){let e=200,t=1e3,i=Math.random()*(t-e)+e;throw await new Promise(n=>setTimeout(n,i)),r}function Fa(r){return new o0e(uut+r)}function sl(r){return new o0e(a0e+r)}var c0e=class{constructor(e,t){if(!e)throw new Error("store is required");if(this.store=e,this.opts=aut(FR,t),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Hf.minKeyLength)throw new Error(`dek.keyLength must be least ${Hf.minKeyLength} bytes`);if(this.opts.dek.salt.length<Hf.minSaltLength)throw new Error(`dek.saltLength must be least ${Hf.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Hf.minIterationCount)throw new Error(`dek.iterationCount must be least ${Hf.minIterationCount}`);let i=this.opts.pass?Vf.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";nl.set(this,{dek:i})}get cms(){return new cut(this,nl.get(this).dek)}static generateOptions(){let e=Object.assign({},FR),t=Math.ceil(Hf.minSaltLength/3)*3;return e.dek.salt=zf(Vf.randomBytes(t),"base64"),e}static get options(){return FR}async createKey(e,t,i=2048){let n=this;if(!Uc(e)||e==="self")return Kt(Sr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(typeof t!="string")return Kt(Sr(new Error(`Invalid key type '${t}'`),"ERR_INVALID_KEY_TYPE"));let s=Fa(e);if(await n.store.has(s))return Kt(Sr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return Kt(Sr(new Error(`Invalid RSA key size ${i}`),"ERR_INVALID_KEY_SIZE"));break;default:break}let a;try{let c=await Vf.keys.generateKeyPair(t,i),f=await c.id(),l=nl.get(this).dek,h=await c.export(l);a={name:e,id:f};let d=n.store.batch();d.put(s,Lc(h)),d.put(sl(e),Lc(JSON.stringify(a))),await d.commit()}catch(c){return Kt(c)}return a}async listKeys(){let e=this,t={prefix:a0e},i=[];for await(let n of e.store.query(t))i.push(JSON.parse(zf(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(t){return Kt(t)}}async findKeyByName(e){if(!Uc(e))return Kt(Sr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let t=sl(e);try{let i=await this.store.get(t);return JSON.parse(zf(i))}catch(i){return Kt(Sr(new Error(`Key '${e}' does not exist. ${i.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(e){let t=this;if(!Uc(e)||e==="self")return Kt(Sr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let i=Fa(e),n=await t.findKeyByName(e),s=t.store.batch();return s.delete(i),s.delete(sl(e)),await s.commit(),n}async renameKey(e,t){let i=this;if(!Uc(e)||e==="self")return Kt(Sr(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!Uc(t)||t==="self")return Kt(Sr(new Error(`Invalid new key name '${t}'`),"ERR_NEW_KEY_NAME_INVALID"));let n=Fa(e),s=Fa(t),o=sl(e),a=sl(t);if(await i.store.has(s))return Kt(Sr(new Error(`Key '${t}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let f=await i.store.get(n),l=await i.store.get(o),h=JSON.parse(zf(l));h.name=t;let d=i.store.batch();return d.put(s,f),d.put(a,Lc(JSON.stringify(h))),d.delete(n),d.delete(o),await d.commit(),h}catch(f){return Kt(f)}}async exportKey(e,t){if(!Uc(e))return Kt(Sr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return Kt(Sr(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));let i=Fa(e);try{let n=await this.store.get(i),s=zf(n),o=nl.get(this).dek;return(await Vf.keys.import(s,o)).export(t)}catch(n){return Kt(n)}}async importKey(e,t,i){let n=this;if(!Uc(e)||e==="self")return Kt(Sr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return Kt(Sr(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));let s=Fa(e);if(await n.store.has(s))return Kt(Sr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let a;try{a=await Vf.keys.import(t,i)}catch(h){return Kt(Sr(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}let c;try{c=await a.id();let h=nl.get(this).dek;t=await a.export(h)}catch(h){return Kt(h)}let f={name:e,id:c},l=n.store.batch();return l.put(s,Lc(t)),l.put(sl(e),Lc(JSON.stringify(f))),await l.commit(),f}async importPeer(e,t){let i=this;if(!Uc(e))return Kt(Sr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t||!t.privKey)return Kt(Sr(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));let n=t.privKey,s=Fa(e);if(await i.store.has(s))return Kt(Sr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let a=await n.id(),c=nl.get(this).dek,f=await n.export(c),l={name:e,id:a},h=i.store.batch();return h.put(s,Lc(f)),h.put(sl(e),Lc(JSON.stringify(l))),await h.commit(),l}catch(a){return Kt(a)}}async _getPrivateKey(e){if(!Uc(e))return Kt(Sr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));try{let t=Fa(e),i=await this.store.get(t);return zf(i)}catch(t){return Kt(Sr(new Error(`Key '${e}' does not exist. ${t.message}`),"ERR_KEY_NOT_FOUND"))}}async rotateKeychainPass(e,t){if(typeof e!="string")return Kt(Sr(new Error(`Invalid old pass type '${typeof e}'`),"ERR_INVALID_OLD_PASS_TYPE"));if(typeof t!="string")return Kt(Sr(new Error(`Invalid new pass type '${typeof t}'`),"ERR_INVALID_NEW_PASS_TYPE"));if(t.length<20)return Kt(Sr(new Error(`Invalid pass length ${t.length}`),"ERR_INVALID_PASS_LENGTH"));s0e("recreating keychain");let i=nl.get(this).dek;this.opts.pass=t;let n=t?Vf.pbkdf2(t,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";nl.set(this,{dek:n});let s=await this.listKeys();for(let o of s){let a=await this.store.get(Fa(o.name)),c=zf(a),f=await Vf.keys.import(c,i),l=n.toString(),h=await f.export(l),d=this.store.batch(),y={name:o.name,id:o.id};d.put(Fa(o.name),Lc(h)),d.put(sl(o.name),Lc(JSON.stringify(y))),await d.commit()}s0e("keychain reconstructed")}};u0e.exports=c0e});var h0e=p((XOt,f0e)=>{u();"use strict";var lut=sg();f0e.exports=r=>{let e=lut(r);return e.delete=e.remove,e}});var p0e=p((d0e,z2)=>{u();(function(r){"use strict";var e,t=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,f=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function y(V){var M,$,X,Q=W.prototype={constructor:W,toString:null,valueOf:null},O=new W(1),b=20,w=4,S=-7,C=21,B=-1e7,G=1e7,F=!1,N=1,v=0,D={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},ae="0123456789abcdefghijklmnopqrstuvwxyz";function W(P,U){var H,J,x,L,K,k,Y,ee,Z=this;if(!(Z instanceof W))return new W(P,U);if(U==null){if(P&&P._isBigNumber===!0){Z.s=P.s,!P.c||P.e>G?Z.c=Z.e=null:P.e<B?Z.c=[Z.e=0]:(Z.e=P.e,Z.c=P.c.slice());return}if((k=typeof P=="number")&&P*0==0){if(Z.s=1/P<0?(P=-P,-1):1,P===~~P){for(L=0,K=P;K>=10;K/=10,L++);L>G?Z.c=Z.e=null:(Z.e=L,Z.c=[P]);return}ee=String(P)}else{if(!t.test(ee=String(P)))return X(Z,ee,k);Z.s=ee.charCodeAt(0)==45?(ee=ee.slice(1),-1):1}(L=ee.indexOf("."))>-1&&(ee=ee.replace(".","")),(K=ee.search(/e/i))>0?(L<0&&(L=K),L+=+ee.slice(K+1),ee=ee.substring(0,K)):L<0&&(L=ee.length)}else{if(_(U,2,ae.length,"Base"),U==10)return Z=new W(P),pe(Z,b+Z.e+1,w);if(ee=String(P),k=typeof P=="number"){if(P*0!=0)return X(Z,ee,k,U);if(Z.s=1/P<0?(ee=ee.slice(1),-1):1,W.DEBUG&&ee.replace(/^0\.0*|\./,"").length>15)throw Error(o+P)}else Z.s=ee.charCodeAt(0)===45?(ee=ee.slice(1),-1):1;for(H=ae.slice(0,U),L=K=0,Y=ee.length;K<Y;K++)if(H.indexOf(J=ee.charAt(K))<0){if(J=="."){if(K>L){L=Y;continue}}else if(!x&&(ee==ee.toUpperCase()&&(ee=ee.toLowerCase())||ee==ee.toLowerCase()&&(ee=ee.toUpperCase()))){x=!0,K=-1,L=0;continue}return X(Z,String(P),k,U)}k=!1,ee=$(ee,U,10,Z.s),(L=ee.indexOf("."))>-1?ee=ee.replace(".",""):L=ee.length}for(K=0;ee.charCodeAt(K)===48;K++);for(Y=ee.length;ee.charCodeAt(--Y)===48;);if(ee=ee.slice(K,++Y)){if(Y-=K,k&&W.DEBUG&&Y>15&&(P>f||P!==n(P)))throw Error(o+Z.s*P);if((L=L-K-1)>G)Z.c=Z.e=null;else if(L<B)Z.c=[Z.e=0];else{if(Z.e=L,Z.c=[],K=(L+1)%c,L<0&&(K+=c),K<Y){for(K&&Z.c.push(+ee.slice(0,K)),Y-=c;K<Y;)Z.c.push(+ee.slice(K,K+=c));K=c-(ee=ee.slice(K)).length}else K-=Y;for(;K--;ee+="0");Z.c.push(+ee)}}else Z.c=[Z.e=0]}W.clone=y,W.ROUND_UP=0,W.ROUND_DOWN=1,W.ROUND_CEIL=2,W.ROUND_FLOOR=3,W.ROUND_HALF_UP=4,W.ROUND_HALF_DOWN=5,W.ROUND_HALF_EVEN=6,W.ROUND_HALF_CEIL=7,W.ROUND_HALF_FLOOR=8,W.EUCLID=9,W.config=W.set=function(P){var U,H;if(P!=null)if(typeof P=="object"){if(P.hasOwnProperty(U="DECIMAL_PLACES")&&(H=P[U],_(H,0,d,U),b=H),P.hasOwnProperty(U="ROUNDING_MODE")&&(H=P[U],_(H,0,8,U),w=H),P.hasOwnProperty(U="EXPONENTIAL_AT")&&(H=P[U],H&&H.pop?(_(H[0],-d,0,U),_(H[1],0,d,U),S=H[0],C=H[1]):(_(H,-d,d,U),S=-(C=H<0?-H:H))),P.hasOwnProperty(U="RANGE"))if(H=P[U],H&&H.pop)_(H[0],-d,-1,U),_(H[1],1,d,U),B=H[0],G=H[1];else if(_(H,-d,d,U),H)B=-(G=H<0?-H:H);else throw Error(s+U+" cannot be zero: "+H);if(P.hasOwnProperty(U="CRYPTO"))if(H=P[U],H===!!H)if(H)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))F=H;else throw F=!H,Error(s+"crypto unavailable");else F=H;else throw Error(s+U+" not true or false: "+H);if(P.hasOwnProperty(U="MODULO_MODE")&&(H=P[U],_(H,0,9,U),N=H),P.hasOwnProperty(U="POW_PRECISION")&&(H=P[U],_(H,0,d,U),v=H),P.hasOwnProperty(U="FORMAT"))if(H=P[U],typeof H=="object")D=H;else throw Error(s+U+" not an object: "+H);if(P.hasOwnProperty(U="ALPHABET"))if(H=P[U],typeof H=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(H))ae=H;else throw Error(s+U+" invalid: "+H)}else throw Error(s+"Object expected: "+P);return{DECIMAL_PLACES:b,ROUNDING_MODE:w,EXPONENTIAL_AT:[S,C],RANGE:[B,G],CRYPTO:F,MODULO_MODE:N,POW_PRECISION:v,FORMAT:D,ALPHABET:ae}},W.isBigNumber=function(P){if(!P||P._isBigNumber!==!0)return!1;if(!W.DEBUG)return!0;var U,H,J=P.c,x=P.e,L=P.s;e:if({}.toString.call(J)=="[object Array]"){if((L===1||L===-1)&&x>=-d&&x<=d&&x===n(x)){if(J[0]===0){if(x===0&&J.length===1)return!0;break e}if(U=(x+1)%c,U<1&&(U+=c),String(J[0]).length==U){for(U=0;U<J.length;U++)if(H=J[U],H<0||H>=a||H!==n(H))break e;if(H!==0)return!0}}}else if(J===null&&x===null&&(L===null||L===1||L===-1))return!0;throw Error(s+"Invalid BigNumber: "+P)},W.maximum=W.max=function(){return oe(arguments,Q.lt)},W.minimum=W.min=function(){return oe(arguments,Q.gt)},W.random=function(){var P=9007199254740992,U=Math.random()*P&2097151?function(){return n(Math.random()*P)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(H){var J,x,L,K,k,Y=0,ee=[],Z=new W(O);if(H==null?H=b:_(H,0,d),K=i(H/c),F)if(crypto.getRandomValues){for(J=crypto.getRandomValues(new Uint32Array(K*=2));Y<K;)k=J[Y]*131072+(J[Y+1]>>>11),k>=9e15?(x=crypto.getRandomValues(new Uint32Array(2)),J[Y]=x[0],J[Y+1]=x[1]):(ee.push(k%1e14),Y+=2);Y=K/2}else if(crypto.randomBytes){for(J=crypto.randomBytes(K*=7);Y<K;)k=(J[Y]&31)*281474976710656+J[Y+1]*1099511627776+J[Y+2]*4294967296+J[Y+3]*16777216+(J[Y+4]<<16)+(J[Y+5]<<8)+J[Y+6],k>=9e15?crypto.randomBytes(7).copy(J,Y):(ee.push(k%1e14),Y+=7);Y=K/7}else throw F=!1,Error(s+"crypto unavailable");if(!F)for(;Y<K;)k=U(),k<9e15&&(ee[Y++]=k%1e14);for(K=ee[--Y],H%=c,K&&H&&(k=l[c-H],ee[Y]=n(K/k)*k);ee[Y]===0;ee.pop(),Y--);if(Y<0)ee=[L=0];else{for(L=-1;ee[0]===0;ee.splice(0,1),L-=c);for(Y=1,k=ee[0];k>=10;k/=10,Y++);Y<c&&(L-=c-Y)}return Z.e=L,Z.c=ee,Z}}(),W.sum=function(){for(var P=1,U=arguments,H=new W(U[0]);P<U.length;)H=H.plus(U[P++]);return H},$=function(){var P="0123456789";function U(H,J,x,L){for(var K,k=[0],Y,ee=0,Z=H.length;ee<Z;){for(Y=k.length;Y--;k[Y]*=J);for(k[0]+=L.indexOf(H.charAt(ee++)),K=0;K<k.length;K++)k[K]>x-1&&(k[K+1]==null&&(k[K+1]=0),k[K+1]+=k[K]/x|0,k[K]%=x)}return k.reverse()}return function(H,J,x,L,K){var k,Y,ee,Z,ce,ge,be,Ke,Te=H.indexOf("."),je=b,Je=w;for(Te>=0&&(Z=v,v=0,H=H.replace(".",""),Ke=new W(J),ge=Ke.pow(H.length-Te),v=Z,Ke.c=U(z(m(ge.c),ge.e,"0"),10,x,P),Ke.e=Ke.c.length),be=U(H,J,x,K?(k=ae,P):(k=P,ae)),ee=Z=be.length;be[--Z]==0;be.pop());if(!be[0])return k.charAt(0);if(Te<0?--ee:(ge.c=be,ge.e=ee,ge.s=L,ge=M(ge,Ke,je,Je,x),be=ge.c,ce=ge.r,ee=ge.e),Y=ee+je+1,Te=be[Y],Z=x/2,ce=ce||Y<0||be[Y+1]!=null,ce=Je<4?(Te!=null||ce)&&(Je==0||Je==(ge.s<0?3:2)):Te>Z||Te==Z&&(Je==4||ce||Je==6&&be[Y-1]&1||Je==(ge.s<0?8:7)),Y<1||!be[0])H=ce?z(k.charAt(1),-je,k.charAt(0)):k.charAt(0);else{if(be.length=Y,ce)for(--x;++be[--Y]>x;)be[Y]=0,Y||(++ee,be=[1].concat(be));for(Z=be.length;!be[--Z];);for(Te=0,H="";Te<=Z;H+=k.charAt(be[Te++]));H=z(H,ee,k.charAt(0))}return H}}(),M=function(){function P(J,x,L){var K,k,Y,ee,Z=0,ce=J.length,ge=x%h,be=x/h|0;for(J=J.slice();ce--;)Y=J[ce]%h,ee=J[ce]/h|0,K=be*Y+ee*ge,k=ge*Y+K%h*h+Z,Z=(k/L|0)+(K/h|0)+be*ee,J[ce]=k%L;return Z&&(J=[Z].concat(J)),J}function U(J,x,L,K){var k,Y;if(L!=K)Y=L>K?1:-1;else for(k=Y=0;k<L;k++)if(J[k]!=x[k]){Y=J[k]>x[k]?1:-1;break}return Y}function H(J,x,L,K){for(var k=0;L--;)J[L]-=k,k=J[L]<x[L]?1:0,J[L]=k*K+J[L]-x[L];for(;!J[0]&&J.length>1;J.splice(0,1));}return function(J,x,L,K,k){var Y,ee,Z,ce,ge,be,Ke,Te,je,Je,ze,Ve,dt,Vt,Jt,yn,Ut,Et=J.s==x.s?1:-1,ri=J.c,it=x.c;if(!ri||!ri[0]||!it||!it[0])return new W(!J.s||!x.s||(ri?it&&ri[0]==it[0]:!it)?NaN:ri&&ri[0]==0||!it?Et*0:Et/0);for(Te=new W(Et),je=Te.c=[],ee=J.e-x.e,Et=L+ee+1,k||(k=a,ee=g(J.e/c)-g(x.e/c),Et=Et/c|0),Z=0;it[Z]==(ri[Z]||0);Z++);if(it[Z]>(ri[Z]||0)&&ee--,Et<0)je.push(1),ce=!0;else{for(Vt=ri.length,yn=it.length,Z=0,Et+=2,ge=n(k/(it[0]+1)),ge>1&&(it=P(it,ge,k),ri=P(ri,ge,k),yn=it.length,Vt=ri.length),dt=yn,Je=ri.slice(0,yn),ze=Je.length;ze<yn;Je[ze++]=0);Ut=it.slice(),Ut=[0].concat(Ut),Jt=it[0],it[1]>=k/2&&Jt++;do{if(ge=0,Y=U(it,Je,yn,ze),Y<0){if(Ve=Je[0],yn!=ze&&(Ve=Ve*k+(Je[1]||0)),ge=n(Ve/Jt),ge>1)for(ge>=k&&(ge=k-1),be=P(it,ge,k),Ke=be.length,ze=Je.length;U(be,Je,Ke,ze)==1;)ge--,H(be,yn<Ke?Ut:it,Ke,k),Ke=be.length,Y=1;else ge==0&&(Y=ge=1),be=it.slice(),Ke=be.length;if(Ke<ze&&(be=[0].concat(be)),H(Je,be,ze,k),ze=Je.length,Y==-1)for(;U(it,Je,yn,ze)<1;)ge++,H(Je,yn<ze?Ut:it,ze,k),ze=Je.length}else Y===0&&(ge++,Je=[0]);je[Z++]=ge,Je[0]?Je[ze++]=ri[dt]||0:(Je=[ri[dt]],ze=1)}while((dt++<Vt||Je[0]!=null)&&Et--);ce=Je[0]!=null,je[0]||je.splice(0,1)}if(k==a){for(Z=1,Et=je[0];Et>=10;Et/=10,Z++);pe(Te,L+(Te.e=Z+ee*c-1)+1,K,ce)}else Te.e=ee,Te.r=+ce;return Te}}();function ne(P,U,H,J){var x,L,K,k,Y;if(H==null?H=w:_(H,0,8),!P.c)return P.toString();if(x=P.c[0],K=P.e,U==null)Y=m(P.c),Y=J==1||J==2&&(K<=S||K>=C)?q(Y,K):z(Y,K,"0");else if(P=pe(new W(P),U,H),L=P.e,Y=m(P.c),k=Y.length,J==1||J==2&&(U<=L||L<=S)){for(;k<U;Y+="0",k++);Y=q(Y,L)}else if(U-=K,Y=z(Y,L,"0"),L+1>k){if(--U>0)for(Y+=".";U--;Y+="0");}else if(U+=L-k,U>0)for(L+1==k&&(Y+=".");U--;Y+="0");return P.s<0&&x?"-"+Y:Y}function oe(P,U){for(var H,J=1,x=new W(P[0]);J<P.length;J++)if(H=new W(P[J]),H.s)U.call(x,H)&&(x=H);else{x=H;break}return x}function de(P,U,H){for(var J=1,x=U.length;!U[--x];U.pop());for(x=U[0];x>=10;x/=10,J++);return(H=J+H*c-1)>G?P.c=P.e=null:H<B?P.c=[P.e=0]:(P.e=H,P.c=U),P}X=function(){var P=/^(-?)0([xbo])(?=\w[\w.]*$)/i,U=/^([^.]+)\.$/,H=/^\.([^.]+)$/,J=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(L,K,k,Y){var ee,Z=k?K:K.replace(x,"");if(J.test(Z))L.s=isNaN(Z)?null:Z<0?-1:1;else{if(!k&&(Z=Z.replace(P,function(ce,ge,be){return ee=(be=be.toLowerCase())=="x"?16:be=="b"?2:8,!Y||Y==ee?ge:ce}),Y&&(ee=Y,Z=Z.replace(U,"$1").replace(H,"0.$1")),K!=Z))return new W(Z,ee);if(W.DEBUG)throw Error(s+"Not a"+(Y?" base "+Y:"")+" number: "+K);L.s=null}L.c=L.e=null}}();function pe(P,U,H,J){var x,L,K,k,Y,ee,Z,ce=P.c,ge=l;if(ce){e:{for(x=1,k=ce[0];k>=10;k/=10,x++);if(L=U-x,L<0)L+=c,K=U,Y=ce[ee=0],Z=Y/ge[x-K-1]%10|0;else if(ee=i((L+1)/c),ee>=ce.length)if(J){for(;ce.length<=ee;ce.push(0));Y=Z=0,x=1,L%=c,K=L-c+1}else break e;else{for(Y=k=ce[ee],x=1;k>=10;k/=10,x++);L%=c,K=L-c+x,Z=K<0?0:Y/ge[x-K-1]%10|0}if(J=J||U<0||ce[ee+1]!=null||(K<0?Y:Y%ge[x-K-1]),J=H<4?(Z||J)&&(H==0||H==(P.s<0?3:2)):Z>5||Z==5&&(H==4||J||H==6&&(L>0?K>0?Y/ge[x-K]:0:ce[ee-1])%10&1||H==(P.s<0?8:7)),U<1||!ce[0])return ce.length=0,J?(U-=P.e+1,ce[0]=ge[(c-U%c)%c],P.e=-U||0):ce[0]=P.e=0,P;if(L==0?(ce.length=ee,k=1,ee--):(ce.length=ee+1,k=ge[c-L],ce[ee]=K>0?n(Y/ge[x-K]%ge[K])*k:0),J)for(;;)if(ee==0){for(L=1,K=ce[0];K>=10;K/=10,L++);for(K=ce[0]+=k,k=1;K>=10;K/=10,k++);L!=k&&(P.e++,ce[0]==a&&(ce[0]=1));break}else{if(ce[ee]+=k,ce[ee]!=a)break;ce[ee--]=0,k=1}for(L=ce.length;ce[--L]===0;ce.pop());}P.e>G?P.c=P.e=null:P.e<B&&(P.c=[P.e=0])}return P}function _e(P){var U,H=P.e;return H===null?P.toString():(U=m(P.c),U=H<=S||H>=C?q(U,H):z(U,H,"0"),P.s<0?"-"+U:U)}return Q.absoluteValue=Q.abs=function(){var P=new W(this);return P.s<0&&(P.s=1),P},Q.comparedTo=function(P,U){return E(this,new W(P,U))},Q.decimalPlaces=Q.dp=function(P,U){var H,J,x,L=this;if(P!=null)return _(P,0,d),U==null?U=w:_(U,0,8),pe(new W(L),P+L.e+1,U);if(!(H=L.c))return null;if(J=((x=H.length-1)-g(this.e/c))*c,x=H[x])for(;x%10==0;x/=10,J--);return J<0&&(J=0),J},Q.dividedBy=Q.div=function(P,U){return M(this,new W(P,U),b,w)},Q.dividedToIntegerBy=Q.idiv=function(P,U){return M(this,new W(P,U),0,1)},Q.exponentiatedBy=Q.pow=function(P,U){var H,J,x,L,K,k,Y,ee,Z,ce=this;if(P=new W(P),P.c&&!P.isInteger())throw Error(s+"Exponent not an integer: "+_e(P));if(U!=null&&(U=new W(U)),k=P.e>14,!ce.c||!ce.c[0]||ce.c[0]==1&&!ce.e&&ce.c.length==1||!P.c||!P.c[0])return Z=new W(Math.pow(+_e(ce),k?2-T(P):+_e(P))),U?Z.mod(U):Z;if(Y=P.s<0,U){if(U.c?!U.c[0]:!U.s)return new W(NaN);J=!Y&&ce.isInteger()&&U.isInteger(),J&&(ce=ce.mod(U))}else{if(P.e>9&&(ce.e>0||ce.e<-1||(ce.e==0?ce.c[0]>1||k&&ce.c[1]>=24e7:ce.c[0]<8e13||k&&ce.c[0]<=9999975e7)))return L=ce.s<0&&T(P)?-0:0,ce.e>-1&&(L=1/L),new W(Y?1/L:L);v&&(L=i(v/c+2))}for(k?(H=new W(.5),Y&&(P.s=1),ee=T(P)):(x=Math.abs(+_e(P)),ee=x%2),Z=new W(O);;){if(ee){if(Z=Z.times(ce),!Z.c)break;L?Z.c.length>L&&(Z.c.length=L):J&&(Z=Z.mod(U))}if(x){if(x=n(x/2),x===0)break;ee=x%2}else if(P=P.times(H),pe(P,P.e+1,1),P.e>14)ee=T(P);else{if(x=+_e(P),x===0)break;ee=x%2}ce=ce.times(ce),L?ce.c&&ce.c.length>L&&(ce.c.length=L):J&&(ce=ce.mod(U))}return J?Z:(Y&&(Z=O.div(Z)),U?Z.mod(U):L?pe(Z,v,w,K):Z)},Q.integerValue=function(P){var U=new W(this);return P==null?P=w:_(P,0,8),pe(U,U.e+1,P)},Q.isEqualTo=Q.eq=function(P,U){return E(this,new W(P,U))===0},Q.isFinite=function(){return!!this.c},Q.isGreaterThan=Q.gt=function(P,U){return E(this,new W(P,U))>0},Q.isGreaterThanOrEqualTo=Q.gte=function(P,U){return(U=E(this,new W(P,U)))===1||U===0},Q.isInteger=function(){return!!this.c&&g(this.e/c)>this.c.length-2},Q.isLessThan=Q.lt=function(P,U){return E(this,new W(P,U))<0},Q.isLessThanOrEqualTo=Q.lte=function(P,U){return(U=E(this,new W(P,U)))===-1||U===0},Q.isNaN=function(){return!this.s},Q.isNegative=function(){return this.s<0},Q.isPositive=function(){return this.s>0},Q.isZero=function(){return!!this.c&&this.c[0]==0},Q.minus=function(P,U){var H,J,x,L,K=this,k=K.s;if(P=new W(P,U),U=P.s,!k||!U)return new W(NaN);if(k!=U)return P.s=-U,K.plus(P);var Y=K.e/c,ee=P.e/c,Z=K.c,ce=P.c;if(!Y||!ee){if(!Z||!ce)return Z?(P.s=-U,P):new W(ce?K:NaN);if(!Z[0]||!ce[0])return ce[0]?(P.s=-U,P):new W(Z[0]?K:w==3?-0:0)}if(Y=g(Y),ee=g(ee),Z=Z.slice(),k=Y-ee){for((L=k<0)?(k=-k,x=Z):(ee=Y,x=ce),x.reverse(),U=k;U--;x.push(0));x.reverse()}else for(J=(L=(k=Z.length)<(U=ce.length))?k:U,k=U=0;U<J;U++)if(Z[U]!=ce[U]){L=Z[U]<ce[U];break}if(L&&(x=Z,Z=ce,ce=x,P.s=-P.s),U=(J=ce.length)-(H=Z.length),U>0)for(;U--;Z[H++]=0);for(U=a-1;J>k;){if(Z[--J]<ce[J]){for(H=J;H&&!Z[--H];Z[H]=U);--Z[H],Z[J]+=a}Z[J]-=ce[J]}for(;Z[0]==0;Z.splice(0,1),--ee);return Z[0]?de(P,Z,ee):(P.s=w==3?-1:1,P.c=[P.e=0],P)},Q.modulo=Q.mod=function(P,U){var H,J,x=this;return P=new W(P,U),!x.c||!P.s||P.c&&!P.c[0]?new W(NaN):!P.c||x.c&&!x.c[0]?new W(x):(N==9?(J=P.s,P.s=1,H=M(x,P,0,3),P.s=J,H.s*=J):H=M(x,P,0,N),P=x.minus(H.times(P)),!P.c[0]&&N==1&&(P.s=x.s),P)},Q.multipliedBy=Q.times=function(P,U){var H,J,x,L,K,k,Y,ee,Z,ce,ge,be,Ke,Te,je,Je=this,ze=Je.c,Ve=(P=new W(P,U)).c;if(!ze||!Ve||!ze[0]||!Ve[0])return!Je.s||!P.s||ze&&!ze[0]&&!Ve||Ve&&!Ve[0]&&!ze?P.c=P.e=P.s=null:(P.s*=Je.s,!ze||!Ve?P.c=P.e=null:(P.c=[0],P.e=0)),P;for(J=g(Je.e/c)+g(P.e/c),P.s*=Je.s,Y=ze.length,ce=Ve.length,Y<ce&&(Ke=ze,ze=Ve,Ve=Ke,x=Y,Y=ce,ce=x),x=Y+ce,Ke=[];x--;Ke.push(0));for(Te=a,je=h,x=ce;--x>=0;){for(H=0,ge=Ve[x]%je,be=Ve[x]/je|0,K=Y,L=x+K;L>x;)ee=ze[--K]%je,Z=ze[K]/je|0,k=be*ee+Z*ge,ee=ge*ee+k%je*je+Ke[L]+H,H=(ee/Te|0)+(k/je|0)+be*Z,Ke[L--]=ee%Te;Ke[L]=H}return H?++J:Ke.splice(0,1),de(P,Ke,J)},Q.negated=function(){var P=new W(this);return P.s=-P.s||null,P},Q.plus=function(P,U){var H,J=this,x=J.s;if(P=new W(P,U),U=P.s,!x||!U)return new W(NaN);if(x!=U)return P.s=-U,J.minus(P);var L=J.e/c,K=P.e/c,k=J.c,Y=P.c;if(!L||!K){if(!k||!Y)return new W(x/0);if(!k[0]||!Y[0])return Y[0]?P:new W(k[0]?J:x*0)}if(L=g(L),K=g(K),k=k.slice(),x=L-K){for(x>0?(K=L,H=Y):(x=-x,H=k),H.reverse();x--;H.push(0));H.reverse()}for(x=k.length,U=Y.length,x-U<0&&(H=Y,Y=k,k=H,U=x),x=0;U;)x=(k[--U]=k[U]+Y[U]+x)/a|0,k[U]=a===k[U]?0:k[U]%a;return x&&(k=[x].concat(k),++K),de(P,k,K)},Q.precision=Q.sd=function(P,U){var H,J,x,L=this;if(P!=null&&P!==!!P)return _(P,1,d),U==null?U=w:_(U,0,8),pe(new W(L),P,U);if(!(H=L.c))return null;if(x=H.length-1,J=x*c+1,x=H[x]){for(;x%10==0;x/=10,J--);for(x=H[0];x>=10;x/=10,J++);}return P&&L.e+1>J&&(J=L.e+1),J},Q.shiftedBy=function(P){return _(P,-f,f),this.times("1e"+P)},Q.squareRoot=Q.sqrt=function(){var P,U,H,J,x,L=this,K=L.c,k=L.s,Y=L.e,ee=b+4,Z=new W("0.5");if(k!==1||!K||!K[0])return new W(!k||k<0&&(!K||K[0])?NaN:K?L:1/0);if(k=Math.sqrt(+_e(L)),k==0||k==1/0?(U=m(K),(U.length+Y)%2==0&&(U+="0"),k=Math.sqrt(+U),Y=g((Y+1)/2)-(Y<0||Y%2),k==1/0?U="5e"+Y:(U=k.toExponential(),U=U.slice(0,U.indexOf("e")+1)+Y),H=new W(U)):H=new W(k+""),H.c[0]){for(Y=H.e,k=Y+ee,k<3&&(k=0);;)if(x=H,H=Z.times(x.plus(M(L,x,ee,1))),m(x.c).slice(0,k)===(U=m(H.c)).slice(0,k))if(H.e<Y&&--k,U=U.slice(k-3,k+1),U=="9999"||!J&&U=="4999"){if(!J&&(pe(x,x.e+b+2,0),x.times(x).eq(L))){H=x;break}ee+=4,k+=4,J=1}else{(!+U||!+U.slice(1)&&U.charAt(0)=="5")&&(pe(H,H.e+b+2,1),P=!H.times(H).eq(L));break}}return pe(H,H.e+b+1,w,P)},Q.toExponential=function(P,U){return P!=null&&(_(P,0,d),P++),ne(this,P,U,1)},Q.toFixed=function(P,U){return P!=null&&(_(P,0,d),P=P+this.e+1),ne(this,P,U)},Q.toFormat=function(P,U,H){var J,x=this;if(H==null)P!=null&&U&&typeof U=="object"?(H=U,U=null):P&&typeof P=="object"?(H=P,P=U=null):H=D;else if(typeof H!="object")throw Error(s+"Argument not an object: "+H);if(J=x.toFixed(P,U),x.c){var L,K=J.split("."),k=+H.groupSize,Y=+H.secondaryGroupSize,ee=H.groupSeparator||"",Z=K[0],ce=K[1],ge=x.s<0,be=ge?Z.slice(1):Z,Ke=be.length;if(Y&&(L=k,k=Y,Y=L,Ke-=L),k>0&&Ke>0){for(L=Ke%k||k,Z=be.substr(0,L);L<Ke;L+=k)Z+=ee+be.substr(L,k);Y>0&&(Z+=ee+be.slice(L)),ge&&(Z="-"+Z)}J=ce?Z+(H.decimalSeparator||"")+((Y=+H.fractionGroupSize)?ce.replace(new RegExp("\\d{"+Y+"}\\B","g"),"$&"+(H.fractionGroupSeparator||"")):ce):Z}return(H.prefix||"")+J+(H.suffix||"")},Q.toFraction=function(P){var U,H,J,x,L,K,k,Y,ee,Z,ce,ge,be=this,Ke=be.c;if(P!=null&&(k=new W(P),!k.isInteger()&&(k.c||k.s!==1)||k.lt(O)))throw Error(s+"Argument "+(k.isInteger()?"out of range: ":"not an integer: ")+_e(k));if(!Ke)return new W(be);for(U=new W(O),ee=H=new W(O),J=Y=new W(O),ge=m(Ke),L=U.e=ge.length-be.e-1,U.c[0]=l[(K=L%c)<0?c+K:K],P=!P||k.comparedTo(U)>0?L>0?U:ee:k,K=G,G=1/0,k=new W(ge),Y.c[0]=0;Z=M(k,U,0,1),x=H.plus(Z.times(J)),x.comparedTo(P)!=1;)H=J,J=x,ee=Y.plus(Z.times(x=ee)),Y=x,U=k.minus(Z.times(x=U)),k=x;return x=M(P.minus(H),J,0,1),Y=Y.plus(x.times(ee)),H=H.plus(x.times(J)),Y.s=ee.s=be.s,L=L*2,ce=M(ee,J,L,w).minus(be).abs().comparedTo(M(Y,H,L,w).minus(be).abs())<1?[ee,J]:[Y,H],G=K,ce},Q.toNumber=function(){return+_e(this)},Q.toPrecision=function(P,U){return P!=null&&_(P,1,d),ne(this,P,U,2)},Q.toString=function(P){var U,H=this,J=H.s,x=H.e;return x===null?J?(U="Infinity",J<0&&(U="-"+U)):U="NaN":(P==null?U=x<=S||x>=C?q(m(H.c),x):z(m(H.c),x,"0"):P===10?(H=pe(new W(H),b+x+1,w),U=z(m(H.c),H.e,"0")):(_(P,2,ae.length,"Base"),U=$(z(m(H.c),x,"0"),10,P,J,!0)),J<0&&H.c[0]&&(U="-"+U)),U},Q.valueOf=Q.toJSON=function(){return _e(this)},Q._isBigNumber=!0,V!=null&&W.set(V),W}function g(V){var M=V|0;return V>0||V===M?M:M-1}function m(V){for(var M,$,X=1,Q=V.length,O=V[0]+"";X<Q;){for(M=V[X++]+"",$=c-M.length;$--;M="0"+M);O+=M}for(Q=O.length;O.charCodeAt(--Q)===48;);return O.slice(0,Q+1||1)}function E(V,M){var $,X,Q=V.c,O=M.c,b=V.s,w=M.s,S=V.e,C=M.e;if(!b||!w)return null;if($=Q&&!Q[0],X=O&&!O[0],$||X)return $?X?0:-w:b;if(b!=w)return b;if($=b<0,X=S==C,!Q||!O)return X?0:!Q^$?1:-1;if(!X)return S>C^$?1:-1;for(w=(S=Q.length)<(C=O.length)?S:C,b=0;b<w;b++)if(Q[b]!=O[b])return Q[b]>O[b]^$?1:-1;return S==C?0:S>C^$?1:-1}function _(V,M,$,X){if(V<M||V>$||V!==n(V))throw Error(s+(X||"Argument")+(typeof V=="number"?V<M||V>$?" out of range: ":" not an integer: ":" not a primitive number: ")+String(V))}function T(V){var M=V.c.length-1;return g(V.e/c)==M&&V.c[M]%2!=0}function q(V,M){return(V.length>1?V.charAt(0)+"."+V.slice(1):V)+(M<0?"e":"e+")+M}function z(V,M,$){var X,Q;if(M<0){for(Q=$+".";++M;Q+=$);V=Q+V}else if(X=V.length,++M>X){for(Q=$,M-=X;--M;Q+=$);V+=Q}else M<X&&(V=V.slice(0,M)+"."+V.slice(M));return V}e=y(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof z2!="undefined"&&z2.exports?z2.exports=e:(r||(r=typeof self!="undefined"&&self?self:window),r.BigNumber=e)})(d0e)});var KR=p((y0e,g0e)=>{u();"use strict";var fut=Math.exp;y0e=g0e.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,i=0,n=0,s=0,o,a={};function c(f,l){return 1-fut(-(f-l)/e)}return a.push=function(l,h){if(o){let d=c(l,o),y=h-t,g=d*y;t=d*h+(1-d)*t,i=(1-d)*(i+y*g),n=Math.sqrt(i),s=t+d*y}else t=h;o=l},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return n},a.forecast=function(){return s},a}});var w0e=p((QOt,v0e)=>{u();"use strict";var{EventEmitter:hut}=br(),{BigNumber:H2}=p0e(),b0e=KR(),dut=vR(),m0e=class extends hut{constructor(e,t){super();this._options=t,this._queue=[],this._stats={dataReceived:H2(0),dataSent:H2(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=H2(0),this._movingAverages[s]={};for(let o=0;o<i.length;o++){let a=i[o];(this._movingAverages[s][a]=b0e(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,t=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(t);for(let s of n){i.movingAverages[s]={};for(let o of Object.keys(t[s]))i.movingAverages[s][o]=t[s][o].movingAverage()}return i}push(e,t){this._queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=dut(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=n/(t||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let f=0;f<c.length;f++){let l=c[f],h=a[l];h||(h=a[l]=b0e(l)),h.push(i,o)}}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,t)?n=this._stats[t]:n=this._stats[t]=H2(0),this._stats[t]=n.plus(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};v0e.exports=m0e});var S0e=p((JOt,E0e)=>{u();"use strict";var put=mr(),{pipe:yut}=Gr(),{tap:_0e}=jd(),gut=h0e(),{METRICS:but}=C2(),jR=w0e(),VR=["dataReceived","dataSent"],mut={in:"dataReceived",out:"dataSent"},$2=class{constructor(e){this._options=put(but,e),this._globalStats=new jR(VR,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=gut(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=e.connectionManager,this._connectionManager.on("peer:disconnect",t=>{this.onPeerDisconnected(t.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(e){let t=e.toB58String();return this._peerStats.get(t)||this._oldPeers.get(t)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let t=e.toB58String(),i=this._peerStats.get(t);i&&(i.stop(),this._peerStats.delete(t),this._oldPeers.set(t,i))}_onMessage({remotePeer:e,protocol:t,direction:i,dataLength:n}){if(!this._running)return;let s=mut[i],o=this.forPeer(e);if(o||(o=new jR(VR,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,n),this._globalStats.push(s,n),t){let a=this.forProtocol(t);a||(a=new jR(VR,this._options),this._protocolStats.set(t,a)),a.push(s,n)}}updatePlaceholder(e,t){if(!this._running)return;let i=this.forPeer(e),n=t.toB58String(),s=this.forPeer(t),o=i;s&&(o=$2.mergeStats(s,o),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,o),o.start()}trackStream({stream:e,remotePeer:t,protocol:i}){let n=this,s=e.source;e.source=_0e(a=>n._onMessage({remotePeer:t,protocol:i,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>yut(a,_0e(c=>n._onMessage({remotePeer:t,protocol:i,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,t){return e.stop(),t.stop(),e._queue=[...e._queue,...t._queue],e}};E0e.exports=$2});var zR=p((ZOt,x0e)=>{u();"use strict";var{Buffer:Do}=pt(),A0e=Symbol.for("BufferList");function lr(r){if(!(this instanceof lr))return new lr(r);lr._init.call(this,r)}lr._init=function(e){Object.defineProperty(this,A0e,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};lr.prototype._new=function(e){return new lr(e)};lr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};lr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};lr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};lr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};lr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Do.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,f=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Do.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,f),f+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=Do.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-l;if(c>d)this._bufs[h].copy(e,f,l),f+=d;else{this._bufs[h].copy(e,f,l,l+c),f+=d;break}c-=d,l&&(l=0)}return e.length>f?e.slice(0,f):e};lr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};lr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};lr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};lr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};lr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Do.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Do.from(e));return this};lr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};lr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=Do.from([r]):typeof r=="string"?r=Do.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=Do.from(r.buffer,r.byteOffset,r.byteLength):Do.isBuffer(r)||(r=Do.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};lr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?lr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:lr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();lr.prototype._isBufferList=function(e){return e instanceof lr||lr.isBufferList(e)};lr.isBufferList=function(e){return e!=null&&e[A0e]};x0e.exports=lr});var G2=p($f=>{u();"use strict";var I0e=zR(),T0e=To(),vut=Gr(),wut=ue(),_ut=ct(),Eut=xd(),R0e=_ut(`
`);$f.encode=r=>T0e.encode.single(new I0e([r,R0e]));$f.write=(r,e)=>r.push($f.encode(e));$f.writeAll=(r,e)=>{r.push(e.reduce((t,i)=>t.append($f.encode(i)),new I0e))};$f.read=async r=>{let e=1,t={[Symbol.asyncIterator](){return this},next:()=>r.next(e)},i=s=>{e=s},n=await vut(t,T0e.decode({onLength:i}),Eut);if(n.get(n.length-1)!==R0e[0])throw wut(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return n.shallowSlice(0,-1)}});var C0e=p((tqt,P0e)=>{u();"use strict";var Dp=me()("mss:select"),Sut=ue(),Mp=G2(),Aut=Cp();P0e.exports=async(r,e,t)=>{e=Array.isArray(e)?[...e]:[e];let{reader:i,writer:n,rest:s,stream:o}=Aut(r),a=e.shift();t?(Dp('select: write ["%s", "%s"]',t,a),Mp.writeAll(n,[t,a])):(Dp('select: write "%s"',a),Mp.write(n,a));let c=(await Mp.read(i)).toString();if(Dp('select: read "%s"',c),c===t&&(c=(await Mp.read(i)).toString(),Dp('select: read "%s"',c)),c===a)return s(),{stream:o,protocol:a};for(let f of e){Dp('select: write "%s"',f),Mp.write(n,f);let l=(await Mp.read(i)).toString();if(Dp('select: read "%s" for "%s"',l,f),l===f)return s(),{stream:o,protocol:f}}throw s(),Sut(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var HR=p(O0e=>{u();"use strict";O0e.PROTOCOL_ID="/multistream/1.0.0"});var k0e=p((iqt,q0e)=>{u();"use strict";var Pb=me()("mss:handle"),xut=zR(),Lp=G2(),Iut=Cp(),{PROTOCOL_ID:$R}=HR();q0e.exports=async(r,e)=>{e=Array.isArray(e)?e:[e];let{writer:t,reader:i,rest:n,stream:s}=Iut(r);for(;;){let o=(await Lp.read(i)).toString();if(Pb('read "%s"',o),o===$R){Pb('respond with "%s" for "%s"',$R,o),Lp.write(t,$R);continue}if(e.includes(o))return Lp.write(t,o),Pb('respond with "%s" for "%s"',o,o),n(),{stream:s,protocol:o};if(o==="ls"){Lp.write(t,new xut(e.map(a=>Lp.encode(a)))),Pb('respond with "%s" for %s',e,o);continue}Lp.write(t,"na"),Pb('respond with "na" for "%s"',o)}}});var D0e=p((nqt,N0e)=>{u();"use strict";var Tut=A2(),Rut=me()("it-multistream-select:ls"),B0e=G2(),Put=Cp(),Cut=To(),Out=Gr();N0e.exports=async r=>{let{reader:e,writer:t,rest:i,stream:n}=Put(r);Rut('write "ls"'),B0e.write(t,"ls"),i();let s=await B0e.read(e),o=Tut([s]),a=[];return await Out(o,Cut.decode(),async c=>{for await(let f of c)a.push(f.shallowSlice(0,-1).toString())}),{stream:n,protocols:a}}});var F0e=p(W2=>{u();"use strict";var M0e=C0e(),qut=k0e(),kut=D0e(),{PROTOCOL_ID:GR}=HR();W2.PROTOCOL_ID=GR;var WR=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;let{stream:e}=await M0e(this._stream,GR);this._stream=e,this._shaken=!0}},L0e=class extends WR{select(e){return M0e(this._stream,e,this._shaken?null:GR)}async ls(){await this._handshake();let{stream:e,protocols:t}=await kut(this._stream);return this._stream=e,t}};W2.Dialer=L0e;var U0e=class extends WR{handle(e){return qut(this._stream,e)}};W2.Listener=U0e});var j0e=p((oqt,K0e)=>{u();"use strict";var But={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};K0e.exports=But});var W0e=p((aqt,G0e)=>{u();"use strict";var V0e=rt(),{Multiaddr:Nut}=et(),cs=ue(),{OPEN:Dut,CLOSING:z0e,CLOSED:YR}=j0e(),H0e=Symbol.for("@libp2p/interface-connection/connection"),$0e=class{constructor({localAddr:e,remoteAddr:t,localPeer:i,remotePeer:n,newStream:s,close:o,getStreams:a,stat:c}){Mut(e,i,n,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=t,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:Dut},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[H0e](){return!0}static isConnection(e){return Boolean(e&&e[H0e])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===z0e)throw cs(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===YR)throw cs(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:t,protocol:i}=await this._newStream(e);return this.addStream(t,{protocol:i}),{stream:t,protocol:i}}addStream(e,{protocol:t,metadata:i={}}){this.registry.set(e.id,{protocol:t,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==YR){if(this._closing)return this._closing;this.stat.status=z0e,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=YR}}};G0e.exports=$0e;function Mut(r,e,t,i,n,s,o){if(r&&!Nut.isMultiaddr(r))throw cs(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!V0e.isPeerId(e))throw cs(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!V0e.isPeerId(t))throw cs(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw cs(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw cs(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw cs(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw cs(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw cs(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw cs(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw cs(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw cs(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var X0e=p(Y0e=>{u();"use strict";Y0e.Connection=W0e()});var J0e=p((uqt,Q0e)=>{u();"use strict";function Lut(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}else return Array.from(r)}Q0e.exports=function(e){var t=void 0,i=void 0;function n(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');i=a}function s(a){Object.keys(a).forEach(function(c){var f=a[c];if(typeof f!="function")throw new Error('Trap "'+c+": "+f+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+f+'" is not a valid trap')}),t=a}n(function(){}),e&&n(e),s(Reflect);var o=new Proxy({},{get:function(c,f){return function(){for(var l=arguments.length,h=Array(l),d=0;d<l;d++)h[d]=arguments[d];return t[f].apply(null,[i].concat(Lut(h.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return t},proxy:new Proxy(i,o)}}});var iye=p((lqt,rye)=>{u();"use strict";var Z0e=me(),Ei=Object.assign(Z0e("libp2p:upgrader"),{error:Z0e("libp2p:upgrader:err")}),Gf=ue(),Up=F0e(),{Connection:Uut}=X0e(),Fut=rt(),{pipe:Kut}=Gr(),eye=J0e(),{codes:Fp}=di(),tye=class{constructor({localPeer:e,metrics:t,cryptos:i=new Map,muxers:n=new Map,onConnectionEnd:s=()=>{},onConnection:o=()=>{}}){this.localPeer=e,this.metrics=t,this.cryptos=i,this.muxers=n,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=s}async upgradeInbound(e){let t,i,n,s,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=eye());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}Ei("Starting the inbound connection upgrade");let f=e;this.protector&&(f=await this.protector.protect(e));try{({conn:t,remotePeer:i,protocol:o}=await this._encryptInbound(this.localPeer,f,this.cryptos)),this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(t,this.muxers):n=t}catch(l){throw Ei.error("Failed to upgrade inbound connection",l),await e.close(l),l}return this.metrics&&(this.metrics.updatePlaceholder(c,i),a(i)),Ei("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let t=e.remoteAddr.getPeerId();if(!t)throw Gf(new Error("outbound connection must have a peer id"),Fp.ERR_INVALID_MULTIADDR);let i=Fut.createFromB58String(t),n,s,o,a,c,f,l;if(this.metrics){({setTarget:f,proxy:l}=eye());let d=(Math.random()*1e9).toString(36)+Date.now();f({toB58String:()=>d}),e=this.metrics.trackStream({stream:e,remotePeer:l})}Ei("Starting the outbound connection upgrade");let h=e;this.protector&&(h=await this.protector.protect(e));try{({conn:n,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,h,i,this.cryptos)),this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(n,this.muxers):o=n}catch(d){throw Ei.error("Failed to upgrade outbound connection",d),await e.close(d),d}return this.metrics&&(this.metrics.updatePlaceholder(l,s),f(s)),Ei("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:t,maConn:i,upgradedConn:n,Muxer:s,remotePeer:o}){let a,c,f;s&&(a=new s({onStream:async d=>{if(!f)return;let y=new Up.Listener(d);try{let{stream:g,protocol:m}=await y.handle(Array.from(this.protocols.keys()));Ei("%s: incoming stream opened on %s",t,m),this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:m}),f.addStream(d,{protocol:m}),this._onStream({connection:f,stream:{...d,...g},protocol:m})}catch(g){Ei.error(g)}},onStreamEnd:d=>{f.removeStream(d.id)}}),c=async d=>{Ei("%s: starting new stream on %s",t,d);let y=a.newStream(),g=new Up.Dialer(y);try{let{stream:m,protocol:E}=await g.select(d);return this.metrics&&this.metrics.trackStream({stream:m,remotePeer:o,protocol:E}),{stream:{...y,...m},protocol:E}}catch(m){throw Ei.error("could not create new stream",m),Gf(m,Fp.ERR_UNSUPPORTED_PROTOCOL)}},Kut(n,a,n).catch(Ei.error));let l=i.timeline;i.timeline=new Proxy(l,{set:(...d)=>(f&&d[1]==="close"&&d[2]&&!l.close&&(async()=>{try{f.stat.status==="open"&&await f.close()}catch(y){Ei.error(y)}finally{this.onConnectionEnd(f)}})(),Reflect.set(...d))}),i.timeline.upgraded=Date.now();let h=()=>{throw Gf(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return f=new Uut({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:t,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||h,getStreams:()=>a?a.streams:h(),close:async()=>{await i.close(),a&&a.streams.map(d=>d.abort())}}),this.onConnection(f),f}_onStream({connection:e,stream:t,protocol:i}){this.protocols.get(i)({connection:e,stream:t,protocol:i})}async _encryptInbound(e,t,i){let n=new Up.Listener(t),s=Array.from(i.keys());Ei("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await n.handle(s),c=i.get(a);if(Ei("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw Gf(o,Fp.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t,i,n){let s=new Up.Dialer(t),o=Array.from(n.keys());Ei("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),f=n.get(c);if(Ei("encrypting outbound connection to %j",i),!f)throw new Error(`no crypto module found for ${c}`);return{...await f.secureOutbound(e,a,i),protocol:c}}catch(a){throw Gf(a,Fp.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){let i=new Up.Dialer(e),n=Array.from(t.keys());Ei("outbound selecting muxer %s",n);try{let{stream:s,protocol:o}=await i.select(n);Ei("%s selected as muxer protocol",o);let a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw Gf(s,Fp.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){let i=new Up.Listener(e),n=Array.from(t.keys());Ei("inbound handling muxers %s",n);try{let{stream:s,protocol:o}=await i.handle(n),a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw Gf(s,Fp.ERR_MUXER_UNAVAILABLE)}}};rye.exports=tye});var Cb=p((fqt,aye)=>{u();"use strict";var XR=ue(),nye=rt(),{codes:{ERR_INVALID_PARAMETERS:sye}}=di(),jut=r=>r,oye=class{constructor({peerStore:e,eventName:t,eventProperty:i,eventTransformer:n=jut}){this._ps=e,this.eventName=t,this.eventProperty=i,this.eventTransformer=n,this.data=new Map}set(e,t){throw XR(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(e,t,{emit:i=!0}={}){let n=e.toB58String();this.data.set(n,t),i&&this._emit(e,t)}_emit(e,t){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(t)})}get(e){if(!nye.isPeerId(e))throw XR(new Error("peerId must be an instance of peer-id"),sye);let t=this.data.get(e.toB58String());return t?[...t]:void 0}delete(e){if(!nye.isPeerId(e))throw XR(new Error("peerId must be an instance of peer-id"),sye);return this.data.delete(e.toB58String())?(this._emit(e,[]),!0):!1}};aye.exports=oye});var fye=p((hqt,lye)=>{u();"use strict";var cye=me(),Mo=Object.assign(cye("libp2p:peer-store:address-book"),{error:cye("libp2p:peer-store:address-book:err")}),Kp=ue(),{Multiaddr:Vut}=et(),Y2=rt(),zut=Cb(),Hut=k2(),{codes:{ERR_INVALID_PARAMETERS:jp}}=di(),$ut=pb(),uye=class extends zut{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:t=>t.addresses?t.addresses.map(i=>i.multiaddr):[]});this.data=new Map}consumePeerRecord(e){let t;try{t=Hut.createFromProtobuf(e.payload)}catch(c){return Mo.error("invalid peer record received"),!1}if(!t.peerId.equals(e.peerId))return Mo("signing key does not match PeerId in the PeerRecord"),!1;if(!t.multiaddrs||!t.multiaddrs.length)return!1;let i=t.peerId,n=i.toB58String(),o=(this.data.get(n)||{record:void 0}).record;if(o&&o.seqNumber>=t.seqNumber)return!1;let a=this._toAddresses(t.multiaddrs,!0);return this._setData(i,{addresses:a,record:{raw:e.marshal(),seqNumber:t.seqNumber}}),Mo(`stored provided peer record for ${n}`),!0}getRawEnvelope(e){let t=this.data.get(e.toB58String());if(!(!t||!t.record||!t.record.raw))return t.record.raw}getPeerRecord(e){let t=this.getRawEnvelope(e);if(!!t)return $ut.createFromProtobuf(t)}set(e,t){if(!Y2.isPeerId(e))throw Mo.error("peerId must be an instance of peer-id to store data"),Kp(new Error("peerId must be an instance of peer-id"),jp);let i=this._toAddresses(t);if(!i.length)return this;let n=e.toB58String(),s=this.data.get(n);return s&&s.addresses&&s.addresses.length===i.length&&s.addresses.filter(a=>i.some(c=>a.multiaddr.equals(c.multiaddr))).length===s.addresses.length?(Mo(`the addresses provided to store are equal to the already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),Mo(`stored provided multiaddrs for ${n}`),s||this._ps.emit("peer",e),this)}add(e,t){if(!Y2.isPeerId(e))throw Mo.error("peerId must be an instance of peer-id to store data"),Kp(new Error("peerId must be an instance of peer-id"),jp);let i=this._toAddresses(t),n=e.toB58String();if(!i.length)return this;let s=this.data.get(n);return s&&s.addresses&&(s.addresses.forEach(o=>{i.find(a=>a.multiaddr.equals(o.multiaddr))||i.push(o)}),s.addresses.length===i.length)?(Mo(`the addresses provided to store are already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),Mo(`added provided multiaddrs for ${n}`),s&&s.addresses||this._ps.emit("peer",e),this)}get(e){if(!Y2.isPeerId(e))throw Kp(new Error("peerId must be an instance of peer-id"),jp);let t=this.data.get(e.toB58String());return t&&t.addresses?[...t.addresses]:void 0}_toAddresses(e,t=!1){if(!e)throw Mo.error("multiaddrs must be provided to store data"),Kp(new Error("multiaddrs must be provided"),jp);let i=[];return e.forEach(n=>{if(!Vut.isMultiaddr(n))throw Mo.error(`multiaddr ${n} must be an instance of multiaddr`),Kp(new Error(`multiaddr ${n} must be an instance of multiaddr`),jp);i.find(s=>s.multiaddr.equals(n))||i.push({multiaddr:n,isCertified:t})}),i}getMultiaddrsForPeer(e,t=i=>i){if(!Y2.isPeerId(e))throw Kp(new Error("peerId must be an instance of peer-id"),jp);let i=this.data.get(e.toB58String());if(!(!i||!i.addresses))return t(i.addresses||[]).map(n=>{let s=n.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};lye.exports=uye});var vye=p((dqt,mye)=>{u();"use strict";var hye=me(),dye=Object.assign(hye("libp2p:peer-store:key-book"),{error:hye("libp2p:peer-store:key-book:err")}),pye=ue(),yye=rt(),Gut=Cb(),{codes:{ERR_INVALID_PARAMETERS:gye}}=di(),bye=class extends Gut{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:t=>t.pubKey});this.data=new Map}set(e,t){if(!yye.isPeerId(e))throw dye.error("peerId must be an instance of peer-id to store data"),pye(new Error("peerId must be an instance of peer-id"),gye);let i=e.toB58String();return!this.data.get(i)&&t&&(e.pubKey=t,this._setData(e,e),dye(`stored provided public key for ${i}`)),this}get(e){if(!yye.isPeerId(e))throw pye(new Error("peerId must be an instance of peer-id"),gye);let t=this.data.get(e.toB58String());return t?t.pubKey:void 0}};mye.exports=bye});var Sye=p((pqt,Eye)=>{u();"use strict";var wye=me(),QR=Object.assign(wye("libp2p:peer-store:proto-book"),{error:wye("libp2p:peer-store:proto-book:err")}),Vp=ue(),Wut=fi(),Ob=rt(),Yut=Cb(),{codes:{ERR_INVALID_PARAMETERS:zp}}=di(),_ye=class extends Yut{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(e,t,i){if(!Ob.isPeerId(e))throw QR.error("peerId must be an instance of peer-id to store data"),Vp(new Error("peerId must be an instance of peer-id"),zp);if(typeof t!="string"||!(i instanceof Uint8Array))throw QR.error("valid key and value must be provided to store data"),Vp(new Error("valid key and value must be provided"),zp);return this._setValue(e,t,i),this}_setValue(e,t,i,{emit:n=!0}={}){let s=e.toB58String(),o=this.data.get(s)||new Map,a=o.get(t);if(a&&Wut(i,a)){QR(`the metadata provided to store is equal to the already stored for ${s} on ${t}`);return}o.set(t,i),this.data.set(s,o),n&&this._emit(e,t)}get(e){if(!Ob.isPeerId(e))throw Vp(new Error("peerId must be an instance of peer-id"),zp);return this.data.get(e.toB58String())}getValue(e,t){if(!Ob.isPeerId(e))throw Vp(new Error("peerId must be an instance of peer-id"),zp);let i=this.data.get(e.toB58String());return i&&i.get(t)}delete(e){if(!Ob.isPeerId(e))throw Vp(new Error("peerId must be an instance of peer-id"),zp);return this.data.delete(e.toB58String())?(this._emit(e),!0):!1}deleteValue(e,t){if(!Ob.isPeerId(e))throw Vp(new Error("peerId must be an instance of peer-id"),zp);let i=this.data.get(e.toB58String());return!i||!i.delete(t)?!1:(this._emit(e,t),!0)}};Eye.exports=_ye});var Tye=p((yqt,Iye)=>{u();"use strict";var Aye=me(),Lo=Object.assign(Aye("libp2p:peer-store:proto-book"),{error:Aye("libp2p:peer-store:proto-book:err")}),Hp=ue(),JR=rt(),Xut=Cb(),{codes:{ERR_INVALID_PARAMETERS:$p}}=di(),xye=class extends Xut{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:t=>Array.from(t)});this.data=new Map}set(e,t){if(!JR.isPeerId(e))throw Lo.error("peerId must be an instance of peer-id to store data"),Hp(new Error("peerId must be an instance of peer-id"),$p);if(!t)throw Lo.error("protocols must be provided to store data"),Hp(new Error("protocols must be provided"),$p);let i=e.toB58String(),n=this.data.get(i),s=new Set(t);return n&&((a,c)=>a.size===c.size&&[...a].every(f=>c.has(f)))(n,s)?(Lo(`the protocols provided to store are equal to the already stored for ${i}`),this):(this._setData(e,s),Lo(`stored provided protocols for ${i}`),this)}add(e,t){if(!JR.isPeerId(e))throw Lo.error("peerId must be an instance of peer-id to store data"),Hp(new Error("peerId must be an instance of peer-id"),$p);if(!t)throw Lo.error("protocols must be provided to store data"),Hp(new Error("protocols must be provided"),$p);let i=e.toB58String(),n=this.data.get(i)||new Set,s=new Set([...n,...t]);return n.size===s.size?(Lo(`the protocols provided to store are already stored for ${i}`),this):(this._setData(e,s),Lo(`added provided protocols for ${i}`),this)}remove(e,t){if(!JR.isPeerId(e))throw Lo.error("peerId must be an instance of peer-id to store data"),Hp(new Error("peerId must be an instance of peer-id"),$p);if(!t)throw Lo.error("protocols must be provided to store data"),Hp(new Error("protocols must be provided"),$p);let i=e.toB58String(),n=this.data.get(i);if(n){let s=new Set([...n].filter(o=>!t.includes(o)));if(n.size===s.size)return this;this._setData(e,s),Lo(`removed provided protocols for ${i}`)}return this}};Iye.exports=xye});var ZR=p((gqt,Cye)=>{u();"use strict";var Qut=ue(),{EventEmitter:Jut}=br(),Rye=rt(),Zut=fye(),elt=vye(),tlt=Sye(),rlt=Tye(),{codes:{ERR_INVALID_PARAMETERS:ilt}}=di(),Pye=class extends Jut{constructor({peerId:e}){super();this._peerId=e,this.addressBook=new Zut(this),this.keyBook=new elt(this),this.metadataBook=new tlt(this),this.protoBook=new rlt(this)}start(){}stop(){}get peers(){let e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());let t=new Map;return e.forEach(i=>{t.set(i,this.get(Rye.createFromB58String(i)))}),t}delete(e){let t=this.addressBook.delete(e),i=this.keyBook.delete(e),n=this.protoBook.delete(e),s=this.metadataBook.delete(e);return t||i||n||s}get(e){if(!Rye.isPeerId(e))throw Qut(new Error("peerId must be an instance of peer-id"),ilt);let t=this.keyBook.data.get(e.toB58String()),i=this.addressBook.get(e),n=this.metadataBook.get(e),s=this.protoBook.get(e);if(!(!t&&!i&&!n&&!s))return{id:t||e,addresses:i||[],protocols:s||[],metadata:n}}};Cye.exports=Pye});var qye=p((bqt,Oye)=>{u();"use strict";function nlt(r,e,t){let i=new r(e,t);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(o,a){a&&i.on(o,a),i._subscribeAdapter(o)}function s(o,a){a?i.removeListener(o,a):i.removeAllListeners(o),i.listenerCount(o)===0&&i._unsubscribeAdapter(o)}return i.subscribe=n,i.unsubscribe=s,i}Oye.exports=nlt});var kye=p((mqt,Gp)=>{u();"use strict";Gp.exports.NAMESPACE_COMMON="/peers/";Gp.exports.NAMESPACE_ADDRESS="/peers/addrs/";Gp.exports.NAMESPACE_KEYS="/peers/keys/";Gp.exports.NAMESPACE_METADATA="/peers/metadata/";Gp.exports.NAMESPACE_PROTOCOL="/peers/protos/"});var Nye=p((vqt,Bye)=>{u();"use strict";var ol=Pi(),Wp=ol.Reader,e8=ol.Writer,Zr=ol.util,Si=ol.roots["libp2p-address-book"]||(ol.roots["libp2p-address-book"]={});Si.Addresses=function(){function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.addrs=Zr.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,i){if(i||(i=e8.create()),t.addrs!=null&&t.addrs.length)for(var n=0;n<t.addrs.length;++n)Si.Addresses.Address.encode(t.addrs[n],i.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&Si.Addresses.CertifiedRecord.encode(t.certifiedRecord,i.uint32(18).fork()).ldelim(),i},r.decode=function(t,i){t instanceof Wp||(t=Wp.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Si.Addresses;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(Si.Addresses.Address.decode(t,t.uint32()));break;case 2:s.certifiedRecord=Si.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Si.Addresses)return t;var i=new Si.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var n=0;n<t.addrs.length;++n){if(typeof t.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[n]=Si.Addresses.Address.fromObject(t.addrs[n])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=Si.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addrs=[]),i.defaults&&(n.certifiedRecord=null),t.addrs&&t.addrs.length){n.addrs=[];for(var s=0;s<t.addrs.length;++s)n.addrs[s]=Si.Addresses.Address.toObject(t.addrs[s],i)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=Si.Addresses.CertifiedRecord.toObject(t.certifiedRecord,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,ol.util.toJSONOptions)},r.Address=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=Zr.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(i,n){return n||(n=e8.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},e.decode=function(i,n){i instanceof Wp||(i=Wp.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Si.Addresses.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Si.Addresses.Address)return i;var n=new Si.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Zr.base64.decode(i.multiaddr,n.multiaddr=Zr.newBuffer(Zr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=Zr.newBuffer(s.multiaddr))),s.isCertified=!1),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?Zr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,ol.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.seq=Zr.Long?Zr.Long.fromBits(0,0,!0):0,e.prototype.raw=Zr.newBuffer([]),e.encode=function(i,n){return n||(n=e8.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&n.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&n.uint32(18).bytes(i.raw),n},e.decode=function(i,n){i instanceof Wp||(i=Wp.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Si.Addresses.CertifiedRecord;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.seq=i.uint64();break;case 2:o.raw=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Si.Addresses.CertifiedRecord)return i;var n=new Si.Addresses.CertifiedRecord;return i.seq!=null&&(Zr.Long?(n.seq=Zr.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?n.seq=parseInt(i.seq,10):typeof i.seq=="number"?n.seq=i.seq:typeof i.seq=="object"&&(n.seq=new Zr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?Zr.base64.decode(i.raw,n.raw=Zr.newBuffer(Zr.base64.length(i.raw)),0):i.raw.length&&(n.raw=i.raw)),n},e.toObject=function(i,n){n||(n={});var s={};if(n.defaults){if(Zr.Long){var o=new Zr.Long(0,0,!0);s.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else s.seq=n.longs===String?"0":0;n.bytes===String?s.raw="":(s.raw=[],n.bytes!==Array&&(s.raw=Zr.newBuffer(s.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?s.seq=n.longs===String?String(i.seq):i.seq:s.seq=n.longs===String?Zr.Long.prototype.toString.call(i.seq):n.longs===Number?new Zr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(s.raw=n.bytes===String?Zr.base64.encode(i.raw,0,i.raw.length):n.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,ol.util.toJSONOptions)},e}(),r}();Bye.exports=Si});var Lye=p((wqt,Mye)=>{u();"use strict";var Yp=Pi(),Dye=Yp.Reader,slt=Yp.Writer,olt=Yp.util,qb=Yp.roots["libp2p-proto-book"]||(Yp.roots["libp2p-proto-book"]={});qb.Protocols=function(){function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocols=olt.emptyArray,r.encode=function(t,i){if(i||(i=slt.create()),t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(10).string(t.protocols[n]);return i},r.decode=function(t,i){t instanceof Dye||(t=Dye.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new qb.Protocols;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof qb.Protocols)return t;var i=new qb.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.protocols=[]),t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Yp.util.toJSONOptions)},r}();Mye.exports=qb});var zye=p((_qt,Vye)=>{u();"use strict";var Uye=me(),ji=Object.assign(Uye("libp2p:persistent-peer-store"),{error:Uye("libp2p:persistent-peer-store:err")}),{Key:X2}=Lt(),{Multiaddr:alt}=et(),t8=rt(),{base32:clt}=(en(),Zi),ult=ZR(),{NAMESPACE_ADDRESS:llt,NAMESPACE_COMMON:flt,NAMESPACE_KEYS:hlt,NAMESPACE_METADATA:dlt,NAMESPACE_PROTOCOL:plt}=kye(),{Addresses:Fye}=Nye(),{Protocols:Kye}=Lye(),jye=class extends ult{constructor({peerId:e,datastore:t,threshold:i=5}){super({peerId:e});this._datastore=t,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=i,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){ji("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(let e of this._datastore.query({prefix:flt}))await this._processDatastoreEntry(e);ji("PeerStore started")}async stop(){ji("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),ji("PeerStore stopped")}_addDirtyPeer({peerId:e}){let t=e.toB58String();ji("add dirty peer",t),this._dirtyPeers.add(t),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{ji.error("error committing data",i)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;let t=e.toB58String();ji("add dirty peer key",t),this._dirtyPeers.add(t),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{ji.error("error committing data",i)})}_addDirtyPeerMetadata({peerId:e,metadata:t}){let i=e.toB58String();ji("add dirty metadata peer",i),this._dirtyPeers.add(i);let n=this._dirtyMetadata.get(i)||new Set;n.add(t),this._dirtyMetadata.set(i,n),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(s=>{ji.error("error committing data",s)})}async _commitData(){let e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),ji("create batch commit");let t=this._datastore.batch();for(let i of e){let n=this.keyBook.data.get(i)||t8.createFromB58String(i);this._batchAddressBook(n,t),!n.hasInlinePublicKey()&&this._batchKeyBook(n,t),this._batchMetadataBook(n,t),this._batchProtoBook(n,t)}await t.commit(),ji("batch committed")}_batchAddressBook(e,t){let i=e.toString(),n=new X2(`${llt}${i}`),s=this.addressBook.data.get(e.toB58String());try{if(!s){t.delete(n);return}let o=Fye.encode({addrs:s.addresses.map(a=>({multiaddr:a.multiaddr.bytes,isCertified:a.isCertified})),certifiedRecord:s.record?{seq:s.record.seqNumber,raw:s.record.raw}:void 0}).finish();t.put(n,o)}catch(o){ji.error(o)}}_batchKeyBook(e,t){let i=e.toString(),n=new X2(`${hlt}${i}`);try{if(!e.pubKey){t.delete(n);return}let s=e.marshalPubKey();t.put(n,s)}catch(s){ji.error(s)}}_batchMetadataBook(e,t){let i=e.toString(),n=this._dirtyMetadata.get(e.toB58String())||[];try{n.forEach(s=>{let o=new X2(`${dlt}${i}/${s}`),a=this.metadataBook.getValue(e,s);a?t.put(o,a):t.delete(o)})}catch(s){ji.error(s)}}_batchProtoBook(e,t){let i=e.toString(),n=new X2(`${plt}${i}`),s=this.protoBook.get(e);try{if(!s){t.delete(n);return}let o=Kye.encode({protocols:s}).finish();t.put(n,o)}catch(o){ji.error(o)}}async _processDatastoreEntry({key:e,value:t}){try{let i=e.toString().split("/"),n=t8.createFromBytes(clt.decode(i[3])),s;switch(i[2]){case"addrs":s=Fye.decode(t),this.addressBook._setData(n,{addresses:s.addrs.map(o=>({multiaddr:new alt(o.multiaddr),isCertified:Boolean(o.isCertified)})),record:s.certifiedRecord?{raw:s.certifiedRecord.raw,seqNumber:s.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":s=await t8.createFromPubKey(t),this.keyBook._setData(s,s,{emit:!1});break;case"metadata":this.metadataBook._setValue(n,i[4],t,{emit:!1});break;case"protos":s=Kye.decode(t),this.protoBook._setData(n,new Set(s.protocols),{emit:!1});break;default:ji("invalid data persisted for: ",e.toString())}}catch(i){ji.error(i)}}};Vye.exports=jye});var Wye=p((Eqt,Gye)=>{u();"use strict";var Hye=me(),ylt=Object.assign(Hye("libp2p:registrar"),{error:Hye("libp2p:registrar:err")}),glt=ue(),{codes:{ERR_INVALID_PARAMETERS:blt}}=di(),mlt=G5(),$ye=class{constructor({peerStore:e,connectionManager:t}){this.peerStore=e,this.connectionManager=t,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!mlt.isTopology(e))throw ylt.error("topology must be an instance of interfaces/topology"),glt(new Error("topology must be an instance of interfaces/topology"),blt);let t=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(t,e),e.registrar=this,t}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,t]of this.topologies)t.disconnect(e.remotePeer)}};Gye.exports=$ye});var Qye=p((Sqt,Xye)=>{u();"use strict";var{Buffer:Uo}=pt(),Yye=Symbol.for("BufferList");function fr(r){if(!(this instanceof fr))return new fr(r);fr._init.call(this,r)}fr._init=function(e){Object.defineProperty(this,Yye,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};fr.prototype._new=function(e){return new fr(e)};fr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};fr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};fr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};fr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};fr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Uo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,f=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Uo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,f),f+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=Uo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-l;if(c>d)this._bufs[h].copy(e,f,l),f+=d;else{this._bufs[h].copy(e,f,l,l+c),f+=d;break}c-=d,l&&(l=0)}return e.length>f?e.slice(0,f):e};fr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};fr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};fr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};fr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};fr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Uo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Uo.from(e));return this};fr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};fr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=Uo.from([r]):typeof r=="string"?r=Uo.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=Uo.from(r.buffer,r.byteOffset,r.byteLength):Uo.isBuffer(r)||(r=Uo.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};fr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?fr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:fr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();fr.prototype._isBufferList=function(e){return e instanceof fr||fr.isBufferList(e)};fr.isBufferList=function(e){return e!=null&&e[Yye]};Xye.exports=fr});var Z2=p((Aqt,kb)=>{u();"use strict";var{Buffer:Q2}=pt(),J2=Qye();kb.exports=async function*(r){for await(let e of r)Q2.isBuffer(e)?yield e:J2.isBufferList(e)?yield e.slice():yield Q2.from(e)};kb.exports.toBuffer=kb.exports;kb.exports.toList=async function*(r){for await(let e of r)Q2.isBuffer(e)?yield new J2().append(e):J2.isBufferList(e)?yield e:yield new J2().append(Q2.from(e))}});var Zye=p((xqt,Jye)=>{u();"use strict";Jye.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32}});var ige=p((tE,rge)=>{u();"use strict";var ege=me(),vlt=Object.assign(ege("libp2p:ping"),{error:ege("libp2p:ping:err")}),wlt=ue(),_lt=Ea(),{pipe:tge}=Gr(),{toBuffer:Elt}=Z2(),{collect:Slt,take:Alt}=jd(),xlt=fi(),{PROTOCOL:eE,PING_LENGTH:Ilt}=Zye();async function Tlt(r,e){vlt("dialing %s to %s",eE,e.toB58String?e.toB58String():e);let t=await r.dial(e),{stream:i}=await t.newStream(eE),n=Date.now(),s=_lt.randomBytes(Ilt),[o]=await tge([s],i,c=>Alt(1,c),Elt,Slt),a=Date.now();if(!xlt(s,o))throw wlt(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return a-n}function Rlt(r){r.handle(eE,({stream:e})=>tge(e,e))}function Plt(r){r.unhandle(eE)}tE=rge.exports=Tlt;tE.mount=Rlt;tE.unmount=Plt});var oge=p((Iqt,sge)=>{u();"use strict";var Xp=Pi(),nge=Xp.Reader,Clt=Xp.Writer,Ar=Xp.util,Bb=Xp.roots["libp2p-identify"]||(Xp.roots["libp2p-identify"]={});Bb.Identify=function(){function r(e){if(this.listenAddrs=[],this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocolVersion="",r.prototype.agentVersion="",r.prototype.publicKey=Ar.newBuffer([]),r.prototype.listenAddrs=Ar.emptyArray,r.prototype.observedAddr=Ar.newBuffer([]),r.prototype.protocols=Ar.emptyArray,r.prototype.signedPeerRecord=Ar.newBuffer([]),r.encode=function(t,i){if(i||(i=Clt.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.listenAddrs!=null&&t.listenAddrs.length)for(var n=0;n<t.listenAddrs.length;++n)i.uint32(18).bytes(t.listenAddrs[n]);if(t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(26).string(t.protocols[n]);return t.observedAddr!=null&&Object.hasOwnProperty.call(t,"observedAddr")&&i.uint32(34).bytes(t.observedAddr),t.protocolVersion!=null&&Object.hasOwnProperty.call(t,"protocolVersion")&&i.uint32(42).string(t.protocolVersion),t.agentVersion!=null&&Object.hasOwnProperty.call(t,"agentVersion")&&i.uint32(50).string(t.agentVersion),t.signedPeerRecord!=null&&Object.hasOwnProperty.call(t,"signedPeerRecord")&&i.uint32(66).bytes(t.signedPeerRecord),i},r.decode=function(t,i){t instanceof nge||(t=nge.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Bb.Identify;t.pos<n;){var o=t.uint32();switch(o>>>3){case 5:s.protocolVersion=t.string();break;case 6:s.agentVersion=t.string();break;case 1:s.publicKey=t.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(t.bytes());break;case 4:s.observedAddr=t.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;case 8:s.signedPeerRecord=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Bb.Identify)return t;var i=new Bb.Identify;if(t.protocolVersion!=null&&(i.protocolVersion=String(t.protocolVersion)),t.agentVersion!=null&&(i.agentVersion=String(t.agentVersion)),t.publicKey!=null&&(typeof t.publicKey=="string"?Ar.base64.decode(t.publicKey,i.publicKey=Ar.newBuffer(Ar.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.listenAddrs){if(!Array.isArray(t.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<t.listenAddrs.length;++n)typeof t.listenAddrs[n]=="string"?Ar.base64.decode(t.listenAddrs[n],i.listenAddrs[n]=Ar.newBuffer(Ar.base64.length(t.listenAddrs[n])),0):t.listenAddrs[n].length&&(i.listenAddrs[n]=t.listenAddrs[n])}if(t.observedAddr!=null&&(typeof t.observedAddr=="string"?Ar.base64.decode(t.observedAddr,i.observedAddr=Ar.newBuffer(Ar.base64.length(t.observedAddr)),0):t.observedAddr.length&&(i.observedAddr=t.observedAddr)),t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return t.signedPeerRecord!=null&&(typeof t.signedPeerRecord=="string"?Ar.base64.decode(t.signedPeerRecord,i.signedPeerRecord=Ar.newBuffer(Ar.base64.length(t.signedPeerRecord)),0):t.signedPeerRecord.length&&(i.signedPeerRecord=t.signedPeerRecord)),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Ar.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=Ar.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=Ar.newBuffer(n.signedPeerRecord)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Ar.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.listenAddrs&&t.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<t.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?Ar.base64.encode(t.listenAddrs[s],0,t.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(t.listenAddrs[s]):t.listenAddrs[s]}if(t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return t.observedAddr!=null&&t.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?Ar.base64.encode(t.observedAddr,0,t.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(t.observedAddr):t.observedAddr),t.protocolVersion!=null&&t.hasOwnProperty("protocolVersion")&&(n.protocolVersion=t.protocolVersion),t.agentVersion!=null&&t.hasOwnProperty("agentVersion")&&(n.agentVersion=t.agentVersion),t.signedPeerRecord!=null&&t.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?Ar.base64.encode(t.signedPeerRecord,0,t.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(t.signedPeerRecord):t.signedPeerRecord),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Xp.util.toJSONOptions)},r}();sge.exports=Bb});var yge=p((Tqt,pge)=>{u();"use strict";var age=me(),Ka=Object.assign(age("libp2p:identify"),{error:age("libp2p:identify:err")}),r8=ue(),rE=To(),{pipe:iE}=Gr(),{collect:cge,take:uge,consume:lge}=jd(),Qp=ct(),Olt=rt(),{Multiaddr:i8}=et(),{toBuffer:fge}=Z2(),Nb=oge(),hge=pb(),dge=k2(),{MULTICODEC_IDENTIFY:n8,MULTICODEC_IDENTIFY_PUSH:nE,PROTOCOL_VERSION:qlt}=aR(),{codes:s8}=di(),Jp=class{constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this),this._host={protocolVersion:qlt,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",Qp(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",Qp(this._host.protocolVersion)),this.connectionManager.on("peer:connect",t=>{this.identify(t).catch(Ka.error)}),this.peerStore.on("change:multiaddrs",({peerId:t})=>{t.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:t})=>{t.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){let t=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(o=>o.bytes),n=this.peerStore.protoBook.get(this.peerId)||[],s=e.map(async o=>{try{let{stream:a}=await o.newStream(nE);await iE([Nb.Identify.encode({listenAddrs:i,signedPeerRecord:t,protocols:n}).finish()],rE.encode(),a,lge)}catch(a){Ka.error("could not push identify update to peer",a)}});return Promise.all(s)}pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],t;for(let i of this.peerStore.peers.values())i.protocols.includes(nE)&&(t=this.connectionManager.get(i.id))&&e.push(t);this.push(e)}async identify(e){let{stream:t}=await e.newStream(n8),[i]=await iE([],t,rE.decode(),uge(1),fge,cge);if(!i)throw r8(new Error("No data could be retrieved"),s8.ERR_CONNECTION_ENDED);let n;try{n=Nb.Identify.decode(i)}catch(d){throw r8(d,s8.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:f}=n,l=await Olt.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw r8(new Error("identified peer does not match the expected peer"),s8.ERR_INVALID_PEER);let h=Jp.getCleanMultiaddr(c);try{let d=await hge.openAndCertify(f,dge.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(d)){this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",Qp(n.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",Qp(n.protocolVersion));return}}catch(d){Ka("received invalid envelope, discard it and fallback to listenAddrs is available",d)}try{this.peerStore.addressBook.set(l,o.map(d=>new i8(d)))}catch(d){Ka.error("received invalid addrs",d)}this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",Qp(n.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",Qp(n.protocolVersion)),Ka("received observed address of %s",h)}handleMessage({connection:e,stream:t,protocol:i}){switch(i){case n8:return this._handleIdentify({connection:e,stream:t});case nE:return this._handlePush({connection:e,stream:t});default:Ka.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:t}){let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=this.peerStore.protoBook.get(this.peerId)||[],o=Nb.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();try{await iE([o],rE.encode(),t,lge)}catch(a){Ka.error("could not respond to identify request",a)}}async _handlePush({connection:e,stream:t}){let i;try{let[s]=await iE([],t,rE.decode(),uge(1),fge,cge);i=Nb.Identify.decode(s)}catch(s){return Ka.error("received invalid message",s)}let n=e.remotePeer;try{let s=await hge.openAndCertify(i.signedPeerRecord,dge.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(s)){this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){Ka("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new i8(s)))}catch(s){Ka.error("received invalid addrs",s)}this.peerStore.protoBook.set(n,i.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new i8(e)}catch(t){return null}return null}},klt={IDENTIFY:n8,IDENTIFY_PUSH:nE};Jp.multicodecs=klt;Jp.Messsage=Nb;pge.exports=Jp});var gge=p(()=>{u()});var mge=p(o8=>{u();"use strict";Object.defineProperty(o8,"__esModule",{value:!0});o8.promisify=sE;var bge="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function sE(r){if(typeof r!="function")throw new TypeError("Argument to promisify must be a function");var e=r[bge],t=sE.Promise||Promise;if(typeof t!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return new t(function(a,c){s.push(function(l){if(l)return c(l);for(var h=arguments.length,d=new Array(h>1?h-1:0),y=1;y<h;y++)d[y-1]=arguments[y];if(d.length===1||!e)return a(d[0]);var g={};d.forEach(function(m,E){var _=e[E];_&&(g[_]=m)}),a(g)}),r.apply(i,s)})}}sE.argumentNames=bge;sE.Promise=void 0});var wge=p((Oqt,vge)=>{u();"use strict";var Blt=ZS(),oE=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Db=Blt(),Nlt=oE&&!Db,Dlt=Db&&!oE,Mlt=Db&&oE,Llt=typeof Ho=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!Db,Ult=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,Flt=typeof process!="undefined"&&typeof process.env!="undefined"&&!1;vge.exports={isTest:Flt,isElectron:Db,isElectronMain:Dlt,isElectronRenderer:Mlt,isNode:Llt,isBrowser:Nlt,isWebWorker:Ult,isEnvWithDom:oE}});var Ege=p((qqt,_ge)=>{u();function js(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}_ge.exports=js;js.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};js.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};js.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},t),this._options.unref&&this._timer.unref(),!0};js.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};js.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};js.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};js.prototype.start=js.prototype.try;js.prototype.errors=function(){return this._errors};js.prototype.attempts=function(){return this._attempts};js.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,o=(r[s]||0)+1;r[s]=o,o>=t&&(e=n,t=o)}return e}});var Sge=p(Wf=>{u();var Klt=Ege();Wf.operation=function(r){var e=Wf.timeouts(r);return new Klt(e,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};Wf.timeouts=function(r){if(r instanceof Array)return[].concat(r);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var t in r)e[t]=r[t];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return r&&r.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,o){return s-o}),i};Wf.createTimeout=function(r,e){var t=e.randomize?Math.random()+1:1,i=Math.round(t*Math.max(e.minTimeout,1)*Math.pow(e.factor,r));return i=Math.min(i,e.maxTimeout),i};Wf.wrap=function(r,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var i in r)typeof r[i]=="function"&&t.push(i)}for(var n=0;n<t.length;n++){var s=t[n],o=r[s];r[s]=function(c){var f=Wf.operation(e),l=Array.prototype.slice.call(arguments,1),h=l.pop();l.push(function(d){f.retry(d)||(d&&(arguments[0]=f.mainError()),h.apply(this,arguments))}),f.attempt(function(){c.apply(r,l)})}.bind(r,o),r[s].options=e}}});var xge=p((Bqt,Age)=>{u();Age.exports=Sge()});var Tge=p((Nqt,aE)=>{u();"use strict";var jlt=xge(),Vlt=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],a8=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},zlt=(r,e,t)=>{let i=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=i,r},Hlt=r=>Vlt.includes(r),Ige=(r,e)=>new Promise((t,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=jlt.operation(e);n.attempt(async s=>{try{t(await r(s))}catch(o){if(!(o instanceof Error)){i(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof a8)n.stop(),i(o.originalError);else if(o instanceof TypeError&&!Hlt(o.message))n.stop(),i(o);else{zlt(o,s,e);try{await e.onFailedAttempt(o)}catch(a){i(a);return}n.retry(o)||i(n.mainError())}}})});aE.exports=Ige;aE.exports.default=Ige;aE.exports.AbortError=a8});var Pge=p((Dqt,Rge)=>{u();"use strict";function $lt(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^::1$/.test(r)}Rge.exports=$lt});var Oge=p((Mqt,Cge)=>{u();"use strict";var Glt=Pge();function Wlt(r){let{address:e}=r.nodeAddress();return Glt(e)}Cge.exports=Wlt});var Mge=p((Lqt,Dge)=>{u();"use strict";var Ylt=gge(),qge=me(),{promisify:c8}=mge(),{Multiaddr:Xlt}=et(),Zp=Object.assign(qge("libp2p:nat"),{error:qge("libp2p:nat:err")}),{isBrowser:kge}=wge(),u8=Tge(),Qlt=cR(),Bge=oR(),Jlt=ue(),{codes:{ERR_INVALID_PARAMETERS:Zlt}}=di(),eft=Oge(),l8=7200;function tft(r=1024,e=65535){return Math.floor(Math.random()*(e-r+1)+r)}var Nge=class{constructor({peerId:e,addressManager:t,transportManager:i,...n}){if(this._peerId=e,this._addressManager=t,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${Bge.name}@${Bge.version} ${this._peerId}`,ttl:n.ttl||l8,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<l8)throw Jlt(new Error(`NatManager ttl should be at least ${l8} seconds`),Zlt)}start(){kge||!this._enabled||this._start().catch(e=>{Zp.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let t of e){let{family:i,host:n,port:s,transport:o}=t.toOptions();if(!t.isThinWaistAddress()||o!=="tcp"||eft(t)||i!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(Qlt(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let f=tft();Zp(`opening uPnP connection from ${c}:${f} to ${n}:${s}`),await a.map({publicPort:f,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(Xlt.fromNodeAddress({family:4,address:c,port:f},o))}}_getClient(){if(this._client)return this._client;let e=new Ylt(this._options),t=c8(e.map.bind(e)),i=c8(e.destroy.bind(e)),n=c8(e.externalIp.bind(e));return this._client={map:(...s)=>u8(()=>t(...s),{onFailedAttempt:Zp.error,unref:!0}),destroy:(...s)=>u8(()=>i(...s),{onFailedAttempt:Zp.error,unref:!0}),externalIp:(...s)=>u8(()=>n(...s),{onFailedAttempt:Zp.error,unref:!0})},this._client}async stop(){if(!(kge||!this._client))try{await this._client.destroy(),this._client=null}catch(e){Zp.error(e)}}};Dge.exports=Nge});var Vge=p((Uqt,jge)=>{u();"use strict";var Lge=me(),us=Object.assign(Lge("libp2p"),{error:Lge("libp2p:err")}),{EventEmitter:rft}=br(),f8=ue(),ift=rt(),{Multiaddr:nft}=et(),sft=Ffe(),oft=Vfe(),h8=sR(),{validate:aft}=zhe(),{codes:cE,messages:cft}=di(),uft=Ghe(),lft=ude(),Uge=Ude(),fft=Jde(),hft=Ape(),Fge=l0e(),dft=S0e(),pft=gR(),yft=iye(),gft=ZR(),bft=qye(),mft=zye(),vft=Wye(),uE=ige(),Kge=yge(),wft=Kge.multicodecs,_ft=Mge(),{updateSelfPeerRecord:Eft}=pR(),Mb=class extends rft{static async create(e){if(e.peerId)return new Mb(e);let t=await ift.create();return e.peerId=t,new Mb(e)}constructor(e){super();if(this._options=aft(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new mft({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new gft({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new uft(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{Eft(this).catch(i=>{us.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new lft(this,{autoDial:this._config.peerDiscovery.autoDial,...this._options.connectionManager}),this._options.metrics.enabled&&(this.metrics=new dft({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){us("creating keychain");let i=Fge.generateOptions();this.keychain=new Fge(this._options.keychain.datastore,{...i,...this._options.keychain}),us("keychain constructed")}if(this.upgrader=new yft({localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new pft({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new _ft({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new vft({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw f8(new Error(cft.CONN_ENCRYPTION_REQUIRED),cE.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new hft({transportManager:this.transportManager,peerStore:this.peerStore,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(Uge.prototype[Symbol.toStringTag],Uge),this.relay=new fft(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new Kge({libp2p:this}),this.handle(Object.values(wft),this.identifyService.handleMessage)),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=new i({libp2p:this,dialer:this.dialer,peerId:this.peerId,peerStore:this.peerStore,registrar:this.registrar,datastore:this.datastore,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=bft(i,this,this._config.pubsub)}this.peerRouting=new sft(this),this.contentRouting=new oft(this),uE.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...t){return e==="error"&&!this._events.error?(us.error(t),!1):super.emit(e,...t)}async start(){us("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),us("libp2p has started")}catch(e){throw this.emit("error",e),us.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){us("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop();for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this._dht&&this._dht.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),uE.unmount(this),this.dialer.destroy()}catch(e){e&&(us.error(e),this.emit("error",e))}us("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,t){return this._dial(e,t)}async dialProtocol(e,t,i){if(!t||!t.length)throw f8(new Error("no protocols were provided to open a stream"),cE.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(t)}async _dial(e,t){let{id:i,multiaddrs:n}=h8(e);if(i.equals(this.peerId))throw f8(new Error("Cannot dial self"),cE.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,t),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let t=this._options.addresses.announceFilter,i=new Set(e);return t(Array.from(i).map(n=>new nft(n)))}async hangUp(e){let{id:t}=h8(e),i=this.connectionManager.connections.get(t.toB58String());!i||await Promise.all(i.map(n=>n.close()))}ping(e){let{id:t,multiaddrs:i}=h8(e);return i?uE(this,i[0]):uE(this,t)}handle(e,t){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,t)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(t=>{this.upgrader.protocols.delete(t)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(let e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){us.error(new Error(cE.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){us("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){us.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=t=>{let i={enabled:!0};if(t.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[t.tag]&&(i={...i,...this._config.peerDiscovery[t.tag]}),i.enabled&&!this._discovery.has(t.tag)){let n;typeof t=="function"?n=new t(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=t,n.on("peer",this._onDiscoveryPeer),this._discovery.set(t.tag,n)}};for(let t of this._modules.peerDiscovery||[])e(t);for(let t of this.transportManager.getTransports())t.discovery&&e(t.discovery);await Promise.all(Array.from(this._discovery.values(),t=>t.start()))}};jge.exports=Mb});var zge=p(()=>{u()});var $ge=p((jqt,Hge)=>{u();Hge.exports=typeof WebSocket=="undefined"?zge():WebSocket});var Wge=p(lE=>{u();"use strict";Object.defineProperty(lE,"__esModule",{value:!0});var Gge=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let t={value:e,done:!1};if(this.pullQueue.length){let i=this.pullQueue.shift();i&&i.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{let t=Promise.reject(e);t.catch(()=>{}),this.pushQueue.push(t)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let t=this.pushQueue.shift();return t?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((i,n)=>{this.pullQueue.push({resolve:i,reject:n})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},d8=class{constructor(e,{highWaterMark:t=100,lowWaterMark:i=1}={}){let n=new Gge;n.highWaterMark=t,n.lowWaterMark=i,n.removeCallback=e({push:s=>n.push(s),stop:()=>n.stop(),fail:s=>n.fail(s),on:(s,o)=>{n.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}};lE.EventIterator=d8;lE.default=d8});var Yge=p(Lb=>{u();"use strict";Object.defineProperty(Lb,"__esModule",{value:!0});var p8=Wge();Lb.EventIterator=p8.EventIterator;function Sft(r,e,t){return new p8.EventIterator(({push:i})=>(this.addEventListener(r,i,e),()=>this.removeEventListener(r,i,e)),t)}Lb.subscribe=Sft;Lb.default=p8.EventIterator});var Qge=p((Hqt,Xge)=>{u();var{Buffer:Aft}=pt(),{EventIterator:xft}=Yge();function Ift(r){return r instanceof ArrayBuffer||r!=null&&r.constructor!=null&&r.constructor.name==="ArrayBuffer"&&typeof r.byteLength=="number"}Xge.exports=r=>{let e=r.removeEventListener||r.removeListener,t=async function*(){let s=new xft(({push:o,stop:a,fail:c})=>(r.addEventListener("message",o),r.addEventListener("error",c),r.addEventListener("close",a),()=>{e.call(r,"message",o),e.call(r,"error",c),e.call(r,"close",a)}),{highWaterMark:1/0});for await(let{data:o}of s)yield Ift(o)?Aft.from(o):o}(),i=r.readyState===1,n;return r.addEventListener("open",()=>{i=!0,n=null}),r.addEventListener("close",()=>{i=!1,n=null}),r.addEventListener("error",s=>{i||(n=s)}),t.connected=()=>new Promise((s,o)=>{if(i)return s();if(n)return o(n);let a=l=>{e.call(r,"open",c),e.call(r,"error",f),l()},c=()=>a(s),f=l=>a(()=>o(l));r.addEventListener("open",c),r.addEventListener("error",f)}),t}});var Zge=p(($qt,Jge)=>{u();Jge.exports=async r=>{if(r.readyState>=2)throw new Error("socket closed");if(r.readyState!==1)return new Promise((e,t)=>{let i=r&&(r.removeEventListener||r.removeListener);function n(){typeof i=="function"&&(i.call(r,"open",s),i.call(r,"error",o))}function s(){n(),e()}function o(a){n(),t(a)}r.addEventListener("open",s),r.addEventListener("error",o)})}});var tbe=p((Gqt,ebe)=>{u();var Tft=Zge();ebe.exports=(r,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async t=>{for await(let i of t){try{await Tft(r)}catch(n){if(n.message==="socket closed")break;throw n}r.send(i)}if(e.closeOnEnd&&r.readyState<=1)return new Promise((i,n)=>{r.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let o=Object.assign(new Error("ws error"),{event:s});n(o)}}),setTimeout(()=>r.close())})})});var ibe=p((Wqt,rbe)=>{u();var Rft=Qge(),Pft=tbe();rbe.exports=(r,e)=>{e=e||{},e.binaryType?r.binaryType=e.binaryType:e.binary&&(r.binaryType="arraybuffer");let t={sink:Pft(r,e),source:Rft(r,e),connected:()=>t.source.connected()};return t}});var sbe=p((Yqt,nbe)=>{u();var{relative:Cft}=Km(),Oft={http:"ws",https:"wss"},qft="ws";nbe.exports=(r,e)=>Cft(r,e,Oft,qft)});var obe=p((Xqt,fE)=>{u();"use strict";var kft=$ge(),Bft=ibe(),Nft=sbe();fE.exports=function(r,e={}){let t=typeof window=="undefined"?{}:window.location,i=Nft(r,t),n=new kft(i,e.websocket),s=Bft(n,e);return s.remoteAddress=i,s.close=()=>new Promise((o,a)=>{n.addEventListener("close",o),n.close()}),s.destroy=()=>{n.terminate?n.terminate():n.close()},s.socket=n,s};fE.exports.connect=fE.exports});var cbe=p((Qqt,abe)=>{u();"use strict";abe.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var y8=p(Yf=>{u();"use strict";Yf.CODE_P2P=421;Yf.CODE_CIRCUIT=290;Yf.CODE_TCP=6;Yf.CODE_WS=477;Yf.CODE_WSS=478;Yf.CLOSE_TIMEOUT=2e3});var g8=p(e0=>{u();"use strict";Object.defineProperty(e0,"__esModule",{value:!0});e0.isCorrect=e0.isInSubnet=void 0;function Dft(r){return this.subnetMask<r.subnetMask?!1:this.mask(r.subnetMask)===r.mask()}e0.isInSubnet=Dft;function Mft(r){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===r&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}e0.isCorrect=Mft});var b8=p(ja=>{u();"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.RE_SUBNET_STRING=ja.RE_ADDRESS=ja.GROUPS=ja.BITS=void 0;ja.BITS=32;ja.GROUPS=4;ja.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;ja.RE_SUBNET_STRING=/\/\d{1,2}$/});var hE=p(t0=>{u();"use strict";var Lft=t0&&t0.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(t0,"__esModule",{value:!0});t0.AddressError=void 0;var Uft=function(r){Lft(e,r);function e(t,i){var n=r.call(this,t)||this;return n.name="AddressError",i!==null&&(n.parseMessage=i),n}return e}(Error);t0.AddressError=Uft});var m8=p((dE,ube)=>{u();(function(){var r,e=244837814094590,t=(e&16777215)==15715070;function i(A,I,j){A!=null&&(typeof A=="number"?this.fromNumber(A,I,j):I==null&&typeof A!="string"?this.fromString(A,256):this.fromString(A,I))}function n(){return new i(null)}function s(A,I,j,ie,ye,Ee){for(;--Ee>=0;){var Ne=I*this[A++]+j[ie]+ye;ye=Math.floor(Ne/67108864),j[ie++]=Ne&67108863}return ye}function o(A,I,j,ie,ye,Ee){for(var Ne=I&32767,Fe=I>>15;--Ee>=0;){var yr=this[A]&32767,Ii=this[A++]>>15,ds=Fe*yr+Ii*Ne;yr=Ne*yr+((ds&32767)<<15)+j[ie]+(ye&1073741823),ye=(yr>>>30)+(ds>>>15)+Fe*Ii+(ye>>>30),j[ie++]=yr&1073741823}return ye}function a(A,I,j,ie,ye,Ee){for(var Ne=I&16383,Fe=I>>14;--Ee>=0;){var yr=this[A]&16383,Ii=this[A++]>>14,ds=Fe*yr+Ii*Ne;yr=Ne*yr+((ds&16383)<<14)+j[ie]+ye,ye=(yr>>28)+(ds>>14)+Fe*Ii,j[ie++]=yr&268435455}return ye}var c=typeof navigator!="undefined";c&&t&&navigator.appName=="Microsoft Internet Explorer"?(i.prototype.am=o,r=30):c&&t&&navigator.appName!="Netscape"?(i.prototype.am=s,r=26):(i.prototype.am=a,r=28),i.prototype.DB=r,i.prototype.DM=(1<<r)-1,i.prototype.DV=1<<r;var f=52;i.prototype.FV=Math.pow(2,f),i.prototype.F1=f-r,i.prototype.F2=2*r-f;var l="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array,d,y;for(d="0".charCodeAt(0),y=0;y<=9;++y)h[d++]=y;for(d="a".charCodeAt(0),y=10;y<36;++y)h[d++]=y;for(d="A".charCodeAt(0),y=10;y<36;++y)h[d++]=y;function g(A){return l.charAt(A)}function m(A,I){var j=h[A.charCodeAt(I)];return j??-1}function E(A){for(var I=this.t-1;I>=0;--I)A[I]=this[I];A.t=this.t,A.s=this.s}function _(A){this.t=1,this.s=A<0?-1:0,A>0?this[0]=A:A<-1?this[0]=A+this.DV:this.t=0}function T(A){var I=n();return I.fromInt(A),I}function q(A,I){var j;if(I==16)j=4;else if(I==8)j=3;else if(I==256)j=8;else if(I==2)j=1;else if(I==32)j=5;else if(I==4)j=2;else{this.fromRadix(A,I);return}this.t=0,this.s=0;for(var ie=A.length,ye=!1,Ee=0;--ie>=0;){var Ne=j==8?A[ie]&255:m(A,ie);if(Ne<0){A.charAt(ie)=="-"&&(ye=!0);continue}ye=!1,Ee==0?this[this.t++]=Ne:Ee+j>this.DB?(this[this.t-1]|=(Ne&(1<<this.DB-Ee)-1)<<Ee,this[this.t++]=Ne>>this.DB-Ee):this[this.t-1]|=Ne<<Ee,Ee+=j,Ee>=this.DB&&(Ee-=this.DB)}j==8&&(A[0]&128)!=0&&(this.s=-1,Ee>0&&(this[this.t-1]|=(1<<this.DB-Ee)-1<<Ee)),this.clamp(),ye&&i.ZERO.subTo(this,this)}function z(){for(var A=this.s&this.DM;this.t>0&&this[this.t-1]==A;)--this.t}function V(A){if(this.s<0)return"-"+this.negate().toString(A);var I;if(A==16)I=4;else if(A==8)I=3;else if(A==2)I=1;else if(A==32)I=5;else if(A==4)I=2;else return this.toRadix(A);var j=(1<<I)-1,ie,ye=!1,Ee="",Ne=this.t,Fe=this.DB-Ne*this.DB%I;if(Ne-- >0)for(Fe<this.DB&&(ie=this[Ne]>>Fe)>0&&(ye=!0,Ee=g(ie));Ne>=0;)Fe<I?(ie=(this[Ne]&(1<<Fe)-1)<<I-Fe,ie|=this[--Ne]>>(Fe+=this.DB-I)):(ie=this[Ne]>>(Fe-=I)&j,Fe<=0&&(Fe+=this.DB,--Ne)),ie>0&&(ye=!0),ye&&(Ee+=g(ie));return ye?Ee:"0"}function M(){var A=n();return i.ZERO.subTo(this,A),A}function $(){return this.s<0?this.negate():this}function X(A){var I=this.s-A.s;if(I!=0)return I;var j=this.t;if(I=j-A.t,I!=0)return this.s<0?-I:I;for(;--j>=0;)if((I=this[j]-A[j])!=0)return I;return 0}function Q(A){var I=1,j;return(j=A>>>16)!=0&&(A=j,I+=16),(j=A>>8)!=0&&(A=j,I+=8),(j=A>>4)!=0&&(A=j,I+=4),(j=A>>2)!=0&&(A=j,I+=2),(j=A>>1)!=0&&(A=j,I+=1),I}function O(){return this.t<=0?0:this.DB*(this.t-1)+Q(this[this.t-1]^this.s&this.DM)}function b(A,I){var j;for(j=this.t-1;j>=0;--j)I[j+A]=this[j];for(j=A-1;j>=0;--j)I[j]=0;I.t=this.t+A,I.s=this.s}function w(A,I){for(var j=A;j<this.t;++j)I[j-A]=this[j];I.t=Math.max(this.t-A,0),I.s=this.s}function S(A,I){var j=A%this.DB,ie=this.DB-j,ye=(1<<ie)-1,Ee=Math.floor(A/this.DB),Ne=this.s<<j&this.DM,Fe;for(Fe=this.t-1;Fe>=0;--Fe)I[Fe+Ee+1]=this[Fe]>>ie|Ne,Ne=(this[Fe]&ye)<<j;for(Fe=Ee-1;Fe>=0;--Fe)I[Fe]=0;I[Ee]=Ne,I.t=this.t+Ee+1,I.s=this.s,I.clamp()}function C(A,I){I.s=this.s;var j=Math.floor(A/this.DB);if(j>=this.t){I.t=0;return}var ie=A%this.DB,ye=this.DB-ie,Ee=(1<<ie)-1;I[0]=this[j]>>ie;for(var Ne=j+1;Ne<this.t;++Ne)I[Ne-j-1]|=(this[Ne]&Ee)<<ye,I[Ne-j]=this[Ne]>>ie;ie>0&&(I[this.t-j-1]|=(this.s&Ee)<<ye),I.t=this.t-j,I.clamp()}function B(A,I){for(var j=0,ie=0,ye=Math.min(A.t,this.t);j<ye;)ie+=this[j]-A[j],I[j++]=ie&this.DM,ie>>=this.DB;if(A.t<this.t){for(ie-=A.s;j<this.t;)ie+=this[j],I[j++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;j<A.t;)ie-=A[j],I[j++]=ie&this.DM,ie>>=this.DB;ie-=A.s}I.s=ie<0?-1:0,ie<-1?I[j++]=this.DV+ie:ie>0&&(I[j++]=ie),I.t=j,I.clamp()}function G(A,I){var j=this.abs(),ie=A.abs(),ye=j.t;for(I.t=ye+ie.t;--ye>=0;)I[ye]=0;for(ye=0;ye<ie.t;++ye)I[ye+j.t]=j.am(0,ie[ye],I,ye,0,j.t);I.s=0,I.clamp(),this.s!=A.s&&i.ZERO.subTo(I,I)}function F(A){for(var I=this.abs(),j=A.t=2*I.t;--j>=0;)A[j]=0;for(j=0;j<I.t-1;++j){var ie=I.am(j,I[j],A,2*j,0,1);(A[j+I.t]+=I.am(j+1,2*I[j],A,2*j+1,ie,I.t-j-1))>=I.DV&&(A[j+I.t]-=I.DV,A[j+I.t+1]=1)}A.t>0&&(A[A.t-1]+=I.am(j,I[j],A,2*j,0,1)),A.s=0,A.clamp()}function N(A,I,j){var ie=A.abs();if(!(ie.t<=0)){var ye=this.abs();if(ye.t<ie.t){I!=null&&I.fromInt(0),j!=null&&this.copyTo(j);return}j==null&&(j=n());var Ee=n(),Ne=this.s,Fe=A.s,yr=this.DB-Q(ie[ie.t-1]);yr>0?(ie.lShiftTo(yr,Ee),ye.lShiftTo(yr,j)):(ie.copyTo(Ee),ye.copyTo(j));var Ii=Ee.t,ds=Ee[Ii-1];if(ds!=0){var Yn=ds*(1<<this.F1)+(Ii>1?Ee[Ii-2]>>this.F2:0),Za=this.FV/Yn,Cm=(1<<this.F1)/Yn,Js=1<<this.F2,Zs=j.t,Om=Zs-Ii,Xc=I??n();for(Ee.dlShiftTo(Om,Xc),j.compareTo(Xc)>=0&&(j[j.t++]=1,j.subTo(Xc,j)),i.ONE.dlShiftTo(Ii,Xc),Xc.subTo(Ee,Ee);Ee.t<Ii;)Ee[Ee.t++]=0;for(;--Om>=0;){var LS=j[--Zs]==ds?this.DM:Math.floor(j[Zs]*Za+(j[Zs-1]+Js)*Cm);if((j[Zs]+=Ee.am(0,LS,j,Om,0,Ii))<LS)for(Ee.dlShiftTo(Om,Xc),j.subTo(Xc,j);j[Zs]<--LS;)j.subTo(Xc,j)}I!=null&&(j.drShiftTo(Ii,I),Ne!=Fe&&i.ZERO.subTo(I,I)),j.t=Ii,j.clamp(),yr>0&&j.rShiftTo(yr,j),Ne<0&&i.ZERO.subTo(j,j)}}}function v(A){var I=n();return this.abs().divRemTo(A,null,I),this.s<0&&I.compareTo(i.ZERO)>0&&A.subTo(I,I),I}function D(A){this.m=A}function ae(A){return A.s<0||A.compareTo(this.m)>=0?A.mod(this.m):A}function W(A){return A}function ne(A){A.divRemTo(this.m,null,A)}function oe(A,I,j){A.multiplyTo(I,j),this.reduce(j)}function de(A,I){A.squareTo(I),this.reduce(I)}D.prototype.convert=ae,D.prototype.revert=W,D.prototype.reduce=ne,D.prototype.mulTo=oe,D.prototype.sqrTo=de;function pe(){if(this.t<1)return 0;var A=this[0];if((A&1)==0)return 0;var I=A&3;return I=I*(2-(A&15)*I)&15,I=I*(2-(A&255)*I)&255,I=I*(2-((A&65535)*I&65535))&65535,I=I*(2-A*I%this.DV)%this.DV,I>0?this.DV-I:-I}function _e(A){this.m=A,this.mp=A.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<A.DB-15)-1,this.mt2=2*A.t}function P(A){var I=n();return A.abs().dlShiftTo(this.m.t,I),I.divRemTo(this.m,null,I),A.s<0&&I.compareTo(i.ZERO)>0&&this.m.subTo(I,I),I}function U(A){var I=n();return A.copyTo(I),this.reduce(I),I}function H(A){for(;A.t<=this.mt2;)A[A.t++]=0;for(var I=0;I<this.m.t;++I){var j=A[I]&32767,ie=j*this.mpl+((j*this.mph+(A[I]>>15)*this.mpl&this.um)<<15)&A.DM;for(j=I+this.m.t,A[j]+=this.m.am(0,ie,A,I,0,this.m.t);A[j]>=A.DV;)A[j]-=A.DV,A[++j]++}A.clamp(),A.drShiftTo(this.m.t,A),A.compareTo(this.m)>=0&&A.subTo(this.m,A)}function J(A,I){A.squareTo(I),this.reduce(I)}function x(A,I,j){A.multiplyTo(I,j),this.reduce(j)}_e.prototype.convert=P,_e.prototype.revert=U,_e.prototype.reduce=H,_e.prototype.mulTo=x,_e.prototype.sqrTo=J;function L(){return(this.t>0?this[0]&1:this.s)==0}function K(A,I){if(A>4294967295||A<1)return i.ONE;var j=n(),ie=n(),ye=I.convert(this),Ee=Q(A)-1;for(ye.copyTo(j);--Ee>=0;)if(I.sqrTo(j,ie),(A&1<<Ee)>0)I.mulTo(ie,ye,j);else{var Ne=j;j=ie,ie=Ne}return I.revert(j)}function k(A,I){var j;return A<256||I.isEven()?j=new D(I):j=new _e(I),this.exp(A,j)}i.prototype.copyTo=E,i.prototype.fromInt=_,i.prototype.fromString=q,i.prototype.clamp=z,i.prototype.dlShiftTo=b,i.prototype.drShiftTo=w,i.prototype.lShiftTo=S,i.prototype.rShiftTo=C,i.prototype.subTo=B,i.prototype.multiplyTo=G,i.prototype.squareTo=F,i.prototype.divRemTo=N,i.prototype.invDigit=pe,i.prototype.isEven=L,i.prototype.exp=K,i.prototype.toString=V,i.prototype.negate=M,i.prototype.abs=$,i.prototype.compareTo=X,i.prototype.bitLength=O,i.prototype.mod=v,i.prototype.modPowInt=k,i.ZERO=T(0),i.ONE=T(1);function Y(){var A=n();return this.copyTo(A),A}function ee(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Z(){return this.t==0?this.s:this[0]<<24>>24}function ce(){return this.t==0?this.s:this[0]<<16>>16}function ge(A){return Math.floor(Math.LN2*this.DB/Math.log(A))}function be(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Ke(A){if(A==null&&(A=10),this.signum()==0||A<2||A>36)return"0";var I=this.chunkSize(A),j=Math.pow(A,I),ie=T(j),ye=n(),Ee=n(),Ne="";for(this.divRemTo(ie,ye,Ee);ye.signum()>0;)Ne=(j+Ee.intValue()).toString(A).substr(1)+Ne,ye.divRemTo(ie,ye,Ee);return Ee.intValue().toString(A)+Ne}function Te(A,I){this.fromInt(0),I==null&&(I=10);for(var j=this.chunkSize(I),ie=Math.pow(I,j),ye=!1,Ee=0,Ne=0,Fe=0;Fe<A.length;++Fe){var yr=m(A,Fe);if(yr<0){A.charAt(Fe)=="-"&&this.signum()==0&&(ye=!0);continue}Ne=I*Ne+yr,++Ee>=j&&(this.dMultiply(ie),this.dAddOffset(Ne,0),Ee=0,Ne=0)}Ee>0&&(this.dMultiply(Math.pow(I,Ee)),this.dAddOffset(Ne,0)),ye&&i.ZERO.subTo(this,this)}function je(A,I,j){if(typeof I=="number")if(A<2)this.fromInt(1);else for(this.fromNumber(A,j),this.testBit(A-1)||this.bitwiseTo(i.ONE.shiftLeft(A-1),Ut,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(I);)this.dAddOffset(2,0),this.bitLength()>A&&this.subTo(i.ONE.shiftLeft(A-1),this);else{var ie=new Array,ye=A&7;ie.length=(A>>3)+1,I.nextBytes(ie),ye>0?ie[0]&=(1<<ye)-1:ie[0]=0,this.fromString(ie,256)}}function Je(){var A=this.t,I=new Array;I[0]=this.s;var j=this.DB-A*this.DB%8,ie,ye=0;if(A-- >0)for(j<this.DB&&(ie=this[A]>>j)!=(this.s&this.DM)>>j&&(I[ye++]=ie|this.s<<this.DB-j);A>=0;)j<8?(ie=(this[A]&(1<<j)-1)<<8-j,ie|=this[--A]>>(j+=this.DB-8)):(ie=this[A]>>(j-=8)&255,j<=0&&(j+=this.DB,--A)),(ie&128)!=0&&(ie|=-256),ye==0&&(this.s&128)!=(ie&128)&&++ye,(ye>0||ie!=this.s)&&(I[ye++]=ie);return I}function ze(A){return this.compareTo(A)==0}function Ve(A){return this.compareTo(A)<0?this:A}function dt(A){return this.compareTo(A)>0?this:A}function Vt(A,I,j){var ie,ye,Ee=Math.min(A.t,this.t);for(ie=0;ie<Ee;++ie)j[ie]=I(this[ie],A[ie]);if(A.t<this.t){for(ye=A.s&this.DM,ie=Ee;ie<this.t;++ie)j[ie]=I(this[ie],ye);j.t=this.t}else{for(ye=this.s&this.DM,ie=Ee;ie<A.t;++ie)j[ie]=I(ye,A[ie]);j.t=A.t}j.s=I(this.s,A.s),j.clamp()}function Jt(A,I){return A&I}function yn(A){var I=n();return this.bitwiseTo(A,Jt,I),I}function Ut(A,I){return A|I}function Et(A){var I=n();return this.bitwiseTo(A,Ut,I),I}function ri(A,I){return A^I}function it(A){var I=n();return this.bitwiseTo(A,ri,I),I}function xr(A,I){return A&~I}function _m(A){var I=n();return this.bitwiseTo(A,xr,I),I}function Tr(){for(var A=n(),I=0;I<this.t;++I)A[I]=this.DM&~this[I];return A.t=this.t,A.s=~this.s,A}function Rr(A){var I=n();return A<0?this.rShiftTo(-A,I):this.lShiftTo(A,I),I}function Em(A){var I=n();return A<0?this.lShiftTo(-A,I):this.rShiftTo(A,I),I}function Pr(A){if(A==0)return-1;var I=0;return(A&65535)==0&&(A>>=16,I+=16),(A&255)==0&&(A>>=8,I+=8),(A&15)==0&&(A>>=4,I+=4),(A&3)==0&&(A>>=2,I+=2),(A&1)==0&&++I,I}function Cr(){for(var A=0;A<this.t;++A)if(this[A]!=0)return A*this.DB+Pr(this[A]);return this.s<0?this.t*this.DB:-1}function Sm(A){for(var I=0;A!=0;)A&=A-1,++I;return I}function Or(){for(var A=0,I=this.s&this.DM,j=0;j<this.t;++j)A+=Sm(this[j]^I);return A}function qr(A){var I=Math.floor(A/this.DB);return I>=this.t?this.s!=0:(this[I]&1<<A%this.DB)!=0}function Am(A,I){var j=i.ONE.shiftLeft(A);return this.bitwiseTo(j,I,j),j}function kr(A){return this.changeBit(A,Ut)}function Br(A){return this.changeBit(A,xr)}function xm(A){return this.changeBit(A,ri)}function Nr(A,I){for(var j=0,ie=0,ye=Math.min(A.t,this.t);j<ye;)ie+=this[j]+A[j],I[j++]=ie&this.DM,ie>>=this.DB;if(A.t<this.t){for(ie+=A.s;j<this.t;)ie+=this[j],I[j++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;j<A.t;)ie+=A[j],I[j++]=ie&this.DM,ie>>=this.DB;ie+=A.s}I.s=ie<0?-1:0,ie>0?I[j++]=ie:ie<-1&&(I[j++]=this.DV+ie),I.t=j,I.clamp()}function Dr(A){var I=n();return this.addTo(A,I),I}function Im(A){var I=n();return this.subTo(A,I),I}function Mr(A){var I=n();return this.multiplyTo(A,I),I}function Lr(){var A=n();return this.squareTo(A),A}function Tm(A){var I=n();return this.divRemTo(A,I,null),I}function Ur(A){var I=n();return this.divRemTo(A,null,I),I}function Fr(A){var I=n(),j=n();return this.divRemTo(A,I,j),new Array(I,j)}function Rm(A){this[this.t]=this.am(0,A-1,this,0,0,this.t),++this.t,this.clamp()}function Kr(A,I){if(A!=0){for(;this.t<=I;)this[this.t++]=0;for(this[I]+=A;this[I]>=this.DV;)this[I]-=this.DV,++I>=this.t&&(this[this.t++]=0),++this[I]}}function Zt(){}function nh(A){return A}function P0(A,I,j){A.multiplyTo(I,j)}function C0(A,I){A.squareTo(I)}Zt.prototype.convert=nh,Zt.prototype.revert=nh,Zt.prototype.mulTo=P0,Zt.prototype.sqrTo=C0;function O0(A){return this.exp(A,new Zt)}function q0(A,I,j){var ie=Math.min(this.t+A.t,I);for(j.s=0,j.t=ie;ie>0;)j[--ie]=0;var ye;for(ye=j.t-this.t;ie<ye;++ie)j[ie+this.t]=this.am(0,A[ie],j,ie,0,this.t);for(ye=Math.min(A.t,I);ie<ye;++ie)this.am(0,A[ie],j,ie,0,I-ie);j.clamp()}function k0(A,I,j){--I;var ie=j.t=this.t+A.t-I;for(j.s=0;--ie>=0;)j[ie]=0;for(ie=Math.max(I-this.t,0);ie<A.t;++ie)j[this.t+ie-I]=this.am(I-ie,A[ie],j,0,0,this.t+ie-I);j.clamp(),j.drShiftTo(1,j)}function Xs(A){this.r2=n(),this.q3=n(),i.ONE.dlShiftTo(2*A.t,this.r2),this.mu=this.r2.divide(A),this.m=A}function B0(A){if(A.s<0||A.t>2*this.m.t)return A.mod(this.m);if(A.compareTo(this.m)<0)return A;var I=n();return A.copyTo(I),this.reduce(I),I}function N0(A){return A}function D0(A){for(A.drShiftTo(this.m.t-1,this.r2),A.t>this.m.t+1&&(A.t=this.m.t+1,A.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);A.compareTo(this.r2)<0;)A.dAddOffset(1,this.m.t+1);for(A.subTo(this.r2,A);A.compareTo(this.m)>=0;)A.subTo(this.m,A)}function M0(A,I){A.squareTo(I),this.reduce(I)}function L0(A,I,j){A.multiplyTo(I,j),this.reduce(j)}Xs.prototype.convert=B0,Xs.prototype.revert=N0,Xs.prototype.reduce=D0,Xs.prototype.mulTo=L0,Xs.prototype.sqrTo=M0;function U0(A,I){var j=A.bitLength(),ie,ye=T(1),Ee;if(j<=0)return ye;j<18?ie=1:j<48?ie=3:j<144?ie=4:j<768?ie=5:ie=6,j<8?Ee=new D(I):I.isEven()?Ee=new Xs(I):Ee=new _e(I);var Ne=new Array,Fe=3,yr=ie-1,Ii=(1<<ie)-1;if(Ne[1]=Ee.convert(this),ie>1){var ds=n();for(Ee.sqrTo(Ne[1],ds);Fe<=Ii;)Ne[Fe]=n(),Ee.mulTo(ds,Ne[Fe-2],Ne[Fe]),Fe+=2}var Yn=A.t-1,Za,Cm=!0,Js=n(),Zs;for(j=Q(A[Yn])-1;Yn>=0;){for(j>=yr?Za=A[Yn]>>j-yr&Ii:(Za=(A[Yn]&(1<<j+1)-1)<<yr-j,Yn>0&&(Za|=A[Yn-1]>>this.DB+j-yr)),Fe=ie;(Za&1)==0;)Za>>=1,--Fe;if((j-=Fe)<0&&(j+=this.DB,--Yn),Cm)Ne[Za].copyTo(ye),Cm=!1;else{for(;Fe>1;)Ee.sqrTo(ye,Js),Ee.sqrTo(Js,ye),Fe-=2;Fe>0?Ee.sqrTo(ye,Js):(Zs=ye,ye=Js,Js=Zs),Ee.mulTo(Js,Ne[Za],ye)}for(;Yn>=0&&(A[Yn]&1<<j)==0;)Ee.sqrTo(ye,Js),Zs=ye,ye=Js,Js=Zs,--j<0&&(j=this.DB-1,--Yn)}return Ee.revert(ye)}function F0(A){var I=this.s<0?this.negate():this.clone(),j=A.s<0?A.negate():A.clone();if(I.compareTo(j)<0){var ie=I;I=j,j=ie}var ye=I.getLowestSetBit(),Ee=j.getLowestSetBit();if(Ee<0)return I;for(ye<Ee&&(Ee=ye),Ee>0&&(I.rShiftTo(Ee,I),j.rShiftTo(Ee,j));I.signum()>0;)(ye=I.getLowestSetBit())>0&&I.rShiftTo(ye,I),(ye=j.getLowestSetBit())>0&&j.rShiftTo(ye,j),I.compareTo(j)>=0?(I.subTo(j,I),I.rShiftTo(1,I)):(j.subTo(I,j),j.rShiftTo(1,j));return Ee>0&&j.lShiftTo(Ee,j),j}function K0(A){if(A<=0)return 0;var I=this.DV%A,j=this.s<0?A-1:0;if(this.t>0)if(I==0)j=this[0]%A;else for(var ie=this.t-1;ie>=0;--ie)j=(I*j+this[ie])%A;return j}function j0(A){var I=A.isEven();if(this.isEven()&&I||A.signum()==0)return i.ZERO;for(var j=A.clone(),ie=this.clone(),ye=T(1),Ee=T(0),Ne=T(0),Fe=T(1);j.signum()!=0;){for(;j.isEven();)j.rShiftTo(1,j),I?((!ye.isEven()||!Ee.isEven())&&(ye.addTo(this,ye),Ee.subTo(A,Ee)),ye.rShiftTo(1,ye)):Ee.isEven()||Ee.subTo(A,Ee),Ee.rShiftTo(1,Ee);for(;ie.isEven();)ie.rShiftTo(1,ie),I?((!Ne.isEven()||!Fe.isEven())&&(Ne.addTo(this,Ne),Fe.subTo(A,Fe)),Ne.rShiftTo(1,Ne)):Fe.isEven()||Fe.subTo(A,Fe),Fe.rShiftTo(1,Fe);j.compareTo(ie)>=0?(j.subTo(ie,j),I&&ye.subTo(Ne,ye),Ee.subTo(Fe,Ee)):(ie.subTo(j,ie),I&&Ne.subTo(ye,Ne),Fe.subTo(Ee,Fe))}if(ie.compareTo(i.ONE)!=0)return i.ZERO;if(Fe.compareTo(A)>=0)return Fe.subtract(A);if(Fe.signum()<0)Fe.addTo(A,Fe);else return Fe;return Fe.signum()<0?Fe.add(A):Fe}var gi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],V0=(1<<26)/gi[gi.length-1];function z0(A){var I,j=this.abs();if(j.t==1&&j[0]<=gi[gi.length-1]){for(I=0;I<gi.length;++I)if(j[0]==gi[I])return!0;return!1}if(j.isEven())return!1;for(I=1;I<gi.length;){for(var ie=gi[I],ye=I+1;ye<gi.length&&ie<V0;)ie*=gi[ye++];for(ie=j.modInt(ie);I<ye;)if(ie%gi[I++]==0)return!1}return j.millerRabin(A)}function BSe(A){var I=this.subtract(i.ONE),j=I.getLowestSetBit();if(j<=0)return!1;var ie=I.shiftRight(j);A=A+1>>1,A>gi.length&&(A=gi.length);for(var ye=n(),Ee=0;Ee<A;++Ee){ye.fromInt(gi[Math.floor(Math.random()*gi.length)]);var Ne=ye.modPow(ie,this);if(Ne.compareTo(i.ONE)!=0&&Ne.compareTo(I)!=0){for(var Fe=1;Fe++<j&&Ne.compareTo(I)!=0;)if(Ne=Ne.modPowInt(2,this),Ne.compareTo(i.ONE)==0)return!1;if(Ne.compareTo(I)!=0)return!1}}return!0}i.prototype.chunkSize=ge,i.prototype.toRadix=Ke,i.prototype.fromRadix=Te,i.prototype.fromNumber=je,i.prototype.bitwiseTo=Vt,i.prototype.changeBit=Am,i.prototype.addTo=Nr,i.prototype.dMultiply=Rm,i.prototype.dAddOffset=Kr,i.prototype.multiplyLowerTo=q0,i.prototype.multiplyUpperTo=k0,i.prototype.modInt=K0,i.prototype.millerRabin=BSe,i.prototype.clone=Y,i.prototype.intValue=ee,i.prototype.byteValue=Z,i.prototype.shortValue=ce,i.prototype.signum=be,i.prototype.toByteArray=Je,i.prototype.equals=ze,i.prototype.min=Ve,i.prototype.max=dt,i.prototype.and=yn,i.prototype.or=Et,i.prototype.xor=it,i.prototype.andNot=_m,i.prototype.not=Tr,i.prototype.shiftLeft=Rr,i.prototype.shiftRight=Em,i.prototype.getLowestSetBit=Cr,i.prototype.bitCount=Or,i.prototype.testBit=qr,i.prototype.setBit=kr,i.prototype.clearBit=Br,i.prototype.flipBit=xm,i.prototype.add=Dr,i.prototype.subtract=Im,i.prototype.multiply=Mr,i.prototype.divide=Tm,i.prototype.remainder=Ur,i.prototype.divideAndRemainder=Fr,i.prototype.modPow=U0,i.prototype.modInverse=j0,i.prototype.pow=O0,i.prototype.gcd=F0,i.prototype.isProbablePrime=z0,i.prototype.square=Lr,i.prototype.Barrett=Xs;var Pm,Wn,xi;function NSe(A){Wn[xi++]^=A&255,Wn[xi++]^=A>>8&255,Wn[xi++]^=A>>16&255,Wn[xi++]^=A>>24&255,xi>=MS&&(xi-=MS)}function RC(){NSe(new Date().getTime())}if(Wn==null){Wn=new Array,xi=0;var Qs;if(typeof window!="undefined"&&window.crypto){if(window.crypto.getRandomValues){var PC=new Uint8Array(32);for(window.crypto.getRandomValues(PC),Qs=0;Qs<32;++Qs)Wn[xi++]=PC[Qs]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var CC=window.crypto.random(32);for(Qs=0;Qs<CC.length;++Qs)Wn[xi++]=CC.charCodeAt(Qs)&255}}for(;xi<MS;)Qs=Math.floor(65536*Math.random()),Wn[xi++]=Qs>>>8,Wn[xi++]=Qs&255;xi=0,RC()}function DSe(){if(Pm==null){for(RC(),Pm=FSe(),Pm.init(Wn),xi=0;xi<Wn.length;++xi)Wn[xi]=0;xi=0}return Pm.next()}function MSe(A){var I;for(I=0;I<A.length;++I)A[I]=DSe()}function NS(){}NS.prototype.nextBytes=MSe;function DS(){this.i=0,this.j=0,this.S=new Array}function LSe(A){var I,j,ie;for(I=0;I<256;++I)this.S[I]=I;for(j=0,I=0;I<256;++I)j=j+this.S[I]+A[I%A.length]&255,ie=this.S[I],this.S[I]=this.S[j],this.S[j]=ie;this.i=0,this.j=0}function USe(){var A;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,A=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=A,this.S[A+this.S[this.i]&255]}DS.prototype.init=LSe,DS.prototype.next=USe;function FSe(){return new DS}var MS=256;typeof dE!="undefined"?dE=ube.exports={default:i,BigInteger:i,SecureRandom:NS}:this.jsbn={BigInteger:i,SecureRandom:NS}}).call(dE)});var Ub=p(pE=>{u();(function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return i(s(o),arguments)}function t(o,a){return e.apply(null,[o].concat(a||[]))}function i(o,a){var c=1,f=o.length,l,h="",d,y,g,m,E,_,T,q;for(d=0;d<f;d++)if(typeof o[d]=="string")h+=o[d];else if(typeof o[d]=="object"){if(g=o[d],g.keys)for(l=a[c],y=0;y<g.keys.length;y++){if(l==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',g.keys[y],g.keys[y-1]));l=l[g.keys[y]]}else g.param_no?l=a[g.param_no]:l=a[c++];if(r.not_type.test(g.type)&&r.not_primitive.test(g.type)&&l instanceof Function&&(l=l()),r.numeric_arg.test(g.type)&&typeof l!="number"&&isNaN(l))throw new TypeError(e("[sprintf] expecting number but found %T",l));switch(r.number.test(g.type)&&(T=l>=0),g.type){case"b":l=parseInt(l,10).toString(2);break;case"c":l=String.fromCharCode(parseInt(l,10));break;case"d":case"i":l=parseInt(l,10);break;case"j":l=JSON.stringify(l,null,g.width?parseInt(g.width):0);break;case"e":l=g.precision?parseFloat(l).toExponential(g.precision):parseFloat(l).toExponential();break;case"f":l=g.precision?parseFloat(l).toFixed(g.precision):parseFloat(l);break;case"g":l=g.precision?String(Number(l.toPrecision(g.precision))):parseFloat(l);break;case"o":l=(parseInt(l,10)>>>0).toString(8);break;case"s":l=String(l),l=g.precision?l.substring(0,g.precision):l;break;case"t":l=String(!!l),l=g.precision?l.substring(0,g.precision):l;break;case"T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase(),l=g.precision?l.substring(0,g.precision):l;break;case"u":l=parseInt(l,10)>>>0;break;case"v":l=l.valueOf(),l=g.precision?l.substring(0,g.precision):l;break;case"x":l=(parseInt(l,10)>>>0).toString(16);break;case"X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase();break}r.json.test(g.type)?h+=l:(r.number.test(g.type)&&(!T||g.sign)?(q=T?"+":"-",l=l.toString().replace(r.sign,"")):q="",E=g.pad_char?g.pad_char==="0"?"0":g.pad_char.charAt(1):" ",_=g.width-(q+l).length,m=g.width&&_>0?E.repeat(_):"",h+=g.align?q+l+m:E==="0"?q+m+l:m+q+l)}return h}var n=Object.create(null);function s(o){if(n[o])return n[o];for(var a=o,c,f=[],l=0;a;){if((c=r.text.exec(a))!==null)f.push(c[0]);else if((c=r.modulo.exec(a))!==null)f.push("%");else if((c=r.placeholder.exec(a))!==null){if(c[2]){l|=1;var h=[],d=c[2],y=[];if((y=r.key.exec(d))!==null)for(h.push(y[1]);(d=d.substring(y[0].length))!=="";)if((y=r.key_access.exec(d))!==null)h.push(y[1]);else if((y=r.index_access.exec(d))!==null)h.push(y[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=h}else l|=2;if(l===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");f.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return n[o]=f}typeof pE!="undefined"&&(pE.sprintf=e,pE.vsprintf=t),typeof window!="undefined"&&(window.sprintf=e,window.vsprintf=t,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:t}}))})()});var v8=p(Va=>{u();"use strict";var Fft=Va&&Va.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Kft=Va&&Va.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),lbe=Va&&Va.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Fft(e,r,t);return Kft(e,r),e};Object.defineProperty(Va,"__esModule",{value:!0});Va.Address4=void 0;var fbe=lbe(g8()),Fo=lbe(b8()),hbe=hE(),Fb=m8(),r0=Ub(),jft=function(){function r(e){this.groups=Fo.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=fbe.isCorrect(Fo.BITS),this.isInSubnet=fbe.isInSubnet,this.address=e;var t=Fo.RE_SUBNET_STRING.exec(e);if(t){if(this.parsedSubnet=t[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>Fo.BITS)throw new hbe.AddressError("Invalid subnet mask.");e=e.replace(Fo.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.prototype.parse=function(e){var t=e.split(".");if(!e.match(Fo.RE_ADDRESS))throw new hbe.AddressError("Invalid IPv4 address.");return t},r.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},r.fromHex=function(e){var t=e.replace(/:/g,"").padStart(8,"0"),i=[],n;for(n=0;n<8;n+=2){var s=t.slice(n,n+2);i.push(parseInt(s,16))}return new r(i.join("."))},r.fromInteger=function(e){return r.fromHex(e.toString(16))},r.fromArpa=function(e){var t=e.replace(/(\.in-addr\.arpa)?\.$/,""),i=t.split(".").reverse().join(".");return new r(i)},r.prototype.toHex=function(){return this.parsedAddress.map(function(e){return r0.sprintf("%02x",parseInt(e,10))}).join(":")},r.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},r.prototype.toGroup6=function(){var e=[],t;for(t=0;t<Fo.GROUPS;t+=2){var i=r0.sprintf("%02x%02x",parseInt(this.parsedAddress[t],10),parseInt(this.parsedAddress[t+1],10));e.push(r0.sprintf("%x",parseInt(i,16)))}return e.join(":")},r.prototype.bigInteger=function(){return new Fb.BigInteger(this.parsedAddress.map(function(e){return r0.sprintf("%02x",parseInt(e,10))}).join(""),16)},r.prototype._startAddress=function(){return new Fb.BigInteger(this.mask()+"0".repeat(Fo.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new Fb.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new Fb.BigInteger(this.mask()+"1".repeat(Fo.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new Fb.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.fromBigInteger=function(e){return r.fromInteger(parseInt(e.toString(),10))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.reverseForm=function(e){e||(e={});var t=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?t:r0.sprintf("%s.in-addr.arpa.",t)},r.prototype.isMulticast=function(){return this.isInSubnet(new r("224.0.0.0/4"))},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(Fo.BITS,"0")},r.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(Fo.RE_ADDRESS,r0.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},r}();Va.Address4=jft});var w8=p(ei=>{u();"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.RE_URL_WITH_PORT=ei.RE_URL=ei.RE_ZONE_STRING=ei.RE_SUBNET_STRING=ei.RE_BAD_ADDRESS=ei.RE_BAD_CHARACTERS=ei.TYPES=ei.SCOPES=ei.GROUPS=ei.BITS=void 0;ei.BITS=128;ei.GROUPS=8;ei.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};ei.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};ei.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;ei.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;ei.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;ei.RE_ZONE_STRING=/%.*$/;ei.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);ei.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var _8=p(za=>{u();"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.simpleGroup=za.spanLeadingZeroes=za.spanAll=za.spanAllZeroes=void 0;var dbe=Ub();function pbe(r){return r.replace(/(0+)/g,'<span class="zero">$1</span>')}za.spanAllZeroes=pbe;function Vft(r,e){e===void 0&&(e=0);var t=r.split("");return t.map(function(i,n){return dbe.sprintf('<span class="digit value-%s position-%d">%s</span>',i,n+e,pbe(i))}).join("")}za.spanAll=Vft;function ybe(r){return r.replace(/^(0+)/,'<span class="zero">$1</span>')}function zft(r){var e=r.split(":");return e.map(function(t){return ybe(t)}).join(":")}za.spanLeadingZeroes=zft;function Hft(r,e){e===void 0&&(e=0);var t=r.split(":");return t.map(function(i,n){return/group-v4/.test(i)?i:dbe.sprintf('<span class="hover-group group-%d">%s</span>',n+e,ybe(i))})}za.simpleGroup=Hft});var gbe=p(Vi=>{u();"use strict";var $ft=Vi&&Vi.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Gft=Vi&&Vi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Wft=Vi&&Vi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$ft(e,r,t);return Gft(e,r),e};Object.defineProperty(Vi,"__esModule",{value:!0});Vi.possibleElisions=Vi.simpleRegularExpression=Vi.ADDRESS_BOUNDARY=Vi.padGroup=Vi.groupPossibilities=void 0;var Yft=Wft(w8()),i0=Ub();function yE(r){return i0.sprintf("(%s)",r.join("|"))}Vi.groupPossibilities=yE;function gE(r){return r.length<4?i0.sprintf("0{0,%d}%s",4-r.length,r):r}Vi.padGroup=gE;Vi.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function Xft(r){var e=[];r.forEach(function(i,n){var s=parseInt(i,16);s===0&&e.push(n)});var t=e.map(function(i){return r.map(function(n,s){if(s===i){var o=s===0||s===Yft.GROUPS-1?":":"";return yE([gE(n),o])}return gE(n)}).join(":")});return t.push(r.map(gE).join(":")),yE(t)}Vi.simpleRegularExpression=Xft;function Qft(r,e,t){var i=e?"":":",n=t?"":":",s=[];!e&&!t&&s.push("::"),e&&t&&s.push(""),(t&&!e||!t&&e)&&s.push(":"),s.push(i0.sprintf("%s(:0{1,4}){1,%d}",i,r-1)),s.push(i0.sprintf("(0{1,4}:){1,%d}%s",r-1,n)),s.push(i0.sprintf("(0{1,4}:){%d}0{1,4}",r-1));for(var o=1;o<r-1;o++)for(var a=1;a<r-o;a++)s.push(i0.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,r-a-o-1));return yE(s)}Vi.possibleElisions=Qft});var _be=p(Vs=>{u();"use strict";var Jft=Vs&&Vs.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Zft=Vs&&Vs.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),bE=Vs&&Vs.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Jft(e,r,t);return Zft(e,r),e},bbe=Vs&&Vs.__spreadArray||function(r,e){for(var t=0,i=e.length,n=r.length;t<i;t++,n++)r[n]=e[t];return r};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.Address6=void 0;var mbe=bE(g8()),E8=bE(b8()),hr=bE(w8()),S8=bE(_8()),Xf=v8(),Qf=gbe(),Fc=hE(),Tn=m8(),Rn=Ub();function mE(r){if(!r)throw new Error("Assertion failed.")}function eht(r){for(var e=/(\d+)(\d{3})/;e.test(r);)r=r.replace(e,"$1,$2");return r}function tht(r){return r=r.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),r=r.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),r}function rht(r,e){var t=[],i=[],n;for(n=0;n<r.length;n++)n<e[0]?t.push(r[n]):n>e[1]&&i.push(r[n]);return t.concat(["compact"]).concat(i)}function vbe(r){return Rn.sprintf("%04x",parseInt(r,16))}function wbe(r){return r&255}var iht=function(){function r(e,t){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=mbe.isInSubnet,this.isCorrect=mbe.isCorrect(hr.BITS),t===void 0?this.groups=hr.GROUPS:this.groups=t,this.address=e;var i=hr.RE_SUBNET_STRING.exec(e);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>hr.BITS)throw new Fc.AddressError("Invalid subnet mask.");e=e.replace(hr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new Fc.AddressError("Invalid subnet mask.");var n=hr.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(hr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.fromBigInteger=function(e){var t=e.toString(16).padStart(32,"0"),i=[],n;for(n=0;n<hr.GROUPS;n++)i.push(t.slice(n*4,(n+1)*4));return new r(i.join(":"))},r.fromURL=function(e){var t,i=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=hr.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};t=n[1],i=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=hr.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};t=n[1]}else t=e;return i?(i=parseInt(i,10),(i<0||i>65536)&&(i=null)):i=null,{address:new r(t),port:i}},r.fromAddress4=function(e){var t=new Xf.Address4(e),i=hr.BITS-(E8.BITS-t.subnetMask);return new r("::ffff:"+t.correctForm()+"/"+i)},r.fromArpa=function(e){var t=e.replace(/(\.ip6\.arpa)?\.$/,""),i=7;if(t.length!==63)throw new Fc.AddressError("Invalid 'ip6.arpa' form.");for(var n=t.split(".").reverse(),s=i;s>0;s--){var o=s*4;n.splice(o,0,":")}return t=n.join(""),new r(t)},r.prototype.microsoftTranscription=function(){return Rn.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var t=hr.BITS-this.subnetMask,i=Math.abs(e-hr.BITS),n=t-i;return n<0?"0":eht(new Tn.BigInteger("2",10).pow(n).toString(10))},r.prototype._startAddress=function(){return new Tn.BigInteger(this.mask()+"0".repeat(hr.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new Tn.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new Tn.BigInteger(this.mask()+"1".repeat(hr.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new Tn.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.prototype.getScope=function(){var e=hr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"},r.prototype.getType=function(){for(var e=0,t=Object.keys(hr.TYPES);e<t.length;e++){var i=t[e];if(this.isInSubnet(new r(i)))return hr.TYPES[i]}return"Global unicast"},r.prototype.getBits=function(e,t){return new Tn.BigInteger(this.getBitsBase2(e,t),2)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.getBitsBase16=function(e,t){var i=t-e;if(i%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,t).toString(16).padStart(i/4,"0")},r.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,hr.BITS)},r.prototype.reverseForm=function(e){e||(e={});var t=Math.floor(this.subnetMask/4),i=this.canonicalForm().replace(/:/g,"").split("").slice(0,t).reverse().join(".");return t>0?e.omitSuffix?i:Rn.sprintf("%s.ip6.arpa.",i):e.omitSuffix?"":"ip6.arpa."},r.prototype.correctForm=function(){var e,t=[],i=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&i++,s!==0&&i>0&&(i>1&&n.push([e-i,e-1]),i=0)}i>1&&n.push([this.parsedAddress.length-i,this.parsedAddress.length-1]);var o=n.map(function(f){return f[1]-f[0]+1});if(n.length>0){var a=o.indexOf(Math.max.apply(Math,o));t=rht(this.parsedAddress,n[a])}else t=this.parsedAddress;for(e=0;e<t.length;e++)t[e]!=="compact"&&(t[e]=parseInt(t[e],16).toString(16));var c=t.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(hr.BITS,"0")},r.prototype.parse4in6=function(e){var t=e.split(":"),i=t.slice(-1)[0],n=i.match(E8.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new Xf.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new Fc.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(E8.RE_ADDRESS,this.address4.parsedAddress.map(tht).join(".")));this.v4=!0,t[t.length-1]=this.address4.toGroup6(),e=t.join(":")}return e},r.prototype.parse=function(e){e=this.parse4in6(e);var t=e.match(hr.RE_BAD_CHARACTERS);if(t)throw new Fc.AddressError(Rn.sprintf("Bad character%s detected in address: %s",t.length>1?"s":"",t.join("")),e.replace(hr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var i=e.match(hr.RE_BAD_ADDRESS);if(i)throw new Fc.AddressError(Rn.sprintf("Address failed regex: %s",i.join("")),e.replace(hr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new Fc.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var f=0;f<c;f++)n.push("0");n=n.concat(a)}else if(s.length===1)n=e.split(":"),this.elidedGroups=0;else throw new Fc.AddressError("Too many :: groups found");if(n=n.map(function(l){return Rn.sprintf("%x",parseInt(l,16))}),n.length!==this.groups)throw new Fc.AddressError("Incorrect number of groups found");return n},r.prototype.canonicalForm=function(){return this.parsedAddress.map(vbe).join(":")},r.prototype.decimal=function(){return this.parsedAddress.map(function(e){return Rn.sprintf("%05d",parseInt(e,16))}).join(":")},r.prototype.bigInteger=function(){return new Tn.BigInteger(this.parsedAddress.map(vbe).join(""),16)},r.prototype.to4=function(){var e=this.binaryZeroPad().split("");return Xf.Address4.fromHex(new Tn.BigInteger(e.slice(96,128).join(""),2).toString(16))},r.prototype.to4in6=function(){var e=this.to4(),t=new r(this.parsedAddress.slice(0,6).join(":"),6),i=t.correctForm(),n="";return/:$/.test(i)||(n=":"),i+n+e.address},r.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),t=this.getBits(80,96).xor(new Tn.BigInteger("ffff",16)).toString(),i=Xf.Address4.fromHex(this.getBitsBase16(32,64)),n=Xf.Address4.fromHex(this.getBits(96,128).xor(new Tn.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),f=s.testBit(8),l=s.testBit(9),h=new Tn.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Rn.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:i.address,client4:n.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:l,groupIndividual:f,nonce:h},udpPort:t}},r.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),t=Xf.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Rn.sprintf("%s",e.slice(0,4)),gateway:t.address}},r.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new r(e)},r.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},r.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(wbe)},r.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(wbe))},r.fromUnsignedByteArray=function(e){for(var t=new Tn.BigInteger("256",10),i=new Tn.BigInteger("0",10),n=new Tn.BigInteger("1",10),s=e.length-1;s>=0;s--)i=i.add(n.multiply(new Tn.BigInteger(e[s].toString(10),10))),n=n.multiply(t);return r.fromBigInteger(i)},r.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},r.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},r.prototype.isMulticast=function(){return this.getType()==="Multicast"},r.prototype.is4=function(){return this.v4},r.prototype.isTeredo=function(){return this.isInSubnet(new r("2001::/32"))},r.prototype.is6to4=function(){return this.isInSubnet(new r("2002::/16"))},r.prototype.isLoopback=function(){return this.getType()==="Loopback"},r.prototype.href=function(e){return e===void 0?e="":e=Rn.sprintf(":%s",e),Rn.sprintf("http://[%s]%s/",this.correctForm(),e)},r.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var t=this.correctForm;return e.v4&&(t=this.to4in6),e.className?Rn.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,t.call(this),e.className):Rn.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,t.call(this))},r.prototype.group=function(){if(this.elidedGroups===0)return S8.simpleGroup(this.address).join(":");mE(typeof this.elidedGroups=="number"),mE(typeof this.elisionBegin=="number");var e=[],t=this.address.split("::"),i=t[0],n=t[1];i.length?e.push.apply(e,S8.simpleGroup(i)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(Rn.sprintf("group-%d",o));return e.push(Rn.sprintf('<span class="%s"></span>',s.join(" "))),n.length?e.push.apply(e,S8.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(mE(this.address4 instanceof Xf.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},r.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var t=[],i=new r(this.correctForm());if(i.elidedGroups===0)t.push(Qf.simpleRegularExpression(i.parsedAddress));else if(i.elidedGroups===hr.GROUPS)t.push(Qf.possibleElisions(hr.GROUPS));else{var n=i.address.split("::");n[0].length&&t.push(Qf.simpleRegularExpression(n[0].split(":"))),mE(typeof i.elidedGroups=="number"),t.push(Qf.possibleElisions(i.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&t.push(Qf.simpleRegularExpression(n[1].split(":"))),t=[t.join(":")]}return e||(t=bbe(bbe(["(?=^|",Qf.ADDRESS_BOUNDARY,"|[^\\w\\:])("],t),[")(?=[^\\w\\:]|",Qf.ADDRESS_BOUNDARY,"|$)"])),t.join("")},r.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},r}();Vs.Address6=iht});var Ebe=p(hn=>{u();"use strict";var nht=hn&&hn.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),sht=hn&&hn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),oht=hn&&hn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&nht(e,r,t);return sht(e,r),e};Object.defineProperty(hn,"__esModule",{value:!0});hn.v6=hn.AddressError=hn.Address6=hn.Address4=void 0;var aht=v8();Object.defineProperty(hn,"Address4",{enumerable:!0,get:function(){return aht.Address4}});var cht=_be();Object.defineProperty(hn,"Address6",{enumerable:!0,get:function(){return cht.Address6}});var uht=hE();Object.defineProperty(hn,"AddressError",{enumerable:!0,get:function(){return uht.AddressError}});var lht=oht(_8());hn.v6={helpers:lht}});var T8=p((ukt,I8)=>{u();"use strict";var Sbe=me(),fht=Object.assign(Sbe("libp2p:ip-port-to-multiaddr"),{error:Sbe("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:A8}=et(),x8=ue(),{Address4:hht,Address6:dht}=Ebe(),vE={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function pht(r,e){if(typeof r!="string")throw x8(new Error(`invalid ip provided: ${r}`),vE.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw x8(new Error(`invalid port provided: ${e}`),vE.ERR_INVALID_PORT_PARAMETER);try{return new hht(r),new A8(`/ip4/${r}/tcp/${e}`)}catch{}try{let t=new dht(r);return t.is4()?new A8(`/ip4/${t.to4().correctForm()}/tcp/${e}`):new A8(`/ip6/${r}/tcp/${e}`)}catch(t){let i=`invalid ip:port for creating a multiaddr: ${r}:${e}`;throw fht.error(i),x8(new Error(i),vE.ERR_INVALID_IP)}}I8.exports=pht;I8.exports.Errors=vE});var xbe=p((lkt,wE)=>{u();"use strict";var R8=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},Abe=(r,e,t,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(r);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{o(t())}catch(l){a(l)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,f=t instanceof Error?t:new R8(c);typeof r.cancel=="function"&&r.cancel(),a(f)},e),(async()=>{try{o(await r)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};wE.exports=Abe;wE.exports.default=Abe;wE.exports.TimeoutError=R8});var Cbe=p((fkt,Pbe)=>{u();"use strict";var Ibe=Da(),{CLOSE_TIMEOUT:yht}=y8(),Tbe=T8(),ght=xbe(),Rbe=me(),P8=Rbe("libp2p:websockets:socket");P8.error=Rbe("libp2p:websockets:socket:error");Pbe.exports=(r,e={})=>{let t={async sink(i){e.signal&&(i=Ibe(i,e.signal));try{await r.sink(async function*(){for await(let n of i)yield n instanceof Uint8Array?n:n.slice()}())}catch(n){n.type!=="aborted"&&P8.error(n)}},source:e.signal?Ibe(r.source,e.signal):r.source,conn:r,localAddr:e.localAddr||(r.localAddress&&r.localPort?Tbe(r.localAddress,r.localPort):void 0),remoteAddr:e.remoteAddr||Tbe(r.remoteAddress,r.remotePort),timeline:{open:Date.now()},async close(){let i=Date.now();try{await ght(r.close(),yht)}catch(n){let{host:s,port:o}=t.remoteAddr.toOptions();P8("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-i),r.destroy()}finally{t.timeline.close=Date.now()}}};return r.socket.once&&r.socket.once("close",()=>{t.timeline.close||(t.timeline.close=Date.now())}),t}});var kbe=p((hkt,qbe)=>{u();"use strict";var al=zl(),{CODE_CIRCUIT:C8,CODE_P2P:O8,CODE_TCP:q8,CODE_WS:bht,CODE_WSS:Obe}=y8();qbe.exports={all:r=>r.filter(e=>{if(e.protoCodes().includes(C8))return!1;let t=e.decapsulateCode(O8);return al.WebSockets.matches(t)||al.WebSocketsSecure.matches(t)}),dnsWss:r=>r.filter(e=>{if(e.protoCodes().includes(C8))return!1;let t=e.decapsulateCode(O8);return al.WebSocketsSecure.matches(t)&&al.DNS.matches(t.decapsulateCode(q8).decapsulateCode(Obe))}),dnsWsOrWss:r=>r.filter(e=>{if(e.protoCodes().includes(C8))return!1;let t=e.decapsulateCode(O8);return al.WebSockets.matches(t)?al.DNS.matches(t.decapsulateCode(q8).decapsulateCode(bht)):al.WebSocketsSecure.matches(t)&&al.DNS.matches(t.decapsulateCode(q8).decapsulateCode(Obe))})}});var Fbe=p((dkt,Ube)=>{u();"use strict";var mht=obe(),vht=Q1(),wht=Lw(),{AbortError:Bbe}=Da(),_ht=Qu(),Nbe=me(),cl=Nbe("libp2p:websockets");cl.error=Nbe("libp2p:websockets:error");var Dbe=G0(),Eht=cbe(),Sht=Cbe(),Mbe=kbe(),Lbe=class{constructor({upgrader:e,filter:t}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=t}async dial(e,t={}){cl("dialing %s",e);let i=await this._connect(e,t),n=Sht(i,{remoteAddr:e,signal:t.signal});cl("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return cl("outbound connection %s upgraded",n.remoteAddr),s}async _connect(e,t={}){if(t.signal&&t.signal.aborted)throw new Bbe;let i=e.toOptions();cl("dialing %s:%s",i.host,i.port);let n=_ht(),s=f=>{let l=`connection error: ${f.message}`;cl.error(l),n.reject(f)},o=mht(wht(e),Object.assign({binary:!0},t));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!t.signal)return await Promise.race([o.connected(),n.promise]),cl("connected %s",e),o;let a,c=new Promise((f,l)=>{if(a=()=>{l(new Bbe),setTimeout(()=>{o.close()})},t.signal.aborted)return a();t.signal.addEventListener("abort",a)});try{await Promise.race([c,n.promise,o.connected()])}finally{t.signal.removeEventListener("abort",a)}return cl("connected %s",e),o}createListener(e={},t){return typeof e=="function"&&(t=e,e={}),Eht({handler:t,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):Dbe.isBrowser||Dbe.isWebWorker?Mbe.dnsWss(e):Mbe.all(e)}};Ube.exports=vht(Lbe,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var jbe=p((pkt,Kbe)=>{u();Kbe.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var N8=p((ykt,B8)=>{u();"use strict";var k8=65536,Aht=4294967295;function xht(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Iht=h5().Buffer,_E=globalThis.crypto||globalThis.msCrypto;_E&&_E.getRandomValues?B8.exports=Tht:B8.exports=xht;function Tht(r,e){if(r>Aht)throw new RangeError("requested too many random bytes");var t=Iht.allocUnsafe(r);if(r>0)if(r>k8)for(var i=0;i<r;i+=k8)_E.getRandomValues(t.slice(i,i+k8));else _E.getRandomValues(t);return typeof e=="function"?process.nextTick(function(){e(null,t)}):t}});var Hbe=p((gkt,zbe)=>{u();"use strict";function Vbe(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Rht(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=void 0),e!=null&&(t.code=e);try{return Vbe(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Vbe(new n,t)}}zbe.exports=Rht});var L8=p((bkt,Ybe)=>{u();var Pht=me()("simple-peer"),$be=jbe(),Gbe=N8(),Cht=R5(),D8=E_(),dr=Hbe(),M8=64*1024,Oht=5*1e3,qht=5*1e3;function Wbe(r){return r.replace(/a=ice-options:trickle\s\n/g,"")}function kht(r){console.warn(r)}var ul=class extends Cht.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=Gbe(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||Gbe(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||ul.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},ul.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(t=>t),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||Oht,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:$be(),!this._wrtc)throw typeof window=="undefined"?dr(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):dr(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){D8(()=>this.destroy(dr(t,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this.streams&&this.streams.forEach(t=>{this.addStream(t)}),this._pc.ontrack=t=>{this._onTrack(t)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw dr(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(t=>{this._addIceCandidate(t)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(t=>{this.destroy(dr(t,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(dr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(i=>{!t.address||t.address.endsWith(".local")?kht("Ignoring unsupported ICE candidate."):this.destroy(dr(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(i){this.destroy(dr(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,n=i.get(t);if(!n)n=this._pc.addTrack(e,t),i.set(t,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?dr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):dr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,t,i){this._debug("replaceTrack()");var n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw dr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,n),s.replaceTrack!=null?s.replaceTrack(t):this.destroy(dr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");var i=this._senderMap.get(e),n=i?i.get(t):null;if(!n)throw dr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(dr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,D8(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,t){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(i){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(i){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,t(e)}_setupData(e){if(!e.channel)return this.destroy(dr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=M8),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(dr(i,"ERR_DATA_CHANNEL"))};var t=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(t&&this._onChannelClose(),t=!0):t=!1},qht)}_read(){}_write(e,t,i){if(this.destroyed)return i(dr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.destroy(dr(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>M8?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Wbe(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(dr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Wbe(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},i=()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(dr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(dr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(dr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(dr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let t=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var n=[];i.forEach(s=>{n.push(t(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var n=[];i.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(t(o))}),e(null,n)}},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((t,i)=>{if(this.destroyed)return;t&&(i=[]);var n={},s={},o={},a=!1;i.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(n[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(o[l.id]=l)});let c=l=>{a=!0;var h=s[l.localCandidateId];h&&(h.ip||h.address)?(this.localAddress=h.ip||h.address,this.localPort=Number(h.port)):h&&h.ipAddress?(this.localAddress=h.ipAddress,this.localPort=Number(h.portNumber)):typeof l.googLocalAddress=="string"&&(h=l.googLocalAddress.split(":"),this.localAddress=h[0],this.localPort=Number(h[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var d=n[l.remoteCandidateId];d&&(d.ip||d.address)?(this.remoteAddress=d.ip||d.address,this.remotePort=Number(d.port)):d&&d.ipAddress?(this.remoteAddress=d.ipAddress,this.remotePort=Number(d.portNumber)):typeof l.googRemoteAddress=="string"&&(d=l.googRemoteAddress.split(":"),this.remoteAddress=d[0],this.remotePort=Number(d[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(o[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(l){return this.destroy(dr(l,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var f=this._cb;this._cb=null,f(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>M8||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),this.push(t)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),!this._remoteStreams.some(i=>i.id===t.id)&&(this._remoteStreams.push(t),D8(()=>{this.emit("stream",t)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],Pht.apply(null,e)}};ul.WEBRTC_SUPPORT=!!$be();ul.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};ul.channelConfig={};Ybe.exports=ul});var Qbe=p((mkt,Xbe)=>{u();"use strict";Xbe.exports={supportsFileReader:typeof self!="undefined"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator!="undefined"&&typeof navigator.mediaDevices!="undefined"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var SE=p(EE=>{u();"use strict";EE.CODE_P2P=421;EE.CODE_CIRCUIT=290;EE.CLOSE_TIMEOUT=2e3});var U8=p((wkt,Jbe)=>{u();var Bht=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Nht=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];Jbe.exports=function(e){var t=e,i=e.indexOf("["),n=e.indexOf("]");i!=-1&&n!=-1&&(e=e.substring(0,i)+e.substring(i,n).replace(/:/g,";")+e.substring(n,e.length));for(var s=Bht.exec(e||""),o={},a=14;a--;)o[Nht[a]]=s[a]||"";return i!=-1&&n!=-1&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=Dht(o,o.path),o.queryKey=Mht(o,o.query),o};function Dht(r,e){var t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&i.splice(0,1),e.substr(e.length-1,1)=="/"&&i.splice(i.length-1,1),i}function Mht(r,e){var t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(t[n]=s)}),t}});var eme=p(AE=>{u();"use strict";Object.defineProperty(AE,"__esModule",{value:!0});AE.url=void 0;var Lht=U8(),Zbe=me()("socket.io-client:url");function Uht(r,e="",t){let i=r;t=t||typeof location!="undefined"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(Zbe("protocol-less url %s",r),typeof t!="undefined"?r=t.protocol+"//"+r:r="https://"+r),Zbe("parse %s",r),i=Lht(r)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(t&&t.port===i.port?"":":"+i.port),i}AE.url=Uht});var tme=p((Ekt,F8)=>{u();try{F8.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(r){F8.exports=!1}});var Kb=p((Skt,rme)=>{u();rme.exports=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())()});var K8=p((Akt,ime)=>{u();var Fht=tme(),Kht=Kb();ime.exports=function(r){let e=r.xdomain,t=r.xscheme,i=r.enablesXDR;try{if(typeof XMLHttpRequest!="undefined"&&(!e||Fht))return new XMLHttpRequest}catch(n){}try{if(typeof XDomainRequest!="undefined"&&!t&&i)return new XDomainRequest}catch(n){}if(!e)try{return new Kht[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(n){}}});var j8=p((xkt,sme)=>{u();var Ha=Object.create(null);Ha.open="0";Ha.close="1";Ha.ping="2";Ha.pong="3";Ha.message="4";Ha.upgrade="5";Ha.noop="6";var nme=Object.create(null);Object.keys(Ha).forEach(r=>{nme[Ha[r]]=r});var jht={type:"error",data:"parser error"};sme.exports={PACKET_TYPES:Ha,PACKET_TYPES_REVERSE:nme,ERROR_PACKET:jht}});var cme=p((Ikt,ame)=>{u();var{PACKET_TYPES:Vht}=j8(),zht=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Hht=typeof ArrayBuffer=="function",$ht=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,Ght=({type:r,data:e},t,i)=>zht&&e instanceof Blob?t?i(e):ome(e,i):Hht&&(e instanceof ArrayBuffer||$ht(e))?t?i(e instanceof ArrayBuffer?e:e.buffer):ome(new Blob([e]),i):i(Vht[r]+(e||"")),ome=(r,e)=>{let t=new FileReader;return t.onload=function(){let i=t.result.split(",")[1];e("b"+i)},t.readAsDataURL(r)};ame.exports=Ght});var ume=p(V8=>{u();(function(r){"use strict";V8.encode=function(e){var t=new Uint8Array(e),i,n=t.length,s="";for(i=0;i<n;i+=3)s+=r[t[i]>>2],s+=r[(t[i]&3)<<4|t[i+1]>>4],s+=r[(t[i+1]&15)<<2|t[i+2]>>6],s+=r[t[i+2]&63];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},V8.decode=function(e){var t=e.length*.75,i=e.length,n,s=0,o,a,c,f;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var l=new ArrayBuffer(t),h=new Uint8Array(l);for(n=0;n<i;n+=4)o=r.indexOf(e[n]),a=r.indexOf(e[n+1]),c=r.indexOf(e[n+2]),f=r.indexOf(e[n+3]),h[s++]=o<<2|a>>4,h[s++]=(a&15)<<4|c>>2,h[s++]=(c&3)<<6|f&63;return l}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")});var hme=p((Rkt,fme)=>{u();var{PACKET_TYPES_REVERSE:z8,ERROR_PACKET:Wht}=j8(),Yht=typeof ArrayBuffer=="function",H8;Yht&&(H8=ume());var Xht=(r,e)=>{if(typeof r!="string")return{type:"message",data:lme(r,e)};let t=r.charAt(0);return t==="b"?{type:"message",data:Qht(r.substring(1),e)}:z8[t]?r.length>1?{type:z8[t],data:r.substring(1)}:{type:z8[t]}:Wht},Qht=(r,e)=>{if(H8){let t=H8.decode(r);return lme(t,e)}else return{base64:!0,data:r}},lme=(r,e)=>{switch(e){case"blob":return r instanceof ArrayBuffer?new Blob([r]):r;case"arraybuffer":default:return r}};fme.exports=Xht});var n0=p((Pkt,gme)=>{u();var dme=cme(),pme=hme(),yme=String.fromCharCode(30),Jht=(r,e)=>{let t=r.length,i=new Array(t),n=0;r.forEach((s,o)=>{dme(s,!1,a=>{i[o]=a,++n===t&&e(i.join(yme))})})},Zht=(r,e)=>{let t=r.split(yme),i=[];for(let n=0;n<t.length;n++){let s=pme(t[n],e);if(i.push(s),s.type==="error")break}return i};gme.exports={protocol:4,encodePacket:dme,encodePayload:Jht,decodePacket:pme,decodePayload:Zht}});var s0=p((Ckt,$8)=>{u();typeof $8!="undefined"&&($8.exports=ls);function ls(r){if(r)return edt(r)}function edt(r){for(var e in ls.prototype)r[e]=ls.prototype[e];return r}ls.prototype.on=ls.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};ls.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};ls.prototype.off=ls.prototype.removeListener=ls.prototype.removeAllListeners=ls.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var i,n=0;n<t.length;n++)if(i=t[n],i===e||i.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+r],this};ls.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,n=t.length;i<n;++i)t[i].apply(this,e)}return this};ls.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};ls.prototype.hasListeners=function(r){return!!this.listeners(r).length}});var xE=p((Okt,mme)=>{u();var tdt=n0(),rdt=s0(),idt=me()("engine.io-client:transport"),bme=class extends rdt{constructor(e){super();this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t){let i=new Error(e);return i.type="TransportError",i.description=t,this.emit("error",i),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):idt("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){let t=tdt.decodePacket(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}};mme.exports=bme});var IE=p(G8=>{u();G8.encode=function(r){var e="";for(var t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e};G8.decode=function(r){for(var e={},t=r.split("&"),i=0,n=t.length;i<n;i++){var s=t[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}});var X8=p((kkt,Sme)=>{u();"use strict";var vme="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),TE=64,wme={},_me=0,ll=0,Eme;function W8(r){var e="";do e=vme[r%TE]+e,r=Math.floor(r/TE);while(r>0);return e}function ndt(r){var e=0;for(ll=0;ll<r.length;ll++)e=e*TE+wme[r.charAt(ll)];return e}function Y8(){var r=W8(+new Date);return r!==Eme?(_me=0,Eme=r):r+"."+W8(_me++)}for(;ll<TE;ll++)wme[vme[ll]]=ll;Y8.encode=W8;Y8.decode=ndt;Sme.exports=Y8});var Q8=p((Bkt,Ime)=>{u();var sdt=xE(),odt=IE(),Ame=n0(),adt=X8(),Ko=me()("engine.io-client:polling"),xme=class extends sdt{get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{Ko("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(Ko("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){Ko("pre-pause polling complete"),--i||t()})),this.writable||(Ko("we are currently writing - waiting to pause"),i++,this.once("drain",function(){Ko("pre-pause writing complete"),--i||t()}))}else t()}poll(){Ko("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){Ko("polling got data %s",e);let t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose(),!1;this.onPacket(i)};Ame.decodePayload(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():Ko('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{Ko("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(Ko("transport open - closing"),e()):(Ko("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,Ame.encodePayload(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{},t=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=adt()),!this.supportsBinary&&!e.sid&&(e.b64=1),e=odt.encode(e),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}};Ime.exports=xme});var J8=p((Nkt,Tme)=>{u();Tme.exports.pick=(r,...e)=>e.reduce((t,i)=>(r.hasOwnProperty(i)&&(t[i]=r[i]),t),{})});var qme=p((Dkt,eP)=>{u();var Rme=K8(),cdt=Q8(),udt=s0(),{pick:ldt}=J8(),fdt=Kb(),Z8=me()("engine.io-client:polling-xhr");function Pme(){}var hdt=function(){return new Rme({xdomain:!1}).responseType!=null}(),Cme=class extends cdt{constructor(e){super(e);if(typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?443:80),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==i}let t=e&&e.forceBase64;this.supportsBinary=hdt&&!t}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new zs(this.uri(),e)}doWrite(e,t){let i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",n=>{this.onError("xhr post error",n)})}doPoll(){Z8("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",t=>{this.onError("xhr poll error",t)}),this.pollXhr=e}},zs=class extends udt{constructor(e,t){super();this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){let e=ldt(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let t=this.xhr=new Rme(e);try{Z8("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{t.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),this.hasXDR()?(t.onload=()=>{this.onLoad()},t.onerror=()=>{this.onError(t.responseText)}):t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():setTimeout(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},Z8("xhr data %s",this.data),t.send(this.data)}catch(i){setTimeout(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=zs.requestsCount++,zs.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=Pme:this.xhr.onreadystatechange=Pme,e)try{this.xhr.abort()}catch(t){}typeof document!="undefined"&&delete zs.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&this.onData(e)}hasXDR(){return typeof XDomainRequest!="undefined"&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}};zs.requestsCount=0;zs.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",Ome);else if(typeof addEventListener=="function"){let r="onpagehide"in fdt?"pagehide":"unload";addEventListener(r,Ome,!1)}}function Ome(){for(let r in zs.requests)zs.requests.hasOwnProperty(r)&&zs.requests[r].abort()}eP.exports=Cme;eP.exports.Request=zs});var Dme=p((Mkt,Nme)=>{u();var ddt=Q8(),kme=Kb(),pdt=/\n/g,ydt=/\\n/g,RE,Bme=class extends ddt{constructor(e){super(e);this.query=this.query||{},RE||(RE=kme.___eio=kme.___eio||[]),this.index=RE.length,RE.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){let e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=n=>{this.onError("jsonp poll error",n)};let t=document.getElementsByTagName("script")[0];t?t.parentNode.insertBefore(e,t):(document.head||document.body).appendChild(e),this.script=e,typeof navigator!="undefined"&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){let n=document.createElement("iframe");document.body.appendChild(n),document.body.removeChild(n)},100)}doWrite(e,t){let i;if(!this.form){let o=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}this.form.action=this.uri();function n(){s(),t()}let s=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(o){this.onError("jsonp polling iframe removal error",o)}try{let o='<iframe src="javascript:0" name="'+this.iframeId+'">';i=document.createElement(o)}catch(o){i=document.createElement("iframe"),i.name=this.iframeId,i.src="javascript:0"}i.id=this.iframeId,this.form.appendChild(i),this.iframe=i};s(),e=e.replace(ydt,`\\
`),this.area.value=e.replace(pdt,"\\n");try{this.form.submit()}catch(o){}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{this.iframe.readyState==="complete"&&n()}:this.iframe.onload=n}};Nme.exports=Bme});var Ume=p((Lkt,Lme)=>{u();var Mme=Kb(),gdt=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):e=>setTimeout(e,0))();Lme.exports={WebSocket:Mme.WebSocket||Mme.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:gdt}});var Vme=p((Ukt,jme)=>{u();var Fme=xE(),bdt=n0(),mdt=IE(),vdt=X8(),{pick:wdt}=J8(),{WebSocket:jb,usingBrowserWebSocket:tP,defaultBinaryType:_dt,nextTick:Edt}=Ume(),Sdt=me()("engine.io-client:websocket"),Kme=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",PE=class extends Fme{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,i=Kme?{}:wdt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=tP&&!Kme?t?new jb(e,t):new jb(e):new jb(e,t,i)}catch(n){return this.emit("error",n)}this.ws.binaryType=this.socket.binaryType||_dt,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let i=e[t],n=t===e.length-1;bdt.encodePacket(i,this.supportsBinary,s=>{let o={};tP||(i.options&&(o.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{tP?this.ws.send(s):this.ws.send(s,o)}catch(a){Sdt("websocket closed before onclose event")}n&&Edt(()=>{this.writable=!0,this.emit("drain")})})}}onClose(){Fme.prototype.onClose.call(this)}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},t=this.opts.secure?"wss":"ws",i="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=vdt()),this.supportsBinary||(e.b64=1),e=mdt.encode(e),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}check(){return!!jb&&!("__initialize"in jb&&this.name===PE.prototype.name)}};jme.exports=PE});var iP=p(rP=>{u();var Adt=K8(),xdt=qme(),Idt=Dme(),Tdt=Vme();rP.polling=Rdt;rP.websocket=Tdt;function Rdt(r){let e,t=!1,i=!1,n=r.jsonp!==!1;if(typeof location!="undefined"){let s=location.protocol==="https:",o=location.port;o||(o=s?443:80),t=r.hostname!==location.hostname||o!==r.port,i=r.secure!==s}if(r.xdomain=t,r.xscheme=i,e=new Adt(r),"open"in e&&!r.forceJSONP)return new xdt(r);if(!n)throw new Error("JSONP disabled");return new Idt(r)}});var Gme=p((Kkt,$me)=>{u();var Pdt=iP(),Cdt=s0(),ai=me()("engine.io-client:socket"),zme=n0(),Hme=U8(),Odt=IE(),$a=class extends Cdt{constructor(e,t={}){super();e&&typeof e=="object"&&(t=e,e=null),e?(e=Hme(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=Hme(t.host).host),this.secure=t.secure!=null?t.secure:typeof location!="undefined"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=t.port||(typeof location!="undefined"&&location.port?location.port:this.secure?443:80),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=Odt.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){ai('creating transport "%s"',e);let t=qdt(this.opts.query);t.EIO=zme.protocol,t.transport=e,this.id&&(t.sid=this.id);let i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return ai("options: %j",i),new Pdt[e](i)}open(){let e;if(this.opts.rememberUpgrade&&$a.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){setTimeout(()=>{this.emit("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(t){ai("error while creating transport: %s",t),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){ai("setting transport %s",e.name),this.transport&&(ai("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(e){ai('probing transport "%s"',e);let t=this.createTransport(e,{probe:1}),i=!1;$a.priorWebsocketSuccess=!1;let n=()=>{i||(ai('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",h=>{if(!i)if(h.type==="pong"&&h.data==="probe"){if(ai('probe transport "%s" pong',e),this.upgrading=!0,this.emit("upgrading",t),!t)return;$a.priorWebsocketSuccess=t.name==="websocket",ai('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(ai("changing transport and sending upgrade packet"),l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emit("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{ai('probe transport "%s" failed',e);let d=new Error("probe error");d.transport=t.name,this.emit("upgradeError",d)}}))};function s(){i||(i=!0,l(),t.close(),t=null)}let o=h=>{let d=new Error("probe error: "+h);d.transport=t.name,s(),ai('probe transport "%s" failed because of error: %s',e,h),this.emit("upgradeError",d)};function a(){o("transport closed")}function c(){o("socket closed")}function f(h){t&&h.name!==t.name&&(ai('"%s" works - aborting "%s"',h.name,t.name),s())}let l=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.removeListener("close",c),this.removeListener("upgrading",f)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",f),t.open()}onOpen(){if(ai("socket open"),this.readyState="open",$a.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){ai("starting upgrade probes");let e=0,t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(ai('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":let t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data);break}else ai('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(ai("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,t,i){return this.sendPacket("message",e,t,i),this}send(e,t,i){return this.sendPacket("message",e,t,i),this}sendPacket(e,t,i,n){if(typeof t=="function"&&(n=t,t=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:t,options:i};this.emit("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),ai("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.removeListener("upgrade",t),this.removeListener("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){ai("socket error %j",e),$a.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(ai('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let t=[],i=0,n=e.length;for(;i<n;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}};$a.priorWebsocketSuccess=!1;$a.protocol=zme.protocol;function qdt(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}$me.exports=$a});var Wme=p((jkt,Jf)=>{u();var nP=Gme();Jf.exports=(r,e)=>new nP(r,e);Jf.exports.Socket=nP;Jf.exports.protocol=nP.protocol;Jf.exports.Transport=xE();Jf.exports.transports=iP();Jf.exports.parser=n0()});var sP=p(o0=>{u();"use strict";Object.defineProperty(o0,"__esModule",{value:!0});o0.hasBinary=o0.isBinary=void 0;var kdt=typeof ArrayBuffer=="function",Bdt=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Yme=Object.prototype.toString,Ndt=typeof Blob=="function"||typeof Blob!="undefined"&&Yme.call(Blob)==="[object BlobConstructor]",Ddt=typeof File=="function"||typeof File!="undefined"&&Yme.call(File)==="[object FileConstructor]";function Xme(r){return kdt&&(r instanceof ArrayBuffer||Bdt(r))||Ndt&&r instanceof Blob||Ddt&&r instanceof File}o0.isBinary=Xme;function CE(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,i=r.length;t<i;t++)if(CE(r[t]))return!0;return!1}if(Xme(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return CE(r.toJSON(),!0);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&CE(r[t]))return!0;return!1}o0.hasBinary=CE});var Qme=p(a0=>{u();"use strict";Object.defineProperty(a0,"__esModule",{value:!0});a0.reconstructPacket=a0.deconstructPacket=void 0;var Mdt=sP();function Ldt(r){let e=[],t=r.data,i=r;return i.data=oP(t,e),i.attachments=e.length,{packet:i,buffers:e}}a0.deconstructPacket=Ldt;function oP(r,e){if(!r)return r;if(Mdt.isBinary(r)){let t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){let t=new Array(r.length);for(let i=0;i<r.length;i++)t[i]=oP(r[i],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){let t={};for(let i in r)r.hasOwnProperty(i)&&(t[i]=oP(r[i],e));return t}return r}function Udt(r,e){return r.data=aP(r.data,e),r.attachments=void 0,r}a0.reconstructPacket=Udt;function aP(r,e){if(!r)return r;if(r&&r._placeholder)return e[r.num];if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=aP(r[t],e);else if(typeof r=="object")for(let t in r)r.hasOwnProperty(t)&&(r[t]=aP(r[t],e));return r}});var qE=p(jo=>{u();"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.Decoder=jo.Encoder=jo.PacketType=jo.protocol=void 0;var Fdt=s0(),Jme=Qme(),Zme=sP(),cP=me()("socket.io-parser");jo.protocol=5;var pi;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(pi=jo.PacketType||(jo.PacketType={}));var e1e=class{encode(e){return cP("encoding packet %j",e),(e.type===pi.EVENT||e.type===pi.ACK)&&Zme.hasBinary(e)?(e.type=e.type===pi.EVENT?pi.BINARY_EVENT:pi.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===pi.BINARY_EVENT||e.type===pi.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data)),cP("encoded %j as %s",e,t),t}encodeAsBinary(e){let t=Jme.deconstructPacket(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n}};jo.Encoder=e1e;var OE=class extends Fdt{constructor(){super()}add(e){let t;if(typeof e=="string")t=this.decodeString(e),t.type===pi.BINARY_EVENT||t.type===pi.BINARY_ACK?(this.reconstructor=new t1e(t),t.attachments===0&&super.emit("decoded",t)):super.emit("decoded",t);else if(Zme.isBinary(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emit("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,i={type:Number(e.charAt(0))};if(pi[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===pi.BINARY_EVENT||i.type===pi.BINARY_ACK){let s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(t+1)==="/"){let s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(s,t)}else i.nsp="/";let n=e.charAt(t+1);if(n!==""&&Number(n)==n){let s=t+1;for(;++t;){let o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}i.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=Kdt(e.substr(t));if(OE.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return cP("decoded %s as %j",e,i),i}static isPayloadValid(e,t){switch(e){case pi.CONNECT:return typeof t=="object";case pi.DISCONNECT:return t===void 0;case pi.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case pi.EVENT:case pi.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case pi.ACK:case pi.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};jo.Decoder=OE;function Kdt(r){try{return JSON.parse(r)}catch(e){return!1}}var t1e=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=Jme.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var uP=p(kE=>{u();"use strict";Object.defineProperty(kE,"__esModule",{value:!0});kE.on=void 0;function jdt(r,e,t){return r.on(e,t),function(){r.off(e,t)}}kE.on=jdt});var lP=p(BE=>{u();"use strict";Object.defineProperty(BE,"__esModule",{value:!0});BE.StrictEventEmitter=void 0;var Vdt=s0(),r1e=class extends Vdt{on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}emit(e,...t){return super.emit(e,...t),this}emitReserved(e,...t){return super.emit(e,...t),this}listeners(e){return super.listeners(e)}};BE.StrictEventEmitter=r1e});var fP=p(DE=>{u();"use strict";Object.defineProperty(DE,"__esModule",{value:!0});DE.Socket=void 0;var Hs=qE(),NE=uP(),zdt=lP(),$s=me()("socket.io-client:socket"),Hdt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),i1e=class extends zdt.StrictEventEmitter{constructor(e,t,i){super();this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;let e=this.io;this.subs=[NE.on(e,"open",this.onopen.bind(this)),NE.on(e,"packet",this.onpacket.bind(this)),NE.on(e,"error",this.onerror.bind(this)),NE.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Hdt.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);let i={type:Hs.PacketType.EVENT,data:t};i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"&&($s("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++);let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)?$s("discard packet as the transport is not currently writable"):this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){$s("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:Hs.PacketType.CONNECT,data:e})}):this.packet({type:Hs.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){$s("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Hs.PacketType.CONNECT:if(e.data&&e.data.sid){let n=e.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Hs.PacketType.EVENT:this.onevent(e);break;case Hs.PacketType.BINARY_EVENT:this.onevent(e);break;case Hs.PacketType.ACK:this.onack(e);break;case Hs.PacketType.BINARY_ACK:this.onack(e);break;case Hs.PacketType.DISCONNECT:this.ondisconnect();break;case Hs.PacketType.CONNECT_ERROR:let i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){let t=e.data||[];$s("emitting event %j",t),e.id!=null&&($s("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let i of t)i.apply(this,e)}super.emit.apply(this,e)}ack(e){let t=this,i=!1;return function(...n){i||(i=!0,$s("sending ack %j",n),t.packet({type:Hs.PacketType.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];typeof t=="function"?($s("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):$s("bad ack %s",e.id)}onconnect(e){$s("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){$s("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&($s("performing disconnect (%s)",this.nsp),this.packet({type:Hs.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}};DE.Socket=i1e});var s1e=p((Ykt,n1e)=>{u();n1e.exports=c0;function c0(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}c0.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=(Math.floor(e*10)&1)==0?r-t:r+t}return Math.min(r,this.max)|0};c0.prototype.reset=function(){this.attempts=0};c0.prototype.setMin=function(r){this.ms=r};c0.prototype.setMax=function(r){this.max=r};c0.prototype.setJitter=function(r){this.jitter=r}});var hP=p(ME=>{u();"use strict";Object.defineProperty(ME,"__esModule",{value:!0});ME.Manager=void 0;var $dt=Wme(),Gdt=fP(),Wdt=qE(),Zf=uP(),Ydt=s1e(),Xdt=lP(),Yi=me()("socket.io-client:manager"),o1e=class extends Xdt.StrictEventEmitter{constructor(e,t){super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new Ydt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let i=t.parser||Wdt;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(Yi("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;Yi("opening %s",this.uri),this.engine=$dt(this.uri,this.opts);let t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=Zf.on(t,"open",function(){i.onopen(),e&&e()}),s=Zf.on(t,"error",o=>{Yi("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",o),e?e(o):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;Yi("connect attempt will timeout after %d",o),o===0&&n();let a=setTimeout(()=>{Yi("connect attempt timed out after %d",o),n(),t.close(),t.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){Yi("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Zf.on(e,"ping",this.onping.bind(this)),Zf.on(e,"data",this.ondata.bind(this)),Zf.on(e,"error",this.onerror.bind(this)),Zf.on(e,"close",this.onclose.bind(this)),Zf.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){Yi("error",e),this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i||(i=new Gdt.Socket(this,e,t),this.nsps[e]=i),i}_destroy(e){let t=Object.keys(this.nsps);for(let i of t)if(this.nsps[i].active){Yi("socket %s is still active, skipping close",i);return}this._close()}_packet(e){Yi("writing packet %j",e);let t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){Yi("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){Yi("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this._readyState==="opening"&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){Yi("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)Yi("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();Yi("will wait %dms before reconnect attempt",t),this._reconnecting=!0;let i=setTimeout(()=>{e.skipReconnect||(Yi("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(Yi("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):(Yi("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};ME.Manager=o1e});var l1e=p((Hn,u1e)=>{u();"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.io=Hn.Socket=Hn.Manager=Hn.protocol=void 0;var Qdt=eme(),a1e=hP(),c1e=me()("socket.io-client");u1e.exports=Hn=LE;var Vb=Hn.managers={};function LE(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};let t=Qdt.url(r,e.path||"/socket.io"),i=t.source,n=t.id,s=t.path,o=Vb[n]&&s in Vb[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(c1e("ignoring socket cache for %s",i),c=new a1e.Manager(i,e)):(Vb[n]||(c1e("new io instance for %s",i),Vb[n]=new a1e.Manager(i,e)),c=Vb[n]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Hn.io=LE;var Jdt=qE();Object.defineProperty(Hn,"protocol",{enumerable:!0,get:function(){return Jdt.protocol}});Hn.connect=LE;var Zdt=hP();Object.defineProperty(Hn,"Manager",{enumerable:!0,get:function(){return Zdt.Manager}});var ept=fP();Object.defineProperty(Hn,"Socket",{enumerable:!0,get:function(){return ept.Socket}});Hn.default=LE});var dP=p((Qkt,f1e)=>{u();var tpt=t2();f1e.exports=r=>async e=>{e=tpt(e);let t=_=>{typeof _.return=="function"&&_.return()},i=null,n=null,s=_=>{i=_,n&&n(_),t(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},f=null,l=!1,h=()=>{l=!0,f&&f()},d=null,y=()=>{d&&d()},g=()=>new Promise((_,T)=>{o=d=_,n=T,r.once("drain",y)}),m=()=>(t(e),new Promise((_,T)=>{if(a||l||i)return _();f=o=_,n=T})),E=()=>{r.removeListener("error",s),r.removeListener("close",c),r.removeListener("finish",h),r.removeListener("drain",y)};r.once("error",s),r.once("close",c),r.once("finish",h);try{for await(let _ of e){if(!r.writable||r.destroyed||i)break;r.write(_)===!1&&await g()}}catch(_){i||r.destroy(),i=_}try{if(r.writable&&r.end(),await m(),i)throw i}finally{E()}}});var pP=p((Jkt,h1e)=>{u();var rpt=dP(),ipt=yb();h1e.exports=r=>({sink:rpt(r),source:ipt(r)})});var p1e=p((Zkt,d1e)=>{u();var npt=pP();d1e.exports=r=>async function*(e){let t=npt(r),i;if(t.sink(e).catch(n=>{i=n}),yield*t.source,i)throw i}});var y1e=p((eBt,u0)=>{u();u0.exports=yb();u0.exports.source=yb();u0.exports.sink=dP();u0.exports.transform=p1e();u0.exports.duplex=pP()});var yP=p((tBt,w1e)=>{u();"use strict";var g1e=Da(),spt=y1e(),{CLOSE_TIMEOUT:opt}=SE(),b1e=T8(),m1e=me(),UE=m1e("libp2p:webrtc-star:socket");UE.error=m1e("libp2p:webrtc-star:socket:error");var v1e=(r,e)=>{if(!(!r||!e))try{return b1e(r,e)}catch(t){return UE.error(t),b1e("0.0.0.0",e)}};w1e.exports=(r,e={})=>{let{sink:t,source:i}=spt.duplex(r),n=e.remoteAddr||v1e(r.remoteAddress,r.remotePort),s=v1e(r.localAddress,r.localPort),o={async sink(a){e.signal&&(a=g1e(a,e.signal));try{await t(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&UE.error(c)}},source:e.signal?g1e(i,e.signal):i,conn:r,localAddr:s,remoteAddr:n,timeline:{open:Date.now()},close(){if(!r.destroyed)return new Promise((a,c)=>{let f=Date.now(),l=setTimeout(()=>{if(o.remoteAddr){let{host:h,port:d}=o.remoteAddr.toOptions();UE("timeout closing socket to %s:%s after %dms, destroying it manually",h,d,Date.now()-f)}r.destroyed||r.destroy()},opt);r.once("close",()=>{a()}),r.end(h=>{if(clearTimeout(l),o.timeline.close=Date.now(),h)return c(h)})})}};return r.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var gP=p((rBt,E1e)=>{u();"use strict";var{Multiaddr:_1e}=et();function apt(r){let e=r.toString().split("/"),t=r.protos()[1].name,i=r.protos()[2].name,n=r.stringTuples()[1][1];if(t!=="tcp"||i!=="ws"&&i!=="wss")throw new Error("invalid multiaddr: "+r.toString());if(!_1e.isName(r))return"http://"+e[2]+":"+e[4];if(i==="ws")return"http://"+e[2]+(n==="80"?"":":"+n);if(i==="wss")return"https://"+e[2]+(n==="443"?"":":"+n)}function cpt(r){let e="/libp2p-webrtc-star";if(r.indexOf(e)!==-1){r=r.substring(e.length,r.length);let t=new _1e(r),i=t.stringTuples().filter(n=>n[0]===421)[0];t=t.decapsulate("p2p"),t=t.encapsulate("/p2p-webrtc-star"),t=t.encapsulate(`/p2p/${i[1]}`),r=t.toString()}return r}E1e.exports={cleanUrlSIO:apt,cleanMultiaddr:cpt}});var I1e=p((iBt,x1e)=>{u();"use strict";var upt=br(),S1e=me(),eh=S1e("libp2p:webrtc-star:listener");eh.error=S1e("libp2p:webrtc-star:listener:error");var lpt=ue(),fpt=l1e(),hpt=L8(),dpt=Qu(),ppt=yP(),{cleanUrlSIO:ypt}=gP(),{CODE_P2P:A1e}=SE(),gpt={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};x1e.exports=({handler:r,upgrader:e},t,i={})=>{let n=new upt,s,o;return n.__connections=[],n.__spChannels=new Map,n.__pendingIntents=new Map,n.listen=a=>{if(s)throw lpt(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=dpt();s=a;let f;!a.protoCodes().includes(A1e)&&e.localPeer?f=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):f=a,n.on("error",()=>c.reject()),o=ypt(a),eh("Dialing to Signalling Server on: "+o),n.io=fpt.connect(o,gpt);let l=h=>{if(h.answer||h.err||!h.intentId)return;let d=h.intentId,y=n.__pendingIntents.get(d);y||(y=[],n.__pendingIntents.set(d,y));let g=n.__spChannels.get(d);if(g){g.signal(h.signal);return}else if(h.signal.type!=="offer"){y.push(h);return}let m={trickle:!1,...i};t.wrtc&&(m.wrtc=t.wrtc),g=new hpt(m);let E=_=>{eh.error("incoming connection errored",_)};g.on("error",E),g.once("close",(..._)=>{g.removeListener("error",E)}),g.on("signal",_=>{h.signal=_,h.answer=!0,n.io.emit("ss-handshake",h)}),g.signal(h.signal);for(let _ of y)g.signal(_.signal);n.__pendingIntents.set(d,[]),g.once("connect",async()=>{let _=ppt(g);eh("new inbound connection %s",_.remoteAddr);let T;try{T=await e.upgradeInbound(_)}catch(q){return eh.error("inbound connection failed to upgrade",q),_.close()}if(!T.remoteAddr)try{T.remoteAddr=a.decapsulateCode(A1e).encapsulate(`/p2p/${T.remotePeer.toB58String()}`)}catch(q){eh.error("could not determine remote address",q)}eh("inbound connection %s upgraded",_.remoteAddr),bpt(n,_,d),n.emit("connection",T),r(T)}),n.__spChannels.set(d,g)};return n.io.once("connect_error",h=>c.reject(h)),n.io.once("error",h=>{n.emit("error",h),n.emit("close")}),n.io.on("ws-handshake",l),n.io.on("ws-peer",t._peerDiscovered),n.io.on("connect",()=>{n.io.emit("ss-join",f.toString())}),n.io.once("connect",()=>{n.emit("listening"),c.resolve()}),t.sigReferences.set(o,{listener:n,signallingAddr:f}),c.promise},n.close=async()=>{let a=t.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(n.__connections.map(c=>c.close())),n.emit("close"),n.removeAllListeners(),s=void 0,t.sigReferences.delete(o)},n.getAddrs=()=>[s],n};function bpt(r,e,t){r.__connections.push(e);let i=()=>{r.__connections=r.__connections.filter(n=>n!==e),r.__spChannels.delete(t),r.__pendingIntents.delete(t)};e.conn.once("close",i)}});var O1e=p((nBt,C1e)=>{u();"use strict";var T1e=me(),Kc=T1e("libp2p:webrtc-star");Kc.error=T1e("libp2p:webrtc-star:error");var{EventEmitter:mpt}=br(),FE=ue(),vpt=Q1(),{AbortError:R1e}=Da(),wpt=L8(),{supportsWebRTCDataChannels:_pt}=Qbe(),{Multiaddr:Ept}=et(),Spt=zl(),Apt=rt(),{CODE_CIRCUIT:xpt}=SE(),Ipt=I1e(),Tpt=yP(),{cleanMultiaddr:Rpt,cleanUrlSIO:Ppt}=gP();function Cpt(){}var P1e=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new mpt,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,t={}){let i=await this._connect(e,t),n=Tpt(i,{remoteAddr:e,signal:t.signal});Kc("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Kc("outbound connection %s upgraded",n.remoteAddr),s}_connect(e,t={}){if(t.signal&&t.signal.aborted)throw new R1e;let i={initiator:!0,trickle:!1,...t.spOptions||{}};this.wrtc&&(i.wrtc=this.wrtc);let n=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(Ppt(e));if(!c||!c.listener)return a(FE(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let f=c.listener.io,l=Date.now(),h;Kc("dialing %s:%s",n.host,n.port);let d=new wpt(i),y=T=>{if(!h){let q=`connection error ${n.host}:${n.port}: ${T.message}`;Kc.error(q),_(T)}},g=()=>{Kc("connnection timeout %s:%s",n.host,n.port);let T=FE(new Error(`connection timeout after ${Date.now()-l}ms`),"ERR_CONNECT_TIMEOUT");d.emit("error",T)},m=()=>{h=!0,Kc("connection opened %s:%s",n.host,n.port),_(null)},E=()=>{Kc.error("connection aborted %s:%s",n.host,n.port),d.destroy(),_(new R1e)},_=T=>{d.removeListener("timeout",g),d.removeListener("connect",m),t.signal&&t.signal.removeEventListener("abort",E),T?a(T):o(d)};d.on("error",y),d.once("timeout",g),d.once("connect",m),d.on("close",()=>{d.removeListener("error",y)}),t.signal&&t.signal.addEventListener("abort",E),d.on("signal",T=>{f.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:T})}),f.on("ws-handshake",T=>{T.intentId===s&&T.err&&(d.destroy(),a(FE(T.err instanceof Error?T.err:new Error(T.err),"ERR_SIGNALLING_FAILED"))),!(T.intentId!==s||!T.answer||d.destroyed)&&d.signal(T.signal)})})}createListener(e={},t){if(!_pt&&!this.wrtc)throw FE(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(t=e,e={}),t=t||Cpt,Ipt({handler:t,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>t.protoCodes().includes(xpt)?!1:Spt.WebRTCStar.matches(t))}_peerDiscovered(e){if(!this.discovery._isStarted)return;Kc("Peer Discovered:",e),e=Rpt(e);let t=new Ept(e),i=Apt.createFromB58String(t.getPeerId());this.discovery.emit("peer",{id:i,multiaddrs:[t]})}};C1e.exports=vpt(P1e,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var KE=p((sBt,k1e)=>{u();"use strict";var{Buffer:Vo}=pt(),q1e=Symbol.for("BufferList");function pr(r){if(!(this instanceof pr))return new pr(r);pr._init.call(this,r)}pr._init=function(e){Object.defineProperty(this,q1e,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};pr.prototype._new=function(e){return new pr(e)};pr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};pr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};pr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};pr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};pr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Vo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,f=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Vo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,f),f+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=Vo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-l;if(c>d)this._bufs[h].copy(e,f,l),f+=d;else{this._bufs[h].copy(e,f,l,l+c),f+=d;break}c-=d,l&&(l=0)}return e.length>f?e.slice(0,f):e};pr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};pr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};pr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};pr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};pr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Vo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Vo.from(e));return this};pr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};pr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=Vo.from([r]):typeof r=="string"?r=Vo.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=Vo.from(r.buffer,r.byteOffset,r.byteLength):Vo.isBuffer(r)||(r=Vo.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};pr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?pr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:pr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();pr.prototype._isBufferList=function(e){return e instanceof pr||pr.isBufferList(e)};pr.isBufferList=function(e){return e!=null&&e[q1e]};k1e.exports=pr});var L1e=p((oBt,M1e)=>{u();"use strict";var jE=Jn(),B1e=KE(),bP=10*1024,N1e=class{constructor(){this._pool=new Uint8Array(bP),this._poolOffset=0}write(e){let t=this._pool,i=this._poolOffset;jE.encode(e.id<<3|e.type,t,i),i+=jE.encode.bytes,jE.encode(e.data?e.data.length:0,t,i),i+=jE.encode.bytes;let n=t.subarray(this._poolOffset,i);return bP-i<100?(this._pool=new Uint8Array(bP),this._poolOffset=0):this._poolOffset=i,e.data?[n,e.data]:n}},D1e=new N1e;M1e.exports=r=>async function*(){for await(let t of r)Array.isArray(t)?yield new B1e(t.map(i=>D1e.write(i))):yield new B1e(D1e.write(t))}()});var K1e=p((aBt,F1e)=>{u();"use strict";var VE=Jn(),Opt=KE();F1e.exports=r=>async function*(){let t=new U1e;for await(let i of r){let n=t.write(i);n.length&&(yield n)}}();var U1e=class{constructor(){this._buffer=new Opt,this._bufferProxy=new Proxy({},{get:(e,t)=>t[0]==="l"?this._buffer[t]:this._buffer.get(parseInt(t))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let t=[];for(;;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(c){break}let{id:i,type:n,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;t.push({id:i,type:n,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return t}_decodeHeader(e){let t=VE.decode(e),i=VE.decode.bytes,n=VE.decode(e,i);return i+=VE.decode.bytes,{id:t>>3,type:t&7,offset:i,length:n}}}});var j1e=p(mP=>{u();"use strict";mP.encode=L1e();mP.decode=K1e()});var wP=p((uBt,vP)=>{u();"use strict";var V1e=1<<20;vP.exports=r=>{r=r||V1e;let e=t=>{if(t.data&&t.data.length>r)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return t=>async function*(){for await(let n of t)Array.isArray(n)?n.forEach(e):e(n),yield n}()};vP.exports.MAX_MSG_SIZE=V1e});var _P=p(zb=>{u();"use strict";var jc=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});zb.MessageTypes=jc;zb.InitiatorMessageTypes=Object.freeze({NEW_STREAM:jc.NEW_STREAM,MESSAGE:jc.MESSAGE_INITIATOR,CLOSE:jc.CLOSE_INITIATOR,RESET:jc.RESET_INITIATOR});zb.ReceiverMessageTypes=Object.freeze({MESSAGE:jc.MESSAGE_RECEIVER,CLOSE:jc.CLOSE_RECEIVER,RESET:jc.RESET_RECEIVER});zb.MessageTypeNames=Object.freeze(Object.entries(jc).reduce((r,e)=>(r[e[1]]=e[0],r),{}))});var G1e=p((fBt,$1e)=>{u();"use strict";var qpt=Da(),z1e=vl(),Hb=me()("libp2p:mplex:stream"),kpt=Ra(),H1e=KE(),Bpt=ue(),{MAX_MSG_SIZE:Npt}=wP(),{InitiatorMessageTypes:Dpt,ReceiverMessageTypes:Mpt}=_P(),EP="ERR_MPLEX_STREAM_RESET",Lpt="ERR_MPLEX_STREAM_ABORT";$1e.exports=({id:r,name:e,send:t,onEnd:i=()=>{},type:n="initiator",maxMsgSize:s=Npt})=>{let o=new z1e,a=new z1e,c=n==="initiator"?Dpt:Mpt,f=n==="initiator"?`i${r}`:`r${r}`;e=String(e??r);let l=!1,h=!1,d,y=E=>{l||(l=!0,Hb("%s stream %s source end",n,e,E),E&&!d&&(d=E),h&&(m.timeline.close=Date.now(),i(d)))},g=E=>{h||(h=!0,Hb("%s stream %s sink end",n,e,E),E&&!d&&(d=E),l&&(m.timeline.close=Date.now(),i(d)))},m={close:()=>m.source.end(),abort:E=>{Hb("%s stream %s abort",n,e,E),m.source.end(E),o.abort(),g(E)},reset:()=>{let E=Bpt(new Error("stream reset"),EP);a.abort(),m.source.end(E),g(E)},sink:async E=>{E=qpt(E,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:Lpt}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:EP}}]),n==="initiator"&&t({id:r,type:c.NEW_STREAM,data:e});try{for await(let _ of E)for(;_.length;){if(_.length<=s){t({id:r,type:c.MESSAGE,data:_});break}_=H1e.isBufferList(_)?_:new H1e(_),t({id:r,type:c.MESSAGE,data:_.shallowSlice(0,s)}),_.consume(s)}}catch(_){return _.code===EP?Hb("%s stream %s reset",n,e):(Hb("%s stream %s error",n,e,_),t({id:r,type:c.RESET})),m.source.end(_),g(_)}t({id:r,type:c.CLOSE}),g()},source:kpt(y),timeline:{open:Date.now(),close:null},id:f};return m}});var Q1e=p((hBt,X1e)=>{u();"use strict";var Upt=Gr(),Fpt=Ra(),Vc=me()("libp2p:mplex"),Kpt=Da(),W1e=j1e(),jpt=wP(),{MessageTypes:th,MessageTypeNames:Y1e}=_P(),Vpt=G1e(),SP=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(t=>{e.push(t)}),this._streams.receivers.forEach(t=>{e.push(t)}),e}newStream(e){let t=this._streamId++;e=e==null?t.toString():String(e);let i=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:i})}_newReceiverStream({id:e,name:t}){let i=this._streams.receivers;return this._newStream({id:e,name:t,type:"receiver",registry:i})}_newStream({id:e,name:t,type:i,registry:n}){if(n.has(e))throw new Error(`${i} stream ${e} already exists!`);Vc("new %s stream %s %s",i,e,t);let a=Vpt({id:e,name:t,send:c=>(Vc.enabled&&Vc("%s stream %s %s send",i,e,t,{...c,type:Y1e[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:i,onEnd:()=>{Vc("%s stream %s %s ended",i,e,t),n.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return n.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=Kpt(e,this._options.signal));try{await Upt(e,W1e.decode,jpt(this._options.maxMsgSize),async t=>{for await(let i of t)for(let n of i)this._handleIncoming(n)})}catch(t){return Vc("error in sink",t),this.source.end(t)}this.source.end()}}_createSource(){let t=Fpt({onEnd:i=>{let{initiators:n,receivers:s}=this._streams;for(let o of n.values())o.abort(i);for(let o of s.values())o.abort(i)},writev:!0});return Object.assign(W1e.encode(t),{push:t.push,end:t.end,return:t.return})}_handleIncoming({id:e,type:t,data:i}){if(Vc.enabled&&Vc("incoming message",{id:e,type:Y1e[t],data:i.slice()}),t===th.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:i.toString()});return this.onStream(o)}let s=(t&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return Vc("missing stream %s",e);switch(t){case th.MESSAGE_INITIATOR:case th.MESSAGE_RECEIVER:s.source.push(i);break;case th.CLOSE_INITIATOR:case th.CLOSE_RECEIVER:s.close();break;case th.RESET_INITIATOR:case th.RESET_RECEIVER:s.reset();break;default:Vc("unknown message type %s",t)}}};SP.multicodec="/mplex/6.7.0";X1e.exports=SP});var Z1e=p((dBt,J1e)=>{u();"use strict";J1e.exports=Q1e()});var tve=p(AP=>{u();"use strict";Object.defineProperty(AP,"__esModule",{value:!0});var eve=65536,zpt=function(){function r(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var t=new Uint8Array(e),i=0;i<t.length;i+=eve)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,eve)));return t},r}();AP.BrowserRandomSource=zpt});var Ga=p(xP=>{u();"use strict";Object.defineProperty(xP,"__esModule",{value:!0});function Hpt(r){for(var e=0;e<r.length;e++)r[e]=0;return r}xP.wipe=Hpt});var rve=p(IP=>{u();"use strict";Object.defineProperty(IP,"__esModule",{value:!0});var $pt=Ga(),Gpt=function(){function r(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Ho!="undefined"){var e=Ah();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=t[n];return $pt.wipe(t),i},r}();IP.NodeRandomSource=Gpt});var ive=p(TP=>{u();"use strict";Object.defineProperty(TP,"__esModule",{value:!0});var Wpt=tve(),Ypt=rve(),Xpt=function(){function r(){if(this.isAvailable=!1,this.name="",this._source=new Wpt.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Ypt.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return r.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},r}();TP.SystemRandomSource=Xpt});var nve=p(fs=>{u();"use strict";Object.defineProperty(fs,"__esModule",{value:!0});function Qpt(r,e){var t=r>>>16&65535,i=r&65535,n=e>>>16&65535,s=e&65535;return i*s+(t*s+i*n<<16>>>0)|0}fs.mul=Math.imul||Qpt;function Jpt(r,e){return r+e|0}fs.add=Jpt;function Zpt(r,e){return r-e|0}fs.sub=Zpt;function e0t(r,e){return r<<e|r>>>32-e}fs.rotl=e0t;function t0t(r,e){return r<<32-e|r>>>e}fs.rotr=t0t;function r0t(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}fs.isInteger=Number.isInteger||r0t;fs.MAX_SAFE_INTEGER=9007199254740991;fs.isSafeInteger=function(r){return fs.isInteger(r)&&r>=-fs.MAX_SAFE_INTEGER&&r<=fs.MAX_SAFE_INTEGER}});var $b=p(gt=>{u();"use strict";Object.defineProperty(gt,"__esModule",{value:!0});var sve=nve();function i0t(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}gt.readInt16BE=i0t;function n0t(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}gt.readUint16BE=n0t;function s0t(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}gt.readInt16LE=s0t;function o0t(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}gt.readUint16LE=o0t;function ove(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}gt.writeUint16BE=ove;gt.writeInt16BE=ove;function ave(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}gt.writeUint16LE=ave;gt.writeInt16LE=ave;function RP(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}gt.readInt32BE=RP;function PP(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}gt.readUint32BE=PP;function CP(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}gt.readInt32LE=CP;function OP(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}gt.readUint32LE=OP;function zE(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}gt.writeUint32BE=zE;gt.writeInt32BE=zE;function HE(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}gt.writeUint32LE=HE;gt.writeInt32LE=HE;function a0t(r,e){e===void 0&&(e=0);var t=RP(r,e),i=RP(r,e+4);return t*4294967296+i-(i>>31)*4294967296}gt.readInt64BE=a0t;function c0t(r,e){e===void 0&&(e=0);var t=PP(r,e),i=PP(r,e+4);return t*4294967296+i}gt.readUint64BE=c0t;function u0t(r,e){e===void 0&&(e=0);var t=CP(r,e),i=CP(r,e+4);return i*4294967296+t-(t>>31)*4294967296}gt.readInt64LE=u0t;function l0t(r,e){e===void 0&&(e=0);var t=OP(r,e),i=OP(r,e+4);return i*4294967296+t}gt.readUint64LE=l0t;function cve(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),zE(r/4294967296>>>0,e,t),zE(r>>>0,e,t+4),e}gt.writeUint64BE=cve;gt.writeInt64BE=cve;function uve(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),HE(r>>>0,e,t),HE(r/4294967296>>>0,e,t+4),e}gt.writeUint64LE=uve;gt.writeInt64LE=uve;function f0t(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=r/8+t-1;s>=t;s--)i+=e[s]*n,n*=256;return i}gt.readUintBE=f0t;function h0t(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=t;s<t+r/8;s++)i+=e[s]*n,n*=256;return i}gt.readUintLE=h0t;function d0t(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!sve.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=r/8+i-1;s>=i;s--)t[s]=e/n&255,n*=256;return t}gt.writeUintBE=d0t;function p0t(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!sve.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+r/8;s++)t[s]=e/n&255,n*=256;return t}gt.writeUintLE=p0t;function y0t(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}gt.readFloat32BE=y0t;function g0t(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}gt.readFloat32LE=g0t;function b0t(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}gt.readFloat64BE=b0t;function m0t(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}gt.readFloat64LE=m0t;function v0t(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}gt.writeFloat32BE=v0t;function w0t(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}gt.writeFloat32LE=w0t;function _0t(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}gt.writeFloat64BE=_0t;function E0t(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}gt.writeFloat64LE=E0t});var dve=p(zo=>{u();"use strict";Object.defineProperty(zo,"__esModule",{value:!0});var S0t=ive(),A0t=$b(),lve=Ga();zo.defaultRandomSource=new S0t.SystemRandomSource;function qP(r,e){return e===void 0&&(e=zo.defaultRandomSource),e.randomBytes(r)}zo.randomBytes=qP;function x0t(r){r===void 0&&(r=zo.defaultRandomSource);var e=qP(4,r),t=A0t.readUint32LE(e);return lve.wipe(e),t}zo.randomUint32=x0t;var fve="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function hve(r,e,t){if(e===void 0&&(e=fve),t===void 0&&(t=zo.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var i="",n=e.length,s=256-256%n;r>0;){for(var o=qP(Math.ceil(r*256/s),t),a=0;a<o.length&&r>0;a++){var c=o[a];c<s&&(i+=e.charAt(c%n),r--)}lve.wipe(o)}return i}zo.randomString=hve;function I0t(r,e,t){e===void 0&&(e=fve),t===void 0&&(t=zo.defaultRandomSource);var i=Math.ceil(r/(Math.log(e.length)/Math.LN2));return hve(i,e,t)}zo.randomStringForEntropy=I0t});var WE=p($n=>{u();"use strict";Object.defineProperty($n,"__esModule",{value:!0});var T0t=dve(),R0t=Ga();$n.PUBLIC_KEY_LENGTH=32;$n.SECRET_KEY_LENGTH=32;$n.SHARED_KEY_LENGTH=32;function Wa(r){var e=new Float64Array(16);if(r)for(var t=0;t<r.length;t++)e[t]=r[t];return e}var pve=new Uint8Array(32);pve[0]=9;var P0t=Wa([56129,1]);function kP(r){for(var e=1,t=0;t<16;t++){var i=r[t]+e+65535;e=Math.floor(i/65536),r[t]=i-e*65536}r[0]+=e-1+37*(e-1)}function Gb(r,e,t){for(var i=~(t-1),n=0;n<16;n++){var s=i&(r[n]^e[n]);r[n]^=s,e[n]^=s}}function C0t(r,e){for(var t=Wa(),i=Wa(),n=0;n<16;n++)i[n]=e[n];kP(i),kP(i),kP(i);for(var s=0;s<2;s++){t[0]=i[0]-65517;for(var n=1;n<15;n++)t[n]=i[n]-65535-(t[n-1]>>16&1),t[n-1]&=65535;t[15]=i[15]-32767-(t[14]>>16&1);var o=t[15]>>16&1;t[14]&=65535,Gb(i,t,1-o)}for(var n=0;n<16;n++)r[2*n]=i[n]&255,r[2*n+1]=i[n]>>8}function O0t(r,e){for(var t=0;t<16;t++)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function $E(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]+t[i]}function GE(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]-t[i]}function zc(r,e,t){var i,n,s=0,o=0,a=0,c=0,f=0,l=0,h=0,d=0,y=0,g=0,m=0,E=0,_=0,T=0,q=0,z=0,V=0,M=0,$=0,X=0,Q=0,O=0,b=0,w=0,S=0,C=0,B=0,G=0,F=0,N=0,v=0,D=t[0],ae=t[1],W=t[2],ne=t[3],oe=t[4],de=t[5],pe=t[6],_e=t[7],P=t[8],U=t[9],H=t[10],J=t[11],x=t[12],L=t[13],K=t[14],k=t[15];i=e[0],s+=i*D,o+=i*ae,a+=i*W,c+=i*ne,f+=i*oe,l+=i*de,h+=i*pe,d+=i*_e,y+=i*P,g+=i*U,m+=i*H,E+=i*J,_+=i*x,T+=i*L,q+=i*K,z+=i*k,i=e[1],o+=i*D,a+=i*ae,c+=i*W,f+=i*ne,l+=i*oe,h+=i*de,d+=i*pe,y+=i*_e,g+=i*P,m+=i*U,E+=i*H,_+=i*J,T+=i*x,q+=i*L,z+=i*K,V+=i*k,i=e[2],a+=i*D,c+=i*ae,f+=i*W,l+=i*ne,h+=i*oe,d+=i*de,y+=i*pe,g+=i*_e,m+=i*P,E+=i*U,_+=i*H,T+=i*J,q+=i*x,z+=i*L,V+=i*K,M+=i*k,i=e[3],c+=i*D,f+=i*ae,l+=i*W,h+=i*ne,d+=i*oe,y+=i*de,g+=i*pe,m+=i*_e,E+=i*P,_+=i*U,T+=i*H,q+=i*J,z+=i*x,V+=i*L,M+=i*K,$+=i*k,i=e[4],f+=i*D,l+=i*ae,h+=i*W,d+=i*ne,y+=i*oe,g+=i*de,m+=i*pe,E+=i*_e,_+=i*P,T+=i*U,q+=i*H,z+=i*J,V+=i*x,M+=i*L,$+=i*K,X+=i*k,i=e[5],l+=i*D,h+=i*ae,d+=i*W,y+=i*ne,g+=i*oe,m+=i*de,E+=i*pe,_+=i*_e,T+=i*P,q+=i*U,z+=i*H,V+=i*J,M+=i*x,$+=i*L,X+=i*K,Q+=i*k,i=e[6],h+=i*D,d+=i*ae,y+=i*W,g+=i*ne,m+=i*oe,E+=i*de,_+=i*pe,T+=i*_e,q+=i*P,z+=i*U,V+=i*H,M+=i*J,$+=i*x,X+=i*L,Q+=i*K,O+=i*k,i=e[7],d+=i*D,y+=i*ae,g+=i*W,m+=i*ne,E+=i*oe,_+=i*de,T+=i*pe,q+=i*_e,z+=i*P,V+=i*U,M+=i*H,$+=i*J,X+=i*x,Q+=i*L,O+=i*K,b+=i*k,i=e[8],y+=i*D,g+=i*ae,m+=i*W,E+=i*ne,_+=i*oe,T+=i*de,q+=i*pe,z+=i*_e,V+=i*P,M+=i*U,$+=i*H,X+=i*J,Q+=i*x,O+=i*L,b+=i*K,w+=i*k,i=e[9],g+=i*D,m+=i*ae,E+=i*W,_+=i*ne,T+=i*oe,q+=i*de,z+=i*pe,V+=i*_e,M+=i*P,$+=i*U,X+=i*H,Q+=i*J,O+=i*x,b+=i*L,w+=i*K,S+=i*k,i=e[10],m+=i*D,E+=i*ae,_+=i*W,T+=i*ne,q+=i*oe,z+=i*de,V+=i*pe,M+=i*_e,$+=i*P,X+=i*U,Q+=i*H,O+=i*J,b+=i*x,w+=i*L,S+=i*K,C+=i*k,i=e[11],E+=i*D,_+=i*ae,T+=i*W,q+=i*ne,z+=i*oe,V+=i*de,M+=i*pe,$+=i*_e,X+=i*P,Q+=i*U,O+=i*H,b+=i*J,w+=i*x,S+=i*L,C+=i*K,B+=i*k,i=e[12],_+=i*D,T+=i*ae,q+=i*W,z+=i*ne,V+=i*oe,M+=i*de,$+=i*pe,X+=i*_e,Q+=i*P,O+=i*U,b+=i*H,w+=i*J,S+=i*x,C+=i*L,B+=i*K,G+=i*k,i=e[13],T+=i*D,q+=i*ae,z+=i*W,V+=i*ne,M+=i*oe,$+=i*de,X+=i*pe,Q+=i*_e,O+=i*P,b+=i*U,w+=i*H,S+=i*J,C+=i*x,B+=i*L,G+=i*K,F+=i*k,i=e[14],q+=i*D,z+=i*ae,V+=i*W,M+=i*ne,$+=i*oe,X+=i*de,Q+=i*pe,O+=i*_e,b+=i*P,w+=i*U,S+=i*H,C+=i*J,B+=i*x,G+=i*L,F+=i*K,N+=i*k,i=e[15],z+=i*D,V+=i*ae,M+=i*W,$+=i*ne,X+=i*oe,Q+=i*de,O+=i*pe,b+=i*_e,w+=i*P,S+=i*U,C+=i*H,B+=i*J,G+=i*x,F+=i*L,N+=i*K,v+=i*k,s+=38*V,o+=38*M,a+=38*$,c+=38*X,f+=38*Q,l+=38*O,h+=38*b,d+=38*w,y+=38*S,g+=38*C,m+=38*B,E+=38*G,_+=38*F,T+=38*N,q+=38*v,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,i=T+n+65535,n=Math.floor(i/65536),T=i-n*65536,i=q+n+65535,n=Math.floor(i/65536),q=i-n*65536,i=z+n+65535,n=Math.floor(i/65536),z=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,i=T+n+65535,n=Math.floor(i/65536),T=i-n*65536,i=q+n+65535,n=Math.floor(i/65536),q=i-n*65536,i=z+n+65535,n=Math.floor(i/65536),z=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=o,r[2]=a,r[3]=c,r[4]=f,r[5]=l,r[6]=h,r[7]=d,r[8]=y,r[9]=g,r[10]=m,r[11]=E,r[12]=_,r[13]=T,r[14]=q,r[15]=z}function Wb(r,e){zc(r,e,e)}function q0t(r,e){for(var t=Wa(),i=0;i<16;i++)t[i]=e[i];for(var i=253;i>=0;i--)Wb(t,t),i!==2&&i!==4&&zc(t,t,e);for(var i=0;i<16;i++)r[i]=t[i]}function BP(r,e){for(var t=new Uint8Array(32),i=new Float64Array(80),n=Wa(),s=Wa(),o=Wa(),a=Wa(),c=Wa(),f=Wa(),l=0;l<31;l++)t[l]=r[l];t[31]=r[31]&127|64,t[0]&=248,O0t(i,e);for(var l=0;l<16;l++)s[l]=i[l];n[0]=a[0]=1;for(var l=254;l>=0;--l){var h=t[l>>>3]>>>(l&7)&1;Gb(n,s,h),Gb(o,a,h),$E(c,n,o),GE(n,n,o),$E(o,s,a),GE(s,s,a),Wb(a,c),Wb(f,n),zc(n,o,n),zc(o,s,c),$E(c,n,o),GE(n,n,o),Wb(s,n),GE(o,a,f),zc(n,o,P0t),$E(n,n,a),zc(o,o,n),zc(n,a,f),zc(a,s,i),Wb(s,c),Gb(n,s,h),Gb(o,a,h)}for(var l=0;l<16;l++)i[l+16]=n[l],i[l+32]=o[l],i[l+48]=s[l],i[l+64]=a[l];var d=i.subarray(32),y=i.subarray(16);q0t(d,d),zc(y,y,d);var g=new Uint8Array(32);return C0t(g,y),g}$n.scalarMult=BP;function yve(r){return BP(r,pve)}$n.scalarMultBase=yve;function gve(r){if(r.length!==$n.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+$n.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(r),t=yve(e);return{publicKey:t,secretKey:e}}$n.generateKeyPairFromSeed=gve;function k0t(r){var e=T0t.randomBytes(32,r),t=gve(e);return R0t.wipe(e),t}$n.generateKeyPair=k0t;function B0t(r,e,t){if(t===void 0&&(t=!1),r.length!==$n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==$n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var i=BP(r,e);if(t){for(var n=0,s=0;s<i.length;s++)n|=i[s];if(n===0)throw new Error("X25519: invalid shared key")}return i}$n.sharedKey=B0t});var mve=p((EBt,bve)=>{u();bve.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var _ve=p((SBt,wve)=>{u();"use strict";var N0t=mve(),D0t=Cp(),vve=To();wve.exports=(r,e={})=>{let t=D0t(r),i=vve.decode.fromReader(t.reader,e),n=!1,s={read:async o=>{let{value:a,done:c}=await t.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(n=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await i.next();if(n=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=N0t(a)?a:a.slice();return o.decode(c)},write:o=>{t.writer.push(o)},writeLP:o=>{s.write(vve.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(t.rest(),t.stream)};return s}});var Sve=p((ABt,Eve)=>{u();"use strict";var M0t=t2();Eve.exports=function(){let e,t,i=async s=>{if(e)throw new Error("already piped");e=M0t(s),t&&t(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{t=o=>{t=null,s(o.next())}})}};return{sink:i,source:n}}});var Ive=p((xBt,xve)=>{u();var Ave=Sve();xve.exports=function(){var r=Ave(),e=Ave();return[{source:r.source,sink:e.sink},{source:e.source,sink:r.sink}]}});var Tve=p(NP=>{u();"use strict";Object.defineProperty(NP,"__esModule",{value:!0});function L0t(r){return typeof r.saveState!="undefined"&&typeof r.restoreState!="undefined"&&typeof r.cleanSavedState!="undefined"}NP.isSerializableHash=L0t});var YE=p(l0=>{u();"use strict";Object.defineProperty(l0,"__esModule",{value:!0});function U0t(r,e,t){return~(r-1)&e|r-1&t}l0.select=U0t;function F0t(r,e){return(r|0)-(e|0)-1>>>31&1}l0.lessOrEqual=F0t;function Rve(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}l0.compare=Rve;function K0t(r,e){return r.length===0||e.length===0?!1:Rve(r,e)!==0}l0.equal=K0t});var Cve=p(Yb=>{u();"use strict";Object.defineProperty(Yb,"__esModule",{value:!0});var Ya=Tve(),j0t=YE(),V0t=Ga(),Pve=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=54^92;this._outer.update(i),Ya.isSerializableHash(this._inner)&&Ya.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),V0t.wipe(i)}return r.prototype.reset=function(){if(!Ya.isSerializableHash(this._inner)||!Ya.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Ya.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ya.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!Ya.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!Ya.isSerializableHash(this._inner)||!Ya.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!Ya.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();Yb.HMAC=Pve;function z0t(r,e,t){var i=new Pve(r,e);i.update(t);var n=i.digest();return i.clean(),n}Yb.hmac=z0t;Yb.equal=j0t.equal});var kve=p(DP=>{u();"use strict";Object.defineProperty(DP,"__esModule",{value:!0});var Ove=Cve(),qve=Ga(),H0t=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=Ove.hmac(this._hash,i,t);this._hmac=new Ove.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),qve.wipe(this._buffer),qve.wipe(this._counter),this._bufpos=0},r}();DP.HKDF=H0t});var LP=p(fl=>{u();"use strict";Object.defineProperty(fl,"__esModule",{value:!0});var XE=$b(),QE=Ga();fl.DIGEST_LENGTH=32;fl.BLOCK_SIZE=64;var Bve=function(){function r(){this.digestLength=fl.DIGEST_LENGTH,this.blockSize=fl.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return r.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},r.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},r.prototype.clean=function(){QE.wipe(this._buffer),QE.wipe(this._temp),this.reset()},r.prototype.update=function(e,t){if(t===void 0&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var i=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[i++],t--;this._bufferLength===this.blockSize&&(MP(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(i=MP(this._temp,this._state,e,i,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[i++],t--;return this},r.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,i=this._bufferLength,n=t/536870912|0,s=t<<3,o=t%64<56?64:128;this._buffer[i]=128;for(var a=i+1;a<o-8;a++)this._buffer[a]=0;XE.writeUint32BE(n,this._buffer,o-8),XE.writeUint32BE(s,this._buffer,o-4),MP(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)XE.writeUint32BE(this._state[a],e,a*4);return this},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},r.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},r.prototype.cleanSavedState=function(e){QE.wipe(e.state),e.buffer&&QE.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},r}();fl.SHA256=Bve;var $0t=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function MP(r,e,t,i,n){for(;n>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],f=e[4],l=e[5],h=e[6],d=e[7],y=0;y<16;y++){var g=i+y*4;r[y]=XE.readUint32BE(t,g)}for(var y=16;y<64;y++){var m=r[y-2],E=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=r[y-15];var _=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;r[y]=(E+r[y-7]|0)+(_+r[y-16]|0)}for(var y=0;y<64;y++){var E=(((f>>>6|f<<32-6)^(f>>>11|f<<32-11)^(f>>>25|f<<32-25))+(f&l^~f&h)|0)+(d+($0t[y]+r[y]|0)|0)|0,_=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;d=h,h=l,l=f,f=c+E|0,c=a,a=o,o=s,s=E+_|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=f,e[5]+=l,e[6]+=h,e[7]+=d,i+=64,n-=64}return i}function G0t(r){var e=new Bve;e.update(r);var t=e.digest();return e.clean(),t}fl.hash=G0t});var Dve=p((Nve,Xb)=>{u();"use strict";(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Ho=="function"&&typeof Xb=="object"&&Xb&&Xb.exports&&(Xb.exports=e(Pi()))})(Nve,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots["libp2p-noise"]||(r.roots["libp2p-noise"]={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),f=0;f<c.length;++f)a[c[f]]!=null&&(this[c[f]]=a[c[f]])}return o.prototype.identityKey=i.newBuffer([]),o.prototype.identitySig=i.newBuffer([]),o.prototype.data=i.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,f){return f||(f=t.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&f.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&f.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&f.uint32(26).bytes(c.data),f},o.encodeDelimited=function(c,f){return this.encode(c,f).ldelim()},o.decode=function(c,f){c instanceof e||(c=e.create(c));for(var l=f===void 0?c.len:c.pos+f,h=new n.pb.NoiseHandshakePayload;c.pos<l;){var d=c.uint32();switch(d>>>3){case 1:h.identityKey=c.bytes();break;case 2:h.identitySig=c.bytes();break;case 3:h.data=c.bytes();break;default:c.skipType(d&7);break}}return h},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||i.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||i.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||i.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof n.pb.NoiseHandshakePayload)return c;var f=new n.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?i.base64.decode(c.identityKey,f.identityKey=i.newBuffer(i.base64.length(c.identityKey)),0):c.identityKey.length&&(f.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?i.base64.decode(c.identitySig,f.identitySig=i.newBuffer(i.base64.length(c.identitySig)),0):c.identitySig.length&&(f.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?i.base64.decode(c.data,f.data=i.newBuffer(i.base64.length(c.data)),0):c.data.length&&(f.data=c.data)),f},o.toObject=function(c,f){f||(f={});var l={};return f.defaults&&(f.bytes===String?l.identityKey="":(l.identityKey=[],f.bytes!==Array&&(l.identityKey=i.newBuffer(l.identityKey))),f.bytes===String?l.identitySig="":(l.identitySig=[],f.bytes!==Array&&(l.identitySig=i.newBuffer(l.identitySig))),f.bytes===String?l.data="":(l.data=[],f.bytes!==Array&&(l.data=i.newBuffer(l.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(l.identityKey=f.bytes===String?i.base64.encode(c.identityKey,0,c.identityKey.length):f.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(l.identitySig=f.bytes===String?i.base64.encode(c.identitySig,0,c.identitySig.length):f.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(l.data=f.bytes===String?i.base64.encode(c.data,0,c.data.length):f.bytes===Array?Array.prototype.slice.call(c.data):c.data),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},o}(),s}(),n})});var hl=p(jt=>{u();"use strict";var W0t=jt&&jt.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Y0t=jt&&jt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),X0t=jt&&jt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&W0t(e,r,t);return Y0t(e,r),e},Mve=jt&&jt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jt,"__esModule",{value:!0});jt.isValidPublicKey=jt.getHkdf=jt.verifySignedPayload=jt.getHandshakePayload=jt.decodePayload=jt.getPeerIdFromPayload=jt.signPayload=jt.createHandshakePayload=jt.getPayload=jt.generateKeypair=void 0;var Q0t=kve(),J0t=LP(),Z0t=X0t(WE()),Gn=pt(),UP=Mve(rt()),eyt=Ea(),tyt=Dve(),ryt=Mve(fi()),JE=tyt.pb.NoiseHandshakePayload;function iyt(){let r=Z0t.generateKeyPair();return{publicKey:Gn.Buffer.from(r.publicKey.buffer,r.publicKey.byteOffset,r.publicKey.length),privateKey:Gn.Buffer.from(r.secretKey.buffer,r.secretKey.byteOffset,r.secretKey.length)}}jt.generateKeypair=iyt;async function nyt(r,e,t){let i=await Uve(r,FP(e)),n=t??Gn.Buffer.alloc(0);return Lve(r.marshalPubKey(),i,n)}jt.getPayload=nyt;function Lve(r,e,t){let i=JE.create({identityKey:Gn.Buffer.from(r),identitySig:e,data:t??null});return Gn.Buffer.from(JE.encode(i).finish())}jt.createHandshakePayload=Lve;async function Uve(r,e){return Gn.Buffer.from(await r.privKey.sign(e))}jt.signPayload=Uve;async function syt(r){return await UP.default.createFromPubKey(Gn.Buffer.from(r.identityKey))}jt.getPeerIdFromPayload=syt;function oyt(r){return JE.toObject(JE.decode(Gn.Buffer.from(r)))}jt.decodePayload=oyt;function FP(r){return Gn.Buffer.concat([Gn.Buffer.from("noise-libp2p-static-key:"),r])}jt.getHandshakePayload=FP;async function ayt(r,e){let t=await UP.default.createFromPubKey(e);return ryt.default(t.id,r)}async function cyt(r,e,t){let i=Gn.Buffer.from(e.identityKey);if(!await ayt(t.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=FP(r),s=eyt.keys.unmarshalPublicKey(i);if(!e.identitySig||!s.verify(n,Gn.Buffer.from(e.identitySig)))throw new Error("Static key doesn't match to peer that signed payload!");return await UP.default.createFromPubKey(i)}jt.verifySignedPayload=cyt;function uyt(r,e){let i=new Q0t.HKDF(J0t.SHA256,e,r).expand(96),n=Gn.Buffer.from(i.buffer,i.byteOffset,i.length),s=n.slice(0,32),o=n.slice(32,64),a=n.slice(64,96);return[s,o,a]}jt.getHkdf=uyt;function lyt(r){return!(!Gn.Buffer.isBuffer(r)||r.length!==32)}jt.isValidPublicKey=lyt});var Kve=p(ZE=>{u();"use strict";Object.defineProperty(ZE,"__esModule",{value:!0});var dn=$b(),KP=Ga(),fyt=20;function hyt(r,e,t){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=t[3]<<24|t[2]<<16|t[1]<<8|t[0],c=t[7]<<24|t[6]<<16|t[5]<<8|t[4],f=t[11]<<24|t[10]<<16|t[9]<<8|t[8],l=t[15]<<24|t[14]<<16|t[13]<<8|t[12],h=t[19]<<24|t[18]<<16|t[17]<<8|t[16],d=t[23]<<24|t[22]<<16|t[21]<<8|t[20],y=t[27]<<24|t[26]<<16|t[25]<<8|t[24],g=t[31]<<24|t[30]<<16|t[29]<<8|t[28],m=e[3]<<24|e[2]<<16|e[1]<<8|e[0],E=e[7]<<24|e[6]<<16|e[5]<<8|e[4],_=e[11]<<24|e[10]<<16|e[9]<<8|e[8],T=e[15]<<24|e[14]<<16|e[13]<<8|e[12],q=i,z=n,V=s,M=o,$=a,X=c,Q=f,O=l,b=h,w=d,S=y,C=g,B=m,G=E,F=_,N=T,v=0;v<fyt;v+=2)q=q+$|0,B^=q,B=B>>>32-16|B<<16,b=b+B|0,$^=b,$=$>>>32-12|$<<12,z=z+X|0,G^=z,G=G>>>32-16|G<<16,w=w+G|0,X^=w,X=X>>>32-12|X<<12,V=V+Q|0,F^=V,F=F>>>32-16|F<<16,S=S+F|0,Q^=S,Q=Q>>>32-12|Q<<12,M=M+O|0,N^=M,N=N>>>32-16|N<<16,C=C+N|0,O^=C,O=O>>>32-12|O<<12,V=V+Q|0,F^=V,F=F>>>32-8|F<<8,S=S+F|0,Q^=S,Q=Q>>>32-7|Q<<7,M=M+O|0,N^=M,N=N>>>32-8|N<<8,C=C+N|0,O^=C,O=O>>>32-7|O<<7,z=z+X|0,G^=z,G=G>>>32-8|G<<8,w=w+G|0,X^=w,X=X>>>32-7|X<<7,q=q+$|0,B^=q,B=B>>>32-8|B<<8,b=b+B|0,$^=b,$=$>>>32-7|$<<7,q=q+X|0,N^=q,N=N>>>32-16|N<<16,S=S+N|0,X^=S,X=X>>>32-12|X<<12,z=z+Q|0,B^=z,B=B>>>32-16|B<<16,C=C+B|0,Q^=C,Q=Q>>>32-12|Q<<12,V=V+O|0,G^=V,G=G>>>32-16|G<<16,b=b+G|0,O^=b,O=O>>>32-12|O<<12,M=M+$|0,F^=M,F=F>>>32-16|F<<16,w=w+F|0,$^=w,$=$>>>32-12|$<<12,V=V+O|0,G^=V,G=G>>>32-8|G<<8,b=b+G|0,O^=b,O=O>>>32-7|O<<7,M=M+$|0,F^=M,F=F>>>32-8|F<<8,w=w+F|0,$^=w,$=$>>>32-7|$<<7,z=z+Q|0,B^=z,B=B>>>32-8|B<<8,C=C+B|0,Q^=C,Q=Q>>>32-7|Q<<7,q=q+X|0,N^=q,N=N>>>32-8|N<<8,S=S+N|0,X^=S,X=X>>>32-7|X<<7;dn.writeUint32LE(q+i|0,r,0),dn.writeUint32LE(z+n|0,r,4),dn.writeUint32LE(V+s|0,r,8),dn.writeUint32LE(M+o|0,r,12),dn.writeUint32LE($+a|0,r,16),dn.writeUint32LE(X+c|0,r,20),dn.writeUint32LE(Q+f|0,r,24),dn.writeUint32LE(O+l|0,r,28),dn.writeUint32LE(b+h|0,r,32),dn.writeUint32LE(w+d|0,r,36),dn.writeUint32LE(S+y|0,r,40),dn.writeUint32LE(C+g|0,r,44),dn.writeUint32LE(B+m|0,r,48),dn.writeUint32LE(G+E|0,r,52),dn.writeUint32LE(F+_|0,r,56),dn.writeUint32LE(N+T|0,r,60)}function Fve(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<t.length;c+=64){hyt(a,s,r);for(var f=c;f<c+64&&f<t.length;f++)i[f]=t[f]^a[f-c];pyt(s,0,o)}return KP.wipe(a),n===0&&KP.wipe(s),i}ZE.streamXOR=Fve;function dyt(r,e,t,i){return i===void 0&&(i=0),KP.wipe(t),Fve(r,e,t,t,i)}ZE.stream=dyt;function pyt(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}});var Vve=p(Hc=>{u();"use strict";Object.defineProperty(Hc,"__esModule",{value:!0});var yyt=YE(),eS=Ga();Hc.DIGEST_LENGTH=16;var jve=function(){function r(e){this.digestLength=Hc.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=t&8191;var i=e[2]|e[3]<<8;this._r[1]=(t>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var f=e[14]|e[15]<<8;this._r[8]=(c>>>8|f<<8)&8191,this._r[9]=f>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return r.prototype._blocks=function(e,t,i){for(var n=this._fin?0:1<<11,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],f=this._h[4],l=this._h[5],h=this._h[6],d=this._h[7],y=this._h[8],g=this._h[9],m=this._r[0],E=this._r[1],_=this._r[2],T=this._r[3],q=this._r[4],z=this._r[5],V=this._r[6],M=this._r[7],$=this._r[8],X=this._r[9];i>=16;){var Q=e[t+0]|e[t+1]<<8;s+=Q&8191;var O=e[t+2]|e[t+3]<<8;o+=(Q>>>13|O<<3)&8191;var b=e[t+4]|e[t+5]<<8;a+=(O>>>10|b<<6)&8191;var w=e[t+6]|e[t+7]<<8;c+=(b>>>7|w<<9)&8191;var S=e[t+8]|e[t+9]<<8;f+=(w>>>4|S<<12)&8191,l+=S>>>1&8191;var C=e[t+10]|e[t+11]<<8;h+=(S>>>14|C<<2)&8191;var B=e[t+12]|e[t+13]<<8;d+=(C>>>11|B<<5)&8191;var G=e[t+14]|e[t+15]<<8;y+=(B>>>8|G<<8)&8191,g+=G>>>5|n;var F=0,N=F;N+=s*m,N+=o*(5*X),N+=a*(5*$),N+=c*(5*M),N+=f*(5*V),F=N>>>13,N&=8191,N+=l*(5*z),N+=h*(5*q),N+=d*(5*T),N+=y*(5*_),N+=g*(5*E),F+=N>>>13,N&=8191;var v=F;v+=s*E,v+=o*m,v+=a*(5*X),v+=c*(5*$),v+=f*(5*M),F=v>>>13,v&=8191,v+=l*(5*V),v+=h*(5*z),v+=d*(5*q),v+=y*(5*T),v+=g*(5*_),F+=v>>>13,v&=8191;var D=F;D+=s*_,D+=o*E,D+=a*m,D+=c*(5*X),D+=f*(5*$),F=D>>>13,D&=8191,D+=l*(5*M),D+=h*(5*V),D+=d*(5*z),D+=y*(5*q),D+=g*(5*T),F+=D>>>13,D&=8191;var ae=F;ae+=s*T,ae+=o*_,ae+=a*E,ae+=c*m,ae+=f*(5*X),F=ae>>>13,ae&=8191,ae+=l*(5*$),ae+=h*(5*M),ae+=d*(5*V),ae+=y*(5*z),ae+=g*(5*q),F+=ae>>>13,ae&=8191;var W=F;W+=s*q,W+=o*T,W+=a*_,W+=c*E,W+=f*m,F=W>>>13,W&=8191,W+=l*(5*X),W+=h*(5*$),W+=d*(5*M),W+=y*(5*V),W+=g*(5*z),F+=W>>>13,W&=8191;var ne=F;ne+=s*z,ne+=o*q,ne+=a*T,ne+=c*_,ne+=f*E,F=ne>>>13,ne&=8191,ne+=l*m,ne+=h*(5*X),ne+=d*(5*$),ne+=y*(5*M),ne+=g*(5*V),F+=ne>>>13,ne&=8191;var oe=F;oe+=s*V,oe+=o*z,oe+=a*q,oe+=c*T,oe+=f*_,F=oe>>>13,oe&=8191,oe+=l*E,oe+=h*m,oe+=d*(5*X),oe+=y*(5*$),oe+=g*(5*M),F+=oe>>>13,oe&=8191;var de=F;de+=s*M,de+=o*V,de+=a*z,de+=c*q,de+=f*T,F=de>>>13,de&=8191,de+=l*_,de+=h*E,de+=d*m,de+=y*(5*X),de+=g*(5*$),F+=de>>>13,de&=8191;var pe=F;pe+=s*$,pe+=o*M,pe+=a*V,pe+=c*z,pe+=f*q,F=pe>>>13,pe&=8191,pe+=l*T,pe+=h*_,pe+=d*E,pe+=y*m,pe+=g*(5*X),F+=pe>>>13,pe&=8191;var _e=F;_e+=s*X,_e+=o*$,_e+=a*M,_e+=c*V,_e+=f*z,F=_e>>>13,_e&=8191,_e+=l*q,_e+=h*T,_e+=d*_,_e+=y*E,_e+=g*m,F+=_e>>>13,_e&=8191,F=(F<<2)+F|0,F=F+N|0,N=F&8191,F=F>>>13,v+=F,s=N,o=v,a=D,c=ae,f=W,l=ne,h=oe,d=de,y=pe,g=_e,t+=16,i-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=f,this._h[5]=l,this._h[6]=h,this._h[7]=d,this._h[8]=y,this._h[9]=g},r.prototype.finish=function(e,t){t===void 0&&(t=0);var i=new Uint16Array(10),n,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=n,n=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,i[0]=this._h[0]+5,n=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this._h[a]+n,n=i[a]>>>13,i[a]&=8191;for(i[9]-=1<<13,s=(n^1)-1,a=0;a<10;a++)i[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|i[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},r.prototype.update=function(e){var t=0,i=e.length,n;if(this._leftover){n=16-this._leftover,n>i&&(n=i);for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[t+s];if(i-=n,t+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(n=i-i%16,this._blocks(e,t,n),t+=n,i-=n),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[t+s];this._leftover+=i}return this},r.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},r.prototype.clean=function(){return eS.wipe(this._buffer),eS.wipe(this._r),eS.wipe(this._h),eS.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},r}();Hc.Poly1305=jve;function gyt(r,e){var t=new jve(r);t.update(e);var i=t.digest();return t.clean(),i}Hc.oneTimeAuth=gyt;function byt(r,e){return r.length!==Hc.DIGEST_LENGTH||e.length!==Hc.DIGEST_LENGTH?!1:yyt.equal(r,e)}Hc.equal=byt});var $ve=p($c=>{u();"use strict";Object.defineProperty($c,"__esModule",{value:!0});var tS=Kve(),myt=Vve(),Qb=Ga(),zve=$b(),vyt=YE();$c.KEY_LENGTH=32;$c.NONCE_LENGTH=12;$c.TAG_LENGTH=16;var Hve=new Uint8Array(16),wyt=function(){function r(e){if(this.nonceLength=$c.NONCE_LENGTH,this.tagLength=$c.TAG_LENGTH,e.length!==$c.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return r.prototype.seal=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);tS.stream(this._key,s,o,4);var a=t.length+this.tagLength,c;if(n){if(n.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=n}else c=new Uint8Array(a);return tS.streamXOR(this._key,s,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),i),Qb.wipe(s),c},r.prototype.open=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);tS.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,t.subarray(0,t.length-this.tagLength),i),!vyt.equal(a,t.subarray(t.length-this.tagLength,t.length)))return null;var c=t.length-this.tagLength,f;if(n){if(n.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");f=n}else f=new Uint8Array(c);return tS.streamXOR(this._key,s,t.subarray(0,t.length-this.tagLength),f,4),Qb.wipe(s),f},r.prototype.clean=function(){return Qb.wipe(this._key),this},r.prototype._authenticate=function(e,t,i,n){var s=new myt.Poly1305(t);n&&(s.update(n),n.length%16>0&&s.update(Hve.subarray(n.length%16))),s.update(i),i.length%16>0&&s.update(Hve.subarray(i.length%16));var o=new Uint8Array(8);n&&zve.writeUint64LE(n.length,o),s.update(o),zve.writeUint64LE(i.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),Qb.wipe(a),Qb.wipe(o)},r}();$c.ChaCha20Poly1305=wyt});var rS=p(Gc=>{u();"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.DUMP_SESSION_KEYS=Gc.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Gc.NOISE_MSG_MAX_LENGTH_BYTES=void 0;Gc.NOISE_MSG_MAX_LENGTH_BYTES=65535;Gc.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Gc.NOISE_MSG_MAX_LENGTH_BYTES-16;Gc.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var f0=p(Xi=>{u();"use strict";var _yt=Xi&&Xi.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Xi,"__esModule",{value:!0});Xi.logCipherState=Xi.logRemoteEphemeralKey=Xi.logRemoteStaticKey=Xi.logLocalEphemeralKeys=Xi.logLocalStaticKeys=Xi.logger=void 0;var Eyt=_yt(me()),Syt=rS();Xi.logger=Eyt.default("libp2p:noise");var Gs;Syt.DUMP_SESSION_KEYS?Gs=Xi.logger:Gs=()=>{};function Ayt(r){Gs(`LOCAL_STATIC_PUBLIC_KEY ${r.publicKey.toString("hex")}`),Gs(`LOCAL_STATIC_PRIVATE_KEY ${r.privateKey.toString("hex")}`)}Xi.logLocalStaticKeys=Ayt;function xyt(r){r?(Gs(`LOCAL_PUBLIC_EPHEMERAL_KEY ${r.publicKey.toString("hex")}`),Gs(`LOCAL_PRIVATE_EPHEMERAL_KEY ${r.privateKey.toString("hex")}`)):Gs("Missing local ephemeral keys.")}Xi.logLocalEphemeralKeys=xyt;function Iyt(r){Gs(`REMOTE_STATIC_PUBLIC_KEY ${r.toString("hex")}`)}Xi.logRemoteStaticKey=Iyt;function Tyt(r){Gs(`REMOTE_EPHEMERAL_PUBLIC_KEY ${r.toString("hex")}`)}Xi.logRemoteEphemeralKey=Tyt;function Ryt(r){r.cs1&&r.cs2?(Gs(`CIPHER_STATE_1 ${r.cs1.n} ${r.cs1.k.toString("hex")}`),Gs(`CIPHER_STATE_2 ${r.cs2.n} ${r.cs2.k.toString("hex")}`)):Gs("Missing cipher state.")}Xi.logCipherState=Ryt});var jP=p(hs=>{u();"use strict";var Pyt=hs&&hs.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Cyt=hs&&hs.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Gve=hs&&hs.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Pyt(e,r,t);return Cyt(e,r),e};Object.defineProperty(hs,"__esModule",{value:!0});hs.AbstractHandshake=hs.MIN_NONCE=void 0;var Qi=pt(),Oyt=Gve(WE()),qyt=Gve(LP()),Wve=$ve(),Yve=hl(),kyt=f0();hs.MIN_NONCE=0;var Xve=class{encryptWithAd(e,t,i){let n=this.encrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,t,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,t){e.n=t}createEmptyKey(){return Qi.Buffer.alloc(32)}isEmptyKey(e){return this.createEmptyKey().equals(e)}incrementNonce(e){return e+1}nonceToBytes(e){let t=Qi.Buffer.alloc(12);return t.writeUInt32LE(e,4),t}encrypt(e,t,i,n){let s=this.nonceToBytes(t),a=new Wve.ChaCha20Poly1305(e).seal(s,n,i);return Qi.Buffer.from(a.buffer,a.byteOffset,a.length)}encryptAndHash(e,t){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,i),i}decrypt(e,t,i,n){let s=this.nonceToBytes(t),a=new Wve.ChaCha20Poly1305(e).open(s,n,i);return a?{plaintext:Qi.Buffer.from(a.buffer,a.byteOffset,a.length),valid:!0}:{plaintext:Qi.Buffer.from(""),valid:!1}}decryptAndHash(e,t){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,t),{plaintext:i,valid:n}}dh(e,t){try{let i=Oyt.sharedKey(e,t),n=Qi.Buffer.from(i.buffer,i.byteOffset,i.length),s=Qi.Buffer.alloc(32);return n.copy(s),s}catch(i){return kyt.logger(i.message),Qi.Buffer.alloc(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){let i=qyt.hash(Qi.Buffer.from([...e,...t]));return Qi.Buffer.from(i.buffer,i.byteOffset,i.length)}mixKey(e,t){let[i,n]=Yve.getHkdf(e.ck,t);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){let t=hs.MIN_NONCE;return{k:e,n:t}}initializeSymmetric(e){let t=Qi.Buffer.from(e,"utf-8"),i=this.hashProtocolName(t),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let t=Qi.Buffer.alloc(32);return e.copy(t),t}else return this.getHash(e,Qi.Buffer.alloc(0))}split(e){let[t,i]=Yve.getHkdf(e.ck,Qi.Buffer.alloc(0)),n=this.initializeKey(t),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,t){let i=this.encryptWithAd(e,Qi.Buffer.alloc(0),t),n=this.createEmptyKey(),s=Qi.Buffer.alloc(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,t){return this.decryptWithAd(e,Qi.Buffer.alloc(0),t.ciphertext)}};hs.AbstractHandshake=Xve});var Jve=p(iS=>{u();"use strict";Object.defineProperty(iS,"__esModule",{value:!0});iS.XX=void 0;var rh=pt(),h0=hl(),Byt=jP(),Qve=class extends Byt.AbstractHandshake{initializeInitiator(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=rh.Buffer.alloc(32);return{ss:o,s:t,rs:i,psk:n,re:a}}initializeResponder(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=rh.Buffer.alloc(32);return{ss:o,s:t,rs:i,psk:n,re:a}}writeMessageA(e,t,i){let n=rh.Buffer.alloc(0);i!==void 0?e.e=i:e.e=h0.generateKeypair();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,t);return{ne:s,ns:n,ciphertext:o}}writeMessageB(e,t){e.e=h0.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=rh.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageC(e,t){let i=rh.Buffer.from(e.s.publicKey),n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,t),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:c,cs2:f}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:f}}readMessageA(e,t){return h0.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(h0.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&h0.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageC(e,t){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&i.length===32&&h0.isValidPublicKey(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&o,cs1:a,cs2:c}}initSession(e,t,i){let n=this.createEmptyKey(),s=rh.Buffer.alloc(32),o;return e?o=this.initializeInitiator(t,i,s,n):o=this.initializeResponder(t,i,s,n),{hs:o,i:e,mc:0}}sendMessage(e,t,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,t,i);else if(e.mc===1)n=this.writeMessageB(e.hs,t);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,t);n=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,t){let i=rh.Buffer.alloc(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,t));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,t));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:f}=this.readMessageC(e.hs,t);i=o,n=a,e.h=s,e.cs1=c,e.cs2=f}return e.mc++,{plaintext:i,valid:n}}};iS.XX=Qve});var Jb=p(yi=>{u();"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.decode2=yi.decode1=yi.decode0=yi.encode2=yi.encode1=yi.encode0=yi.uint16BEDecode=yi.uint16BEEncode=void 0;var d0=pt(),Nyt=(r,e,t)=>(e=e||d0.Buffer.allocUnsafe(2),e.writeUInt16BE(r,t),e);yi.uint16BEEncode=Nyt;yi.uint16BEEncode.bytes=2;var Dyt=r=>{if(r.length<2)throw RangeError("Could not decode int16BE");return r.readUInt16BE(0)};yi.uint16BEDecode=Dyt;yi.uint16BEDecode.bytes=2;function Myt(r){return d0.Buffer.concat([r.ne,r.ciphertext])}yi.encode0=Myt;function Lyt(r){return d0.Buffer.concat([r.ne,r.ns,r.ciphertext])}yi.encode1=Lyt;function Uyt(r){return d0.Buffer.concat([r.ns,r.ciphertext])}yi.encode2=Uyt;function Fyt(r){if(r.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:r.slice(0,32),ciphertext:r.slice(32,r.length),ns:d0.Buffer.alloc(0)}}yi.decode0=Fyt;function Kyt(r){if(r.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:r.slice(0,32),ns:r.slice(32,80),ciphertext:r.slice(80,r.length)}}yi.decode1=Kyt;function jyt(r){if(r.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:d0.Buffer.alloc(0),ns:r.slice(0,48),ciphertext:r.slice(48,r.length)}}yi.decode2=jyt});var VP=p(nS=>{u();"use strict";Object.defineProperty(nS,"__esModule",{value:!0});nS.XXHandshake=void 0;var Zb=pt(),Vyt=Jve(),p0=hl(),ci=f0(),y0=Jb(),Zve=class{constructor(e,t,i,n,s,o,a){this.isInitiator=e,this.payload=t,this.prologue=i,this.staticKeypair=n,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new Vyt.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=Zb.Buffer.alloc(0)}async propose(){if(ci.logLocalStaticKeys(this.session.hs.s),this.isInitiator){ci.logger("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,Zb.Buffer.alloc(0));this.connection.writeLP(y0.encode0(e)),ci.logger("Stage 0 - Initiator finished sending first message."),ci.logLocalEphemeralKeys(this.session.hs.e)}else{ci.logger("Stage 0 - Responder waiting to receive first message...");let e=y0.decode0((await this.connection.readLP()).slice()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new Error("xx handshake stage 0 validation fail");ci.logger("Stage 0 - Responder received first message."),ci.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){ci.logger("Stage 1 - Initiator waiting to receive first message from responder...");let e=y0.decode1((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");ci.logger("Stage 1 - Initiator received the message."),ci.logRemoteEphemeralKey(this.session.hs.re),ci.logRemoteStaticKey(this.session.hs.rs),ci.logger("Initiator going to check remote's signature...");try{let n=await p0.decodePayload(t);this.remotePeer=this.remotePeer||await p0.getPeerIdFromPayload(n),this.remotePeer=await p0.verifySignedPayload(e.ns,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}ci.logger("All good with the signature!")}else{ci.logger("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(y0.encode1(e)),ci.logger("Stage 1 - Responder sent the second handshake message with signed payload."),ci.logLocalEphemeralKeys(this.session.hs.e)}}async finish(){if(this.isInitiator){ci.logger("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(y0.encode2(e)),ci.logger("Stage 2 - Initiator sent message with signed payload.")}else{ci.logger("Stage 2 - Responder waiting for third handshake message...");let e=y0.decode2((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");ci.logger("Stage 2 - Responder received the message, finished handshake.");try{let n=await p0.decodePayload(t);this.remotePeer=this.remotePeer||await p0.getPeerIdFromPayload(n),await p0.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}ci.logCipherState(this.session)}encrypt(e,t){let i=this.getCS(t);return this.xx.encryptWithAd(i,Zb.Buffer.alloc(0),e)}decrypt(e,t){let i=this.getCS(t,!1);return this.xx.decryptWithAd(i,Zb.Buffer.alloc(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=Zb.Buffer.from(e.buffer,e.byteOffset,e.length))}};nS.XXHandshake=Zve});var twe=p(oS=>{u();"use strict";Object.defineProperty(oS,"__esModule",{value:!0});oS.IK=void 0;var sS=pt(),em=hl(),zyt=jP(),ewe=class extends zyt.AbstractHandshake{initSession(e,t,i,n){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(t,i,n,s):o=this.initializeResponder(t,i,n,s),{hs:o,i:e,mc:0}}sendMessage(e,t){let i;if(e.mc===0)i=this.writeMessageA(e.hs,t);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,t);i=n,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,t){let i=sS.Buffer.alloc(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,t)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:f}=this.readMessageB(e.hs,t);i=s,n=o,e.h=a,e.cs1=c,e.cs2=f}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,t){e.e=em.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=sS.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageB(e,t){e.e=em.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,t),s=this.createEmptyKey(),o={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,t){em.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&em.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageB(e,t){if(em.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:o}}initializeInitiator(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,i);let a=sS.Buffer.alloc(32);return{ss:o,s:t,rs:i,re:a,psk:n}}initializeResponder(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,t.publicKey);let a=sS.Buffer.alloc(32);return{ss:o,s:t,rs:i,re:a,psk:n}}};oS.IK=ewe});var iwe=p(aS=>{u();"use strict";Object.defineProperty(aS,"__esModule",{value:!0});aS.FailedIKError=void 0;var rwe=class extends Error{constructor(e,t){super(t);this.initialMsg=e,this.name="FailedIKhandshake"}};aS.FailedIKError=rwe});var owe=p(uS=>{u();"use strict";Object.defineProperty(uS,"__esModule",{value:!0});uS.IKHandshake=void 0;var Hyt=twe(),g0=pt(),cS=Jb(),b0=hl(),nwe=iwe(),Ai=f0(),swe=class{constructor(e,t,i,n,s,o,a,c){this.isInitiator=e,this.payload=g0.Buffer.from(t),this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new Hyt.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=g0.Buffer.alloc(0)}async stage0(){if(Ai.logLocalStaticKeys(this.session.hs.s),Ai.logRemoteStaticKey(this.session.hs.rs),this.isInitiator){Ai.logger("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(cS.encode1(e)),Ai.logger("IK Stage 0 - Initiator sent message."),Ai.logLocalEphemeralKeys(this.session.hs.e)}else{Ai.logger("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let t=cS.decode1(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");Ai.logger("IK Stage 0 - Responder got message, going to verify payload.");let s=await b0.decodePayload(i);this.remotePeer=this.remotePeer||await b0.getPeerIdFromPayload(s),await b0.verifySignedPayload(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),Ai.logger("IK Stage 0 - Responder successfully verified payload!"),Ai.logRemoteEphemeralKey(this.session.hs.re)}catch(t){let i=t;throw Ai.logger("Responder breaking up with IK handshake in stage 0."),new nwe.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){Ai.logger("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),t=cS.decode0(g0.Buffer.from(e)),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);Ai.logger("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await b0.decodePayload(i);this.remotePeer=this.remotePeer||await b0.getPeerIdFromPayload(s),await b0.verifySignedPayload(t.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),Ai.logger("IK Stage 1 - Initiator successfully verified payload!"),Ai.logRemoteEphemeralKey(this.session.hs.re)}catch(s){let o=s;throw Ai.logger("Initiator breaking up with IK handshake in stage 1."),new nwe.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{Ai.logger("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(cS.encode0(e)),Ai.logger("IK Stage 1 - Responder sent message..."),Ai.logLocalEphemeralKeys(this.session.hs.e)}Ai.logCipherState(this.session)}decrypt(e,t){let i=this.getCS(t,!1);return this.ik.decryptWithAd(i,g0.Buffer.alloc(0),e)}encrypt(e,t){let i=this.getCS(t);return this.ik.encryptWithAd(i,g0.Buffer.alloc(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=g0.Buffer.from(e.buffer,e.byteOffset,e.length))}};uS.IKHandshake=swe});var uwe=p(lS=>{u();"use strict";Object.defineProperty(lS,"__esModule",{value:!0});lS.XXFallbackHandshake=void 0;var zP=pt(),$yt=VP(),HP=hl(),Ws=f0(),awe=Jb(),cwe=class extends $yt.XXHandshake{constructor(e,t,i,n,s,o,a,c,f){super(e,t,i,n,s,a,f);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,zP.Buffer.alloc(0),this.ephemeralKeys),Ws.logger("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),Ws.logLocalEphemeralKeys(this.session.hs.e);else{Ws.logger("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=awe.decode0(this.initialMsg),{valid:t}=this.xx.recvMessage(this.session,{ne:e.ne,ns:zP.Buffer.alloc(0),ciphertext:zP.Buffer.alloc(0)});if(!t)throw new Error("xx fallback stage 0 decryption validation fail");Ws.logger("XX Fallback Stage 0 - Responder used received message from IK."),Ws.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=awe.decode1(this.initialMsg),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");Ws.logger("XX Fallback Stage 1 - Initiator used received message from IK."),Ws.logRemoteEphemeralKey(this.session.hs.re),Ws.logRemoteStaticKey(this.session.hs.rs),Ws.logger("Initiator going to check remote's signature...");try{let n=await HP.decodePayload(t);this.remotePeer=this.remotePeer||await HP.getPeerIdFromPayload(n),await HP.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}Ws.logger("All good with the signature!")}else Ws.logger("XX Fallback Stage 1 - Responder start"),await super.exchange(),Ws.logger("XX Fallback Stage 1 - Responder end")}};lS.XXFallbackHandshake=cwe});var fwe=p(m0=>{u();"use strict";Object.defineProperty(m0,"__esModule",{value:!0});m0.decryptStream=m0.encryptStream=void 0;var lwe=pt(),fS=rS();function Gyt(r){return async function*(e){for await(let t of e){let i=lwe.Buffer.from(t.buffer,t.byteOffset,t.length);for(let n=0;n<i.length;n+=fS.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let s=n+fS.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;s>i.length&&(s=i.length),yield r.encrypt(i.slice(n,s),r.session)}}}}m0.encryptStream=Gyt;function Wyt(r){return async function*(e){for await(let t of e){let i=lwe.Buffer.from(t.buffer,t.byteOffset,t.length);for(let n=0;n<i.length;n+=fS.NOISE_MSG_MAX_LENGTH_BYTES){let s=n+fS.NOISE_MSG_MAX_LENGTH_BYTES;s>i.length&&(s=i.length);let o=i.slice(n,s),{plaintext:a,valid:c}=await r.decrypt(o,r.session);if(!c)throw new Error("Failed to validate decrypted chunk");yield a}}}}m0.decryptStream=Wyt});var dwe=p(hS=>{u();"use strict";Object.defineProperty(hS,"__esModule",{value:!0});hS.KeyCache=void 0;var hwe=class{constructor(){this.storage=new Map}store(e,t){this.storage.set(e.id,t)}load(e){var t;return e&&(t=this.storage.get(e.id))!==null&&t!==void 0?t:null}resetStorage(){this.storage.clear()}},Yyt=new hwe;hS.KeyCache=Yyt});var GP=p(Ys=>{u();"use strict";var Xyt=Ys&&Ys.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Qyt=Ys&&Ys.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Jyt=Ys&&Ys.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Xyt(e,r,t);return Qyt(e,r),e},dS=Ys&&Ys.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.Noise=void 0;var Zyt=Jyt(WE()),tm=pt(),pwe=dS(_ve()),egt=dS(Ive()),ywe=dS(Z2()),tgt=dS(Gr()),gwe=To(),rgt=VP(),igt=owe(),ngt=uwe(),bwe=hl(),v0=Jb(),mwe=fwe(),$P=dwe(),sgt=f0(),vwe=rS(),wwe=class{constructor(e,t){if(this.protocol="/noise",this.prologue=tm.Buffer.alloc(0),this.earlyData=t??tm.Buffer.alloc(0),this.useNoisePipes=!1,e){let i=Zyt.generateKeyPairFromSeed(e);this.staticKeys={privateKey:tm.Buffer.from(i.secretKey.buffer,i.secretKey.byteOffset,i.secretKey.length),publicKey:tm.Buffer.from(i.publicKey.buffer,i.publicKey.byteOffset,i.publicKey.length)}}else this.staticKeys=bwe.generateKeypair()}async secureOutbound(e,t,i){let n=pwe.default(t,{lengthEncoder:v0.uint16BEEncode,lengthDecoder:v0.uint16BEDecode,maxDataLength:vwe.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,t,i){let n=pwe.default(t,{lengthEncoder:v0.uint16BEEncode,lengthDecoder:v0.uint16BEDecode,maxDataLength:vwe.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var t;let i=await bwe.getPayload(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&$P.KeyCache.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new igt.IKHandshake(a,i,this.prologue,this.staticKeys,o,(t=$P.KeyCache.load(e.remotePeer))!==null&&t!==void 0?t:tm.Buffer.alloc(32),s);try{return await this.performIKHandshake(c)}catch(f){let l;return e.isInitiator&&(l=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,i,f.initialMsg,l)}}else return await this.performXXHandshake(e,i)}async performXXFallbackHandshake(e,t,i,n){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new ngt.XXFallbackHandshake(s,t,this.prologue,this.staticKeys,a,i,o,n);try{await c.propose(),await c.exchange(),await c.finish()}catch(f){sgt.logger(f);let l=f;throw new Error(`Error occurred during XX Fallback handshake: ${l.message}`)}return c}async performXXHandshake(e,t){let{isInitiator:i,remotePeer:n,connection:s}=e,o=new rgt.XXHandshake(i,t,this.prologue,this.staticKeys,s,n);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&$P.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,t){let[i,n]=egt.default(),s=e.unwrap();return await tgt.default(i,ywe.default,mwe.encryptStream(t),gwe.encode({lengthEncoder:v0.uint16BEEncode}),s,gwe.decode({lengthDecoder:v0.uint16BEDecode}),ywe.default,mwe.decryptStream(t),i),n}};Ys.Noise=wwe});var _we=p(Wc=>{u();"use strict";var ogt=Wc&&Wc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),agt=Wc&&Wc.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ogt(e,r,t)};Object.defineProperty(Wc,"__esModule",{value:!0});Wc.NOISE=void 0;var cgt=GP();agt(GP(),Wc);Wc.NOISE=new cgt.Noise});var Awe=p((YBt,Swe)=>{u();"use strict";var ugt=N8(),{EventEmitter:lgt}=br();function Ewe(r,e){if(r===e)return!0;if(r.length!==e.length)return!1;for(let t=0,i=r.length;t<i;++t)if(r[t]!==e[t])return!1;return!0}function WP(){return{contacts:[],dontSplit:!1,left:null,right:null}}function rm(r,e){if(!(e instanceof Uint8Array))throw new TypeError(r+" is not a Uint8Array")}var im=class extends lgt{constructor(e={}){super();this.localNodeId=e.localNodeId||ugt(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||im.distance,this.arbiter=e.arbiter||im.arbiter,this.metadata=Object.assign({},e.metadata),rm("option.localNodeId as parameter 1",this.localNodeId),this.root=WP()}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let i=0,n=0,s=Math.min(e.length,t.length),o=Math.max(e.length,t.length);for(;n<s;++n)i=i*256+(e[n]^t[n]);for(;n<o;++n)i=i*256+255;return i}add(e){rm("contact.id",(e||{}).id);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e.id,t++);let n=this._indexOf(i,e.id);return n>=0?(this._update(i,n,e),this):i.contacts.length<this.numberOfNodesPerKBucket?(i.contacts.push(e),this.emit("added",e),this):i.dontSplit?(this.emit("ping",i.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(i,t),this.add(e))}closest(e,t=1/0){if(rm("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let i=[];for(let n=[this.root],s=0;n.length>0&&i.length<t;){let o=n.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);n.push(o.left===a?o.right:o.left),n.push(a)}else i=i.concat(o.contacts)}return i.map(n=>[this.distance(n.id,e),n]).sort((n,s)=>n[0]-s[0]).slice(0,t).map(n=>n[1])}count(){let e=0;for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e+=i.contacts.length}return e}_determineNode(e,t,i){let n=i>>3,s=i%8;return t.length<=n&&s!==0?e.left:t[n]&1<<7-s?e.right:e.left}get(e){rm("id",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);return n>=0?i.contacts[n]:null}_indexOf(e,t){for(let i=0;i<e.contacts.length;++i)if(Ewe(e.contacts[i].id,t))return i;return-1}remove(e){rm("the id as parameter 1",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);if(n>=0){let s=i.contacts.splice(n,1)[0];this.emit("removed",s)}return this}_split(e,t){e.left=WP(),e.right=WP();for(let s of e.contacts)this._determineNode(e,s.id,t).contacts.push(s);e.contacts=null;let i=this._determineNode(e,this.localNodeId,t),n=e.left===i?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e=e.concat(i.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let t=e.pop();t.contacts===null?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,i){if(!Ewe(e.contacts[t].id,i.id))throw new Error("wrong index for _update");let n=e.contacts[t],s=this.arbiter(n,i);s===n&&n!==i||(e.contacts.splice(t,1),e.contacts.push(s),this.emit("updated",n,s))}};Swe.exports=im});var pS=p((XBt,xwe)=>{u();xwe.exports=dl;function dl(r,e){if(r.length!==e.length)throw new Error("Inputs should have the same length");for(var t=Buffer.allocUnsafe(r.length),i=0;i<r.length;i++)t[i]=r[i]^e[i];return t}dl.compare=function(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");for(var i=0;i<e.length;i++)if(e[i]!==t[i])return e[i]<t[i]?-1:1;return 0};dl.gt=function(e,t){return dl.compare(e,t)===1};dl.lt=function(e,t){return dl.compare(e,t)===-1};dl.eq=function(e,t){return dl.compare(e,t)===0}});var yS=p((QBt,Iwe)=>{u();"use strict";var fgt=IR();Iwe.exports=async(r,e,{concurrency:t=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(t)||t===1/0)&&t>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`);let o=[],a=[],c=r[Symbol.iterator](),f=!1,l=!1,h=0,d=0,y=()=>{if(f)return;let g=c.next(),m=d;if(d++,g.done){l=!0,h===0&&(!i&&a.length!==0?s(new fgt(a)):n(o));return}h++,(async()=>{try{let E=await g.value;o[m]=await e(E,m),h--,y()}catch(E){i?(f=!0,s(E)):(a.push(E),h--,y())}})()};for(let g=0;g<t&&(y(),!l);g++);})});var w0=p((JBt,gS)=>{u();"use strict";var YP=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},Twe=(r,e,t,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(r);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{o(t())}catch(l){a(l)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,f=t instanceof Error?t:new YP(c);typeof r.cancel=="function"&&r.cancel(),a(f)},e),(async()=>{try{o(await r)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};gS.exports=Twe;gS.exports.default=Twe;gS.exports.TimeoutError=YP});var li=p(ui=>{u();"use strict";var XP=me(),{sha256:Rwe}=(Hr(),Ir),{base58btc:hgt}=(zr(),Vr),{Key:dgt}=Lt(),Pwe=pS(),pgt=yS(),{Record:ygt}=sf(),ggt=rt(),bgt=ue(),mgt=_n(),Cwe=ct(),Owe=Ze(),qwe=w0();ui.convertBuffer=async r=>(await Rwe.digest(r)).digest;ui.convertPeerId=async r=>(await Rwe.digest(r.id)).digest;ui.bufferToKey=r=>new dgt("/"+ui.encodeBase32(r),!1);ui.keyForPublicKey=r=>mgt([Cwe("/pk/"),r.id]);ui.isPublicKeyKey=r=>Owe(r.slice(0,4))==="/pk/";ui.fromPublicKeyKey=r=>new ggt(r.slice(4));ui.now=()=>Date.now();ui.encodeBase32=r=>Owe(r,"base32");ui.decodeBase32=r=>Cwe(r,"base32");ui.sortClosestPeers=async(r,e)=>(await pgt(r,async i=>{let n=await ui.convertPeerId(i);return{peer:i,distance:Pwe(n,e)}})).sort(ui.xorCompare).map(i=>i.peer);ui.xorCompare=(r,e)=>Pwe.compare(r.distance,e.distance);ui.pathSize=(r,e)=>Math.ceil(r/e);ui.createPutRecord=(r,e)=>{let t=new Date;return new ygt(r,e,t).serialize()};ui.logger=(r,e)=>{let t=["libp2p","dht"];return e&&t.push(e),r&&t.push(`${r.toB58String().slice(0,8)}`),XP.formatters.b=n=>hgt.baseEncode(n),Object.assign(XP(t.join(":")),{error:XP(t.concat(["error"]).join(":"))})};ui.TimeoutError=class extends Error{get code(){return"ETIMEDOUT"}};ui.withTimeout=(r,e)=>{async function t(...i){if(!e)return r(...i);let n;try{n=await qwe(r(...i),e)}catch(s){throw s instanceof qwe.TimeoutError?bgt(s,"ETIMEDOUT"):s}return n}return t};ui.mapParallel=async function(r,e){let t=[];for await(let i of r)t.push(e(i));return Promise.all(t)}});var Nwe=p((tNt,Bwe)=>{u();"use strict";var vgt=Awe(),bS=li(),kwe=class{constructor(e,t){this.self=e,this._onPing=this._onPing.bind(this),this._onInit(t)}async _onInit(e){let t=await bS.convertPeerId(this.self);this.kb=new vgt({localNodeId:t,numberOfNodesPerKBucket:e,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}_onPing(e,t){let i=e[0];i&&this.kb.remove(i.id),this.kb.add(t)}get size(){return this.kb.count()}async find(e){let t=await bS.convertPeerId(e),i=this.closestPeer(t);if(i&&e.equals(i))return i}closestPeer(e){let t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t){return this.kb.closest(e,t).map(n=>n.peer)}async add(e){let t=await bS.convertPeerId(e);this.kb.add({id:t,peer:e})}async remove(e){let t=await bS.convertPeerId(e);this.kb.remove(t)}};Bwe.exports=kwe});var pl=p(Pn=>{u();"use strict";var mS=Pn.second=1e3,Dwe=Pn.minute=60*mS,QP=Pn.hour=60*Dwe;Pn.MAX_RECORD_AGE=36*QP;Pn.PROTOCOL_DHT="/kad/1.0.0";Pn.PROVIDERS_KEY_PREFIX="/providers/";Pn.PROVIDERS_LRU_CACHE_SIZE=256;Pn.PROVIDERS_VALIDITY=24*QP;Pn.PROVIDERS_CLEANUP_INTERVAL=QP;Pn.READ_MESSAGE_TIMEOUT=10*mS;Pn.GET_MANY_RECORD_COUNT=16;Pn.K=20;Pn.ALPHA=3;Pn.defaultRandomWalk={enabled:!0,queriesPerPeriod:1,interval:5*Dwe,timeout:10*mS,delay:10*mS}});var Lwe=p((iNt,Mwe)=>{u();"use strict";var yl=Pi(),_0=yl.Reader,JP=yl.Writer,$e=yl.util,ti=yl.roots["libp2p-dht-message"]||(yl.roots["libp2p-dht-message"]={});ti.Record=function(){function r(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.key=null,r.prototype.value=null,r.prototype.author=null,r.prototype.signature=null,r.prototype.timeReceived=null;var e;return Object.defineProperty(r.prototype,"_key",{get:$e.oneOfGetter(e=["key"]),set:$e.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_value",{get:$e.oneOfGetter(e=["value"]),set:$e.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_author",{get:$e.oneOfGetter(e=["author"]),set:$e.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_signature",{get:$e.oneOfGetter(e=["signature"]),set:$e.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_timeReceived",{get:$e.oneOfGetter(e=["timeReceived"]),set:$e.oneOfSetter(e)}),r.encode=function(i,n){return n||(n=JP.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(10).bytes(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&n.uint32(18).bytes(i.value),i.author!=null&&Object.hasOwnProperty.call(i,"author")&&n.uint32(26).bytes(i.author),i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&n.uint32(34).bytes(i.signature),i.timeReceived!=null&&Object.hasOwnProperty.call(i,"timeReceived")&&n.uint32(42).string(i.timeReceived),n},r.decode=function(i,n){i instanceof _0||(i=_0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new ti.Record;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.key=i.bytes();break;case 2:o.value=i.bytes();break;case 3:o.author=i.bytes();break;case 4:o.signature=i.bytes();break;case 5:o.timeReceived=i.string();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof ti.Record)return i;var n=new ti.Record;return i.key!=null&&(typeof i.key=="string"?$e.base64.decode(i.key,n.key=$e.newBuffer($e.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.value!=null&&(typeof i.value=="string"?$e.base64.decode(i.value,n.value=$e.newBuffer($e.base64.length(i.value)),0):i.value.length&&(n.value=i.value)),i.author!=null&&(typeof i.author=="string"?$e.base64.decode(i.author,n.author=$e.newBuffer($e.base64.length(i.author)),0):i.author.length&&(n.author=i.author)),i.signature!=null&&(typeof i.signature=="string"?$e.base64.decode(i.signature,n.signature=$e.newBuffer($e.base64.length(i.signature)),0):i.signature.length&&(n.signature=i.signature)),i.timeReceived!=null&&(n.timeReceived=String(i.timeReceived)),n},r.toObject=function(i,n){n||(n={});var s={};return i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?$e.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.value!=null&&i.hasOwnProperty("value")&&(s.value=n.bytes===String?$e.base64.encode(i.value,0,i.value.length):n.bytes===Array?Array.prototype.slice.call(i.value):i.value,n.oneofs&&(s._value="value")),i.author!=null&&i.hasOwnProperty("author")&&(s.author=n.bytes===String?$e.base64.encode(i.author,0,i.author.length):n.bytes===Array?Array.prototype.slice.call(i.author):i.author,n.oneofs&&(s._author="author")),i.signature!=null&&i.hasOwnProperty("signature")&&(s.signature=n.bytes===String?$e.base64.encode(i.signature,0,i.signature.length):n.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,n.oneofs&&(s._signature="signature")),i.timeReceived!=null&&i.hasOwnProperty("timeReceived")&&(s.timeReceived=i.timeReceived,n.oneofs&&(s._timeReceived="timeReceived")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,yl.util.toJSONOptions)},r}();ti.Message=function(){function r(t){if(this.closerPeers=[],this.providerPeers=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.type=null,r.prototype.clusterLevelRaw=null,r.prototype.key=null,r.prototype.record=null,r.prototype.closerPeers=$e.emptyArray,r.prototype.providerPeers=$e.emptyArray;var e;return Object.defineProperty(r.prototype,"_type",{get:$e.oneOfGetter(e=["type"]),set:$e.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_clusterLevelRaw",{get:$e.oneOfGetter(e=["clusterLevelRaw"]),set:$e.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_key",{get:$e.oneOfGetter(e=["key"]),set:$e.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_record",{get:$e.oneOfGetter(e=["record"]),set:$e.oneOfSetter(e)}),r.encode=function(i,n){if(n||(n=JP.create()),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(8).int32(i.type),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(18).bytes(i.key),i.record!=null&&Object.hasOwnProperty.call(i,"record")&&n.uint32(26).bytes(i.record),i.closerPeers!=null&&i.closerPeers.length)for(var s=0;s<i.closerPeers.length;++s)ti.Message.Peer.encode(i.closerPeers[s],n.uint32(66).fork()).ldelim();if(i.providerPeers!=null&&i.providerPeers.length)for(var s=0;s<i.providerPeers.length;++s)ti.Message.Peer.encode(i.providerPeers[s],n.uint32(74).fork()).ldelim();return i.clusterLevelRaw!=null&&Object.hasOwnProperty.call(i,"clusterLevelRaw")&&n.uint32(80).int32(i.clusterLevelRaw),n},r.decode=function(i,n){i instanceof _0||(i=_0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new ti.Message;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.type=i.int32();break;case 10:o.clusterLevelRaw=i.int32();break;case 2:o.key=i.bytes();break;case 3:o.record=i.bytes();break;case 8:o.closerPeers&&o.closerPeers.length||(o.closerPeers=[]),o.closerPeers.push(ti.Message.Peer.decode(i,i.uint32()));break;case 9:o.providerPeers&&o.providerPeers.length||(o.providerPeers=[]),o.providerPeers.push(ti.Message.Peer.decode(i,i.uint32()));break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof ti.Message)return i;var n=new ti.Message;switch(i.type){case"PUT_VALUE":case 0:n.type=0;break;case"GET_VALUE":case 1:n.type=1;break;case"ADD_PROVIDER":case 2:n.type=2;break;case"GET_PROVIDERS":case 3:n.type=3;break;case"FIND_NODE":case 4:n.type=4;break;case"PING":case 5:n.type=5;break}if(i.clusterLevelRaw!=null&&(n.clusterLevelRaw=i.clusterLevelRaw|0),i.key!=null&&(typeof i.key=="string"?$e.base64.decode(i.key,n.key=$e.newBuffer($e.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.record!=null&&(typeof i.record=="string"?$e.base64.decode(i.record,n.record=$e.newBuffer($e.base64.length(i.record)),0):i.record.length&&(n.record=i.record)),i.closerPeers){if(!Array.isArray(i.closerPeers))throw TypeError(".Message.closerPeers: array expected");n.closerPeers=[];for(var s=0;s<i.closerPeers.length;++s){if(typeof i.closerPeers[s]!="object")throw TypeError(".Message.closerPeers: object expected");n.closerPeers[s]=ti.Message.Peer.fromObject(i.closerPeers[s])}}if(i.providerPeers){if(!Array.isArray(i.providerPeers))throw TypeError(".Message.providerPeers: array expected");n.providerPeers=[];for(var s=0;s<i.providerPeers.length;++s){if(typeof i.providerPeers[s]!="object")throw TypeError(".Message.providerPeers: object expected");n.providerPeers[s]=ti.Message.Peer.fromObject(i.providerPeers[s])}}return n},r.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.closerPeers=[],s.providerPeers=[]),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?ti.Message.MessageType[i.type]:i.type,n.oneofs&&(s._type="type")),i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?$e.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.record!=null&&i.hasOwnProperty("record")&&(s.record=n.bytes===String?$e.base64.encode(i.record,0,i.record.length):n.bytes===Array?Array.prototype.slice.call(i.record):i.record,n.oneofs&&(s._record="record")),i.closerPeers&&i.closerPeers.length){s.closerPeers=[];for(var o=0;o<i.closerPeers.length;++o)s.closerPeers[o]=ti.Message.Peer.toObject(i.closerPeers[o],n)}if(i.providerPeers&&i.providerPeers.length){s.providerPeers=[];for(var o=0;o<i.providerPeers.length;++o)s.providerPeers[o]=ti.Message.Peer.toObject(i.providerPeers[o],n)}return i.clusterLevelRaw!=null&&i.hasOwnProperty("clusterLevelRaw")&&(s.clusterLevelRaw=i.clusterLevelRaw,n.oneofs&&(s._clusterLevelRaw="clusterLevelRaw")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,yl.util.toJSONOptions)},r.MessageType=function(){var t={},i=Object.create(t);return i[t[0]="PUT_VALUE"]=0,i[t[1]="GET_VALUE"]=1,i[t[2]="ADD_PROVIDER"]=2,i[t[3]="GET_PROVIDERS"]=3,i[t[4]="FIND_NODE"]=4,i[t[5]="PING"]=5,i}(),r.ConnectionType=function(){var t={},i=Object.create(t);return i[t[0]="NOT_CONNECTED"]=0,i[t[1]="CONNECTED"]=1,i[t[2]="CAN_CONNECT"]=2,i[t[3]="CANNOT_CONNECT"]=3,i}(),r.Peer=function(){function t(n){if(this.addrs=[],n)for(var s=Object.keys(n),o=0;o<s.length;++o)n[s[o]]!=null&&(this[s[o]]=n[s[o]])}t.prototype.id=null,t.prototype.addrs=$e.emptyArray,t.prototype.connection=null;var i;return Object.defineProperty(t.prototype,"_id",{get:$e.oneOfGetter(i=["id"]),set:$e.oneOfSetter(i)}),Object.defineProperty(t.prototype,"_connection",{get:$e.oneOfGetter(i=["connection"]),set:$e.oneOfSetter(i)}),t.encode=function(s,o){if(o||(o=JP.create()),s.id!=null&&Object.hasOwnProperty.call(s,"id")&&o.uint32(10).bytes(s.id),s.addrs!=null&&s.addrs.length)for(var a=0;a<s.addrs.length;++a)o.uint32(18).bytes(s.addrs[a]);return s.connection!=null&&Object.hasOwnProperty.call(s,"connection")&&o.uint32(24).int32(s.connection),o},t.decode=function(s,o){s instanceof _0||(s=_0.create(s));for(var a=o===void 0?s.len:s.pos+o,c=new ti.Message.Peer;s.pos<a;){var f=s.uint32();switch(f>>>3){case 1:c.id=s.bytes();break;case 2:c.addrs&&c.addrs.length||(c.addrs=[]),c.addrs.push(s.bytes());break;case 3:c.connection=s.int32();break;default:s.skipType(f&7);break}}return c},t.fromObject=function(s){if(s instanceof ti.Message.Peer)return s;var o=new ti.Message.Peer;if(s.id!=null&&(typeof s.id=="string"?$e.base64.decode(s.id,o.id=$e.newBuffer($e.base64.length(s.id)),0):s.id.length&&(o.id=s.id)),s.addrs){if(!Array.isArray(s.addrs))throw TypeError(".Message.Peer.addrs: array expected");o.addrs=[];for(var a=0;a<s.addrs.length;++a)typeof s.addrs[a]=="string"?$e.base64.decode(s.addrs[a],o.addrs[a]=$e.newBuffer($e.base64.length(s.addrs[a])),0):s.addrs[a].length&&(o.addrs[a]=s.addrs[a])}switch(s.connection){case"NOT_CONNECTED":case 0:o.connection=0;break;case"CONNECTED":case 1:o.connection=1;break;case"CAN_CONNECT":case 2:o.connection=2;break;case"CANNOT_CONNECT":case 3:o.connection=3;break}return o},t.toObject=function(s,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addrs=[]),s.id!=null&&s.hasOwnProperty("id")&&(a.id=o.bytes===String?$e.base64.encode(s.id,0,s.id.length):o.bytes===Array?Array.prototype.slice.call(s.id):s.id,o.oneofs&&(a._id="id")),s.addrs&&s.addrs.length){a.addrs=[];for(var c=0;c<s.addrs.length;++c)a.addrs[c]=o.bytes===String?$e.base64.encode(s.addrs[c],0,s.addrs[c].length):o.bytes===Array?Array.prototype.slice.call(s.addrs[c]):s.addrs[c]}return s.connection!=null&&s.hasOwnProperty("connection")&&(a.connection=o.enums===String?ti.Message.ConnectionType[s.connection]:s.connection,o.oneofs&&(a._connection="connection")),a},t.prototype.toJSON=function(){return this.constructor.toObject(this,yl.util.toJSONOptions)},t}(),r}();Mwe.exports=ti});var Xa=p((nNt,jwe)=>{u();"use strict";var wgt=rt(),{Multiaddr:_gt}=et(),{Record:Egt}=sf(),vS=Lwe(),Sgt=vS.Message.MessageType,Uwe=vS.Message.ConnectionType,E0=class{constructor(e,t,i){if(t&&!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(Fwe),providerPeers:this.providerPeers.map(Fwe),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),vS.Message.encode(e).finish()}static deserialize(e){let t=vS.Message.decode(e),i=new E0(t.type||0,t.key||Uint8Array.from([]),t.clusterLevelRaw||0);return i.closerPeers=t.closerPeers.map(Kwe),i.providerPeers=t.providerPeers.map(Kwe),t.record&&t.record.length&&(i.record=Egt.deserialize(t.record)),i}};E0.TYPES=Sgt;E0.CONNECTION_TYPES=Uwe;function Fwe(r){return{id:r.id.id,addrs:(r.multiaddrs||[]).map(t=>t.bytes),connection:Uwe.CONNECTED}}function Kwe(r){return{id:new wgt(r.id),multiaddrs:(r.addrs||[]).map(e=>new _gt(e))}}jwe.exports=E0});var Hwe=p((sNt,zwe)=>{u();"use strict";var{Record:Agt}=sf(),xgt=ue(),Vwe=Xa(),ZP=li();zwe.exports=r=>{let e=ZP.logger(r.peerId,"rpc:get-value");async function t(i,n){let s=n.key;if(e("key: %b",s),!s||s.length===0)throw xgt(new Error("Invalid key"),"ERR_INVALID_KEY");let o=new Vwe(Vwe.TYPES.GET_VALUE,s,n.clusterLevel);if(ZP.isPublicKeyKey(s)){e("is public key");let f=ZP.fromPublicKeyKey(s),l;if(r._isSelf(f))l=r.peerId;else{let h=r.peerStore.get(f);l=h&&h.id}if(l&&l.pubKey)return e("returning found public key"),o.record=new Agt(s,l.pubKey.bytes),o}let[a,c]=await Promise.all([r._checkLocalDatastore(s),r._betterPeersToQuery(n,i)]);return a&&(e("got record"),o.record=a),c.length>0&&(e("got closer %s",c.length),o.closerPeers=c),o}return t}});var Wwe=p((oNt,Gwe)=>{u();"use strict";var $we=li(),Igt=ue();Gwe.exports=r=>{let e=$we.logger(r.peerId,"rpc:put-value");async function t(i,n){let s=n.key;e("key: %b",s);let o=n.record;if(!o){let c=`Empty record from: ${i.toB58String()}`;throw e.error(c),Igt(new Error(c),"ERR_EMPTY_RECORD")}await r._verifyRecordLocally(o),o.timeReceived=new Date;let a=$we.bufferToKey(o.key);return await r.datastore.put(a,o.serialize()),r.onPut(o,i),n}return t}});var Xwe=p((aNt,Ywe)=>{u();"use strict";var Tgt=fi(),Rgt=Xa(),Pgt=li();Ywe.exports=r=>{let e=Pgt.logger(r.peerId,"rpc:find-node");async function t(i,n){e("start");let s;Tgt(n.key,r.peerId.id)?s=[{id:r.peerId,multiaddrs:r.libp2p.multiaddrs}]:s=await r._betterPeersToQuery(n,i);let o=new Rgt(n.type,new Uint8Array(0),n.clusterLevel);return s.length>0?o.closerPeers=s:e("handle FindNode %s: could not find anything",i.toB58String()),o}return t}});var Zwe=p((cNt,Jwe)=>{u();"use strict";var{CID:Cgt}=(xe(),Ce),Qwe=ue(),Ogt=li();Jwe.exports=r=>{let e=Ogt.logger(r.peerId,"rpc:add-provider");async function t(i,n){if(e("start"),!n.key||n.key.length===0)throw Qwe(new Error("Missing key"),"ERR_MISSING_KEY");let s;try{s=Cgt.decode(n.key)}catch(o){let a=`Invalid CID: ${o.message}`;throw Qwe(new Error(a),"ERR_INVALID_CID")}return n.providerPeers.forEach(o=>{if(!o.id.isEqual(i)){e("invalid provider peer %s from %s",o.id.toB58String(),i.toB58String());return}if(o.multiaddrs.length<1){e("no valid addresses for provider %s. Ignore",i.toB58String());return}if(e("received provider %s for %s (addrs %s)",i.toB58String(),s.toString(),o.multiaddrs.map(a=>a.toString())),!r._isSelf(o.id))return r.peerStore.addressBook.add(o.id,o.multiaddrs),r.providers.addProvider(s,o.id)}),r.providers.addProvider(s,i)}return t}});var r_e=p((uNt,t_e)=>{u();"use strict";var{CID:qgt}=(xe(),Ce),kgt=ue(),Bgt=Xa(),e_e=li();t_e.exports=r=>{let e=e_e.logger(r.peerId,"rpc:get-providers");async function t(i,n){let s;try{s=qgt.decode(n.key)}catch(y){throw kgt(new Error(`Invalid CID: ${y.message}`),"ERR_INVALID_CID")}e("%s",s.toString());let o=e_e.bufferToKey(s.bytes),[a,c,f]=await Promise.all([r.datastore.has(o),r.providers.getProviders(s),r._betterPeersToQuery(n,i)]),l=c.map(y=>({id:y,multiaddrs:[]})),h=f.map(y=>({id:y.id,multiaddrs:[]}));a&&l.push({id:r.peerId,multiaddrs:[]});let d=new Bgt(n.type,n.key,n.clusterLevel);return l.length>0&&(d.providerPeers=l),h.length>0&&(d.closerPeers=h),e("got %s providers %s closerPeers",l.length,h.length),d}return t}});var n_e=p((lNt,i_e)=>{u();"use strict";var Ngt=li();i_e.exports=r=>{let e=Ngt.logger(r.peerId,"rpc:ping");function t(i,n){return e("from %s",i.toB58String()),n}return t}});var o_e=p((fNt,s_e)=>{u();"use strict";var S0=Xa().TYPES;s_e.exports=r=>{let e={[S0.GET_VALUE]:Hwe()(r),[S0.PUT_VALUE]:Wwe()(r),[S0.FIND_NODE]:Xwe()(r),[S0.ADD_PROVIDER]:Zwe()(r),[S0.GET_PROVIDERS]:r_e()(r),[S0.PING]:n_e()(r)};function t(i){return e[i]}return t}});var u_e=p((hNt,c_e)=>{u();"use strict";var{pipe:Dgt}=Gr(),a_e=To(),Mgt=Xa(),Lgt=o_e(),Ugt=li();c_e.exports=r=>{let e=Ugt.logger(r.peerId,"rpc"),t=Lgt(r);async function i(s,o){let a=t(o.type);try{await r._add(s)}catch(c){e.error("Failed to update the kbucket store",c)}if(!a){e.error(`no handler found for message type: ${o.type}`);return}return a(s,o)}async function n({stream:s,connection:o}){let a=o.remotePeer;try{await r._add(a)}catch(f){e.error(f)}let c=a.toB58String();e("from: %s",c),await Dgt(s.source,a_e.decode(),f=>async function*(){for await(let l of f){let h=Mgt.deserialize(l.slice()),d=await i(a,h);d&&(yield d.serialize())}}(),a_e.encode(),s.sink)}return n}});var d_e=p((dNt,h_e)=>{u();"use strict";var wS=ue(),{pipe:l_e}=Gr(),eC=To(),Fgt=w0(),{consume:Kgt}=jd(),jgt=xd(),Vgt=Q_(),zgt=u_e(),Hgt=pl(),$gt=Xa(),Ggt=li(),f_e=class{constructor(e){this.dht=e,this.readMessageTimeout=Hgt.READ_MESSAGE_TIMEOUT,this._log=Ggt.logger(this.dht.peerId,"net"),this._rpc=zgt(this.dht),this._onPeerConnected=this._onPeerConnected.bind(this),this._running=!1}start(){if(this._running)return;if(!this.dht.isStarted)throw wS(new Error("Can not start network"),"ERR_CANNOT_START_NETWORK");this._running=!0,this.dht._clientMode===!1&&this.dht.registrar.handle(this.dht.protocol,this._rpc);let e=new Vgt({multicodecs:[this.dht.protocol],handlers:{onConnect:this._onPeerConnected,onDisconnect:()=>{}}});this._registrarId=this.dht.registrar.register(e)}stop(){!this.dht.isStarted&&!this.isStarted||(this._running=!1,this._registrarId&&this.dht.registrar.unregister(this._registrarId))}get isStarted(){return this._running}get isConnected(){return this.dht.isStarted&&this.isStarted}async _onPeerConnected(e){await this.dht._add(e),this._log("added to the routing table: %s",e.toB58String())}async sendRequest(e,t){if(!this.isConnected)throw wS(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeReadMessage(s,t.serialize())}async sendMessage(e,t){if(!this.isConnected)throw wS(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeMessage(s,t.serialize())}async _writeReadMessage(e,t){return Fgt(Wgt(e,t),this.readMessageTimeout)}_writeMessage(e,t){return l_e([t],eC.encode(),e,Kgt)}};async function Wgt(r,e){let t=await l_e([e],eC.encode(),r,eC.decode(),async i=>{let n=await jgt(i);if(n)return n.slice()});if(t.length===0)throw wS(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");return $gt.deserialize(t)}h_e.exports=f_e});var b_e=p((pNt,g_e)=>{u();"use strict";var _S=pS(),p_e=li(),Ygt=yS(),Xgt=fi(),y_e=class{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>Xgt(n.peerId.id,e.id)))return;let t=await p_e.convertPeerId(e),i={peerId:e,distance:_S(this.originDhtKey,t)};this.peerDistances.push(i),this.peerDistances.sort((n,s)=>_S.compare(n.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let t=await Ygt(e,n=>p_e.convertPeerId(n)),i=this.peerDistances[this.peerDistances.length-1].distance;for(let n of t){let s=_S(this.originDhtKey,n);if(_S.compare(s,i)<0)return!0}return!1}};g_e.exports=y_e});var v_e=p((tC,m_e)=>{u();(function(){var r,e,t,i,n,s,o,a,c,f,l,h,d,y,g;t=Math.floor,f=Math.min,e=function(m,E){return m<E?-1:m>E?1:0},c=function(m,E,_,T,q){var z;if(_==null&&(_=0),q==null&&(q=e),_<0)throw new Error("lo must be non-negative");for(T==null&&(T=m.length);_<T;)z=t((_+T)/2),q(E,m[z])<0?T=z:_=z+1;return[].splice.apply(m,[_,_-_].concat(E)),E},s=function(m,E,_){return _==null&&(_=e),m.push(E),y(m,0,m.length-1,_)},n=function(m,E){var _,T;return E==null&&(E=e),_=m.pop(),m.length?(T=m[0],m[0]=_,g(m,0,E)):T=_,T},a=function(m,E,_){var T;return _==null&&(_=e),T=m[0],m[0]=E,g(m,0,_),T},o=function(m,E,_){var T;return _==null&&(_=e),m.length&&_(m[0],E)<0&&(T=[m[0],E],E=T[0],m[0]=T[1],g(m,0,_)),E},i=function(m,E){var _,T,q,z,V,M,$,X;for(E==null&&(E=e),M=function(){X=[];for(var Q=0,O=t(m.length/2);0<=O?Q<O:Q>O;0<=O?Q++:Q--)X.push(Q);return X}.apply(this).reverse(),$=[],T=0,z=M.length;T<z;T++)_=M[T],$.push(g(m,_,E));return $},d=function(m,E,_){var T;if(_==null&&(_=e),T=m.indexOf(E),T!==-1)return y(m,0,T,_),g(m,T,_)},l=function(m,E,_){var T,q,z,V,M;if(_==null&&(_=e),q=m.slice(0,E),!q.length)return q;for(i(q,_),M=m.slice(E),z=0,V=M.length;z<V;z++)T=M[z],o(q,T,_);return q.sort(_).reverse()},h=function(m,E,_){var T,q,z,V,M,$,X,Q,O,b;if(_==null&&(_=e),E*10<=m.length){if(V=m.slice(0,E).sort(_),!V.length)return V;for(z=V[V.length-1],Q=m.slice(E),M=0,X=Q.length;M<X;M++)T=Q[M],_(T,z)<0&&(c(V,T,0,null,_),V.pop(),z=V[V.length-1]);return V}for(i(m,_),b=[],q=$=0,O=f(E,m.length);0<=O?$<O:$>O;q=0<=O?++$:--$)b.push(n(m,_));return b},y=function(m,E,_,T){var q,z,V;for(T==null&&(T=e),q=m[_];_>E;){if(V=_-1>>1,z=m[V],T(q,z)<0){m[_]=z,_=V;continue}break}return m[_]=q},g=function(m,E,_){var T,q,z,V,M;for(_==null&&(_=e),q=m.length,M=E,z=m[E],T=2*E+1;T<q;)V=T+1,V<q&&!(_(m[T],m[V])<0)&&(T=V),m[E]=m[T],E=T,T=2*E+1;return m[E]=z,y(m,M,E,_)},r=function(){m.push=s,m.pop=n,m.replace=a,m.pushpop=o,m.heapify=i,m.updateItem=d,m.nlargest=l,m.nsmallest=h;function m(E){this.cmp=E??e,this.nodes=[]}return m.prototype.push=function(E){return s(this.nodes,E,this.cmp)},m.prototype.pop=function(){return n(this.nodes,this.cmp)},m.prototype.peek=function(){return this.nodes[0]},m.prototype.contains=function(E){return this.nodes.indexOf(E)!==-1},m.prototype.replace=function(E){return a(this.nodes,E,this.cmp)},m.prototype.pushpop=function(E){return o(this.nodes,E,this.cmp)},m.prototype.heapify=function(){return i(this.nodes,this.cmp)},m.prototype.updateItem=function(E){return d(this.nodes,E,this.cmp)},m.prototype.clear=function(){return this.nodes=[]},m.prototype.empty=function(){return this.nodes.length===0},m.prototype.size=function(){return this.nodes.length},m.prototype.clone=function(){var E;return E=new m,E.nodes=this.nodes.slice(0),E},m.prototype.toArray=function(){return this.nodes.slice(0)},m.prototype.insert=m.prototype.push,m.prototype.top=m.prototype.peek,m.prototype.front=m.prototype.peek,m.prototype.has=m.prototype.contains,m.prototype.copy=m.prototype.clone,m}(),function(m,E){return typeof define=="function"&&define.amd?define([],E):typeof tC=="object"?m_e.exports=E():m.Heap=E()}(this,function(){return r})}).call(tC)});var __e=p((yNt,w_e)=>{u();w_e.exports=v_e()});var S_e=p((gNt,E_e)=>{u();"use strict";var Qgt=__e(),Jgt=pS(),Zgt=me(),ES=li(),rC=Zgt("libp2p:dht:peer-queue"),nm=class{static async fromPeerId(e){let t=await ES.convertPeerId(e);return new nm(t)}static async fromKey(e){let t=await ES.convertBuffer(e);return new nm(t)}constructor(e){rC("create: %b",e),this.from=e,this.heap=new Qgt(ES.xorCompare)}async enqueue(e){rC("enqueue %s",e.toB58String());let t=await ES.convertPeerId(e),i={id:e,distance:Jgt(this.from,t)};this.heap.push(i)}dequeue(){let e=this.heap.pop();return rC("dequeue %s",e.id.toB58String()),e.id}get length(){return this.heap.size()}};E_e.exports=nm});var I_e=p((bNt,x_e)=>{u();"use strict";var ebt=S_e(),tbt=li(),rbt=3e4,A_e=class{constructor(e,t){if(this.run=e,this.queryFunc=tbt.withTimeout(t,rbt),!this.queryFunc)throw new Error("Path requires a `queryFn` to be specified");if(typeof this.queryFunc!="function")throw new Error("Path expected `queryFn` to be a function. Got "+typeof this.queryFunc);this.initialPeers=[],this.peersToQuery=null,this.res=null}addInitialPeer(e){this.initialPeers.push(e)}async execute(){let e=await ebt.fromKey(this.run.query.key);this.peersToQuery=e,await Promise.all(this.initialPeers.map(t=>this.addPeerToQuery(t))),await this.run.workerQueue(this)}async addPeerToQuery(e){this.run.query.dht._isSelf(e)||this.run.peersSeen.has(e.toB58String())||this.peersToQuery&&await this.peersToQuery.enqueue(e)}};x_e.exports=A_e});var P_e=p((mNt,R_e)=>{u();"use strict";var{default:ibt}=_c(),T_e=class{constructor(e,t,i,n){this.dht=e,this.run=t,this.path=i,this.log=n,this.concurrency=this.dht.concurrency,this.queue=this.setupQueue(),this.execution=null,this.queuedPeerIds=new Set}setupQueue(){let e=new ibt({concurrency:this.concurrency});return e.on("idle",()=>{this.path.peersToQuery&&!this.path.peersToQuery.length&&(this.log("queue:drain"),this.stop())}),e.on("next",()=>{!this.running||e.pending<this.concurrency&&this.fill()}),e}stop(e){!this.running||(this.running=!1,this.queue.clear(),this.log("worker:stop, %d workers still running",this.run.workers.filter(t=>t.running).length),this.execution&&(e?this.execution.reject(e):this.execution.resolve()))}async execute(){this.running=!0,this.execution=null;let e=new Promise((t,i)=>{this.execution={resolve:t,reject:i}});this.fill(),await e}fill(){if(!!this.path.peersToQuery)for(;this.queue.pending+this.queue.size<this.concurrency&&this.path.peersToQuery.length>0;){let e=this.path.peersToQuery.dequeue();this.queuedPeerIds.add(e),this.queue.add(()=>this.processNext(e).catch(t=>{this.log.error("queue",t),this.stop(t)}).finally(()=>{this.queuedPeerIds.delete(e)}))}}async processNext(e){if(!this.running||this.run.peersSeen.has(e.toB58String()))return;let t,i;try{t=await this.run.continueQuerying(this)}catch(o){i=o}if(!this.running)return;if(i)throw i;if(!t){this.stop();return}if(this.run.peersSeen.has(e.toB58String()))return;this.run.peersSeen.add(e.toB58String()),this.log("queue:work");let n,s;try{n=await this.execQuery(e)}catch(o){s=o}if(!!this.running){if(this.log("queue:work:done",s,n),s)throw s;if(n&&n.queryComplete){this.log("query:complete"),this.run.stop();return}n&&n.pathComplete&&this.stop()}}async execQuery(e){let t,i;try{t=await this.path.queryFunc(e)}catch(n){i=n}if(!!this.running){if(i){this.run.errors.push(i);return}if(this.run.peersQueried&&await this.run.peersQueried.add(e),!!t){if(t.pathComplete||t.queryComplete)return this.path.res=t,{pathComplete:t.pathComplete,queryComplete:t.queryComplete};if(t.closerPeers&&t.closerPeers.length>0){let n=async s=>{this.dht._isSelf(s.id)||(this.dht._peerDiscovered(s.id,s.multiaddrs),await this.path.addPeerToQuery(s.id))};await Promise.all(t.closerPeers.map(n))}}}}};R_e.exports=T_e});var q_e=p((vNt,O_e)=>{u();"use strict";var nbt=b_e(),sbt=br(),obt=I_e(),abt=P_e(),cbt=li(),C_e=class extends sbt{constructor(e){super();this.query=e,this.running=!1,this.workers=[],this.peersSeen=new Set,this.errors=[],this.peersQueried=null}stop(){if(!!this.running){this.running=!1;for(let e of this.workers)e.stop()}}async execute(e){let t=[],i=Math.min(this.query.dht.disjointPaths,e.length);for(let s=0;s<i;s++)t.push(new obt(this,this.query.makePath(s,i)));e.forEach((s,o)=>{t[o%i].addInitialPeer(s)}),await this.executePaths(t);let n={finalSet:new Set(this.peersQueried&&this.peersQueried.peers),paths:[]};for(let s of t)s.res&&(s.res.pathComplete||s.res.queryComplete)&&(s.res.success=!0,n.paths.push(s.res));return n}async executePaths(e){this.running=!0,this.emit("start");try{await Promise.all(e.map(t=>t.execute()))}finally{this.stop(),this.emit("complete")}if(this.errors.length===this.peersSeen.size)throw this.errors[0]}async workerQueue(e){await this.init(),await this.startWorker(e)}async startWorker(e){let t=new abt(this.query.dht,this,e,this.query._log);this.workers.push(t),await t.execute()}async init(){if(!this.peersQueried){if(this.peersQueriedPromise){await this.peersQueriedPromise;return}this.peersQueriedPromise=(async()=>{let e=await cbt.convertBuffer(this.query.key);this.peersQueried=new nbt(e,this.query.dht.kBucketSize)})(),await this.peersQueriedPromise,delete this.peersQueriedPromise}}async continueQuerying(e){if(this.peersQueried&&this.peersQueried.length<this.peersQueried.capacity)return!0;let t=Array.from(e.queuedPeerIds);return!!(this.peersQueried&&await this.peersQueried.anyCloser(t))}};O_e.exports=C_e});var SS=p((wNt,B_e)=>{u();"use strict";var{base58btc:ubt}=(zr(),Vr),lbt=li(),fbt=q_e(),k_e=class{constructor(e,t,i){this.dht=e,this.key=t,this.makePath=i,this._log=lbt.logger(this.dht.peerId,"query:"+ubt.baseEncode(t)),this.running=!1,this._onStart=this._onStart.bind(this),this._onComplete=this._onComplete.bind(this)}async run(e){return this.dht._queryManager.running?e.length===0?(this._log.error("Running query with no peers"),{finalSet:new Set,paths:[]}):(this._run=new fbt(this),this._log(`query running with K=${this.dht.kBucketSize}, A=${this.dht.concurrency}, D=${Math.min(this.dht.disjointPaths,e.length)}`),this._run.once("start",this._onStart),this._run.once("complete",this._onComplete),this._run.execute(e)):(this._log.error("Attempt to run query after shutdown"),{finalSet:new Set,paths:[]})}_onStart(){this.running=!0,this._startTime=Date.now(),this._log("query:start"),this.dht._queryManager.queryStarted(this)}_onComplete(){this.stop()}stop(){this._log(`query:done in ${Date.now()-(this._startTime||0)}ms`),this._run&&this._log(`${this._run.errors.length} of ${this._run.peersSeen.size} peers errored (${this._run.errors.length/this._run.peersSeen.size*100}% fail rate)`),!!this.running&&(this.running=!1,this._run&&(this._run.removeListener("start",this._onStart),this._run.removeListener("complete",this._onComplete),this._run.stop()),this.dht._queryManager.queryCompleted(this))}};B_e.exports=k_e});var L_e=p((_Nt,M_e)=>{u();"use strict";var iC=ue(),hbt=w0(),dbt=fi(),N_e=Ze(),D_e=sf(),nC=pl(),pbt=SS(),ih=li(),ybt=D_e.Record;M_e.exports=r=>{let e=async(n,s)=>r.datastore.put(ih.bufferToKey(n),s),t=async n=>{r._log(`getLocal ${N_e(n,"base32")}`);let s=await r.datastore.get(ih.bufferToKey(n));r._log(`found ${N_e(n,"base32")} in local datastore`);let o=ybt.deserialize(s);return await r._verifyRecordLocally(o),o},i=async(n,s,o)=>{let a=await ih.createPutRecord(n,o);return Promise.all(s.map(async c=>{if(!dbt(c.val,o)){if(r._isSelf(c.from)){try{await r._putLocal(n,a)}catch(f){r._log.error("Failed error correcting self",f)}return}try{await r._putValueToPeer(n,a,c.from)}catch(f){r._log.error("Failed error correcting entry",f)}}}))};return{async _putLocal(n,s){return e(n,s)},async put(n,s,o={}){r._log("PutValue %b",n);let a=await ih.createPutRecord(n,s);await e(n,a);let c=0,f=0;await ih.mapParallel(r.getClosestPeers(n,{shallow:!0}),async h=>{try{c+=1,await r._putValueToPeer(n,a,h),f+=1}catch(d){r._log.error("Failed to put to peer (%b): %s",h.id,d)}});let l=o.minPeers||c;if(l>f){let h=iC(new Error(`Failed to put value to enough peers: ${f}/${l}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw r._log.error(h),h}},async get(n,s={}){s.timeout=s.timeout||nC.minute,r._log("_get %b",n);let o=await r.getMany(n,nC.GET_MANY_RECORD_COUNT,s),a=o.map(l=>l.val),c=0;try{c=D_e.selection.bestRecord(r.selectors,n,a)}catch(l){if(l.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw l}let f=a[c];if(r._log("GetValue %b %s",n,f),!f)throw iC(new Error("best value was not found"),"ERR_NOT_FOUND");return await i(n,o,f),f},async getMany(n,s,o={}){o.timeout=o.timeout||nC.minute,r._log("getMany %b (%s)",n,s);let a=[],c;try{c=await t(n)}catch(g){if(s===0)throw g}if(c&&a.push({val:c.value,from:r.peerId}),a.length>=s)return a;let f=await ih.convertBuffer(n),l=r.routingTable.closestPeers(f,r.kBucketSize);if(r._log("peers in rt: %d",l.length),l.length===0){let g="Failed to lookup key! No peers from routing table!";if(r._log.error(g),a.length===0)throw iC(new Error(g),"ERR_NO_PEERS_IN_ROUTING_TABLE");return a}let h=a.length;function d(g,m){let E=ih.pathSize(s-h,m),_=0;async function T(q){let z,V,M;try{let X=await r._getValueOrPeers(q,n);z=X.record,V=X.peers}catch(X){if(X.code!=="ERR_INVALID_RECORD")throw X;M=X}let $={closerPeers:V};return z&&z.value?(a.push({val:z.value,from:q}),_++):M&&(a.push({err:M,from:q}),_++),_>=E&&($.pathComplete=!0),$}return T}let y=new pbt(r,n,d);try{await hbt(y.run(l),o.timeout)}catch(g){if(a.length===0)throw g}finally{y.stop()}return a}}}});var K_e=p((ENt,F_e)=>{u();"use strict";var U_e=class{constructor(){this.list=[]}push(e){return this.has(e.id)?!1:(this.list.push(e),!0)}has(e){let t=this.list.find(i=>i.id.equals(e));return Boolean(t)}toArray(){return this.list.slice()}pop(){return this.list.pop()}get length(){return this.list.length}};F_e.exports=U_e});var z_e=p((SNt,V_e)=>{u();"use strict";var gbt=K_e(),j_e=class extends gbt{constructor(e){super();this.limit=e}push(e){return this.length<this.limit?super.push(e):!1}};V_e.exports=j_e});var X_e=p((ANt,Y_e)=>{u();"use strict";var bbt=ue(),H_e=w0(),$_e=pl(),G_e=z_e(),AS=Xa(),mbt=SS(),W_e=li();Y_e.exports=r=>{let e=async(t,i)=>{let n=new AS(AS.TYPES.GET_PROVIDERS,i.bytes,0);return r.network.sendRequest(t,n)};return{async provide(t){r._log(`provide: ${t}`);let i=[];await r.providers.addProvider(t,r.peerId);let n=r.libp2p?r.libp2p.multiaddrs:[],s=new AS(AS.TYPES.ADD_PROVIDER,t.bytes,0);s.providerPeers=[{id:r.peerId,multiaddrs:n}];async function o(a){r._log(`putProvider ${t} to ${a.toB58String()}`);try{await r.network.sendMessage(a,s)}catch(c){i.push(c)}}if(await W_e.mapParallel(r.getClosestPeers(t.bytes),o),i.length)throw bbt(new Error(`Failed to provide to ${i.length} of ${r.kBucketSize} peers`),"ERR_SOME_PROVIDES_FAILED",{errors:i})},async*findProviders(t,i={timeout:6e4,maxNumProviders:5}){let n=i.timeout||$_e.minute,s=i.maxNumProviders||$_e.K;r._log(`findProviders ${t}`);let o=new G_e(s);if((await r.providers.getProviders(t)).forEach(d=>{let y=r.peerStore.get(d);y?o.push({id:y.id,multiaddrs:y.addresses.map(g=>g.multiaddr)}):o.push({id:d,multiaddrs:[]})}),o.length>=s){for(let d of o.toArray())yield d;return}let c=[];function f(d,y){let g=W_e.pathSize(s-o.length,y),m=new G_e(g);c.push(m);async function E(_){let T=await e(_,t),q=T.providerPeers;return r._log(`Found ${q.length} provider entries for ${t}`),q.forEach(z=>{m.push({...z})}),m.length>=g?{pathComplete:!0}:{closerPeers:T.closerPeers}}return E}let l=new mbt(r,t.bytes,f),h=r.routingTable.closestPeers(t.bytes,r.kBucketSize);try{await H_e(l.run(h),n)}catch(d){if(d.name!==H_e.TimeoutError.name)throw d}finally{l.stop()}c.forEach(d=>{d.toArray().forEach(y=>{o.push(y)})});for(let d of o.toArray())yield d}}}});var Z_e=p((xNt,J_e)=>{u();"use strict";var sm=ue(),vbt=w0(),sC=rt(),wbt=Ea(),_bt=Ze(),Ebt=pl(),xS=Xa(),Q_e=SS(),om=li();J_e.exports=r=>{let e=async s=>{r._log(`findPeerLocal ${s.toB58String()}`);let o=await r.routingTable.find(s),a=o&&r.peerStore.get(o);if(a)return{id:a.id,multiaddrs:a.addresses.map(c=>c.multiaddr)}},t=async(s,o)=>{let a=new xS(xS.TYPES.GET_VALUE,o,0);return r.network.sendRequest(s,a)},i=async(s,o)=>(r._log(`closerPeersSingle ${_bt(s,"base32")} from ${o.toB58String()}`),(await r.peerRouting._findPeerSingle(o,new sC(s))).closerPeers.filter(c=>!r._isSelf(c.id)).map(c=>(r.peerStore.addressBook.add(c.id,c.multiaddrs),c))),n=async s=>{let o=om.keyForPublicKey(s),a=await t(s,o);if(!a.record||!a.record.value)throw sm(new Error(`Node not responding with its public key: ${s.toB58String()}`),"ERR_INVALID_RECORD");let c=await sC.createFromPubKey(a.record.value);if(!c.equals(s))throw sm(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");return c.pubKey};return{async _findPeerSingle(s,o){r._log("findPeerSingle %s",s.toB58String());let a=new xS(xS.TYPES.FIND_NODE,o.id,0);return r.network.sendRequest(s,a)},async findPeer(s,o={timeout:6e4}){o.timeout=o.timeout||Ebt.minute,r._log("findPeer %s",s.toB58String());let a=await e(s);if(a!=null)return r._log("found local"),a;let c=await om.convertPeerId(s),f=r.routingTable.closestPeers(c,r.kBucketSize);if(f.length===0)throw sm(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED");if(f.find(m=>m.isEqual(s))){let m=r.peerStore.get(s);if(m)return r._log("found in peerStore"),{id:m.id,multiaddrs:m.addresses.map(E=>E.multiaddr)}}let h=new Q_e(r,s.id,()=>async E=>{let _=await this._findPeerSingle(E,s),T=_.closerPeers.find(q=>q.id.isEqual(s));return T?{peer:T,queryComplete:!0}:{closerPeers:_.closerPeers}}),d;try{d=await vbt(h.run(f),o.timeout)}finally{h.stop()}let y=!1;if(d.paths.forEach(m=>{m.success&&m.peer&&(y=!0,r.peerStore.addressBook.add(m.peer.id,m.peer.multiaddrs))}),r._log("findPeer %s: %s",s.toB58String(),y),!y)throw sm(new Error("No peer found"),"ERR_NOT_FOUND");let g=r.peerStore.get(s);if(!g)throw sm(new Error("No peer found in peer store"),"ERR_NOT_FOUND");return{id:g.id,multiaddrs:g.addresses.map(m=>m.multiaddr)}},async*getClosestPeers(s,o={shallow:!1}){r._log("getClosestPeers to %b",s);let a=await om.convertBuffer(s),c=r.routingTable.closestPeers(a,r.kBucketSize),l=await new Q_e(r,s,()=>async d=>({closerPeers:await i(s,d),pathComplete:o.shallow?!0:void 0})).run(c);if(!l||!l.finalSet)return[];let h=await om.sortClosestPeers(Array.from(l.finalSet),a);for(let d of h.slice(0,r.kBucketSize))yield d},async getPublicKey(s){r._log("getPublicKey %s",s.toB58String());let o=r.peerStore.get(s);if(o&&o.id.pubKey)return r._log("getPublicKey: found local copy"),o.id.pubKey;let a;try{a=await n(s)}catch(l){let h=om.keyForPublicKey(s),d=await r.get(h);a=wbt.keys.unmarshalPublicKey(d)}let c=new sC(s.id,void 0,a),f=(o&&o.addresses||[]).map(l=>l.multiaddr);return r.peerStore.addressBook.add(c,f),r.peerStore.keyBook.set(c,a),a}}}});var s2e=p((INt,n2e)=>{u();"use strict";var Sbt=sg(),e2e=Jn(),Abt=rt(),{Key:xbt}=Lt(),{default:Ibt}=_c(),am=pl(),cm=li(),t2e=class{constructor(e,t,i){this.datastore=e,this._log=cm.logger(t,"providers"),this.cleanupInterval=am.PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=am.PROVIDERS_VALIDITY,this.lruCacheSize=i||am.PROVIDERS_LRU_CACHE_SIZE,this.providers=Sbt(this.lruCacheSize),this.syncQueue=new Ibt({concurrency:1})}start(){this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval)}stop(){this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{this._log("start cleanup");let e=Date.now(),t=0,i=0,n=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:am.PROVIDERS_KEY_PREFIX});for await(let a of o)try{let{cid:c,peerId:f}=r2e(a.key),l=i2e(a.value),h=Date.now(),d=h-l,y=d>this.provideValidity;if(this._log("comparing: %d - %d = %d > %d %s",h,l,d,this.provideValidity,y?"(expired)":""),y){i++,s.delete(a.key);let g=n.get(c)||new Set;g.add(f),n.set(c,g)}t++}catch(c){this._log.error(c.message)}this._log("deleting %d / %d entries",i,t),n.size&&await s.commit();for(let[a,c]of n){let f=um(a),l=this.providers.get(f);if(l){for(let h of c)l.delete(h);l.size===0?this.providers.remove(f):this.providers.set(f,l)}}this._log("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let t=um(e),i=this.providers.get(t);return i||(i=await Rbt(this.datastore,e),this.providers.set(t,i)),i}async addProvider(e,t){return this.syncQueue.add(async()=>{this._log("addProvider %s",e.toString());let i=await this._getProvidersMap(e);this._log("loaded %s provs",i.size);let n=new Date;i.set(cm.encodeBase32(t.id),n);let s=um(e);return this.providers.set(s,i),Tbt(this.datastore,e,t,n)})}async getProviders(e){return this.syncQueue.add(async()=>(this._log("getProviders %s",e.toString()),[...(await this._getProvidersMap(e)).keys()].map(i=>new Abt(cm.decodeBase32(i)))))}};function um(r){return r=typeof r=="string"?r:cm.encodeBase32(r.bytes),am.PROVIDERS_KEY_PREFIX+r}async function Tbt(r,e,t,i){let n=[um(e),"/",cm.encodeBase32(t.id)].join(""),s=new xbt(n),o=Uint8Array.from(e2e.encode(i.getTime()));return r.put(s,o)}function r2e(r){let e=r.toString().split("/");if(e.length!==4)throw new Error("incorrectly formatted provider entry key in datastore: "+r);return{cid:e[2],peerId:e[3]}}async function Rbt(r,e){let t=new Map,i=r.query({prefix:um(e)});for await(let n of i){let{peerId:s}=r2e(n.key);t.set(s,i2e(n.value))}return t}function i2e(r){return e2e.decode(r)}n2e.exports=t2e});var a2e=p((TNt,oC)=>{u();"use strict";var Pbt=yS(),o2e=async(r,e,t)=>Pbt(new Array(r).fill(),(i,n)=>e(n),t);oC.exports=o2e;oC.exports.default=o2e});var l2e=p((RNt,u2e)=>{u();"use strict";var Cbt=Ea(),{sha256:Obt}=(Hr(),Ir),qbt=rt(),{AbortController:kbt}=vl(),Bbt=ue(),Nbt=a2e(),Dbt=pl(),{logger:Mbt}=li(),c2e=class{constructor(e,t){if(!e)throw new Error("Random Walk needs an instance of the Kademlia DHT");this._kadDHT=e,this._options={...Dbt.defaultRandomWalk,...t},this.log=Mbt(e.peerId,"random-walk"),this._timeoutId=void 0}start(){this._running||(this._running=!0,!(this._timeoutId||!this._options.enabled)&&(this._timeoutId=setTimeout(()=>{this._runPeriodically()},this._options.delay)))}stop(){this._running=!1,this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0),this._controller&&this._controller.abort()}async _runPeriodically(){for(;this._timeoutId;){try{await this._walk(this._options.queriesPerPeriod,this._options.timeout)}catch(e){this._kadDHT._log.error("random-walk:error",e)}if(!this._running)return;await new Promise(e=>{this._timeoutId=setTimeout(e,this._options.interval)})}}async _walk(e,t){this.log("start"),this._controller=new kbt;try{await Nbt(e,async i=>{this.log("running query %d",i);try{let n=await this._randomPeerId();if(!this._controller)return;await this._query(n,{timeout:t,signal:this._controller.signal})}catch(n){if(n&&n.code!=="ETIMEDOUT")throw this.log.error("query %d finished with error",i,n),n}this.log("finished query %d",i)})}finally{this._controller=null,this.log("finished queries")}}async _query(e,t){this.log("query:%s",e.toB58String());let i;try{i=await this._kadDHT.findPeer(e,t)}catch(n){if(n&&n.code==="ERR_NOT_FOUND")return;throw n}throw this.log("query:found",i),Bbt(new Error(`random-walk: ACTUALLY FOUND PEER: ${i}, ${e.toB58String()}`),"ERR_FOUND_RANDOM_PEER")}async _randomPeerId(){let e=await Obt.digest(Cbt.randomBytes(16));return new qbt(e.bytes)}};u2e.exports=c2e});var d2e=p((PNt,h2e)=>{u();"use strict";var f2e=class{constructor(){this.queries=new Set,this.running=!1}queryStarted(e){this.queries.add(e)}queryCompleted(e){this.queries.delete(e)}start(){this.running=!0}stop(){this.running=!1;for(let e of this.queries)e.stop();this.queries.clear()}};h2e.exports=f2e});var g2e=p((CNt,uC)=>{u();"use strict";var{EventEmitter:Lbt}=br(),IS=ue(),lm=sf(),{MemoryDatastore:Ubt}=Lt(),p2e=fi(),aC=Ze(),Fbt=Nwe(),A0=li(),fm=pl(),Kbt=d_e(),jbt=L_e(),Vbt=X_e(),zbt=Z_e(),TS=Xa(),Hbt=s2e(),$bt=l2e(),Gbt=d2e(),cC=lm.Record,y2e=class extends Lbt{constructor({libp2p:e,dialer:t,peerId:i,peerStore:n,registrar:s,protocolPrefix:o="/ipfs",forceProtocolLegacy:a=!1,datastore:c=new Ubt,kBucketSize:f=fm.K,clientMode:l=!1,concurrency:h=fm.ALPHA,validators:d={},selectors:y={},randomWalk:g={enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:3e4,delay:1e4},onPut:m=()=>{},onRemove:E=()=>{}}){super();if(!t)throw new Error("libp2p-kad-dht requires an instance of Dialer");this.libp2p=e,this.dialer=t,this.peerId=i,this.peerStore=n,this.registrar=s,this.protocol=o+(a?"":fm.PROTOCOL_DHT),this.kBucketSize=f,this._clientMode=l,this.concurrency=h,this.disjointPaths=Math.ceil(this.kBucketSize/2),this.routingTable=new Fbt(this.peerId,this.kBucketSize),this.datastore=c,this.providers=new Hbt(this.datastore,this.peerId),this.validators={pk:lm.validator.validators.pk,...d},this.selectors={pk:lm.selection.selectors.pk,...y},this.network=new Kbt(this),this._log=A0.logger(this.peerId),this.randomWalk=new $bt(this,g),this._queryManager=new Gbt,this._running=!1,this.contentFetching=jbt(this),this.contentRouting=Vbt(this),this.peerRouting=zbt(this),this.onPut=m,this.onRemove=E}get isStarted(){return this._running}start(){this._running||(this._running=!0,this.providers.start(),this._queryManager.start(),this.network.start(),this.randomWalk.start())}stop(){this._running=!1,this.randomWalk.stop(),this.network.stop(),this._queryManager.stop(),this.providers.stop()}async put(e,t,i={}){return this.contentFetching.put(e,t,i)}async get(e,t={}){return this.contentFetching.get(e,t)}async getMany(e,t,i={}){return this.contentFetching.getMany(e,t,i)}async removeLocal(e){this._log(`removeLocal: ${aC(e,"base32")}`);let t=A0.bufferToKey(e);try{await this.datastore.delete(t)}catch(i){if(i.code==="ERR_NOT_FOUND")return;throw i}}async _putLocal(e,t){this._log(`_putLocal: ${aC(e,"base32")}`);let i=A0.bufferToKey(e);await this.datastore.put(i,t)}async provide(e){return this.contentRouting.provide(e)}async*findProviders(e,t={timeout:6e3,maxNumProviders:5}){for await(let i of this.contentRouting.findProviders(e,t))yield i}async findPeer(e,t={timeout:6e4}){return this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={shallow:!1}){yield*this.peerRouting.getClosestPeers(e,t)}getPublicKey(e){return this.peerRouting.getPublicKey(e)}_peerDiscovered(e,t){this.emit("peer",{id:e,multiaddrs:t})}async _nearestPeersToQuery(e){let t=await A0.convertBuffer(e.key);return this.routingTable.closestPeers(t,this.kBucketSize).map(n=>{let s=this.peerStore.get(n);return{id:n,multiaddrs:s?s.addresses.map(o=>o.multiaddr):[]}})}async _betterPeersToQuery(e,t){return this._log("betterPeersToQuery"),(await this._nearestPeersToQuery(e)).filter(n=>this._isSelf(n.id)?(this._log.error("trying to return self as closer"),!1):!n.id.isEqual(t))}async _checkLocalDatastore(e){this._log(`checkLocalDatastore: ${aC(e)} %b`,e);let t=A0.bufferToKey(e),i;try{i=await this.datastore.get(t)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let n=cC.deserialize(i);if(!n)throw IS(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||A0.now()-n.timeReceived.getTime()>fm.MAX_RECORD_AGE){await this.datastore.delete(t),this.onRemove(n);return}return n}async _add(e){await this.routingTable.add(e)}async _verifyRecordLocally(e){this._log("verifyRecordLocally"),await lm.validator.verifyRecord(this.validators,e)}_isSelf(e){return e&&p2e(this.peerId.id,e.id)}async _putValueToPeer(e,t,i){let n=new TS(TS.TYPES.PUT_VALUE,e,0);n.record=cC.deserialize(t);let s=await this.network.sendRequest(i,n);if(s.record&&!p2e(s.record.value,cC.deserialize(t).value))throw IS(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")}async _getValueOrPeers(e,t){let i=await this._getValueSingle(e,t),n=i.closerPeers,s=i.record;if(s){try{await this._verifyRecordOnline(s)}catch(o){let a="invalid record received, discarded";throw this._log(a),IS(new Error(a),"ERR_INVALID_RECORD")}return{record:s,peers:n}}if(n.length>0)return{peers:n};throw IS(new Error("Not found"),"ERR_NOT_FOUND")}async _getValueSingle(e,t){let i=new TS(TS.TYPES.GET_VALUE,t,0);return this.network.sendRequest(e,i)}async _verifyRecordOnline(e){await lm.validator.verifyRecord(this.validators,e)}};uC.exports=y2e;uC.exports.multicodec="/ipfs"+fm.PROTOCOL_DHT});var v2e=p((ONt,m2e)=>{u();"use strict";var Wbt=Fbe(),Ybt=O1e(),Xbt=Z1e(),{NOISE:Qbt}=_we(),Jbt=g2e(),Zbt=ET(),b2e=TI();m2e.exports=()=>({dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[Wbt,Ybt],streamMuxer:[Xbt],connEncryption:[Qbt],peerDiscovery:[],dht:Jbt,pubsub:Zbt},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!1,clientMode:!0,randomWalk:{enabled:!1},validators:{ipns:b2e.validator},selectors:{ipns:b2e.selector}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0,threshold:1}})});var S2e=p((lC,E2e)=>{u();"use strict";var emt=rt(),{Multiaddr:tmt}=et(),rmt=zl(),{EventEmitter:imt}=br(),w2e=me(),RS=Object.assign(w2e("libp2p:bootstrap"),{error:w2e("libp2p:bootstrap:error")}),_2e=class extends imt{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),RS("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!rmt.P2P.matches(e))return RS.error("Invalid multiaddr");let t=new tmt(e),i=t.getPeerId();if(!i){RS.error("Invalid bootstrap multiaddr without peer id");return}let n=emt.createFromB58String(i);try{this.emit("peer",{id:n,multiaddrs:[t]})}catch(s){RS.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};lC=E2e.exports=_2e;lC.tag="bootstrap"});var fC=p((qNt,x2e)=>{u();"use strict";var Dt=Ag(),nmt=mr().bind({ignoreUndefined:!0}),smt=ue(),A2e=hse(),omt=vse(),amt=xse(),{create:cmt}=Ofe(),{Multiaddr:umt}=et(),lmt=Pw().version;x2e.exports=({options:r={},peerId:e,multiaddrs:t=[],repo:i,keychainConfig:n={},config:s={}})=>{let{datastore:o,keys:a}=i,c=fmt({options:r,config:s,datastore:o,keys:a,keychainConfig:n,peerId:e,multiaddrs:t});return typeof r.libp2p=="function"?r.libp2p({libp2pOptions:c,options:r,config:s,datastore:o,peerId:e}):Vge().create(c)};function fmt({options:r,config:e,datastore:t,keys:i,keychainConfig:n,peerId:s,multiaddrs:o}){let a=()=>{let m=Dt(e,"Pubsub.Router")||"gossipsub";if(!A2e[m])throw smt(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${m} router.`),"ERR_NOT_SUPPORTED");return A2e[m]},c={datastore:t,peerId:s,modules:{}},f={modules:{pubsub:a(),contentRouting:[],peerRouting:[]},config:{peerDiscovery:{mdns:{enabled:Dt(r,"config.Discovery.MDNS.Enabled",Dt(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:Dt(r,"config.Discovery.webRTCStar.Enabled",Dt(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:Dt(r,"config.Bootstrap",Dt(e,"Bootstrap",[]))}},relay:{enabled:Dt(r,"relay.enabled",Dt(e,"relay.enabled",!0)),hop:{enabled:Dt(r,"relay.hop.enabled",Dt(e,"relay.hop.enabled",!1)),active:Dt(r,"relay.hop.active",Dt(e,"relay.hop.active",!1))}},dht:{enabled:Dt(e,"Routing.Type","none")!=="none",clientMode:Dt(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:Dt(r,"dht.kBucketSize",20)},pubsub:{enabled:Dt(r,"config.Pubsub.Enabled",Dt(e,"Pubsub.Enabled",!0))},nat:{enabled:!Dt(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(m=>m.toString()),announce:Dt(r,"addresses.announce",Dt(e,"Addresses.Announce",[])),noAnnounce:Dt(r,"addresses.noAnnounce",Dt(e,"Addresses.NoAnnounce",[]))},connectionManager:Dt(r,"connectionManager",{maxConnections:Dt(r,"config.Swarm.ConnMgr.HighWater",Dt(e,"Swarm.ConnMgr.HighWater")),minConnections:Dt(r,"config.Swarm.ConnMgr.LowWater",Dt(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:i,...n},host:{agentVersion:`js-ipfs/${lmt}`}},l=v2e(),h=Dt(r,"libp2p",void 0);typeof h=="function"&&(h=void 0);let d=nmt(c,l(),f,h);Dt(d,"config.peerDiscovery.bootstrap.list",[]).length>0&&d.modules.peerDiscovery.push(S2e());let g=Dt(r,"config.Addresses.Delegates",Dt(e,"Addresses.Delegates",[]));if(g.length>0){let m=g[Math.floor(Math.random()*g.length)],E=new umt(m).toOptions(),_={host:E.host,protocol:parseInt(E.port)===443?"https":"http",port:E.port},T=cmt(_);f.modules.contentRouting=f.modules.contentRouting||[],f.modules.contentRouting.push(new amt(s,T)),f.modules.peerRouting=f.modules.peerRouting||[],f.modules.peerRouting.push(new omt(T))}return d}});var O2e=p((kNt,C2e)=>{u();"use strict";var hm=me()("ipfs:components:peer:storage"),hmt=gie(),dmt=pw(),{ERR_REPO_NOT_INITIALIZED:pmt}=Jl().errors,ymt=ct(),gmt=Ze(),hC=rt(),I2e=mr().bind({ignoreUndefined:!0}),bmt=c4(),{NotEnabledError:mmt,NotInitializedError:vmt}=Iu(),T2e=fC(),PS=class{constructor(e,t,i,n,s){this.print=n,this.peerId=e,this.keychain=t,this.repo=i,this.print=n,this.isNew=s}static async start(e,t,i){let{repoAutoMigrate:n,repo:s,onMigrationProgress:o}=i,a=typeof s=="string"||s==null?hmt(e,t,{path:s,autoMigrate:n,onMigrationProgress:o}):s,{peerId:c,keychain:f,isNew:l}=await wmt(e,a,i);return new PS(c,f,a,e,l)}};C2e.exports=PS;var wmt=async(r,e,t)=>{if(!e.closed)return{...await R2e(e,t),isNew:!1};try{return await e.open(),{...await R2e(e,t),isNew:!1}}catch(i){if(i.code!==pmt)throw i;if(t.init&&t.init.allowNew===!1)throw new mmt("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await _mt(r,e,t),isNew:!0}}},_mt=async(r,e,t)=>{let i=t.init||{},n=await e.exists();if(hm("repo exists?",n),n===!0)throw new Error("repo already exists");let s=i.privateKey?await Emt(i.privateKey):await Smt(r,i),o=Amt(s);hm("peer identity: %s",o.PeerID);let a={...I2e(P2e(dmt(),i.profiles),t.config),Identity:o};await e.init(a),await e.open(),hm("repo opened");let c=await T2e({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:{pass:t.pass}});return c.keychain&&c.keychain.opts&&(await c.loadKeychain(),await e.config.set("Keychain",{dek:c.keychain.opts.dek})),{peerId:s,keychain:c.keychain}},Emt=r=>(hm("using user-supplied private-key"),typeof r=="object"?r:hC.createFromPrivKey(ymt(r,"base64pad"))),Smt=(r,{algorithm:e="RSA",bits:t=2048})=>(r("generating %s-bit (rsa only) %s keypair...",t,e),hC.create({keyType:e,bits:t})),Amt=r=>({PeerID:r.toB58String(),PrivKey:gmt(r.privKey.bytes,"base64pad")}),R2e=async(r,e)=>{let t=e.config,i=e.init&&e.init.profiles||[],n=e.pass,s=await r.config.getAll(),o=xmt(P2e(s,i),t);if(s!==o&&await r.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new vmt("No private key was found in the config, please intialize the repo");let a=await hC.createFromPrivKey(o.Identity.PrivKey),c=await T2e({options:void 0,multiaddrs:void 0,peerId:a,repo:r,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},xmt=(r,e)=>e?I2e(r,e):r,P2e=(r,e)=>(e||[]).reduce((t,i)=>{let n=bmt.profiles[i];if(!n)throw new Error(`Could not find profile with name '${i}'`);return hm("applying profile %s",i),n.transform(t)},r)});var N2e=p((BNt,B2e)=>{u();B2e.exports=k2e;var q2e=128,Imt=127,Tmt=~Imt,Rmt=Math.pow(2,31);function k2e(r,e,t){e=e||[],t=t||0;for(var i=t;r>=Rmt;)e[t++]=r&255|q2e,r/=128;for(;r&Tmt;)e[t++]=r&255|q2e,r>>>=7;return e[t]=r|0,k2e.bytes=t-i+1,e}});var L2e=p((NNt,M2e)=>{u();M2e.exports=dC;var Pmt=128,D2e=127;function dC(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw dC.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&D2e)<<i:(s&D2e)*Math.pow(2,i),i+=7}while(s>=Pmt);return dC.bytes=n-e,t}});var F2e=p((DNt,U2e)=>{u();var Cmt=Math.pow(2,7),Omt=Math.pow(2,14),qmt=Math.pow(2,21),kmt=Math.pow(2,28),Bmt=Math.pow(2,35),Nmt=Math.pow(2,42),Dmt=Math.pow(2,49),Mmt=Math.pow(2,56),Lmt=Math.pow(2,63);U2e.exports=function(r){return r<Cmt?1:r<Omt?2:r<qmt?3:r<kmt?4:r<Bmt?5:r<Nmt?6:r<Dmt?7:r<Mmt?8:r<Lmt?9:10}});var j2e=p((MNt,K2e)=>{u();K2e.exports={encode:N2e(),decode:L2e(),encodingLength:F2e()}});var H2e=p((LNt,z2e)=>{u();"use strict";var V2e=j2e();z2e.exports=r=>{if(!(r instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;r.length>0;){let t=V2e.decode(r);e.push(t),r=r.slice(V2e.decode.bytes)}return e}});var W2e=p((UNt,G2e)=>{u();"use strict";var{base58btc:Umt}=(zr(),Vr),$2e=class{constructor(e,t,i){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=i}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(Umt)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};G2e.exports=$2e});var dm=p((FNt,X2e)=>{u();"use strict";var Y2e=W2e(),{base58btc:CS}=(zr(),Vr),Fmt=(r,e)=>Array.prototype.slice.call(e,0).sort((t,i)=>{let n=r(t),s=r(i);return n<s?-1:n>s?1:0}),pC=class{constructor(e){this.set=new Map,this._stats=e}get length(){return this.set.size}add(e,t,i){let n=x0(),s=e.toString(CS),o=this.set.get(s);o?(o.inc(),o.priority=t,o.wantType===n.WantType.Have&&i===n.WantType.Block&&(o.wantType=i)):(this.set.set(s,new Y2e(e,t,i)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let t=e.toString(CS),i=this.set.get(t);!i||(i.dec(),!i.hasRefs()&&(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(Fmt(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString(CS);return this.set.has(t)}get(e){let t=e.toString(CS);return this.set.get(t)}};pC.Entry=Y2e;X2e.exports=pC});var yC=p((jNt,Q2e)=>{u();"use strict";var Kmt=dm().Entry,{base58btc:jmt}=(zr(),Vr);Q2e.exports=class{constructor(e,t,i,n,s){this.entry=new Kmt(e,t,i),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(jmt)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}});var gl=p((VNt,eEe)=>{u();"use strict";var J2e=me(),Vmt=fi(),Z2e=yC(),zmt=(r,e)=>{let t=["bitswap"];return e&&t.push(e),r&&t.push(`${r.toB58String().slice(0,8)}`),Object.assign(J2e(t.join(":")),{error:J2e(t.concat(["error"]).join(":"))})},gC=(r,e,t)=>{let i=0,n=t.length;for(;i<n;){if(r(e,t[i]))return!0;i+=1}return!1},Hmt=(r,e)=>{let t=0,i=e.length,n=[],s;for(;t<i;)s=e[t],gC(r,s,n)||(n[n.length]=s),t+=1;return n},$mt=(r,e)=>e.reduce((t,i)=>{let n=r(i);return t[n]?t[n].push(i):t[n]=[i],t},{}),Gmt=(r,e,t)=>e.filter(i=>!gC(r,i,t)),Wmt=(r,e)=>Array.prototype.slice.call(e,0).sort((t,i)=>{let n=r(t),s=r(i);return n<s?-1:n>s?1:0}),Ymt=(r,e)=>{if(r.size!==e.size)return!1;for(let[t,i]of r){let n=e.get(t);if(n===void 0||i instanceof Uint8Array&&n instanceof Uint8Array&&!Vmt(i,n)||i instanceof Z2e&&n instanceof Z2e&&!i.equals(n))return!1}return!0};eEe.exports={logger:zmt,includesWith:gC,uniqWith:Hmt,groupBy:$mt,pullAllWith:Gmt,sortBy:Wmt,isMapEqual:Ymt}});var rEe=p((zNt,tEe)=>{u();"use strict";var Qa=Pi(),Ja=Qa.Reader,pm=Qa.Writer,Mt=Qa.util,It=Qa.roots["ipfs-bitswap"]||(Qa.roots["ipfs-bitswap"]={});It.Message=function(){function r(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.wantlist=null,r.prototype.blocks=Mt.emptyArray,r.prototype.payload=Mt.emptyArray,r.prototype.blockPresences=Mt.emptyArray,r.prototype.pendingBytes=0,r.encode=function(t,i){if(i||(i=pm.create()),t.wantlist!=null&&Object.hasOwnProperty.call(t,"wantlist")&&It.Message.Wantlist.encode(t.wantlist,i.uint32(10).fork()).ldelim(),t.blocks!=null&&t.blocks.length)for(var n=0;n<t.blocks.length;++n)i.uint32(18).bytes(t.blocks[n]);if(t.payload!=null&&t.payload.length)for(var n=0;n<t.payload.length;++n)It.Message.Block.encode(t.payload[n],i.uint32(26).fork()).ldelim();if(t.blockPresences!=null&&t.blockPresences.length)for(var n=0;n<t.blockPresences.length;++n)It.Message.BlockPresence.encode(t.blockPresences[n],i.uint32(34).fork()).ldelim();return t.pendingBytes!=null&&Object.hasOwnProperty.call(t,"pendingBytes")&&i.uint32(40).int32(t.pendingBytes),i},r.decode=function(t,i){t instanceof Ja||(t=Ja.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new It.Message;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.wantlist=It.Message.Wantlist.decode(t,t.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(t.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(It.Message.Block.decode(t,t.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(It.Message.BlockPresence.decode(t,t.uint32()));break;case 5:s.pendingBytes=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof It.Message)return t;var i=new It.Message;if(t.wantlist!=null){if(typeof t.wantlist!="object")throw TypeError(".Message.wantlist: object expected");i.wantlist=It.Message.Wantlist.fromObject(t.wantlist)}if(t.blocks){if(!Array.isArray(t.blocks))throw TypeError(".Message.blocks: array expected");i.blocks=[];for(var n=0;n<t.blocks.length;++n)typeof t.blocks[n]=="string"?Mt.base64.decode(t.blocks[n],i.blocks[n]=Mt.newBuffer(Mt.base64.length(t.blocks[n])),0):t.blocks[n].length&&(i.blocks[n]=t.blocks[n])}if(t.payload){if(!Array.isArray(t.payload))throw TypeError(".Message.payload: array expected");i.payload=[];for(var n=0;n<t.payload.length;++n){if(typeof t.payload[n]!="object")throw TypeError(".Message.payload: object expected");i.payload[n]=It.Message.Block.fromObject(t.payload[n])}}if(t.blockPresences){if(!Array.isArray(t.blockPresences))throw TypeError(".Message.blockPresences: array expected");i.blockPresences=[];for(var n=0;n<t.blockPresences.length;++n){if(typeof t.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");i.blockPresences[n]=It.Message.BlockPresence.fromObject(t.blockPresences[n])}}return t.pendingBytes!=null&&(i.pendingBytes=t.pendingBytes|0),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),i.defaults&&(n.wantlist=null,n.pendingBytes=0),t.wantlist!=null&&t.hasOwnProperty("wantlist")&&(n.wantlist=It.Message.Wantlist.toObject(t.wantlist,i)),t.blocks&&t.blocks.length){n.blocks=[];for(var s=0;s<t.blocks.length;++s)n.blocks[s]=i.bytes===String?Mt.base64.encode(t.blocks[s],0,t.blocks[s].length):i.bytes===Array?Array.prototype.slice.call(t.blocks[s]):t.blocks[s]}if(t.payload&&t.payload.length){n.payload=[];for(var s=0;s<t.payload.length;++s)n.payload[s]=It.Message.Block.toObject(t.payload[s],i)}if(t.blockPresences&&t.blockPresences.length){n.blockPresences=[];for(var s=0;s<t.blockPresences.length;++s)n.blockPresences[s]=It.Message.BlockPresence.toObject(t.blockPresences[s],i)}return t.pendingBytes!=null&&t.hasOwnProperty("pendingBytes")&&(n.pendingBytes=t.pendingBytes),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Qa.util.toJSONOptions)},r.Wantlist=function(){function e(t){if(this.entries=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.entries=Mt.emptyArray,e.prototype.full=!1,e.encode=function(i,n){if(n||(n=pm.create()),i.entries!=null&&i.entries.length)for(var s=0;s<i.entries.length;++s)It.Message.Wantlist.Entry.encode(i.entries[s],n.uint32(10).fork()).ldelim();return i.full!=null&&Object.hasOwnProperty.call(i,"full")&&n.uint32(16).bool(i.full),n},e.decode=function(i,n){i instanceof Ja||(i=Ja.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new It.Message.Wantlist;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(It.Message.Wantlist.Entry.decode(i,i.uint32()));break;case 2:o.full=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof It.Message.Wantlist)return i;var n=new It.Message.Wantlist;if(i.entries){if(!Array.isArray(i.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var s=0;s<i.entries.length;++s){if(typeof i.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[s]=It.Message.Wantlist.Entry.fromObject(i.entries[s])}}return i.full!=null&&(n.full=Boolean(i.full)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.entries=[]),n.defaults&&(s.full=!1),i.entries&&i.entries.length){s.entries=[];for(var o=0;o<i.entries.length;++o)s.entries[o]=It.Message.Wantlist.Entry.toObject(i.entries[o],n)}return i.full!=null&&i.hasOwnProperty("full")&&(s.full=i.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Qa.util.toJSONOptions)},e.WantType=function(){var t={},i=Object.create(t);return i[t[0]="Block"]=0,i[t[1]="Have"]=1,i}(),e.Entry=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.block=Mt.newBuffer([]),t.prototype.priority=0,t.prototype.cancel=!1,t.prototype.wantType=0,t.prototype.sendDontHave=!1,t.encode=function(n,s){return s||(s=pm.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&s.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&s.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&s.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&s.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&s.uint32(40).bool(n.sendDontHave),s},t.decode=function(n,s){n instanceof Ja||(n=Ja.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new It.Message.Wantlist.Entry;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof It.Message.Wantlist.Entry)return n;var s=new It.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?Mt.base64.decode(n.block,s.block=Mt.newBuffer(Mt.base64.length(n.block)),0):n.block.length&&(s.block=n.block)),n.priority!=null&&(s.priority=n.priority|0),n.cancel!=null&&(s.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return n.sendDontHave!=null&&(s.sendDontHave=Boolean(n.sendDontHave)),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=Mt.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(o.block=s.bytes===String?Mt.base64.encode(n.block,0,n.block.length):s.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(o.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(o.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?It.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(o.sendDontHave=n.sendDontHave),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,Qa.util.toJSONOptions)},t}(),e}(),r.Block=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.prefix=Mt.newBuffer([]),e.prototype.data=Mt.newBuffer([]),e.encode=function(i,n){return n||(n=pm.create()),i.prefix!=null&&Object.hasOwnProperty.call(i,"prefix")&&n.uint32(10).bytes(i.prefix),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),n},e.decode=function(i,n){i instanceof Ja||(i=Ja.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new It.Message.Block;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.prefix=i.bytes();break;case 2:o.data=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof It.Message.Block)return i;var n=new It.Message.Block;return i.prefix!=null&&(typeof i.prefix=="string"?Mt.base64.decode(i.prefix,n.prefix=Mt.newBuffer(Mt.base64.length(i.prefix)),0):i.prefix.length&&(n.prefix=i.prefix)),i.data!=null&&(typeof i.data=="string"?Mt.base64.decode(i.data,n.data=Mt.newBuffer(Mt.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.prefix="":(s.prefix=[],n.bytes!==Array&&(s.prefix=Mt.newBuffer(s.prefix))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=Mt.newBuffer(s.data)))),i.prefix!=null&&i.hasOwnProperty("prefix")&&(s.prefix=n.bytes===String?Mt.base64.encode(i.prefix,0,i.prefix.length):n.bytes===Array?Array.prototype.slice.call(i.prefix):i.prefix),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?Mt.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Qa.util.toJSONOptions)},e}(),r.BlockPresenceType=function(){var e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),r.BlockPresence=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.cid=Mt.newBuffer([]),e.prototype.type=0,e.encode=function(i,n){return n||(n=pm.create()),i.cid!=null&&Object.hasOwnProperty.call(i,"cid")&&n.uint32(10).bytes(i.cid),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(16).int32(i.type),n},e.decode=function(i,n){i instanceof Ja||(i=Ja.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new It.Message.BlockPresence;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.cid=i.bytes();break;case 2:o.type=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof It.Message.BlockPresence)return i;var n=new It.Message.BlockPresence;switch(i.cid!=null&&(typeof i.cid=="string"?Mt.base64.decode(i.cid,n.cid=Mt.newBuffer(Mt.base64.length(i.cid)),0):i.cid.length&&(n.cid=i.cid)),i.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.cid="":(s.cid=[],n.bytes!==Array&&(s.cid=Mt.newBuffer(s.cid))),s.type=n.enums===String?"Have":0),i.cid!=null&&i.hasOwnProperty("cid")&&(s.cid=n.bytes===String?Mt.base64.encode(i.cid,0,i.cid.length):n.bytes===Array?Array.prototype.slice.call(i.cid):i.cid),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?It.Message.BlockPresenceType[i.type]:i.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Qa.util.toJSONOptions)},e}(),r}();tEe.exports=It});var x0=p((HNt,nEe)=>{u();"use strict";var{CID:I0}=(uu(),Rh),{sha256:bC}=(Hr(),Ir),{base58btc:ym}=(zr(),Vr),Xmt=H2e(),{isMapEqual:mC}=gl(),{Message:Yc}=rEe(),iEe=yC(),Qmt=_n(),Jmt=ue(),pn=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,i,n,s){i==null&&(i=pn.WantType.Block);let o=e.toString(ym),a=this.wantlist.get(o);a?(a.wantType===i&&(a.priority=t),n&&(a.cancel=Boolean(n)),s&&(a.sendDontHave=Boolean(s)),i===pn.WantType.Block&&a.wantType===pn.WantType.Have&&(a.wantType=i)):this.wantlist.set(o,new iEe(e,t,i,n,s))}addBlock(e,t){let i=e.toString(ym);this.blocks.set(i,t)}addHave(e){let t=e.toString(ym);this.blockPresences.has(t)||this.blockPresences.set(t,pn.BlockPresenceType.Have)}addDontHave(e){let t=e.toString(ym);this.blockPresences.has(t)||this.blockPresences.set(t,pn.BlockPresenceType.DontHave)}cancel(e){let t=e.toString(ym);this.wantlist.delete(t),this.addEntry(e,0,pn.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),cancel:Boolean(t.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return Yc.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:Boolean(t.cancel),sendDontHave:Boolean(t.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[t,i]of this.blocks.entries()){let n=I0.parse(t),s=Uint8Array.from([n.code]),o=n.multihash.bytes.subarray(0,2),a=Qmt([[n.version],s,o],1+s.byteLength+o.byteLength);e.payload.push(new Yc.Block({prefix:a,data:i}))}for(let[t,i]of this.blockPresences)e.blockPresences.push(new Yc.BlockPresence({cid:I0.parse(t).bytes,type:i}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),Yc.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!mC(this.wantlist,e.wantlist)||!mC(this.blocks,e.blocks)||!mC(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};pn.deserialize=async(r,e={})=>{let t=Yc.decode(r),i=t.wantlist&&t.wantlist.full||!1,n=new pn(i);return t.wantlist&&t.wantlist.entries&&t.wantlist.entries.forEach(s=>{if(!s.block)return;let o=I0.decode(s.block);n.addEntry(o,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),t.blockPresences&&t.blockPresences.forEach(s=>{if(!s.cid)return;let o=I0.decode(s.cid);s.type===pn.BlockPresenceType.Have?n.addHave(o):n.addDontHave(o)}),t.blocks.length>0?(await Promise.all(t.blocks.map(async s=>{let o=await bC.digest(s),a=I0.createV0(o);n.addBlock(a,s)})),n):(t.payload.length>0&&(await Promise.all(t.payload.map(async s=>{if(!s.prefix||!s.data)return;let o=Xmt(s.prefix),a=o[0],c=o[1],f=o[2],l=f===bC.code?bC:e[f];if(!l)throw Jmt(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let h=await l.digest(s.data),d=I0.create(a,c,h);n.addBlock(d,s.data)})),n.setPendingBytes(t.pendingBytes)),n)};pn.blockPresenceSize=r=>r.bytes.length+1;pn.Entry=iEe;pn.WantType={Block:Yc.Wantlist.WantType.Block,Have:Yc.Wantlist.WantType.Have};pn.BlockPresenceType={Have:Yc.BlockPresenceType.Have,DontHave:Yc.BlockPresenceType.DontHave};nEe.exports=pn});var gm=p(($Nt,sEe)=>{u();"use strict";var vC=1e3;sEe.exports={maxProvidersPerRequest:3,providerRequestTimeout:10*vC,hasBlockTimeout:15*vC,provideTimeout:15*vC,kMaxPriority:Math.pow(2,31)-1,maxListeners:1e3,wantlistSendDebounceMs:1}});var aEe=p((GNt,oEe)=>{u();oEe.exports=Zmt;function Zmt(r,e,t){var i=null,n=null,s=function(){i&&(clearTimeout(i),n=null,i=null)},o=function(){var c=n;s(),c&&c()},a=function(){if(!e)return r.apply(this,arguments);var c=this,f=arguments,l=t&&!i;if(s(),n=function(){r.apply(c,f)},i=setTimeout(function(){if(i=null,!l){var h=n;return n=null,h()}},e),l)return n()};return a.cancel=s,a.flush=o,a}});var uEe=p((YNt,cEe)=>{u();"use strict";var e1t=aEe(),t1t=x0(),r1t=gl().logger,{wantlistSendDebounceMs:i1t}=gm();cEe.exports=class{constructor(e,t,i){this.peerId=t,this.network=i,this.refcnt=1,this._entries=[],this._log=r1t(e,"msgqueue"),this.sendEntries=e1t(this._sendEntries.bind(this),i1t)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new t1t(!1);this._entries.forEach(t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(t){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),t.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(t=>{this._log.error("send error: %s",t.message)})}}});var fEe=p((QNt,lEe)=>{u();"use strict";var wC=x0(),n1t=dm(),s1t=gm(),o1t=uEe(),a1t=gl().logger,{base58btc:c1t}=(zr(),Vr);lEe.exports=class{constructor(e,t,i){this.peers=new Map,this.wantlist=new n1t(i),this.network=t,this._stats=i,this._peerId=e,this._log=a1t(e,"want")}_addEntries(e,t,i){let n=e.map((s,o)=>new wC.Entry(s,s1t.kMaxPriority-o,wC.WantType.Block,t));n.forEach(s=>{s.cancel?i?this.wantlist.removeForce(s.cid.toString(c1t)):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toB58String());if(t){t.refcnt++;return}t=new o1t(this._peerId,e,this.network);let i=new wC(!0);for(let n of this.wantlist.entries())i.addEntry(n[1].cid,n[1].priority);return t.addMessage(i),this.peers.set(e.toB58String(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toB58String());!t||(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}});var bEe=p((JNt,gEe)=>{u();"use strict";var hEe=To(),{pipe:dEe}=Gr(),u1t=Q_(),l1t=x0(),pEe=gm(),f1t=gl().logger,_C="/ipfs/bitswap/1.0.0",EC="/ipfs/bitswap/1.1.0",SC="/ipfs/bitswap/1.2.0",yEe=class{constructor(e,t,i,n={}){this._log=f1t(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[_C],n.b100Only||(this._protocols.unshift(EC),this._protocols.unshift(SC)),this._stats=i,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashers=n.hashers||{}}start(){this._running=!0,this._libp2p.handle(this._protocols,this._onConnection);let e=new u1t({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=this._libp2p.registrar.register(e);for(let t of this._libp2p.peerStore.peers.values()){let i=this._libp2p.connectionManager.get(t.id);i&&this._onPeerConnect(i.remotePeer)}}stop(){this._running=!1,this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:t,connection:i}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,i.remotePeer.toB58String());try{await dEe(t,hEe.decode(),async n=>{for await(let s of n)try{let o=await l1t.deserialize(s.slice(),this._hashers);await this._bitswap._receiveMessage(i.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(n){this._log(n)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t,i={}){return this._libp2p.contentRouting.findProviders(e,{timeout:pEe.providerRequestTimeout,maxNumProviders:t})}async findAndConnect(e,t){let i=[];for await(let n of this.findProviders(e,pEe.maxProvidersPerRequest,t))this._log(`connecting to provider ${n.id}`),i.push(this.connectTo(n.id,t).catch(s=>{this._log.error(s)}));await Promise.all(i)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");let i=e.toB58String();this._log("sendMessage to %s",i,t);let n=await this._libp2p.dial(e),{stream:s,protocol:o}=await n.newStream([SC,EC,_C]),a;switch(o){case _C:a=t.serializeToBitswap100();break;case EC:case SC:a=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}h1t(s,a,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){let i=e.toB58String();if(this._stats){for(let n of t.values())this._stats.push(i,"dataSent",n.length);this._stats.push(i,"blocksSent",t.size)}}};async function h1t(r,e,t){try{await dEe([e],hEe.encode(),r)}catch(i){t(i)}}gEe.exports=yEe});var wEe=p((ZNt,vEe)=>{u();"use strict";var d1t=dm(),mEe=class{constructor(e){this.partner=e,this.wantlist=new d1t,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,i){this.wantlist.add(e,t,i)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};vEe.exports=mEe});var SEe=p((eDt,EEe)=>{u();"use strict";var _Ee=class extends Map{constructor(e,t){super();this._cmp=t||this._defaultSort,this._keys=[];for(let[i,n]of e||[])this.set(i,n)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let i=this._find(t);this._keys.splice(i,0,t)}set(e,t){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,t);let i=this._find(e);return this._keys.splice(i,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let i=1;i<this._keys.length;i++){if(this._keys[t+i]===e)return t+i;if(this._keys[t-i]===e)return t-i}return-1}_find(e){let t=0,i=this._keys.length;for(;t<i;){let n=t+i>>>1,s=this._kCmp(this._keys[n],e);if(s<0)t=n+1;else if(s>0)i=n;else return n}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(!!e)for(let i of this._keys)e.apply(t,[[i,this.get(i)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}};EEe.exports=_Ee});var REe=p((tDt,TEe)=>{u();"use strict";var AEe=SEe(),p1t={hasNewInfo(){return!1},merge(){}},xEe=class{constructor(e=p1t){this._taskMerger=e,this._byPeer=new AEe([],AC.compare)}pushTasks(e,t){let i=this._byPeer.get(e.toB58String());i||(i=new AC(e,this._taskMerger)),i.pushTasks(t),this._byPeer.set(e.toB58String(),i)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:i,pendingSize:n}=t.popTasks(e);if(i.length===0)return{tasks:i,pendingSize:n};let s=t.peerId;return t.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:i,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){let i=this._byPeer.get(t.toB58String());i&&i.remove(e)}tasksDone(e,t){let i=this._byPeer.get(e.toB58String());if(!i)return;let n=this._byPeer.indexOf(e.toB58String());for(let s of t)i.taskDone(s);this._byPeer.update(n)}},AC=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new IEe,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let i of this._active)i.topic===e.topic&&t.push(i);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,i=[],n=this._pending.tasks();for(let s=0;s<n.length&&t<e;s++){let o=n[s];i.push(o),t+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:i,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},IEe=class{constructor(){this._tasks=new AEe([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let i=this._tasks.get(e);if(!i)return;let n=this._tasks.indexOf(e);i.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};TEe.exports=xEe});var CEe=p((rDt,PEe)=>{u();"use strict";var y1t={hasNewInfo(r,e){let t=!1,i=!1;for(let n of e)n.data.haveBlock&&(t=!0),n.data.isWantBlock&&(i=!0);return!!(!i&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){let t=r.data,i=e.data;!i.haveBlock&&t.haveBlock&&(i.haveBlock=t.haveBlock,i.blockSize=t.blockSize),!i.isWantBlock&&t.isWantBlock&&(i.isWantBlock=!0,(!i.haveBlock||t.haveBlock)&&(i.haveBlock=t.haveBlock,e.size=r.size)),i.isWantBlock&&i.haveBlock&&(e.size=i.blockSize)}};PEe.exports=y1t});var BEe=p((iDt,kEe)=>{u();"use strict";var{CID:xC}=(uu(),Rh),{base58btc:OS}=(zr(),Vr),bm=x0(),OEe=bm.WantType,g1t=dm(),b1t=wEe(),m1t=REe(),v1t=CEe(),{logger:w1t}=gl(),_1t=16*1024,E1t=1024,qEe=class{constructor(e,t,i,n,s={}){this._log=w1t(e,"engine"),this.blockstore=t,this.network=i,this._stats=n,this._opts=this._processOpts(s),this.ledgerMap=new Map,this._running=!1,this._requestQueue=new m1t(v1t)}_processOpts(e){return{maxSizeReplaceHasWithBlock:E1t,targetMessageSize:_1t,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:i}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let n=new bm(!1);n.setPendingBytes(i);let s=[],o=new Map;for(let c of t){let f=xC.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(f),o.set(c.topic,c.data)):n.addHave(f):n.addDontHave(f)}let a=await this._getBlocks(s);for(let[c,f]of o){let l=xC.parse(c),h=a.get(c);h?n.addBlock(l,h):f.sendDontHave&&n.addDontHave(l)}if(n.empty){e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let[c,f]of a.entries())e&&this.messageSent(e,xC.parse(c),f)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?i.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?{peer:i.partner,value:i.debtRatio(),sent:i.accounting.bytesSent,recv:i.accounting.bytesRecv,exchanged:i.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let t of this.ledgerMap.values())for(let i of e){let n=t.wantlistContains(i.cid);if(!n)continue;let s=i.data.length,o=this._sendAsBlock(n.wantType,s),a=s;o||(a=bm.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(t.partner,[{topic:n.cid.toString(OS),priority:n.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){let i=this._findOrCreate(e);if(t.empty)return;if(t.full&&(i.wantlist=new g1t),this._updateBlockAccounting(t.blocks,i),t.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],s=[];t.wantlist.forEach(o=>{o.cancel?(i.cancelWant(o.cid),n.push(o.cid)):(i.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,t){for(let i of t)this._requestQueue.remove(i.toString(OS),e)}async _addWants(e,t){let i=await this._getBlockSizes(t.map(s=>s.cid)),n=[];for(let s of t){let o=s.cid.toString(OS),a=i.get(o);if(a==null)s.sendDontHave&&n.push({topic:o,priority:s.priority,size:bm.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===OEe.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),f=a;c||(f=bm.blockPresenceSize(s.cid)),n.push({topic:o,priority:s.priority,size:f,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===OEe.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([i,n])=>[i,n.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async i=>{try{let n=await this.blockstore.get(i);t.set(i.toString(OS),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",i,n)}})),t}_updateBlockAccounting(e,t){for(let i of e.values())this._log("got block (%s bytes)",i.length),t.receivedBytes(i.length)}messageSent(e,t,i){let n=this._findOrCreate(e);n.sentBytes(i.length),n.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){}_findOrCreate(e){let t=e.toB58String(),i=this.ledgerMap.get(t);if(i)return i;let n=new b1t(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};kEe.exports=qEe});var FEe=p((nDt,UEe)=>{u();"use strict";var{EventEmitter:S1t}=br(),NEe=Ze(),A1t=gm(),x1t=gl().logger,DEe=r=>`unwant:${NEe(r.multihash.bytes,"base64")}`,MEe=r=>`block:${NEe(r.multihash.bytes,"base64")}`,LEe=class extends S1t{constructor(e){super();this.setMaxListeners(A1t.maxListeners),this._log=x1t(e,"notif")}hasBlock(e,t){let i=MEe(e);this._log(i),this.emit(i,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");let i=MEe(e),n=DEe(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(i,c),o(new Error(`Block for ${e} unwanted`))},c=f=>{this.removeListener(n,a),s(f)};this.once(n,a),this.once(i,c),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.removeListener(i,c),this.removeListener(n,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=DEe(e);this._log(t),this.emit(t)}};UEe.exports=LEe});var zEe=p((sDt,VEe)=>{u();"use strict";var{EventEmitter:I1t}=br(),KEe=KR(),jEe=class extends I1t{constructor(e,t){super();this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(i=>{this._stats[i]=BigInt(0),this._movingAverages[i]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[i][n]=KEe(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=n/t*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=KEe(a)),c.push(i,s)})}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};VEe.exports=jEe});var YEe=p((oDt,WEe)=>{u();"use strict";var{EventEmitter:T1t}=br(),HEe=zEe(),$Ee={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},GEe=class extends T1t{constructor(e=[],t=$Ee){super();let i=Object.assign({},$Ee,t);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=e,this._options=i,this._enabled=this._options.enabled,this._global=new HEe(e,i),this._global.on("update",n=>this.emit("update",n)),this._peers=new Map}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(t)}push(e,t,i){if(this._enabled&&(this._global.push(t,i),e)){let n=this._peers.get(e);n||(n=new HEe(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,i)}}disconnected(e){let t=e.toB58String(),i=this._peers.get(t);i&&(i.stop(),this._peers.delete(t))}};WEe.exports=GEe});var JEe=p((aDt,QEe)=>{u();"use strict";var R1t=fEe(),P1t=bEe(),C1t=BEe(),O1t=FEe(),q1t=gl().logger,k1t=YEe(),{AbortController:B1t}=Ji(),{anySignal:N1t}=wl(),{BlockstoreAdapter:D1t}=X_(),{CID:M1t}=(uu(),Rh),L1t={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},U1t=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],XEe=class extends D1t{constructor(e,t,i={}){super();this._libp2p=e,this._log=q1t(this.peerId),this._options=Object.assign({},L1t,i),this._stats=new k1t(U1t,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new P1t(e,this,this._stats,{hashers:i.hashers}),this.blockstore=t,this.engine=new C1t(this.peerId,t,this.network,this._stats),this.wm=new R1t(this.peerId,this.network,this._stats),this.notifications=new O1t(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(n){this._log("failed to receive message",t)}if(t.blocks.size===0)return;let i=[];for(let[n,s]of t.blocks.entries()){let o=M1t.parse(n);i.push({wasWanted:this.wm.wantlist.contains(o),cid:o,data:s})}this.wm.cancelWants(i.filter(({wasWanted:n})=>n).map(({cid:n})=>n)),await Promise.all(i.map(({cid:n,wasWanted:s,data:o})=>this._handleReceivedBlock(e,n,o,s)))}async _handleReceivedBlock(e,t,i,n){this._log("received block");let s=await this.blockstore.has(t);this._updateReceiveCounters(e.toB58String(),t,i,s),!!n&&await this.put(t,i)}_updateReceiveCounters(e,t,i,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",i.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",i.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){let i=(f,l)=>(this.wm.wantBlocks([f],l),this.notifications.wantBlock(f,l)),n=!1,s=async(f,l)=>{try{return await this.blockstore.get(f,l)}catch(h){if(h.code!=="ERR_NOT_FOUND")throw h;return n||(n=!0,this.network.findAndConnect(f).catch(d=>this._log.error(d))),i(f,l)}},o=new B1t,a=t.signal?N1t([t.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(i=>this.notifications.unwantBlock(i))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,i){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(let{key:i,value:n}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(i,n),yield{key:i,value:n}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(){this.wm.start(),this.network.start(),this.engine.start(),this.started=!0}stop(){this._stats.stop(),this.wm.stop(),this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}};QEe.exports=XEe});var eSe=p((cDt,ZEe)=>{u();"use strict";var F1t=JEe(),K1t=(r,e,t={})=>new F1t(r,e,t);ZEe.exports={createBitswap:K1t}});var nSe=p((uDt,iSe)=>{u();"use strict";var{BlockstoreAdapter:j1t}=X_(),V1t=Pd(),tSe=Ra(),rSe=class extends j1t{constructor(e,t){super();this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,t,i={}){this.bitswap.isStarted()?await this.bitswap.put(e,t,i):await this.child.put(e,t,i)}async*putMany(e,t={}){this.bitswap.isStarted()?yield*this.bitswap.putMany(e,t):yield*this.child.putMany(e,t)}async get(e,t={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,t):this.child.get(e,t)}async*getMany(e,t={}){let i=tSe(),n=tSe();Promise.resolve().then(async()=>{for await(let s of e)!await this.has(s)&&this.bitswap.isStarted()?i.push(s):n.push(s);i.end(),n.end()}),yield*V1t(this.bitswap.getMany(i,t),this.child.getMany(n,t))}async delete(e,t){await this.child.delete(e,t)}async*deleteMany(e,t){yield*this.child.deleteMany(e,t)}async has(e,t={}){return this.child.has(e,t)}async*query(e,t={}){yield*this.child.query(e,t)}async*queryKeys(e,t={}){yield*this.child.queryKeys(e,t)}};iSe.exports=rSe});var oSe=p((lDt,sSe)=>{u();"use strict";var{createBitswap:z1t}=eSe(),H1t=fC(),{Multiaddr:$1t}=et(),G1t=ue(),W1t=nSe(),qS=class{constructor(e,t,i,n,s){this.peerId=e,this.libp2p=t,this.bitswap=i,this.repo=n,this.blockstore=s}static async start({peerId:e,repo:t,print:i,options:n}){t.closed&&await t.open();let s=await t.config.getAll(),o=await H1t({options:n,repo:t,peerId:e,multiaddrs:Y1t(e,s),config:s,keychainConfig:void 0});o.keychain&&await o.loadKeychain(),await o.start();for(let f of o.multiaddrs)i(`Swarm listening on ${f}/p2p/${e.toB58String()}`);let a=z1t(o,t.blocks,{statsEnabled:!0});await a.start();let c=new W1t(t.blocks,a);return t.blocks=c,t.pins.blockstore=c,new qS(e,o,a,t,c)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await Promise.all([e.bitswap.stop(),e.libp2p.stop()])}};sSe.exports=qS;var Y1t=(r,e)=>{let t=r.toB58String(),i=[],n=e.Addresses&&e.Addresses.Swarm||[];for(let s of n){let o=new $1t(s);if(o.protoCodes().includes(X1t))throw G1t(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==t&&(o=o.encapsulate(`/p2p/${t}`)),i.push(o)}return i},X1t=479});var cSe=p((fDt,aSe)=>{u();"use strict";var Q1t=Oe();aSe.exports=({network:r})=>{async function e(t={}){let i=[],{libp2p:n}=await r.use(t);for(let[s,o]of n.peerStore.peers.entries())i.push({id:s,addrs:o.addresses.map(a=>a.multiaddr)});return i}return Q1t(e)}});var lSe=p((hDt,uSe)=>{u();"use strict";var J1t=Oe();uSe.exports=({network:r})=>{async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.dial(t,i)}return J1t(e)}});var hSe=p((dDt,fSe)=>{u();"use strict";var Z1t=Oe();fSe.exports=({network:r})=>{async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.hangUp(t)}return Z1t(e)}});var pSe=p((pDt,dSe)=>{u();"use strict";var evt=Oe();dSe.exports=({network:r})=>{async function e(t={}){let{libp2p:i}=await r.use(t);return i.multiaddrs}return evt(e)}});var gSe=p((yDt,ySe)=>{u();"use strict";var tvt=Oe();ySe.exports=({network:r})=>{async function e(t={}){let{libp2p:i}=await r.use(t),n=[];for(let[s,o]of i.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(t.verbose||t.direction)&&(c.direction=a.stat.direction),t.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),n.push(c)}return n}return tvt(e)}});var vSe=p((gDt,mSe)=>{u();"use strict";var rvt=cSe(),ivt=lSe(),nvt=hSe(),svt=pSe(),ovt=gSe(),bSe=class{constructor({network:e}){this.addrs=rvt({network:e}),this.connect=ivt({network:e}),this.disconnect=nvt({network:e}),this.localAddrs=svt({network:e}),this.peers=ovt({network:e})}};mSe.exports=bSe});var _Se=p((bDt,wSe)=>{u();"use strict";var avt=rt(),mm={success:!0,time:0,text:""},cvt=Oe();wSe.exports=({network:r})=>{async function*e(t,i={}){let{libp2p:n}=await r.use();i.count=i.count||10;let s=avt.createFromB58String(t),o=n.peerStore.get(s),a=o&&o.id;if(!a){yield{...mm,text:`Looking up peer ${t}`};let l=await n.peerRouting.findPeer(s);a=l&&l.id}if(!a)throw new Error("Peer was not found");yield{...mm,text:`PING ${a.toB58String()}`};let c=0,f=0;for(let l=0;l<i.count;l++)try{let h=await n.ping(a);f+=h,c++,yield{...mm,time:h}}catch(h){yield{...mm,success:!1,text:h.toString()}}if(c){let l=f/c;yield{...mm,text:`Average latency: ${l}ms`}}}return cvt(e)}});var xSe=p((mDt,ASe)=>{u();"use strict";var ESe=rt(),{CID:SSe}=(xe(),Ce),kS=ue(),{NotEnabledError:uvt}=Iu(),lvt=Ag(),T0=Oe();ASe.exports=({network:r,repo:e})=>{let{get:t,put:i,findProvs:n,findPeer:s,provide:o,query:a}={async get(c,f={}){let{libp2p:l}=await R0(r,f);return l._dht.get(IC(c),f)},async*put(c,f,l){let{libp2p:h}=await R0(r,l);yield*h._dht.put(IC(c),f)},async*findProvs(c,f={numProviders:20}){let{libp2p:l}=await R0(r,f);for await(let h of l._dht.findProviders(IC(c),{maxNumProviders:f.numProviders,signal:f.signal}))yield{id:h.id.toB58String(),addrs:h.addrs}},async findPeer(c,f){let{libp2p:l}=await R0(r,f),h=await l._dht.findPeer(ESe.createFromB58String(c));return{id:h.id.toB58String(),addrs:h.multiaddrs}},async*provide(c,f={recursive:!1}){let{libp2p:l}=await R0(r,f),h=Array.isArray(c)?c:[c];for(let g in c)if(typeof c[g]=="string")try{c[g]=SSe.parse(c[g])}catch(m){throw kS(m,"ERR_INVALID_CID")}if(!(await Promise.all(h.map(g=>e.blocks.has(g)))).every(g=>g))throw kS(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(f.recursive)throw kS(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");for(let g of c)yield l._dht.provide(g)},async*query(c,f){let{libp2p:l}=await R0(r,f);for await(let h of l._dht.getClosestPeers(ESe.createFromB58String(c).toBytes()))yield{id:h.toB58String(),addrs:[]}}};return{get:T0(t),put:T0(i),findProvs:T0(n),findPeer:T0(s),provide:T0(o),query:T0(a)}};var fvt=r=>{try{let e=r.toString().split("/").filter(t=>t&&t!=="ipfs"&&t!=="ipns")[0];return SSe.parse(e).bytes}catch(e){throw kS(e,"ERR_INVALID_CID")}},IC=r=>r instanceof Uint8Array?r:fvt(r),R0=async(r,e)=>{let t=await r.use(e);if(lvt(t.libp2p,"_config.dht.enabled",!1))return t;throw new uvt("dht not enabled")}});var TSe=p((vDt,ISe)=>{u();"use strict";var vm=Oe(),hvt=ue(),{NotEnabledError:dvt}=Iu(),pvt=Ag();ISe.exports=({network:r,config:e})=>{let t=pvt(e||{},"Pubsub.Enabled",!0);return{subscribe:t?vm(i):wm,unsubscribe:t?vm(n):wm,publish:t?vm(s):wm,ls:t?vm(o):wm,peers:t?vm(a):wm};async function i(c,f,l={}){let{libp2p:h}=await r.use(l);return h.pubsub.subscribe(c,f,l)}async function n(c,f,l={}){let{libp2p:h}=await r.use(l);h.pubsub.unsubscribe(c,f,l)}async function s(c,f,l={}){let{libp2p:h}=await r.use(l);if(!f)throw hvt(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await h.pubsub.publish(c,f)}async function o(c={}){let{libp2p:f}=await r.use(c);return f.pubsub.getTopics()}async function a(c,f={}){let{libp2p:l}=await r.use(f);return l.pubsub.getSubscribers(c)}};var wm=async()=>{throw new dvt("pubsub not enabled")}});var qSe=p((wDt,OSe)=>{u();"use strict";var yvt=mr().bind({ignoreUndefined:!0}),{isTest:gvt}=G0(),TC=me()("ipfs"),RSe=ue(),{UnixFS:bvt}=mi(),PSe=(xt(),At),mvt=(mc(),$l),{identity:CSe}=(cc(),aa),{bases:vvt,hashes:wvt,codecs:_vt}=(n6(),i6),Evt=j9(),{AlreadyInitializedError:Svt}=Iu(),Avt=ct(),xvt=PU(),Ivt=OU(),Tvt=XU(),Rvt=JU(),Pvt=rF(),Cvt=lV(),Ovt=LH(),qvt=f$(),kvt=p$(),Bvt=g$(),Nvt=I$(),Dvt=j$(),Mvt=tG(),Lvt=GY(),Uvt=YY(),Fvt=QY(),Kvt=c4(),jvt=PX(),Vvt=LX(),zvt=KX(),Hvt=uJ(),$vt=RJ(),Gvt=ZJ(),Wvt=aZ(),Yvt=dZ(),Xvt=O2e(),Qvt=oSe(),Jvt=Rv(),Zvt=vSe(),ewt=_Se(),twt=xSe(),rwt=TSe(),iwt=AT(),nwt=xT(),swt=IT(),BS=class{constructor({print:e,storage:t,codecs:i,options:n}){let{peerId:s,repo:o,keychain:a}=t,c=Jvt.create(Qvt),f=Vvt(n.preload),l=Tvt(),h=Rvt({network:c}),d=new Ovt(n);this.hashers=new nwt({hashers:Object.values(wvt).concat(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]),loadHasher:n.ipld&&n.ipld.loadHasher}),this.bases=new swt({bases:Object.values(vvt).concat(n.ipld&&n.ipld.bases?n.ipld.bases:[]),loadBase:n.ipld&&n.ipld.loadBase});let y=new Cvt({repo:o,codecs:i}),g=new Mvt({codecs:i,hashers:this.hashers,preload:f,repo:o}),m=new qvt({dns:l,ipns:d,repo:o,codecs:i,peerId:s,isOnline:h,keychain:a,options:n}),E=Pvt({repo:o,codecs:i,bases:this.bases,name:m}),_=new jvt({repo:o,codecs:i,hashers:this.hashers,preload:f}),T=Object.assign(kvt({repo:o,codecs:i,resolve:E,preload:f}),{local:Bvt({repo:t.repo})}),{add:q,addAll:z,cat:V,get:M,ls:$}=new Lvt({preload:f,repo:o,options:n.EXPERIMENTAL}),X=Hvt({repo:o,preload:f,hashers:this.hashers,options:n}),Q=zvt({files:X,preload:f,options:n.preload});this.preload=f,this.name=m,this.ipns=d,this.pin=y,this.resolve=E,this.block=g,this.refs=T,this.start=xvt({network:c,peerId:s,repo:o,preload:f,ipns:d,mfsPreload:Q,print:e,keychain:a,options:n}),this.stop=Ivt({network:c,preload:f,mfsPreload:Q,ipns:d,repo:o}),this.dht=twt({network:c,repo:o}),this.pubsub=rwt({network:c,config:n.config}),this.dns=l,this.isOnline=h,this.id=Fvt({network:c,peerId:s}),this.version=Uvt({repo:o}),this.bitswap=new Nvt({network:c}),this.bootstrap=new Dvt({repo:o}),this.config=Kvt({repo:o}),this.ping=ewt({network:c}),this.add=q,this.addAll=z,this.cat=V,this.get=M,this.ls=$,this.dag=_,this.files=X,this.key=new $vt({keychain:a}),this.object=new Gvt({preload:f,codecs:i,repo:o}),this.repo=new Wvt({repo:o,hashers:this.hashers}),this.stats=new Yvt({repo:o,network:c}),this.swarm=new Zvt({network:c}),Object.defineProperty(this,"libp2p",{get(){let w=c.try();return w?w.libp2p:void 0}});let O=()=>Promise.reject(RSe(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),b=async function*(){throw RSe(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=O,this.diag={cmds:O,net:O,sys:O},this.log={level:O,ls:O,tail:b},this.mount=O,this.codecs=i}async init(){throw new Svt}static async create(e={}){e=yvt(awt(),e);let t=e.init||{},i={name:CSe.name,code:CSe.code,encode:f=>f,decode:f=>f},n=new iwt({codecs:Object.values(_vt).concat([PSe,mvt,i]).concat(e.ipld&&e.ipld.codecs||[]),loadCodec:e.ipld&&e.ipld.loadCodec}),s=e.silent?TC:console.log,o=await Xvt.start(s,n,e),a=await o.repo.config.getAll(),c=new BS({storage:o,print:s,codecs:n,options:{...e,config:a}});if(await c.preload.start(),c.ipns.startOffline(o),o.isNew&&!t.emptyRepo){let f=await owt(c);TC("adding default assets"),await Evt({addAll:c.addAll,print:s}),TC("initializing IPNS keyspace"),await c.ipns.initializeKeyspace(o.peerId.privKey,Avt(`/ipfs/${f}`))}return e.start!==!1&&await c.start(),c}};OSe.exports=BS;var owt=async r=>{let e=PSe.encode({Data:new bvt({type:"directory"}).marshal(),Links:[]}),t=await r.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await r.pin.add(t),t},awt=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!gvt,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}})});var gwt=p((_Dt,kSe)=>{u();"use strict";var cwt=QS(),uwt=c3(),lwt=rt(),fwt=Ea(),hwt=sd(),{multiaddr:dwt}=et(),{CID:pwt}=(xe(),Ce),{create:ywt}=qSe();kSe.exports={create:ywt,crypto:fwt,isIPFS:hwt,CID:pwt,multiaddr:dwt,PeerId:lwt,globSource:cwt,urlSource:uwt}});return gwt();})();
/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
return IpfsCore}));
